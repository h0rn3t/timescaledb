diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_ddl.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_ddl.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_ddl.out	2025-11-06 02:35:39.289068546 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_ddl.out	2025-11-06 02:43:07.039134834 +0000
@@ -1738,19 +1738,14 @@
 -- fully compressed
 EXPLAIN (buffers off, costs off) SELECT * FROM test_partials ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on test_partials
-   Order: test_partials."time"
-   ->  Sort
-         Sort Key: _hyper_33_120_chunk."time"
+ Sort
+   Sort Key: test_partials."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_33_120_chunk
                ->  Seq Scan on compress_hyper_34_123_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_33_121_chunk
-         ->  Sort
-               Sort Key: compress_hyper_34_124_chunk._ts_meta_min_1
+         ->  Custom Scan (ColumnarScan) on _hyper_33_121_chunk
                ->  Seq Scan on compress_hyper_34_124_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_33_122_chunk
-         ->  Sort
-               Sort Key: compress_hyper_34_125_chunk._ts_meta_min_1
+         ->  Custom Scan (ColumnarScan) on _hyper_33_122_chunk
                ->  Seq Scan on compress_hyper_34_125_chunk
 
 -- test P, F, F
@@ -1939,30 +1934,19 @@
 
 EXPLAIN (buffers off, costs off) SELECT * FROM test_partials ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on test_partials
-   Order: test_partials."time"
-   ->  Sort
-         Sort Key: _hyper_33_120_chunk."time"
+ Sort
+   Sort Key: test_partials."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_33_120_chunk
                ->  Seq Scan on compress_hyper_34_127_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_33_121_chunk
-         ->  Sort
-               Sort Key: compress_hyper_34_128_chunk._ts_meta_min_1
+         ->  Custom Scan (ColumnarScan) on _hyper_33_121_chunk
                ->  Seq Scan on compress_hyper_34_128_chunk
-   ->  Merge Append
-         Sort Key: test_partials."time"
          ->  Custom Scan (ColumnarScan) on _hyper_33_122_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_34_129_chunk._ts_meta_min_1
-                     ->  Seq Scan on compress_hyper_34_129_chunk
-         ->  Index Scan Backward using _hyper_33_122_chunk_test_partials_time_idx on _hyper_33_122_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_33_126_chunk
-         ->  Sort
-               Sort Key: compress_hyper_34_131_chunk._ts_meta_min_1
+               ->  Seq Scan on compress_hyper_34_129_chunk
+         ->  Seq Scan on _hyper_33_122_chunk
+         ->  Custom Scan (ColumnarScan) on _hyper_33_126_chunk
                ->  Seq Scan on compress_hyper_34_131_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_33_130_chunk
-         ->  Sort
-               Sort Key: compress_hyper_34_132_chunk._ts_meta_min_1
+         ->  Custom Scan (ColumnarScan) on _hyper_33_130_chunk
                ->  Seq Scan on compress_hyper_34_132_chunk
 
 -- verify result correctness
@@ -2044,18 +2028,13 @@
 -- plan is still the same
 EXPLAIN (BUFFERS OFF, COSTS OFF) SELECT * FROM space_part ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on space_part
-   Order: space_part."time"
-   ->  Merge Append
-         Sort Key: space_part."time"
+ Sort
+   Sort Key: space_part."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_135_chunk._ts_meta_min_1, compress_hyper_36_135_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_135_chunk
-         ->  Index Scan Backward using _hyper_35_133_chunk_space_part_time_idx on _hyper_35_133_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_136_chunk._ts_meta_min_1, compress_hyper_36_136_chunk._ts_meta_max_1
+               ->  Seq Scan on compress_hyper_36_135_chunk
+         ->  Seq Scan on _hyper_35_133_chunk
+         ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
                ->  Seq Scan on compress_hyper_36_136_chunk
 
 -- now add more chunks that do adhere to the new space partitioning
@@ -2069,23 +2048,16 @@
 -- plan still ok
 EXPLAIN (BUFFERS OFF, COSTS OFF) SELECT * FROM space_part ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on space_part
-   Order: space_part."time"
-   ->  Merge Append
-         Sort Key: space_part."time"
+ Sort
+   Sort Key: space_part."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_135_chunk._ts_meta_min_1, compress_hyper_36_135_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_135_chunk
-         ->  Index Scan Backward using _hyper_35_133_chunk_space_part_time_idx on _hyper_35_133_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_136_chunk._ts_meta_min_1, compress_hyper_36_136_chunk._ts_meta_max_1
+               ->  Seq Scan on compress_hyper_36_135_chunk
+         ->  Seq Scan on _hyper_35_133_chunk
+         ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
                ->  Seq Scan on compress_hyper_36_136_chunk
-   ->  Merge Append
-         Sort Key: space_part."time"
-         ->  Index Scan Backward using _hyper_35_137_chunk_space_part_time_idx on _hyper_35_137_chunk
-         ->  Index Scan Backward using _hyper_35_138_chunk_space_part_time_idx on _hyper_35_138_chunk
+         ->  Seq Scan on _hyper_35_137_chunk
+         ->  Seq Scan on _hyper_35_138_chunk
 
 -- compress them
 SELECT compress_chunk(c, if_not_compressed=>true) FROM show_chunks('space_part') c;
@@ -2101,26 +2073,17 @@
 -- plan still ok
 EXPLAIN (BUFFERS OFF, COSTS OFF) SELECT * FROM space_part ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on space_part
-   Order: space_part."time"
-   ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_135_chunk._ts_meta_min_1, compress_hyper_36_135_chunk._ts_meta_max_1
+ Sort
+   Sort Key: space_part."time"
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
                ->  Seq Scan on compress_hyper_36_135_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_136_chunk._ts_meta_min_1, compress_hyper_36_136_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
                ->  Seq Scan on compress_hyper_36_136_chunk
-   ->  Merge Append
-         Sort Key: space_part."time"
          ->  Custom Scan (ColumnarScan) on _hyper_35_137_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_139_chunk._ts_meta_min_1, compress_hyper_36_139_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_139_chunk
+               ->  Seq Scan on compress_hyper_36_139_chunk
          ->  Custom Scan (ColumnarScan) on _hyper_35_138_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_140_chunk._ts_meta_min_1, compress_hyper_36_140_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_140_chunk
+               ->  Seq Scan on compress_hyper_36_140_chunk
 
 -- make second one of them partial
 insert into space_part values
@@ -2129,27 +2092,18 @@
 VACUUM ANALYZE space_part;
 EXPLAIN (BUFFERS OFF, COSTS OFF) SELECT * FROM space_part ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on space_part
-   Order: space_part."time"
-   ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_135_chunk._ts_meta_min_1, compress_hyper_36_135_chunk._ts_meta_max_1
+ Sort
+   Sort Key: space_part."time"
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
                ->  Seq Scan on compress_hyper_36_135_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_136_chunk._ts_meta_min_1, compress_hyper_36_136_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
                ->  Seq Scan on compress_hyper_36_136_chunk
-   ->  Merge Append
-         Sort Key: space_part."time"
          ->  Custom Scan (ColumnarScan) on _hyper_35_137_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_139_chunk._ts_meta_min_1, compress_hyper_36_139_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_139_chunk
+               ->  Seq Scan on compress_hyper_36_139_chunk
          ->  Custom Scan (ColumnarScan) on _hyper_35_138_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_140_chunk._ts_meta_min_1, compress_hyper_36_140_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_140_chunk
-         ->  Index Scan Backward using _hyper_35_138_chunk_space_part_time_idx on _hyper_35_138_chunk
+               ->  Seq Scan on compress_hyper_36_140_chunk
+         ->  Seq Scan on _hyper_35_138_chunk
 
 -- make other one partial too
 INSERT INTO space_part VALUES
@@ -2157,28 +2111,19 @@
 VACUUM ANALYZE space_part;
 EXPLAIN (BUFFERS OFF, COSTS OFF) SELECT * FROM space_part ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on space_part
-   Order: space_part."time"
-   ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_135_chunk._ts_meta_min_1, compress_hyper_36_135_chunk._ts_meta_max_1
+ Sort
+   Sort Key: space_part."time"
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _hyper_35_133_chunk
                ->  Seq Scan on compress_hyper_36_135_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
-         ->  Sort
-               Sort Key: compress_hyper_36_136_chunk._ts_meta_min_1, compress_hyper_36_136_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _hyper_35_134_chunk
                ->  Seq Scan on compress_hyper_36_136_chunk
-   ->  Merge Append
-         Sort Key: space_part."time"
          ->  Custom Scan (ColumnarScan) on _hyper_35_137_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_139_chunk._ts_meta_min_1, compress_hyper_36_139_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_139_chunk
-         ->  Index Scan Backward using _hyper_35_137_chunk_space_part_time_idx on _hyper_35_137_chunk
+               ->  Seq Scan on compress_hyper_36_139_chunk
+         ->  Seq Scan on _hyper_35_137_chunk
          ->  Custom Scan (ColumnarScan) on _hyper_35_138_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_140_chunk._ts_meta_min_1, compress_hyper_36_140_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_140_chunk
-         ->  Index Scan Backward using _hyper_35_138_chunk_space_part_time_idx on _hyper_35_138_chunk
+               ->  Seq Scan on compress_hyper_36_140_chunk
+         ->  Seq Scan on _hyper_35_138_chunk
 
 -- test creation of unique expression index does not interfere with enabling compression
 -- github issue 6205
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/columnar_scan_cost.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/columnar_scan_cost.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/columnar_scan_cost.out	2025-11-06 02:35:39.286068578 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/columnar_scan_cost.out	2025-11-06 02:43:41.323772025 +0000
@@ -22,86 +22,86 @@
 vacuum freeze analyze costtab;
 explain (buffers off) select * from costtab;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.10 rows=0 width=108)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=142)
 
 explain (buffers off) select * from costtab where s = '1';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..11.12 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..1.12 rows=0 width=108)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=1 width=142)
          Filter: (s = '1'::text)
 
 explain (buffers off) select * from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.10 rows=1 width=108)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=142)
 
 explain (buffers off) select * from costtab where ti = '200';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.38..31.12 rows=3000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.38..1.12 rows=1 width=108)
    Vectorized Filter: (ti = '200'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=3 width=142)
          Filter: _timescaledb_functions.bloom1_contains(_ts_meta_v2_bloom1_ti, '200'::text)
 
 explain (buffers off) select * from costtab where fi = 200;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.15 rows=10000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.15 rows=1 width=108)
    Vectorized Filter: (fi = '200'::double precision)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.15 rows=10 width=142)
          Filter: ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision))
 
 explain (buffers off) select ts from costtab;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=4)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.10 rows=0 width=4)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=44)
 
 explain (buffers off) select ts from costtab where s = '1';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..11.12 rows=1000 width=4)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..1.12 rows=0 width=4)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=1 width=46)
          Filter: (s = '1'::text)
 
 explain (buffers off) select ts from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=4)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.10 rows=1 width=4)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=76)
 
 explain (buffers off) select ts, s from costtab;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=36)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.10 rows=0 width=36)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=46)
 
 explain (buffers off) select ts, s from costtab where s = '1';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..11.12 rows=1000 width=36)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..1.12 rows=0 width=36)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=1 width=46)
          Filter: (s = '1'::text)
 
 explain (buffers off) select ts, s from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=36)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.10 rows=1 width=36)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=78)
 
 explain (buffers off) select * from costtab where ts = 5000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.15..11.15 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.15..1.15 rows=1 width=108)
    Vectorized Filter: (ts = 5000)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.15 rows=1 width=142)
          Filter: ((_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000))
 
 explain (buffers off) select * from costtab where fi = 200 and ts = 5000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.20..11.20 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.20..1.20 rows=1 width=108)
    Vectorized Filter: ((fi = '200'::double precision) AND (ts = 5000))
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.20 rows=1 width=142)
          Filter: ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision) AND (_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000))
 
 explain (buffers off) select * from costtab where s = '1' or (fi = 200 and ts = 5000);
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.23..11.22 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.23..1.23 rows=1 width=108)
    Filter: ((s = '1'::text) OR ((fi = '200'::double precision) AND (ts = 5000)))
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.23 rows=1 width=142)
          Filter: ((s = '1'::text) OR ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision) AND (_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000)))
@@ -131,10 +131,10 @@
 vacuum analyze estimate_count;
 explain (analyze, timing off, summary off, buffers off) select * from estimate_count;
 --- QUERY PLAN ---
- Append  (cost=0.04..2974.00 rows=193000 width=20) (actual rows=193000.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_3_chunk  (cost=0.04..679.00 rows=64000 width=20) (actual rows=64000.00 loops=1)
+ Append  (cost=0.04..79.00 rows=0 width=20) (actual rows=193000.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_3_chunk  (cost=0.04..39.00 rows=0 width=20) (actual rows=64000.00 loops=1)
          ->  Seq Scan on compress_hyper_4_5_chunk  (cost=0.00..39.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_4_chunk  (cost=0.04..1330.00 rows=129000 width=20) (actual rows=129000.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_4_chunk  (cost=0.04..40.00 rows=0 width=20) (actual rows=129000.00 loops=1)
          ->  Seq Scan on compress_hyper_4_6_chunk  (cost=0.00..40.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
 
 -- different batch sizes
@@ -153,10 +153,10 @@
 vacuum analyze estimate_count;
 explain (analyze, timing off, summary off, buffers off) select * from estimate_count;
 --- QUERY PLAN ---
- Append  (cost=0.04..934.50 rows=57100 width=20) (actual rows=57100.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk  (cost=0.04..230.00 rows=19100 width=20) (actual rows=19100.00 loops=1)
+ Append  (cost=0.04..78.00 rows=0 width=20) (actual rows=57100.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk  (cost=0.04..39.00 rows=0 width=20) (actual rows=19100.00 loops=1)
          ->  Seq Scan on compress_hyper_4_9_chunk  (cost=0.00..39.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk  (cost=0.04..419.00 rows=38000 width=20) (actual rows=38000.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk  (cost=0.04..39.00 rows=0 width=20) (actual rows=38000.00 loops=1)
          ->  Seq Scan on compress_hyper_4_10_chunk  (cost=0.00..39.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
 
 -- more different batch sizes
@@ -175,10 +175,10 @@
 vacuum analyze estimate_count;
 explain (analyze, timing off, summary off, buffers off) select * from estimate_count;
 --- QUERY PLAN ---
- Append  (cost=0.04..265.21 rows=12548 width=20) (actual rows=12559.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_11_chunk  (cost=0.04..83.50 rows=4550 width=20) (actual rows=4553.00 loops=1)
+ Append  (cost=0.04..77.00 rows=0 width=20) (actual rows=12559.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_11_chunk  (cost=0.04..38.00 rows=0 width=20) (actual rows=4553.00 loops=1)
          ->  Seq Scan on compress_hyper_4_13_chunk  (cost=0.00..38.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_12_chunk  (cost=0.04..118.97 rows=7997 width=20) (actual rows=8006.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_12_chunk  (cost=0.04..39.00 rows=0 width=20) (actual rows=8006.00 loops=1)
          ->  Seq Scan on compress_hyper_4_14_chunk  (cost=0.00..39.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
 
 -- more different + one very frequent
@@ -198,10 +198,10 @@
 vacuum analyze estimate_count;
 explain (analyze, timing off, summary off, buffers off) select * from estimate_count;
 --- QUERY PLAN ---
- Append  (cost=0.04..2340.10 rows=150807 width=20) (actual rows=150830.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk  (cost=0.04..541.81 rows=50281 width=20) (actual rows=50287.00 loops=1)
+ Append  (cost=0.04..78.00 rows=0 width=20) (actual rows=150830.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk  (cost=0.04..39.00 rows=0 width=20) (actual rows=50287.00 loops=1)
          ->  Seq Scan on compress_hyper_4_17_chunk  (cost=0.00..39.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_16_chunk  (cost=0.04..1044.26 rows=100526 width=20) (actual rows=100543.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_16_chunk  (cost=0.04..39.00 rows=0 width=20) (actual rows=100543.00 loops=1)
          ->  Seq Scan on compress_hyper_4_18_chunk  (cost=0.00..39.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
 
 -- single row. Postgres generates all-zero entry in pg_statistics in this case,
@@ -218,7 +218,7 @@
 vacuum analyze estimate_count;
 explain (analyze, timing off, summary off, buffers off) select * from estimate_count;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_3_19_chunk  (cost=1.01..11.01 rows=1000 width=20) (actual rows=1.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_3_19_chunk  (cost=1.01..1.01 rows=0 width=20) (actual rows=1.00 loops=1)
    ->  Seq Scan on compress_hyper_4_20_chunk  (cost=0.00..1.01 rows=1 width=88) (actual rows=1.00 loops=1)
 
 -- no statistics
@@ -250,10 +250,10 @@
 ;
 explain (analyze, timing off, summary off, buffers off) select * from estimate_count;
 --- QUERY PLAN ---
- Append  (cost=0.04..30079.00 rows=2000000 width=20) (actual rows=193000.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_21_chunk  (cost=0.04..10039.00 rows=1000000 width=20) (actual rows=64000.00 loops=1)
+ Append  (cost=0.04..79.00 rows=0 width=20) (actual rows=193000.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_21_chunk  (cost=0.04..39.00 rows=0 width=20) (actual rows=64000.00 loops=1)
          ->  Seq Scan on compress_hyper_4_23_chunk  (cost=0.00..39.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_22_chunk  (cost=0.04..10040.00 rows=1000000 width=20) (actual rows=129000.00 loops=1)
+   ->  Custom Scan (ColumnarScan) on _hyper_3_22_chunk  (cost=0.04..40.00 rows=0 width=20) (actual rows=129000.00 loops=1)
          ->  Seq Scan on compress_hyper_4_24_chunk  (cost=0.00..40.00 rows=1000 width=88) (actual rows=1000.00 loops=1)
 
 -- Test a high-cardinality orderby column
@@ -269,7 +269,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts > 200000 and ts < 300000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.43..1005.58 rows=99000 width=4) (actual rows=99999.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.43..15.58 rows=1 width=4) (actual rows=99999.00 loops=1)
    Vectorized Filter: ((ts > 200000) AND (ts < 300000))
    Rows Removed by Filter: 1
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..15.58 rows=99 width=44) (actual rows=100.00 loops=1)
@@ -278,7 +278,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts = 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=18.70..28.70 rows=1000 width=4) (actual rows=1.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=18.70..18.70 rows=1 width=4) (actual rows=1.00 loops=1)
    Vectorized Filter: (ts = 500000)
    Rows Removed by Filter: 999
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..18.70 rows=1 width=44) (actual rows=1.00 loops=1)
@@ -287,7 +287,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts < 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.32..5001.61 rows=498000 width=4) (actual rows=499999.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.32..21.61 rows=1 width=4) (actual rows=499999.00 loops=1)
    Vectorized Filter: (ts < 500000)
    Rows Removed by Filter: 1
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..21.61 rows=498 width=44) (actual rows=500.00 loops=1)
@@ -296,7 +296,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts > 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.05..5035.50 rows=501000 width=4) (actual rows=500000.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.05..25.50 rows=1 width=4) (actual rows=500000.00 loops=1)
    Vectorized Filter: (ts > 500000)
    ->  Seq Scan on compress_hyper_6_26_chunk  (cost=0.00..25.50 rows=501 width=44) (actual rows=500.00 loops=1)
          Filter: (_ts_meta_max_1 > 500000)
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_bloom_sparse-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_bloom_sparse-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_bloom_sparse-17.out	2025-11-06 02:35:39.286068578 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_bloom_sparse-17.out	2025-11-06 02:43:46.709713078 +0000
@@ -98,13 +98,13 @@
    ->  Nested Loop (actual rows=3.00 loops=1)
          Join Filter: (_hyper_1_1_chunk.value = query.value)
          Rows Removed by Join Filter: 29997
-         ->  CTE Scan on query (actual rows=3.00 loops=1)
-               Output: query.value
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=10000.00 loops=3)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=10000.00 loops=1)
                Output: _hyper_1_1_chunk.value
                Bulk Decompression: true
-               ->  Seq Scan on _timescaledb_internal.compress_hyper_2_2_chunk (actual rows=10.00 loops=3)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_2_2_chunk (actual rows=10.00 loops=1)
                      Output: compress_hyper_2_2_chunk._ts_meta_count, compress_hyper_2_2_chunk._ts_meta_min_1, compress_hyper_2_2_chunk._ts_meta_max_1, compress_hyper_2_2_chunk.x, compress_hyper_2_2_chunk._ts_meta_v2_bloom1_value, compress_hyper_2_2_chunk.value, compress_hyper_2_2_chunk._ts_meta_v2_bloom1_u, compress_hyper_2_2_chunk.u, compress_hyper_2_2_chunk._ts_meta_v2_min_ts, compress_hyper_2_2_chunk._ts_meta_v2_max_ts, compress_hyper_2_2_chunk.ts
+         ->  CTE Scan on query (actual rows=3.00 loops=10000)
+               Output: query.value
 
 ;
 with query(value) as materialized (values (md5(3516::text)), (md5(9347::text)),
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_qualpushdown_saop.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_qualpushdown_saop.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_qualpushdown_saop.out	2025-11-06 02:35:39.287068567 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_qualpushdown_saop.out	2025-11-06 02:45:42.400309359 +0000
@@ -405,12 +405,14 @@
    ->  Limit (actual rows=10.00 loops=1)
          ->  Group (actual rows=10.00 loops=1)
                Group Key: saop_1.segmentby
-               ->  Merge Append (actual rows=39133.00 loops=1)
+               ->  Sort (actual rows=39133.00 loops=1)
                      Sort Key: saop_1.segmentby
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=19567.00 loops=1)
-                           ->  Index Scan using compress_hyper_2_3_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_3_chunk compress_hyper_2_3_chunk_1 (actual rows=28.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk _hyper_1_2_chunk_1 (actual rows=19567.00 loops=1)
-                           ->  Index Scan using compress_hyper_2_4_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=28.00 loops=1)
+                     Sort Method: quicksort 
+                     ->  Append (actual rows=100001.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=50001.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_2_3_chunk compress_hyper_2_3_chunk_1 (actual rows=69.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk _hyper_1_2_chunk_1 (actual rows=50000.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=69.00 loops=1)
    ->  Append (actual rows=4348.00 loops=10)
          ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=2174.00 loops=10)
                Filter: (segmentby = ANY ((ARRAY[saop_1.segmentby])))
@@ -424,101 +426,4 @@
 explain (analyze, buffers off, costs off, timing off, summary off)
 with arrays as (select array[segmentby] a from saop group by segmentby order by segmentby limit 10)
 select * from saop, arrays where with_minmax = any(a);
---- QUERY PLAN ---
- Nested Loop (actual rows=34482.00 loops=1)
-   Join Filter: (saop.with_minmax = ANY (arrays.a))
-   Rows Removed by Join Filter: 965528
-   ->  Append (actual rows=100001.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=50001.00 loops=1)
-               ->  Seq Scan on compress_hyper_2_3_chunk (actual rows=69.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=50000.00 loops=1)
-               ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=69.00 loops=1)
-   ->  Materialize (actual rows=10.00 loops=100001)
-         ->  Subquery Scan on arrays (actual rows=10.00 loops=1)
-               ->  Limit (actual rows=10.00 loops=1)
-                     ->  Group (actual rows=10.00 loops=1)
-                           Group Key: saop_1.segmentby
-                           ->  Merge Append (actual rows=39133.00 loops=1)
-                                 Sort Key: saop_1.segmentby
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=19567.00 loops=1)
-                                       ->  Index Scan using compress_hyper_2_3_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_3_chunk compress_hyper_2_3_chunk_1 (actual rows=28.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk _hyper_1_2_chunk_1 (actual rows=19567.00 loops=1)
-                                       ->  Index Scan using compress_hyper_2_4_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=28.00 loops=1)
-
-explain (analyze, buffers off, costs off, timing off, summary off)
-with arrays as (select array[segmentby] a from saop group by segmentby order by segmentby limit 10)
-select * from saop, arrays where with_bloom = any(a);
---- QUERY PLAN ---
- Nested Loop (actual rows=474.00 loops=1)
-   Join Filter: (saop.with_bloom = ANY (arrays.a))
-   Rows Removed by Join Filter: 999536
-   ->  Append (actual rows=100001.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=50001.00 loops=1)
-               ->  Seq Scan on compress_hyper_2_3_chunk (actual rows=69.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=50000.00 loops=1)
-               ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=69.00 loops=1)
-   ->  Materialize (actual rows=10.00 loops=100001)
-         ->  Subquery Scan on arrays (actual rows=10.00 loops=1)
-               ->  Limit (actual rows=10.00 loops=1)
-                     ->  Group (actual rows=10.00 loops=1)
-                           Group Key: saop_1.segmentby
-                           ->  Merge Append (actual rows=39133.00 loops=1)
-                                 Sort Key: saop_1.segmentby
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=19567.00 loops=1)
-                                       ->  Index Scan using compress_hyper_2_3_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_3_chunk compress_hyper_2_3_chunk_1 (actual rows=28.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk _hyper_1_2_chunk_1 (actual rows=19567.00 loops=1)
-                                       ->  Index Scan using compress_hyper_2_4_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=28.00 loops=1)
-
--- Array parameter of prepared statements.
-prepare array_param as select * from saop where with_bloom = any($1);
-set timescaledb.enable_chunk_append to off;
--- Generic plans.
-set plan_cache_mode = force_generic_plan;
-explain (analyze, buffers off, costs off, timing off, summary off)
-execute array_param(array['1', '10']);
---- QUERY PLAN ---
- Append (actual rows=270.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=135.00 loops=1)
-         Vectorized Filter: (with_bloom = ANY ($1))
-         Rows Removed by Filter: 49866
-         ->  Seq Scan on compress_hyper_2_3_chunk (actual rows=69.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=135.00 loops=1)
-         Vectorized Filter: (with_bloom = ANY ($1))
-         Rows Removed by Filter: 49865
-         ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=69.00 loops=1)
-
-explain (analyze, buffers off, costs off, timing off, summary off)
-execute array_param(array[]::text[]);
---- QUERY PLAN ---
- Append (actual rows=0.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: (with_bloom = ANY ($1))
-         Rows Removed by Filter: 50001
-         ->  Seq Scan on compress_hyper_2_3_chunk (actual rows=69.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: (with_bloom = ANY ($1))
-         Rows Removed by Filter: 50000
-         ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=69.00 loops=1)
-
--- Custom plans.
-set plan_cache_mode = force_custom_plan;
-explain (analyze, buffers off, costs off, timing off, summary off)
-execute array_param(array['1', '10']);
---- QUERY PLAN ---
- Append (actual rows=270.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=135.00 loops=1)
-         Vectorized Filter: (with_bloom = ANY ('{1,10}'::text[]))
-         Rows Removed by Filter: 49866
-         ->  Seq Scan on compress_hyper_2_3_chunk (actual rows=69.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=135.00 loops=1)
-         Vectorized Filter: (with_bloom = ANY ('{1,10}'::text[]))
-         Rows Removed by Filter: 49865
-         ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=69.00 loops=1)
-
-explain (analyze, buffers off, costs off, timing off, summary off)
-execute array_param(array[]::text[]);
---- QUERY PLAN ---
- Result (actual rows=0.00 loops=1)
-   One-Time Filter: false
-
-reset timescaledb.enable_chunk_append;
+timeout: sending signal TERM to command ‘/home/runner/postgresql/bin/psql’
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_sort_transform.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_sort_transform.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_sort_transform.out	2025-11-06 02:35:39.287068567 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_sort_transform.out	2025-11-06 02:43:42.570758316 +0000
@@ -98,11 +98,11 @@
                ->  Merge Append (actual rows=3.00 loops=1)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
                      ->  Partial GroupAggregate (actual rows=2.00 loops=1)
-                           Group Key: time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time")
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=7.00 loops=1)
-                                 ->  Sort (actual rows=3.00 loops=1)
-                                       Sort Key: compress_hyper_2_4_chunk._ts_meta_min_1
-                                       Sort Method: quicksort 
+                           Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                           ->  Sort (actual rows=7.00 loops=1)
+                                 Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1440.00 loops=1)
                                        ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=3.00 loops=1)
                      ->  Partial GroupAggregate (actual rows=2.00 loops=1)
                            Group Key: time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time")
@@ -110,10 +110,10 @@
                ->  Merge Append (never executed)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
                      ->  Partial GroupAggregate (never executed)
-                           Group Key: time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time")
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: compress_hyper_2_5_chunk._ts_meta_min_1
+                           Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                           ->  Sort (never executed)
+                                 Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
                                        ->  Seq Scan on compress_hyper_2_5_chunk (never executed)
                      ->  Partial GroupAggregate (never executed)
                            Group Key: time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time")
@@ -121,10 +121,10 @@
                ->  Merge Append (never executed)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
                      ->  Partial GroupAggregate (never executed)
-                           Group Key: time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time")
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: compress_hyper_2_6_chunk._ts_meta_min_1
+                           Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                           ->  Sort (never executed)
+                                 Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
                                        ->  Seq Scan on compress_hyper_2_6_chunk (never executed)
                      ->  Partial GroupAggregate (never executed)
                            Group Key: time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time")
@@ -144,11 +144,11 @@
                ->  Merge Append (actual rows=3.00 loops=1)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
                      ->  Partial GroupAggregate (actual rows=2.00 loops=1)
-                           Group Key: time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time")
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=7.00 loops=1)
-                                 ->  Sort (actual rows=3.00 loops=1)
-                                       Sort Key: compress_hyper_2_4_chunk._ts_meta_min_1
-                                       Sort Method: quicksort 
+                           Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                           ->  Sort (actual rows=7.00 loops=1)
+                                 Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1440.00 loops=1)
                                        ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=3.00 loops=1)
                      ->  Partial GroupAggregate (actual rows=2.00 loops=1)
                            Group Key: time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time")
@@ -156,10 +156,10 @@
                ->  Merge Append (never executed)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
                      ->  Partial GroupAggregate (never executed)
-                           Group Key: time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time")
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: compress_hyper_2_5_chunk._ts_meta_min_1
+                           Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                           ->  Sort (never executed)
+                                 Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
                                        ->  Seq Scan on compress_hyper_2_5_chunk (never executed)
                      ->  Partial GroupAggregate (never executed)
                            Group Key: time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time")
@@ -167,10 +167,10 @@
                ->  Merge Append (never executed)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
                      ->  Partial GroupAggregate (never executed)
-                           Group Key: time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time")
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: compress_hyper_2_6_chunk._ts_meta_min_1
+                           Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                           ->  Sort (never executed)
+                                 Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
                                        ->  Seq Scan on compress_hyper_2_6_chunk (never executed)
                      ->  Partial GroupAggregate (never executed)
                            Group Key: time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time")
@@ -188,31 +188,31 @@
          ->  Merge Append (actual rows=3.00 loops=1)
                Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
                ->  Partial GroupAggregate (actual rows=2.00 loops=1)
-                     Group Key: time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time")
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=7.00 loops=1)
-                           ->  Sort (actual rows=3.00 loops=1)
-                                 Sort Key: compress_hyper_2_4_chunk._ts_meta_min_1
-                                 Sort Method: quicksort 
+                     Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                     ->  Sort (actual rows=7.00 loops=1)
+                           Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1440.00 loops=1)
                                  ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=3.00 loops=1)
                ->  Partial GroupAggregate (actual rows=2.00 loops=1)
                      Group Key: time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time")
                      ->  Index Only Scan Backward using _hyper_1_1_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_1_chunk (actual rows=7.00 loops=1)
                ->  Partial GroupAggregate (actual rows=1.00 loops=1)
-                     Group Key: time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time")
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=4.00 loops=1)
-                           ->  Sort (actual rows=3.00 loops=1)
-                                 Sort Key: compress_hyper_2_5_chunk._ts_meta_min_1
-                                 Sort Method: quicksort 
+                     Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                     ->  Sort (actual rows=4.00 loops=1)
+                           Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=1512.00 loops=1)
                                  ->  Seq Scan on compress_hyper_2_5_chunk (actual rows=3.00 loops=1)
                ->  Partial GroupAggregate (actual rows=1.00 loops=1)
                      Group Key: time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time")
                      ->  Index Only Scan Backward using _hyper_1_2_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_2_chunk (actual rows=4.00 loops=1)
                ->  Partial GroupAggregate (actual rows=1.00 loops=1)
-                     Group Key: time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time")
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=4.00 loops=1)
-                           ->  Sort (actual rows=3.00 loops=1)
-                                 Sort Key: compress_hyper_2_6_chunk._ts_meta_min_1
-                                 Sort Method: quicksort 
+                     Group Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                     ->  Sort (actual rows=4.00 loops=1)
+                           Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=507.00 loops=1)
                                  ->  Seq Scan on compress_hyper_2_6_chunk (actual rows=3.00 loops=1)
                ->  Partial GroupAggregate (actual rows=1.00 loops=1)
                      Group Key: time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time")
@@ -230,27 +230,27 @@
                Order: time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time")
                ->  Merge Append (actual rows=1.00 loops=1)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
-                     ->  Result (actual rows=1.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1.00 loops=1)
-                                 ->  Sort (actual rows=3.00 loops=1)
-                                       Sort Key: compress_hyper_2_4_chunk._ts_meta_min_1
-                                       Sort Method: quicksort 
+                     ->  Sort (actual rows=1.00 loops=1)
+                           Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                           Sort Method: top-N heapsort 
+                           ->  Result (actual rows=1440.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1440.00 loops=1)
                                        ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=3.00 loops=1)
                      ->  Index Scan Backward using _hyper_1_1_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_1_chunk (actual rows=1.00 loops=1)
                ->  Merge Append (never executed)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: compress_hyper_2_5_chunk._ts_meta_min_1
+                     ->  Sort (never executed)
+                           Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                           ->  Result (never executed)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
                                        ->  Seq Scan on compress_hyper_2_5_chunk (never executed)
                      ->  Index Scan Backward using _hyper_1_2_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_2_chunk (never executed)
                ->  Merge Append (never executed)
                      Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: compress_hyper_2_6_chunk._ts_meta_min_1
+                     ->  Sort (never executed)
+                           Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                           ->  Result (never executed)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
                                        ->  Seq Scan on compress_hyper_2_6_chunk (never executed)
                      ->  Index Scan Backward using _hyper_1_3_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_3_chunk (never executed)
 
@@ -264,27 +264,27 @@
          Order: time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time")
          ->  Merge Append (actual rows=1.00 loops=1)
                Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
-               ->  Result (actual rows=1.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1.00 loops=1)
-                           ->  Sort (actual rows=3.00 loops=1)
-                                 Sort Key: compress_hyper_2_4_chunk._ts_meta_min_1
-                                 Sort Method: quicksort 
+               ->  Sort (actual rows=1.00 loops=1)
+                     Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_1_chunk."time"))
+                     Sort Method: top-N heapsort 
+                     ->  Result (actual rows=1440.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1440.00 loops=1)
                                  ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=3.00 loops=1)
                ->  Index Scan Backward using _hyper_1_1_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_1_chunk (actual rows=1.00 loops=1)
          ->  Merge Append (never executed)
                Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
-               ->  Result (never executed)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
-                           ->  Sort (never executed)
-                                 Sort Key: compress_hyper_2_5_chunk._ts_meta_min_1
+               ->  Sort (never executed)
+                     Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_2_chunk."time"))
+                     ->  Result (never executed)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
                                  ->  Seq Scan on compress_hyper_2_5_chunk (never executed)
                ->  Index Scan Backward using _hyper_1_2_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_2_chunk (never executed)
          ->  Merge Append (never executed)
                Sort Key: (time_bucket('@ 1 min'::interval, ht_metrics_partially_compressed."time"))
-               ->  Result (never executed)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
-                           ->  Sort (never executed)
-                                 Sort Key: compress_hyper_2_6_chunk._ts_meta_min_1
+               ->  Sort (never executed)
+                     Sort Key: (time_bucket('@ 1 min'::interval, _hyper_1_3_chunk."time"))
+                     ->  Result (never executed)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
                                  ->  Seq Scan on compress_hyper_2_6_chunk (never executed)
                ->  Index Scan Backward using _hyper_1_3_chunk_ht_metrics_partially_compressed_time_idx on _hyper_1_3_chunk (never executed)
 
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression.out	2025-11-06 02:35:39.288068556 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression.out	2025-11-06 02:45:52.859175866 +0000
@@ -1751,32 +1751,20 @@
 --- QUERY PLAN ---
  Limit
    Output: ht_metrics_partially_compressed."time", ht_metrics_partially_compressed.device, ht_metrics_partially_compressed.value
-   ->  Custom Scan (ChunkAppend) on public.ht_metrics_partially_compressed
+   ->  Sort
          Output: ht_metrics_partially_compressed."time", ht_metrics_partially_compressed.device, ht_metrics_partially_compressed.value
-         Order: ht_metrics_partially_compressed."time" DESC, ht_metrics_partially_compressed.device
-         Startup Exclusion: false
-         Runtime Exclusion: false
-         ->  Sort
-               Output: _hyper_41_78_chunk."time", _hyper_41_78_chunk.device, _hyper_41_78_chunk.value
-               Sort Key: _hyper_41_78_chunk."time" DESC, _hyper_41_78_chunk.device
+         Sort Key: ht_metrics_partially_compressed."time" DESC, ht_metrics_partially_compressed.device
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_41_78_chunk
                      Output: _hyper_41_78_chunk."time", _hyper_41_78_chunk.device, _hyper_41_78_chunk.value
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_42_80_chunk
                            Output: compress_hyper_42_80_chunk._ts_meta_count, compress_hyper_42_80_chunk.device, compress_hyper_42_80_chunk._ts_meta_min_1, compress_hyper_42_80_chunk._ts_meta_max_1, compress_hyper_42_80_chunk."time", compress_hyper_42_80_chunk.value
-         ->  Merge Append
-               Sort Key: ht_metrics_partially_compressed."time" DESC, ht_metrics_partially_compressed.device
-               ->  Sort
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_41_77_chunk
                      Output: _hyper_41_77_chunk."time", _hyper_41_77_chunk.device, _hyper_41_77_chunk.value
-                     Sort Key: _hyper_41_77_chunk."time" DESC, _hyper_41_77_chunk.device
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_41_77_chunk
-                           Output: _hyper_41_77_chunk."time", _hyper_41_77_chunk.device, _hyper_41_77_chunk.value
-                           ->  Seq Scan on _timescaledb_internal.compress_hyper_42_79_chunk
-                                 Output: compress_hyper_42_79_chunk._ts_meta_count, compress_hyper_42_79_chunk.device, compress_hyper_42_79_chunk._ts_meta_min_1, compress_hyper_42_79_chunk._ts_meta_max_1, compress_hyper_42_79_chunk."time", compress_hyper_42_79_chunk.value
-               ->  Sort
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_42_79_chunk
+                           Output: compress_hyper_42_79_chunk._ts_meta_count, compress_hyper_42_79_chunk.device, compress_hyper_42_79_chunk._ts_meta_min_1, compress_hyper_42_79_chunk._ts_meta_max_1, compress_hyper_42_79_chunk."time", compress_hyper_42_79_chunk.value
+               ->  Seq Scan on _timescaledb_internal._hyper_41_77_chunk
                      Output: _hyper_41_77_chunk."time", _hyper_41_77_chunk.device, _hyper_41_77_chunk.value
-                     Sort Key: _hyper_41_77_chunk."time" DESC, _hyper_41_77_chunk.device
-                     ->  Seq Scan on _timescaledb_internal._hyper_41_77_chunk
-                           Output: _hyper_41_77_chunk."time", _hyper_41_77_chunk.device, _hyper_41_77_chunk.value
 
 -- Test parameter change on rescan
 -- issue 6069
@@ -1867,13 +1855,12 @@
                Order: i6069."timestamp" DESC
                Startup Exclusion: false
                Runtime Exclusion: true
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_43_83_chunk
+               ->  Sort
                      Output: _hyper_43_83_chunk."timestamp", _hyper_43_83_chunk.attr_id, _hyper_43_83_chunk.number_val
-                     Filter: ((_hyper_43_83_chunk."timestamp" > 'Fri Jun 30 00:00:00 2023'::timestamp without time zone) AND (_hyper_43_83_chunk."timestamp" < 'Thu Jul 06 00:00:00 2023'::timestamp without time zone))
-                     Batch Sorted Merge: true
-                     ->  Sort
-                           Output: compress_hyper_44_86_chunk._ts_meta_count, compress_hyper_44_86_chunk.attr_id, compress_hyper_44_86_chunk._ts_meta_min_1, compress_hyper_44_86_chunk._ts_meta_max_1, compress_hyper_44_86_chunk."timestamp", compress_hyper_44_86_chunk.number_val
-                           Sort Key: compress_hyper_44_86_chunk._ts_meta_max_1 DESC
+                     Sort Key: _hyper_43_83_chunk."timestamp" DESC
+                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_43_83_chunk
+                           Output: _hyper_43_83_chunk."timestamp", _hyper_43_83_chunk.attr_id, _hyper_43_83_chunk.number_val
+                           Vectorized Filter: ((_hyper_43_83_chunk."timestamp" > 'Fri Jun 30 00:00:00 2023'::timestamp without time zone) AND (_hyper_43_83_chunk."timestamp" < 'Thu Jul 06 00:00:00 2023'::timestamp without time zone))
                            ->  Index Scan using compress_hyper_44_86_chunk_attr_id__ts_meta_min_1__ts_meta__idx on _timescaledb_internal.compress_hyper_44_86_chunk
                                  Output: compress_hyper_44_86_chunk._ts_meta_count, compress_hyper_44_86_chunk.attr_id, compress_hyper_44_86_chunk._ts_meta_min_1, compress_hyper_44_86_chunk._ts_meta_max_1, compress_hyper_44_86_chunk."timestamp", compress_hyper_44_86_chunk.number_val
                                  Index Cond: ((compress_hyper_44_86_chunk.attr_id = "*VALUES*".column1) AND (compress_hyper_44_86_chunk._ts_meta_min_1 < 'Thu Jul 06 00:00:00 2023'::timestamp without time zone) AND (compress_hyper_44_86_chunk._ts_meta_max_1 > 'Fri Jun 30 00:00:00 2023'::timestamp without time zone))
@@ -2088,76 +2075,45 @@
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
    Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-   ->  Custom Scan (ChunkAppend) on public.sensor_data_compressed (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-         Order: sensor_data_compressed."time" DESC
-         Startup Exclusion: false
-         Runtime Exclusion: false
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_93_chunk (actual rows=2.00 loops=1)
-               Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (actual rows=2.00 loops=1)
-                     Output: compress_hyper_46_100_chunk._ts_meta_count, compress_hyper_46_100_chunk.sensor_id, compress_hyper_46_100_chunk._ts_meta_min_1, compress_hyper_46_100_chunk._ts_meta_max_1, compress_hyper_46_100_chunk."time", compress_hyper_46_100_chunk.cpu, compress_hyper_46_100_chunk.temperature
-                     Sort Key: compress_hyper_46_100_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+         Sort Key: sensor_data_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_93_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_100_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_100_chunk._ts_meta_count, compress_hyper_46_100_chunk.sensor_id, compress_hyper_46_100_chunk._ts_meta_min_1, compress_hyper_46_100_chunk._ts_meta_max_1, compress_hyper_46_100_chunk."time", compress_hyper_46_100_chunk.cpu, compress_hyper_46_100_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_92_chunk (actual rows=2.00 loops=1)
-               Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (actual rows=2.00 loops=1)
-                     Output: compress_hyper_46_99_chunk._ts_meta_count, compress_hyper_46_99_chunk.sensor_id, compress_hyper_46_99_chunk._ts_meta_min_1, compress_hyper_46_99_chunk._ts_meta_max_1, compress_hyper_46_99_chunk."time", compress_hyper_46_99_chunk.cpu, compress_hyper_46_99_chunk.temperature
-                     Sort Key: compress_hyper_46_99_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_92_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_99_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_99_chunk._ts_meta_count, compress_hyper_46_99_chunk.sensor_id, compress_hyper_46_99_chunk._ts_meta_min_1, compress_hyper_46_99_chunk._ts_meta_max_1, compress_hyper_46_99_chunk."time", compress_hyper_46_99_chunk.cpu, compress_hyper_46_99_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_91_chunk (actual rows=1.00 loops=1)
-               Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (actual rows=2.00 loops=1)
-                     Output: compress_hyper_46_98_chunk._ts_meta_count, compress_hyper_46_98_chunk.sensor_id, compress_hyper_46_98_chunk._ts_meta_min_1, compress_hyper_46_98_chunk._ts_meta_max_1, compress_hyper_46_98_chunk."time", compress_hyper_46_98_chunk.cpu, compress_hyper_46_98_chunk.temperature
-                     Sort Key: compress_hyper_46_98_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_91_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_98_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_98_chunk._ts_meta_count, compress_hyper_46_98_chunk.sensor_id, compress_hyper_46_98_chunk._ts_meta_min_1, compress_hyper_46_98_chunk._ts_meta_max_1, compress_hyper_46_98_chunk."time", compress_hyper_46_98_chunk.cpu, compress_hyper_46_98_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (never executed)
-               Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_46_97_chunk._ts_meta_count, compress_hyper_46_97_chunk.sensor_id, compress_hyper_46_97_chunk._ts_meta_min_1, compress_hyper_46_97_chunk._ts_meta_max_1, compress_hyper_46_97_chunk."time", compress_hyper_46_97_chunk.cpu, compress_hyper_46_97_chunk.temperature
-                     Sort Key: compress_hyper_46_97_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_97_chunk._ts_meta_count, compress_hyper_46_97_chunk.sensor_id, compress_hyper_46_97_chunk._ts_meta_min_1, compress_hyper_46_97_chunk._ts_meta_max_1, compress_hyper_46_97_chunk."time", compress_hyper_46_97_chunk.cpu, compress_hyper_46_97_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (never executed)
-               Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_46_96_chunk._ts_meta_count, compress_hyper_46_96_chunk.sensor_id, compress_hyper_46_96_chunk._ts_meta_min_1, compress_hyper_46_96_chunk._ts_meta_max_1, compress_hyper_46_96_chunk."time", compress_hyper_46_96_chunk.cpu, compress_hyper_46_96_chunk.temperature
-                     Sort Key: compress_hyper_46_96_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_96_chunk._ts_meta_count, compress_hyper_46_96_chunk.sensor_id, compress_hyper_46_96_chunk._ts_meta_min_1, compress_hyper_46_96_chunk._ts_meta_max_1, compress_hyper_46_96_chunk."time", compress_hyper_46_96_chunk.cpu, compress_hyper_46_96_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (never executed)
-               Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_46_95_chunk._ts_meta_count, compress_hyper_46_95_chunk.sensor_id, compress_hyper_46_95_chunk._ts_meta_min_1, compress_hyper_46_95_chunk._ts_meta_max_1, compress_hyper_46_95_chunk."time", compress_hyper_46_95_chunk.cpu, compress_hyper_46_95_chunk.temperature
-                     Sort Key: compress_hyper_46_95_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (actual rows=1.00 loops=1)
+                     Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (actual rows=1.00 loops=1)
                            Output: compress_hyper_46_95_chunk._ts_meta_count, compress_hyper_46_95_chunk.sensor_id, compress_hyper_46_95_chunk._ts_meta_min_1, compress_hyper_46_95_chunk._ts_meta_max_1, compress_hyper_46_95_chunk."time", compress_hyper_46_95_chunk.cpu, compress_hyper_46_95_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (never executed)
-               Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_46_94_chunk._ts_meta_count, compress_hyper_46_94_chunk.sensor_id, compress_hyper_46_94_chunk._ts_meta_min_1, compress_hyper_46_94_chunk._ts_meta_max_1, compress_hyper_46_94_chunk."time", compress_hyper_46_94_chunk.cpu, compress_hyper_46_94_chunk.temperature
-                     Sort Key: compress_hyper_46_94_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (actual rows=1.00 loops=1)
+                     Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (actual rows=1.00 loops=1)
                            Output: compress_hyper_46_94_chunk._ts_meta_count, compress_hyper_46_94_chunk.sensor_id, compress_hyper_46_94_chunk._ts_meta_min_1, compress_hyper_46_94_chunk._ts_meta_max_1, compress_hyper_46_94_chunk."time", compress_hyper_46_94_chunk.cpu, compress_hyper_46_94_chunk.temperature
 
 -- Only the first chunks should be accessed (batch sorted merge is disabled)
@@ -2167,69 +2123,45 @@
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
    Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-   ->  Custom Scan (ChunkAppend) on public.sensor_data_compressed (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-         Order: sensor_data_compressed."time" DESC
-         Startup Exclusion: false
-         Runtime Exclusion: false
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
-               Sort Key: _hyper_45_93_chunk."time" DESC
-               Sort Method: quicksort 
+         Sort Key: sensor_data_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_93_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
                      Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_100_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_100_chunk._ts_meta_count, compress_hyper_46_100_chunk.sensor_id, compress_hyper_46_100_chunk._ts_meta_min_1, compress_hyper_46_100_chunk._ts_meta_max_1, compress_hyper_46_100_chunk."time", compress_hyper_46_100_chunk.cpu, compress_hyper_46_100_chunk.temperature
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
-               Sort Key: _hyper_45_92_chunk."time" DESC
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_92_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
                      Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_99_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_99_chunk._ts_meta_count, compress_hyper_46_99_chunk.sensor_id, compress_hyper_46_99_chunk._ts_meta_min_1, compress_hyper_46_99_chunk._ts_meta_max_1, compress_hyper_46_99_chunk."time", compress_hyper_46_99_chunk.cpu, compress_hyper_46_99_chunk.temperature
-         ->  Sort (actual rows=1.00 loops=1)
-               Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
-               Sort Key: _hyper_45_91_chunk."time" DESC
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_91_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
                      Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_98_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_98_chunk._ts_meta_count, compress_hyper_46_98_chunk.sensor_id, compress_hyper_46_98_chunk._ts_meta_min_1, compress_hyper_46_98_chunk._ts_meta_max_1, compress_hyper_46_98_chunk."time", compress_hyper_46_98_chunk.cpu, compress_hyper_46_98_chunk.temperature
-         ->  Sort (never executed)
-               Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
-               Sort Key: _hyper_45_90_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
                      Bulk Decompression: true
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (never executed)
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_97_chunk._ts_meta_count, compress_hyper_46_97_chunk.sensor_id, compress_hyper_46_97_chunk._ts_meta_min_1, compress_hyper_46_97_chunk._ts_meta_max_1, compress_hyper_46_97_chunk."time", compress_hyper_46_97_chunk.cpu, compress_hyper_46_97_chunk.temperature
-         ->  Sort (never executed)
-               Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
-               Sort Key: _hyper_45_89_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
                      Bulk Decompression: true
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (never executed)
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_96_chunk._ts_meta_count, compress_hyper_46_96_chunk.sensor_id, compress_hyper_46_96_chunk._ts_meta_min_1, compress_hyper_46_96_chunk._ts_meta_max_1, compress_hyper_46_96_chunk."time", compress_hyper_46_96_chunk.cpu, compress_hyper_46_96_chunk.temperature
-         ->  Sort (never executed)
-               Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
-               Sort Key: _hyper_45_88_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (actual rows=1.00 loops=1)
                      Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
                      Bulk Decompression: true
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (never executed)
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (actual rows=1.00 loops=1)
                            Output: compress_hyper_46_95_chunk._ts_meta_count, compress_hyper_46_95_chunk.sensor_id, compress_hyper_46_95_chunk._ts_meta_min_1, compress_hyper_46_95_chunk._ts_meta_max_1, compress_hyper_46_95_chunk."time", compress_hyper_46_95_chunk.cpu, compress_hyper_46_95_chunk.temperature
-         ->  Sort (never executed)
-               Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
-               Sort Key: _hyper_45_87_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (actual rows=1.00 loops=1)
                      Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
                      Bulk Decompression: true
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (never executed)
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (actual rows=1.00 loops=1)
                            Output: compress_hyper_46_94_chunk._ts_meta_count, compress_hyper_46_94_chunk.sensor_id, compress_hyper_46_94_chunk._ts_meta_min_1, compress_hyper_46_94_chunk._ts_meta_max_1, compress_hyper_46_94_chunk."time", compress_hyper_46_94_chunk.cpu, compress_hyper_46_94_chunk.temperature
 
 RESET timescaledb.enable_decompression_sorted_merge;
@@ -2243,80 +2175,47 @@
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
    Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-   ->  Custom Scan (ChunkAppend) on public.sensor_data_compressed (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-         Order: sensor_data_compressed."time" DESC
-         Startup Exclusion: false
-         Runtime Exclusion: false
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_93_chunk (actual rows=2.00 loops=1)
-               Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (actual rows=2.00 loops=1)
-                     Output: compress_hyper_46_100_chunk._ts_meta_count, compress_hyper_46_100_chunk.sensor_id, compress_hyper_46_100_chunk._ts_meta_min_1, compress_hyper_46_100_chunk._ts_meta_max_1, compress_hyper_46_100_chunk."time", compress_hyper_46_100_chunk.cpu, compress_hyper_46_100_chunk.temperature
-                     Sort Key: compress_hyper_46_100_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+         Sort Key: sensor_data_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=13.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_93_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_100_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_100_chunk._ts_meta_count, compress_hyper_46_100_chunk.sensor_id, compress_hyper_46_100_chunk._ts_meta_min_1, compress_hyper_46_100_chunk._ts_meta_max_1, compress_hyper_46_100_chunk."time", compress_hyper_46_100_chunk.cpu, compress_hyper_46_100_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_92_chunk (actual rows=2.00 loops=1)
-               Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (actual rows=2.00 loops=1)
-                     Output: compress_hyper_46_99_chunk._ts_meta_count, compress_hyper_46_99_chunk.sensor_id, compress_hyper_46_99_chunk._ts_meta_min_1, compress_hyper_46_99_chunk._ts_meta_max_1, compress_hyper_46_99_chunk."time", compress_hyper_46_99_chunk.cpu, compress_hyper_46_99_chunk.temperature
-                     Sort Key: compress_hyper_46_99_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_92_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_99_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_99_chunk._ts_meta_count, compress_hyper_46_99_chunk.sensor_id, compress_hyper_46_99_chunk._ts_meta_min_1, compress_hyper_46_99_chunk._ts_meta_max_1, compress_hyper_46_99_chunk."time", compress_hyper_46_99_chunk.cpu, compress_hyper_46_99_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_91_chunk (actual rows=1.00 loops=1)
-               Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (actual rows=2.00 loops=1)
-                     Output: compress_hyper_46_98_chunk._ts_meta_count, compress_hyper_46_98_chunk.sensor_id, compress_hyper_46_98_chunk._ts_meta_min_1, compress_hyper_46_98_chunk._ts_meta_max_1, compress_hyper_46_98_chunk."time", compress_hyper_46_98_chunk.cpu, compress_hyper_46_98_chunk.temperature
-                     Sort Key: compress_hyper_46_98_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_91_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_98_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_98_chunk._ts_meta_count, compress_hyper_46_98_chunk.sensor_id, compress_hyper_46_98_chunk._ts_meta_min_1, compress_hyper_46_98_chunk._ts_meta_max_1, compress_hyper_46_98_chunk."time", compress_hyper_46_98_chunk.cpu, compress_hyper_46_98_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (never executed)
-               Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_46_97_chunk._ts_meta_count, compress_hyper_46_97_chunk.sensor_id, compress_hyper_46_97_chunk._ts_meta_min_1, compress_hyper_46_97_chunk._ts_meta_max_1, compress_hyper_46_97_chunk."time", compress_hyper_46_97_chunk.cpu, compress_hyper_46_97_chunk.temperature
-                     Sort Key: compress_hyper_46_97_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_97_chunk._ts_meta_count, compress_hyper_46_97_chunk.sensor_id, compress_hyper_46_97_chunk._ts_meta_min_1, compress_hyper_46_97_chunk._ts_meta_max_1, compress_hyper_46_97_chunk."time", compress_hyper_46_97_chunk.cpu, compress_hyper_46_97_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (never executed)
-               Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_46_96_chunk._ts_meta_count, compress_hyper_46_96_chunk.sensor_id, compress_hyper_46_96_chunk._ts_meta_min_1, compress_hyper_46_96_chunk._ts_meta_max_1, compress_hyper_46_96_chunk."time", compress_hyper_46_96_chunk.cpu, compress_hyper_46_96_chunk.temperature
-                     Sort Key: compress_hyper_46_96_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (actual rows=2.00 loops=1)
+                     Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_96_chunk._ts_meta_count, compress_hyper_46_96_chunk.sensor_id, compress_hyper_46_96_chunk._ts_meta_min_1, compress_hyper_46_96_chunk._ts_meta_max_1, compress_hyper_46_96_chunk."time", compress_hyper_46_96_chunk.cpu, compress_hyper_46_96_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (never executed)
-               Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_46_95_chunk._ts_meta_count, compress_hyper_46_95_chunk.sensor_id, compress_hyper_46_95_chunk._ts_meta_min_1, compress_hyper_46_95_chunk._ts_meta_max_1, compress_hyper_46_95_chunk."time", compress_hyper_46_95_chunk.cpu, compress_hyper_46_95_chunk.temperature
-                     Sort Key: compress_hyper_46_95_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (actual rows=1.00 loops=1)
+                     Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (actual rows=1.00 loops=1)
                            Output: compress_hyper_46_95_chunk._ts_meta_count, compress_hyper_46_95_chunk.sensor_id, compress_hyper_46_95_chunk._ts_meta_min_1, compress_hyper_46_95_chunk._ts_meta_max_1, compress_hyper_46_95_chunk."time", compress_hyper_46_95_chunk.cpu, compress_hyper_46_95_chunk.temperature
-         ->  Merge Append (never executed)
-               Sort Key: sensor_data_compressed."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (actual rows=1.00 loops=1)
                      Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
-                     Batch Sorted Merge: true
-                     Bulk Decompression: false
-                     ->  Sort (never executed)
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (actual rows=1.00 loops=1)
                            Output: compress_hyper_46_94_chunk._ts_meta_count, compress_hyper_46_94_chunk.sensor_id, compress_hyper_46_94_chunk._ts_meta_min_1, compress_hyper_46_94_chunk._ts_meta_max_1, compress_hyper_46_94_chunk."time", compress_hyper_46_94_chunk.cpu, compress_hyper_46_94_chunk.temperature
-                           Sort Key: compress_hyper_46_94_chunk._ts_meta_max_1 DESC
-                           ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (never executed)
-                                 Output: compress_hyper_46_94_chunk._ts_meta_count, compress_hyper_46_94_chunk.sensor_id, compress_hyper_46_94_chunk._ts_meta_min_1, compress_hyper_46_94_chunk._ts_meta_max_1, compress_hyper_46_94_chunk."time", compress_hyper_46_94_chunk.cpu, compress_hyper_46_94_chunk.temperature
-               ->  Index Scan using _hyper_45_87_chunk_sensor_data_compressed_time_idx on _timescaledb_internal._hyper_45_87_chunk (never executed)
+               ->  Index Scan using _hyper_45_87_chunk_sensor_data_compressed_time_idx on _timescaledb_internal._hyper_45_87_chunk (actual rows=1.00 loops=1)
                      Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
 
 -- Only the first chunks should be accessed (batch sorted merge is disabled)
@@ -2326,73 +2225,47 @@
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
    Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-   ->  Custom Scan (ChunkAppend) on public.sensor_data_compressed (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Output: sensor_data_compressed."time", sensor_data_compressed.sensor_id, sensor_data_compressed.cpu, sensor_data_compressed.temperature
-         Order: sensor_data_compressed."time" DESC
-         Startup Exclusion: false
-         Runtime Exclusion: false
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
-               Sort Key: _hyper_45_93_chunk."time" DESC
-               Sort Method: quicksort 
+         Sort Key: sensor_data_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=13.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_93_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_93_chunk."time", _hyper_45_93_chunk.sensor_id, _hyper_45_93_chunk.cpu, _hyper_45_93_chunk.temperature
                      Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_100_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_100_chunk._ts_meta_count, compress_hyper_46_100_chunk.sensor_id, compress_hyper_46_100_chunk._ts_meta_min_1, compress_hyper_46_100_chunk._ts_meta_max_1, compress_hyper_46_100_chunk."time", compress_hyper_46_100_chunk.cpu, compress_hyper_46_100_chunk.temperature
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
-               Sort Key: _hyper_45_92_chunk."time" DESC
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_92_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_92_chunk."time", _hyper_45_92_chunk.sensor_id, _hyper_45_92_chunk.cpu, _hyper_45_92_chunk.temperature
                      Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_99_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_99_chunk._ts_meta_count, compress_hyper_46_99_chunk.sensor_id, compress_hyper_46_99_chunk._ts_meta_min_1, compress_hyper_46_99_chunk._ts_meta_max_1, compress_hyper_46_99_chunk."time", compress_hyper_46_99_chunk.cpu, compress_hyper_46_99_chunk.temperature
-         ->  Sort (actual rows=1.00 loops=1)
-               Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
-               Sort Key: _hyper_45_91_chunk."time" DESC
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_91_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_91_chunk."time", _hyper_45_91_chunk.sensor_id, _hyper_45_91_chunk.cpu, _hyper_45_91_chunk.temperature
                      Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_46_98_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_98_chunk._ts_meta_count, compress_hyper_46_98_chunk.sensor_id, compress_hyper_46_98_chunk._ts_meta_min_1, compress_hyper_46_98_chunk._ts_meta_max_1, compress_hyper_46_98_chunk."time", compress_hyper_46_98_chunk.cpu, compress_hyper_46_98_chunk.temperature
-         ->  Sort (never executed)
-               Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
-               Sort Key: _hyper_45_90_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_90_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_90_chunk."time", _hyper_45_90_chunk.sensor_id, _hyper_45_90_chunk.cpu, _hyper_45_90_chunk.temperature
                      Bulk Decompression: true
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (never executed)
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_97_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_97_chunk._ts_meta_count, compress_hyper_46_97_chunk.sensor_id, compress_hyper_46_97_chunk._ts_meta_min_1, compress_hyper_46_97_chunk._ts_meta_max_1, compress_hyper_46_97_chunk."time", compress_hyper_46_97_chunk.cpu, compress_hyper_46_97_chunk.temperature
-         ->  Sort (never executed)
-               Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
-               Sort Key: _hyper_45_89_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_89_chunk (actual rows=2.00 loops=1)
                      Output: _hyper_45_89_chunk."time", _hyper_45_89_chunk.sensor_id, _hyper_45_89_chunk.cpu, _hyper_45_89_chunk.temperature
                      Bulk Decompression: true
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (never executed)
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_96_chunk (actual rows=2.00 loops=1)
                            Output: compress_hyper_46_96_chunk._ts_meta_count, compress_hyper_46_96_chunk.sensor_id, compress_hyper_46_96_chunk._ts_meta_min_1, compress_hyper_46_96_chunk._ts_meta_max_1, compress_hyper_46_96_chunk."time", compress_hyper_46_96_chunk.cpu, compress_hyper_46_96_chunk.temperature
-         ->  Sort (never executed)
-               Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
-               Sort Key: _hyper_45_88_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_88_chunk (actual rows=1.00 loops=1)
                      Output: _hyper_45_88_chunk."time", _hyper_45_88_chunk.sensor_id, _hyper_45_88_chunk.cpu, _hyper_45_88_chunk.temperature
                      Bulk Decompression: true
-                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (never executed)
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_95_chunk (actual rows=1.00 loops=1)
                            Output: compress_hyper_46_95_chunk._ts_meta_count, compress_hyper_46_95_chunk.sensor_id, compress_hyper_46_95_chunk._ts_meta_min_1, compress_hyper_46_95_chunk._ts_meta_max_1, compress_hyper_46_95_chunk."time", compress_hyper_46_95_chunk.cpu, compress_hyper_46_95_chunk.temperature
-         ->  Merge Append (never executed)
-               Sort Key: sensor_data_compressed."time" DESC
-               ->  Sort (never executed)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (actual rows=1.00 loops=1)
                      Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
-                     Sort Key: _hyper_45_87_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_45_87_chunk (never executed)
-                           Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
-                           Bulk Decompression: true
-                           ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (never executed)
-                                 Output: compress_hyper_46_94_chunk._ts_meta_count, compress_hyper_46_94_chunk.sensor_id, compress_hyper_46_94_chunk._ts_meta_min_1, compress_hyper_46_94_chunk._ts_meta_max_1, compress_hyper_46_94_chunk."time", compress_hyper_46_94_chunk.cpu, compress_hyper_46_94_chunk.temperature
-               ->  Index Scan using _hyper_45_87_chunk_sensor_data_compressed_time_idx on _timescaledb_internal._hyper_45_87_chunk (never executed)
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_46_94_chunk (actual rows=1.00 loops=1)
+                           Output: compress_hyper_46_94_chunk._ts_meta_count, compress_hyper_46_94_chunk.sensor_id, compress_hyper_46_94_chunk._ts_meta_min_1, compress_hyper_46_94_chunk._ts_meta_max_1, compress_hyper_46_94_chunk."time", compress_hyper_46_94_chunk.cpu, compress_hyper_46_94_chunk.temperature
+               ->  Index Scan using _hyper_45_87_chunk_sensor_data_compressed_time_idx on _timescaledb_internal._hyper_45_87_chunk (actual rows=1.00 loops=1)
                      Output: _hyper_45_87_chunk."time", _hyper_45_87_chunk.sensor_id, _hyper_45_87_chunk.cpu, _hyper_45_87_chunk.temperature
 
 RESET timescaledb.enable_decompression_sorted_merge;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_insert.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_insert.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_insert.out	2025-11-06 02:35:39.290068535 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_insert.out	2025-11-06 02:46:08.672977584 +0000
@@ -719,9 +719,9 @@
 -- should be ordered append
 :PREFIX SELECT * FROM test_ordering ORDER BY 1;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_13_20_chunk
-   ->  Sort
-         Sort Key: compress_hyper_14_21_chunk._ts_meta_min_1, compress_hyper_14_21_chunk._ts_meta_max_1
+ Sort
+   Sort Key: _hyper_13_20_chunk."time"
+   ->  Custom Scan (ColumnarScan) on _hyper_13_20_chunk
          ->  Seq Scan on compress_hyper_14_21_chunk
 
 INSERT INTO test_ordering SELECT 1;
@@ -735,31 +735,25 @@
 -- the path with sort pushdown, which is desirable in most cases
 :PREFIX SELECT * FROM test_ordering ORDER BY 1;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on test_ordering
-   Order: test_ordering."time"
-   ->  Merge Append
-         Sort Key: test_ordering."time"
+ Sort
+   Sort Key: test_ordering."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_13_20_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_14_21_chunk._ts_meta_min_1, compress_hyper_14_21_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_14_21_chunk
-         ->  Index Only Scan Backward using _hyper_13_20_chunk_test_ordering_time_idx on _hyper_13_20_chunk
+               ->  Seq Scan on compress_hyper_14_21_chunk
+         ->  Seq Scan on _hyper_13_20_chunk
 
 INSERT INTO test_ordering VALUES (105),(104),(103);
 VACUUM ANALYZE test_ordering;
 -- should be ordered append
 :PREFIX SELECT * FROM test_ordering ORDER BY 1;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on test_ordering
-   Order: test_ordering."time"
-   ->  Merge Append
-         Sort Key: test_ordering."time"
+ Sort
+   Sort Key: test_ordering."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_13_20_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_14_21_chunk._ts_meta_min_1, compress_hyper_14_21_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_14_21_chunk
-         ->  Index Only Scan Backward using _hyper_13_20_chunk_test_ordering_time_idx on _hyper_13_20_chunk
-   ->  Index Only Scan Backward using _hyper_13_22_chunk_test_ordering_time_idx on _hyper_13_22_chunk
+               ->  Seq Scan on compress_hyper_14_21_chunk
+         ->  Seq Scan on _hyper_13_20_chunk
+         ->  Seq Scan on _hyper_13_22_chunk
 
 --insert into compressed + uncompressed chunk
 INSERT INTO test_ordering VALUES (21), (22),(113);
@@ -798,15 +792,12 @@
 -- should be ordered append
 :PREFIX SELECT * FROM test_ordering ORDER BY 1;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on test_ordering
-   Order: test_ordering."time"
-   ->  Custom Scan (ColumnarScan) on _hyper_13_20_chunk
-         ->  Sort
-               Sort Key: compress_hyper_14_21_chunk._ts_meta_min_1, compress_hyper_14_21_chunk._ts_meta_max_1
+ Sort
+   Sort Key: test_ordering."time"
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _hyper_13_20_chunk
                ->  Seq Scan on compress_hyper_14_21_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_13_22_chunk
-         ->  Sort
-               Sort Key: compress_hyper_14_23_chunk._ts_meta_min_1, compress_hyper_14_23_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _hyper_13_22_chunk
                ->  Seq Scan on compress_hyper_14_23_chunk
 
 SET timescaledb.enable_decompression_sorted_merge = 1;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_sequence_num_removal.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_sequence_num_removal.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_sequence_num_removal.out	2025-11-06 02:35:39.291068524 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_sequence_num_removal.out	2025-11-06 02:46:30.350707242 +0000
@@ -35,34 +35,24 @@
 :EXPLAIN SELECT * FROM hyper
 ORDER BY device_id, time;
 --- QUERY PLAN ---
- Merge Append
+ Sort
+   Output: hyper."time", hyper.device_id, hyper.val
    Sort Key: hyper.device_id, hyper."time"
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
-         Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val
-               Sort Key: compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
+               Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_5_chunk
                      Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
-         Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-               Sort Key: compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
+               Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_6_chunk
                      Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
-         Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val
-               Sort Key: compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
+               Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_7_chunk
                      Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
-         Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
-               Sort Key: compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
+               Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_8_chunk
                      Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
 
@@ -87,38 +77,24 @@
 :EXPLAIN SELECT * FROM hyper
 ORDER BY device_id DESC, time DESC;
 --- QUERY PLAN ---
- Merge Append
+ Sort
+   Output: hyper."time", hyper.device_id, hyper.val
    Sort Key: hyper.device_id DESC, hyper."time" DESC
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
-         Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val
-               Sort Key: compress_hyper_2_5_chunk.device_id DESC, compress_hyper_2_5_chunk._ts_meta_min_1 DESC, compress_hyper_2_5_chunk._ts_meta_max_1 DESC
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
+               Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_5_chunk
                      Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
-         Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-               Sort Key: compress_hyper_2_6_chunk.device_id DESC, compress_hyper_2_6_chunk._ts_meta_min_1 DESC, compress_hyper_2_6_chunk._ts_meta_max_1 DESC
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
+               Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_6_chunk
                      Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
-         Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val
-               Sort Key: compress_hyper_2_7_chunk.device_id DESC, compress_hyper_2_7_chunk._ts_meta_min_1 DESC, compress_hyper_2_7_chunk._ts_meta_max_1 DESC
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
+               Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_7_chunk
                      Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
-         Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
-               Sort Key: compress_hyper_2_8_chunk.device_id DESC, compress_hyper_2_8_chunk._ts_meta_min_1 DESC, compress_hyper_2_8_chunk._ts_meta_max_1 DESC
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
+               Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_8_chunk
                      Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
 
@@ -190,34 +166,24 @@
 :EXPLAIN SELECT * FROM hyper
 ORDER BY device_id, time;
 --- QUERY PLAN ---
- Merge Append
+ Sort
+   Output: hyper."time", hyper.device_id, hyper.val
    Sort Key: hyper.device_id, hyper."time"
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
-         Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val, compress_hyper_2_5_chunk._ts_meta_sequence_num
-               Sort Key: compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_sequence_num
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
+               Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_5_chunk
                      Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val, compress_hyper_2_5_chunk._ts_meta_sequence_num
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
-         Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-               Sort Key: compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
+               Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_6_chunk
                      Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
-         Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val, compress_hyper_2_7_chunk._ts_meta_sequence_num
-               Sort Key: compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_sequence_num
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
+               Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_7_chunk
                      Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val, compress_hyper_2_7_chunk._ts_meta_sequence_num
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
-         Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
-               Sort Key: compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
+               Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_8_chunk
                      Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
 
@@ -242,38 +208,24 @@
 :EXPLAIN SELECT * FROM hyper
 ORDER BY device_id DESC, time DESC;
 --- QUERY PLAN ---
- Merge Append
+ Sort
+   Output: hyper."time", hyper.device_id, hyper.val
    Sort Key: hyper.device_id DESC, hyper."time" DESC
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
-         Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val, compress_hyper_2_5_chunk._ts_meta_sequence_num
-               Sort Key: compress_hyper_2_5_chunk.device_id DESC, compress_hyper_2_5_chunk._ts_meta_sequence_num DESC
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
+               Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_5_chunk
                      Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val, compress_hyper_2_5_chunk._ts_meta_sequence_num
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
-         Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-               Sort Key: compress_hyper_2_6_chunk.device_id DESC, compress_hyper_2_6_chunk._ts_meta_min_1 DESC, compress_hyper_2_6_chunk._ts_meta_max_1 DESC
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
+               Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_6_chunk
                      Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
-         Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val, compress_hyper_2_7_chunk._ts_meta_sequence_num
-               Sort Key: compress_hyper_2_7_chunk.device_id DESC, compress_hyper_2_7_chunk._ts_meta_sequence_num DESC
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
+               Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_7_chunk
                      Output: compress_hyper_2_7_chunk._ts_meta_count, compress_hyper_2_7_chunk.device_id, compress_hyper_2_7_chunk._ts_meta_min_1, compress_hyper_2_7_chunk._ts_meta_max_1, compress_hyper_2_7_chunk."time", compress_hyper_2_7_chunk.val, compress_hyper_2_7_chunk._ts_meta_sequence_num
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
-         Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
-         Reverse: true
-         ->  Sort
-               Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
-               Sort Key: compress_hyper_2_8_chunk.device_id DESC, compress_hyper_2_8_chunk._ts_meta_min_1 DESC, compress_hyper_2_8_chunk._ts_meta_max_1 DESC
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
+               Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_8_chunk
                      Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
 
@@ -315,34 +267,24 @@
 :EXPLAIN SELECT * FROM hyper
 ORDER BY device_id, time;
 --- QUERY PLAN ---
- Merge Append
+ Sort
+   Output: hyper."time", hyper.device_id, hyper.val
    Sort Key: hyper.device_id, hyper."time"
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
-         Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val, compress_hyper_2_5_chunk._ts_meta_sequence_num
-               Sort Key: compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_sequence_num
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk
+               Output: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id, _hyper_1_1_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_5_chunk
                      Output: compress_hyper_2_5_chunk._ts_meta_count, compress_hyper_2_5_chunk.device_id, compress_hyper_2_5_chunk._ts_meta_min_1, compress_hyper_2_5_chunk._ts_meta_max_1, compress_hyper_2_5_chunk."time", compress_hyper_2_5_chunk.val, compress_hyper_2_5_chunk._ts_meta_sequence_num
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
-         Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-               Sort Key: compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk
+               Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_6_chunk
                      Output: compress_hyper_2_6_chunk._ts_meta_count, compress_hyper_2_6_chunk.device_id, compress_hyper_2_6_chunk._ts_meta_min_1, compress_hyper_2_6_chunk._ts_meta_max_1, compress_hyper_2_6_chunk."time", compress_hyper_2_6_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
-         Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_9_chunk._ts_meta_count, compress_hyper_2_9_chunk.device_id, compress_hyper_2_9_chunk._ts_meta_min_1, compress_hyper_2_9_chunk._ts_meta_max_1, compress_hyper_2_9_chunk."time", compress_hyper_2_9_chunk.val
-               Sort Key: compress_hyper_2_9_chunk.device_id, compress_hyper_2_9_chunk._ts_meta_min_1, compress_hyper_2_9_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk
+               Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_9_chunk
                      Output: compress_hyper_2_9_chunk._ts_meta_count, compress_hyper_2_9_chunk.device_id, compress_hyper_2_9_chunk._ts_meta_min_1, compress_hyper_2_9_chunk._ts_meta_max_1, compress_hyper_2_9_chunk."time", compress_hyper_2_9_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
-         Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
-               Sort Key: compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_4_chunk
+               Output: _hyper_1_4_chunk."time", _hyper_1_4_chunk.device_id, _hyper_1_4_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_8_chunk
                      Output: compress_hyper_2_8_chunk._ts_meta_count, compress_hyper_2_8_chunk.device_id, compress_hyper_2_8_chunk._ts_meta_min_1, compress_hyper_2_8_chunk._ts_meta_max_1, compress_hyper_2_8_chunk."time", compress_hyper_2_8_chunk.val
 
@@ -365,37 +307,24 @@
 :EXPLAIN SELECT * FROM hyper
 ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on public.hyper
+ Sort
    Output: hyper."time", hyper.device_id, hyper.val
-   Order: hyper."time"
-   Startup Exclusion: false
-   Runtime Exclusion: false
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_10_chunk
-         Output: _hyper_1_10_chunk."time", _hyper_1_10_chunk.device_id, _hyper_1_10_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_14_chunk._ts_meta_count, compress_hyper_2_14_chunk._ts_meta_min_1, compress_hyper_2_14_chunk._ts_meta_max_1, compress_hyper_2_14_chunk."time", compress_hyper_2_14_chunk.device_id, compress_hyper_2_14_chunk.val
-               Sort Key: compress_hyper_2_14_chunk._ts_meta_min_1, compress_hyper_2_14_chunk._ts_meta_max_1
+   Sort Key: hyper."time"
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_10_chunk
+               Output: _hyper_1_10_chunk."time", _hyper_1_10_chunk.device_id, _hyper_1_10_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_14_chunk
                      Output: compress_hyper_2_14_chunk._ts_meta_count, compress_hyper_2_14_chunk._ts_meta_min_1, compress_hyper_2_14_chunk._ts_meta_max_1, compress_hyper_2_14_chunk."time", compress_hyper_2_14_chunk.device_id, compress_hyper_2_14_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_11_chunk
-         Output: _hyper_1_11_chunk."time", _hyper_1_11_chunk.device_id, _hyper_1_11_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_15_chunk._ts_meta_count, compress_hyper_2_15_chunk._ts_meta_min_1, compress_hyper_2_15_chunk._ts_meta_max_1, compress_hyper_2_15_chunk."time", compress_hyper_2_15_chunk.device_id, compress_hyper_2_15_chunk.val
-               Sort Key: compress_hyper_2_15_chunk._ts_meta_min_1, compress_hyper_2_15_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_11_chunk
+               Output: _hyper_1_11_chunk."time", _hyper_1_11_chunk.device_id, _hyper_1_11_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_15_chunk
                      Output: compress_hyper_2_15_chunk._ts_meta_count, compress_hyper_2_15_chunk._ts_meta_min_1, compress_hyper_2_15_chunk._ts_meta_max_1, compress_hyper_2_15_chunk."time", compress_hyper_2_15_chunk.device_id, compress_hyper_2_15_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_12_chunk
-         Output: _hyper_1_12_chunk."time", _hyper_1_12_chunk.device_id, _hyper_1_12_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_16_chunk._ts_meta_count, compress_hyper_2_16_chunk._ts_meta_min_1, compress_hyper_2_16_chunk._ts_meta_max_1, compress_hyper_2_16_chunk."time", compress_hyper_2_16_chunk.device_id, compress_hyper_2_16_chunk.val
-               Sort Key: compress_hyper_2_16_chunk._ts_meta_min_1, compress_hyper_2_16_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_12_chunk
+               Output: _hyper_1_12_chunk."time", _hyper_1_12_chunk.device_id, _hyper_1_12_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_16_chunk
                      Output: compress_hyper_2_16_chunk._ts_meta_count, compress_hyper_2_16_chunk._ts_meta_min_1, compress_hyper_2_16_chunk._ts_meta_max_1, compress_hyper_2_16_chunk."time", compress_hyper_2_16_chunk.device_id, compress_hyper_2_16_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_13_chunk
-         Output: _hyper_1_13_chunk."time", _hyper_1_13_chunk.device_id, _hyper_1_13_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_17_chunk._ts_meta_count, compress_hyper_2_17_chunk._ts_meta_min_1, compress_hyper_2_17_chunk._ts_meta_max_1, compress_hyper_2_17_chunk."time", compress_hyper_2_17_chunk.device_id, compress_hyper_2_17_chunk.val
-               Sort Key: compress_hyper_2_17_chunk._ts_meta_min_1, compress_hyper_2_17_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_13_chunk
+               Output: _hyper_1_13_chunk."time", _hyper_1_13_chunk.device_id, _hyper_1_13_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_17_chunk
                      Output: compress_hyper_2_17_chunk._ts_meta_count, compress_hyper_2_17_chunk._ts_meta_min_1, compress_hyper_2_17_chunk._ts_meta_max_1, compress_hyper_2_17_chunk."time", compress_hyper_2_17_chunk.device_id, compress_hyper_2_17_chunk.val
 
@@ -436,37 +365,24 @@
 :EXPLAIN SELECT * FROM hyper
 ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on public.hyper
+ Sort
    Output: hyper."time", hyper.device_id, hyper.val
-   Order: hyper."time"
-   Startup Exclusion: false
-   Runtime Exclusion: false
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_10_chunk
-         Output: _hyper_1_10_chunk."time", _hyper_1_10_chunk.device_id, _hyper_1_10_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_14_chunk._ts_meta_count, compress_hyper_2_14_chunk._ts_meta_min_1, compress_hyper_2_14_chunk._ts_meta_max_1, compress_hyper_2_14_chunk."time", compress_hyper_2_14_chunk.device_id, compress_hyper_2_14_chunk.val, compress_hyper_2_14_chunk._ts_meta_sequence_num
-               Sort Key: compress_hyper_2_14_chunk._ts_meta_sequence_num
+   Sort Key: hyper."time"
+   ->  Append
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_10_chunk
+               Output: _hyper_1_10_chunk."time", _hyper_1_10_chunk.device_id, _hyper_1_10_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_14_chunk
                      Output: compress_hyper_2_14_chunk._ts_meta_count, compress_hyper_2_14_chunk._ts_meta_min_1, compress_hyper_2_14_chunk._ts_meta_max_1, compress_hyper_2_14_chunk."time", compress_hyper_2_14_chunk.device_id, compress_hyper_2_14_chunk.val, compress_hyper_2_14_chunk._ts_meta_sequence_num
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_11_chunk
-         Output: _hyper_1_11_chunk."time", _hyper_1_11_chunk.device_id, _hyper_1_11_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_15_chunk._ts_meta_count, compress_hyper_2_15_chunk._ts_meta_min_1, compress_hyper_2_15_chunk._ts_meta_max_1, compress_hyper_2_15_chunk."time", compress_hyper_2_15_chunk.device_id, compress_hyper_2_15_chunk.val
-               Sort Key: compress_hyper_2_15_chunk._ts_meta_min_1, compress_hyper_2_15_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_11_chunk
+               Output: _hyper_1_11_chunk."time", _hyper_1_11_chunk.device_id, _hyper_1_11_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_15_chunk
                      Output: compress_hyper_2_15_chunk._ts_meta_count, compress_hyper_2_15_chunk._ts_meta_min_1, compress_hyper_2_15_chunk._ts_meta_max_1, compress_hyper_2_15_chunk."time", compress_hyper_2_15_chunk.device_id, compress_hyper_2_15_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_12_chunk
-         Output: _hyper_1_12_chunk."time", _hyper_1_12_chunk.device_id, _hyper_1_12_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_16_chunk._ts_meta_count, compress_hyper_2_16_chunk._ts_meta_min_1, compress_hyper_2_16_chunk._ts_meta_max_1, compress_hyper_2_16_chunk."time", compress_hyper_2_16_chunk.device_id, compress_hyper_2_16_chunk.val
-               Sort Key: compress_hyper_2_16_chunk._ts_meta_min_1, compress_hyper_2_16_chunk._ts_meta_max_1
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_12_chunk
+               Output: _hyper_1_12_chunk."time", _hyper_1_12_chunk.device_id, _hyper_1_12_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_16_chunk
                      Output: compress_hyper_2_16_chunk._ts_meta_count, compress_hyper_2_16_chunk._ts_meta_min_1, compress_hyper_2_16_chunk._ts_meta_max_1, compress_hyper_2_16_chunk."time", compress_hyper_2_16_chunk.device_id, compress_hyper_2_16_chunk.val
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_13_chunk
-         Output: _hyper_1_13_chunk."time", _hyper_1_13_chunk.device_id, _hyper_1_13_chunk.val
-         ->  Sort
-               Output: compress_hyper_2_17_chunk._ts_meta_count, compress_hyper_2_17_chunk._ts_meta_min_1, compress_hyper_2_17_chunk._ts_meta_max_1, compress_hyper_2_17_chunk."time", compress_hyper_2_17_chunk.device_id, compress_hyper_2_17_chunk.val, compress_hyper_2_17_chunk._ts_meta_sequence_num
-               Sort Key: compress_hyper_2_17_chunk._ts_meta_sequence_num
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_13_chunk
+               Output: _hyper_1_13_chunk."time", _hyper_1_13_chunk.device_id, _hyper_1_13_chunk.val
                ->  Seq Scan on _timescaledb_internal.compress_hyper_2_17_chunk
                      Output: compress_hyper_2_17_chunk._ts_meta_count, compress_hyper_2_17_chunk._ts_meta_min_1, compress_hyper_2_17_chunk._ts_meta_max_1, compress_hyper_2_17_chunk."time", compress_hyper_2_17_chunk.device_id, compress_hyper_2_17_chunk.val, compress_hyper_2_17_chunk._ts_meta_sequence_num
 
@@ -526,11 +442,11 @@
 :EXPLAIN SELECT * FROM hyper
 WHERE device_id = 1 ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_21_chunk
+ Sort
    Output: _hyper_1_21_chunk."time", _hyper_1_21_chunk.device_id, _hyper_1_21_chunk.val
-   ->  Sort
-         Output: compress_hyper_2_25_chunk._ts_meta_count, compress_hyper_2_25_chunk.device_id, compress_hyper_2_25_chunk._ts_meta_min_1, compress_hyper_2_25_chunk._ts_meta_max_1, compress_hyper_2_25_chunk."time", compress_hyper_2_25_chunk.val
-         Sort Key: compress_hyper_2_25_chunk._ts_meta_min_1, compress_hyper_2_25_chunk._ts_meta_max_1
+   Sort Key: _hyper_1_21_chunk."time"
+   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_21_chunk
+         Output: _hyper_1_21_chunk."time", _hyper_1_21_chunk.device_id, _hyper_1_21_chunk.val
          ->  Seq Scan on _timescaledb_internal.compress_hyper_2_25_chunk
                Output: compress_hyper_2_25_chunk._ts_meta_count, compress_hyper_2_25_chunk.device_id, compress_hyper_2_25_chunk._ts_meta_min_1, compress_hyper_2_25_chunk._ts_meta_max_1, compress_hyper_2_25_chunk."time", compress_hyper_2_25_chunk.val
                Filter: (compress_hyper_2_25_chunk.device_id = 1)
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_sorted_merge.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_sorted_merge.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_sorted_merge.out	2025-11-06 02:35:39.291068524 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_sorted_merge.out	2025-11-06 02:46:46.953500332 +0000
@@ -1080,59 +1080,53 @@
          Order: sensor_data."time" DESC
          Startup Exclusion: false
          Runtime Exclusion: false
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_13_chunk (actual rows=1.00 loops=1)
+         ->  Sort (actual rows=1.00 loops=1)
                Output: _hyper_7_13_chunk."time", _hyper_7_13_chunk.sensor_id, _hyper_7_13_chunk.cpu, _hyper_7_13_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (actual rows=2.00 loops=1)
-                     Output: compress_hyper_8_19_chunk._ts_meta_count, compress_hyper_8_19_chunk.sensor_id, compress_hyper_8_19_chunk._ts_meta_min_1, compress_hyper_8_19_chunk._ts_meta_max_1, compress_hyper_8_19_chunk."time", compress_hyper_8_19_chunk.cpu, compress_hyper_8_19_chunk.temperature
-                     Sort Key: compress_hyper_8_19_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               Sort Key: _hyper_7_13_chunk."time" DESC
+               Sort Method: top-N heapsort 
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_13_chunk (actual rows=14500.00 loops=1)
+                     Output: _hyper_7_13_chunk."time", _hyper_7_13_chunk.sensor_id, _hyper_7_13_chunk.cpu, _hyper_7_13_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_8_19_chunk (actual rows=100.00 loops=1)
                            Output: compress_hyper_8_19_chunk._ts_meta_count, compress_hyper_8_19_chunk.sensor_id, compress_hyper_8_19_chunk._ts_meta_min_1, compress_hyper_8_19_chunk._ts_meta_max_1, compress_hyper_8_19_chunk."time", compress_hyper_8_19_chunk.cpu, compress_hyper_8_19_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_12_chunk (never executed)
+         ->  Sort (never executed)
                Output: _hyper_7_12_chunk."time", _hyper_7_12_chunk.sensor_id, _hyper_7_12_chunk.cpu, _hyper_7_12_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_8_18_chunk._ts_meta_count, compress_hyper_8_18_chunk.sensor_id, compress_hyper_8_18_chunk._ts_meta_min_1, compress_hyper_8_18_chunk._ts_meta_max_1, compress_hyper_8_18_chunk."time", compress_hyper_8_18_chunk.cpu, compress_hyper_8_18_chunk.temperature
-                     Sort Key: compress_hyper_8_18_chunk._ts_meta_max_1 DESC
+               Sort Key: _hyper_7_12_chunk."time" DESC
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_12_chunk (never executed)
+                     Output: _hyper_7_12_chunk."time", _hyper_7_12_chunk.sensor_id, _hyper_7_12_chunk.cpu, _hyper_7_12_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_8_18_chunk (never executed)
                            Output: compress_hyper_8_18_chunk._ts_meta_count, compress_hyper_8_18_chunk.sensor_id, compress_hyper_8_18_chunk._ts_meta_min_1, compress_hyper_8_18_chunk._ts_meta_max_1, compress_hyper_8_18_chunk."time", compress_hyper_8_18_chunk.cpu, compress_hyper_8_18_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_11_chunk (never executed)
+         ->  Sort (never executed)
                Output: _hyper_7_11_chunk."time", _hyper_7_11_chunk.sensor_id, _hyper_7_11_chunk.cpu, _hyper_7_11_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_8_17_chunk._ts_meta_count, compress_hyper_8_17_chunk.sensor_id, compress_hyper_8_17_chunk._ts_meta_min_1, compress_hyper_8_17_chunk._ts_meta_max_1, compress_hyper_8_17_chunk."time", compress_hyper_8_17_chunk.cpu, compress_hyper_8_17_chunk.temperature
-                     Sort Key: compress_hyper_8_17_chunk._ts_meta_max_1 DESC
+               Sort Key: _hyper_7_11_chunk."time" DESC
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_11_chunk (never executed)
+                     Output: _hyper_7_11_chunk."time", _hyper_7_11_chunk.sensor_id, _hyper_7_11_chunk.cpu, _hyper_7_11_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_8_17_chunk (never executed)
                            Output: compress_hyper_8_17_chunk._ts_meta_count, compress_hyper_8_17_chunk.sensor_id, compress_hyper_8_17_chunk._ts_meta_min_1, compress_hyper_8_17_chunk._ts_meta_max_1, compress_hyper_8_17_chunk."time", compress_hyper_8_17_chunk.cpu, compress_hyper_8_17_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_10_chunk (never executed)
+         ->  Sort (never executed)
                Output: _hyper_7_10_chunk."time", _hyper_7_10_chunk.sensor_id, _hyper_7_10_chunk.cpu, _hyper_7_10_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_8_16_chunk._ts_meta_count, compress_hyper_8_16_chunk.sensor_id, compress_hyper_8_16_chunk._ts_meta_min_1, compress_hyper_8_16_chunk._ts_meta_max_1, compress_hyper_8_16_chunk."time", compress_hyper_8_16_chunk.cpu, compress_hyper_8_16_chunk.temperature
-                     Sort Key: compress_hyper_8_16_chunk._ts_meta_max_1 DESC
+               Sort Key: _hyper_7_10_chunk."time" DESC
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_10_chunk (never executed)
+                     Output: _hyper_7_10_chunk."time", _hyper_7_10_chunk.sensor_id, _hyper_7_10_chunk.cpu, _hyper_7_10_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_8_16_chunk (never executed)
                            Output: compress_hyper_8_16_chunk._ts_meta_count, compress_hyper_8_16_chunk.sensor_id, compress_hyper_8_16_chunk._ts_meta_min_1, compress_hyper_8_16_chunk._ts_meta_max_1, compress_hyper_8_16_chunk."time", compress_hyper_8_16_chunk.cpu, compress_hyper_8_16_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_9_chunk (never executed)
+         ->  Sort (never executed)
                Output: _hyper_7_9_chunk."time", _hyper_7_9_chunk.sensor_id, _hyper_7_9_chunk.cpu, _hyper_7_9_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_8_15_chunk._ts_meta_count, compress_hyper_8_15_chunk.sensor_id, compress_hyper_8_15_chunk._ts_meta_min_1, compress_hyper_8_15_chunk._ts_meta_max_1, compress_hyper_8_15_chunk."time", compress_hyper_8_15_chunk.cpu, compress_hyper_8_15_chunk.temperature
-                     Sort Key: compress_hyper_8_15_chunk._ts_meta_max_1 DESC
+               Sort Key: _hyper_7_9_chunk."time" DESC
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_9_chunk (never executed)
+                     Output: _hyper_7_9_chunk."time", _hyper_7_9_chunk.sensor_id, _hyper_7_9_chunk.cpu, _hyper_7_9_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_8_15_chunk (never executed)
                            Output: compress_hyper_8_15_chunk._ts_meta_count, compress_hyper_8_15_chunk.sensor_id, compress_hyper_8_15_chunk._ts_meta_min_1, compress_hyper_8_15_chunk._ts_meta_max_1, compress_hyper_8_15_chunk."time", compress_hyper_8_15_chunk.cpu, compress_hyper_8_15_chunk.temperature
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_8_chunk (never executed)
+         ->  Sort (never executed)
                Output: _hyper_7_8_chunk."time", _hyper_7_8_chunk.sensor_id, _hyper_7_8_chunk.cpu, _hyper_7_8_chunk.temperature
-               Batch Sorted Merge: true
-               Bulk Decompression: false
-               ->  Sort (never executed)
-                     Output: compress_hyper_8_14_chunk._ts_meta_count, compress_hyper_8_14_chunk.sensor_id, compress_hyper_8_14_chunk._ts_meta_min_1, compress_hyper_8_14_chunk._ts_meta_max_1, compress_hyper_8_14_chunk."time", compress_hyper_8_14_chunk.cpu, compress_hyper_8_14_chunk.temperature
-                     Sort Key: compress_hyper_8_14_chunk._ts_meta_max_1 DESC
+               Sort Key: _hyper_7_8_chunk."time" DESC
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_7_8_chunk (never executed)
+                     Output: _hyper_7_8_chunk."time", _hyper_7_8_chunk.sensor_id, _hyper_7_8_chunk.cpu, _hyper_7_8_chunk.temperature
+                     Bulk Decompression: true
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_8_14_chunk (never executed)
                            Output: compress_hyper_8_14_chunk._ts_meta_count, compress_hyper_8_14_chunk.sensor_id, compress_hyper_8_14_chunk._ts_meta_min_1, compress_hyper_8_14_chunk._ts_meta_max_1, compress_hyper_8_14_chunk."time", compress_hyper_8_14_chunk.cpu, compress_hyper_8_14_chunk.temperature
 
@@ -1230,14 +1224,13 @@
 :PREFIX
 SELECT time, segment_by, x1 FROM test_costs ORDER BY time DESC;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_9_20_chunk (actual rows=11800.00 loops=1)
+ Sort (actual rows=11800.00 loops=1)
    Output: _hyper_9_20_chunk."time", _hyper_9_20_chunk.segment_by, _hyper_9_20_chunk.x1
-   Batch Sorted Merge: true
-   Bulk Decompression: false
-   ->  Sort (actual rows=100.00 loops=1)
-         Output: compress_hyper_10_21_chunk._ts_meta_count, compress_hyper_10_21_chunk.segment_by, compress_hyper_10_21_chunk._ts_meta_min_1, compress_hyper_10_21_chunk._ts_meta_max_1, compress_hyper_10_21_chunk."time", compress_hyper_10_21_chunk._ts_meta_min_2, compress_hyper_10_21_chunk._ts_meta_max_2, compress_hyper_10_21_chunk.x1
-         Sort Key: compress_hyper_10_21_chunk._ts_meta_max_1 DESC
-         Sort Method: quicksort 
+   Sort Key: _hyper_9_20_chunk."time" DESC
+   Sort Method: quicksort 
+   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_9_20_chunk (actual rows=11800.00 loops=1)
+         Output: _hyper_9_20_chunk."time", _hyper_9_20_chunk.segment_by, _hyper_9_20_chunk.x1
+         Bulk Decompression: true
          ->  Seq Scan on _timescaledb_internal.compress_hyper_10_21_chunk (actual rows=100.00 loops=1)
                Output: compress_hyper_10_21_chunk._ts_meta_count, compress_hyper_10_21_chunk.segment_by, compress_hyper_10_21_chunk._ts_meta_min_1, compress_hyper_10_21_chunk._ts_meta_max_1, compress_hyper_10_21_chunk."time", compress_hyper_10_21_chunk._ts_meta_min_2, compress_hyper_10_21_chunk._ts_meta_max_2, compress_hyper_10_21_chunk.x1
 
@@ -1289,242 +1282,4 @@
 set timescaledb.debug_require_batch_sorted_merge to 'require';
 :PREFIX
 SELECT time, segment_by, x1 FROM test_costs WHERE segment_by > 900 and segment_by < 999 ORDER BY time DESC;
---- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_9_20_chunk (actual rows=11564.00 loops=1)
-   Output: _hyper_9_20_chunk."time", _hyper_9_20_chunk.segment_by, _hyper_9_20_chunk.x1
-   Batch Sorted Merge: true
-   Bulk Decompression: false
-   ->  Sort (actual rows=98.00 loops=1)
-         Output: compress_hyper_10_22_chunk._ts_meta_count, compress_hyper_10_22_chunk.segment_by, compress_hyper_10_22_chunk._ts_meta_min_1, compress_hyper_10_22_chunk._ts_meta_max_1, compress_hyper_10_22_chunk."time", compress_hyper_10_22_chunk._ts_meta_min_2, compress_hyper_10_22_chunk._ts_meta_max_2, compress_hyper_10_22_chunk.x1
-         Sort Key: compress_hyper_10_22_chunk._ts_meta_max_1 DESC
-         Sort Method: quicksort 
-         ->  Index Scan using compress_hyper_10_22_chunk_segment_by__ts_meta_min_1__ts_me_idx on _timescaledb_internal.compress_hyper_10_22_chunk (actual rows=98.00 loops=1)
-               Output: compress_hyper_10_22_chunk._ts_meta_count, compress_hyper_10_22_chunk.segment_by, compress_hyper_10_22_chunk._ts_meta_min_1, compress_hyper_10_22_chunk._ts_meta_max_1, compress_hyper_10_22_chunk."time", compress_hyper_10_22_chunk._ts_meta_min_2, compress_hyper_10_22_chunk._ts_meta_max_2, compress_hyper_10_22_chunk.x1
-               Index Cond: ((compress_hyper_10_22_chunk.segment_by > 900) AND (compress_hyper_10_22_chunk.segment_by < 999))
-
--- Target list creation - Issue 5738
-CREATE TABLE bugtab(
- time timestamp without time zone,
- hin   character varying(128) NOT NULL,
- model character varying(128) NOT NULL,
- block character varying(128) NOT NULL,
- message_name character varying(128) NOT NULL,
- signal_name  character varying(128) NOT NULL,
- signal_numeric_value double precision,
- signal_string_value character varying(128)
-);
-SELECT create_hypertable('bugtab', 'time');
-WARNING:  column type "timestamp without time zone" used for "time" does not follow best practices
-WARNING:  column type "character varying" used for "hin" does not follow best practices
-WARNING:  column type "character varying" used for "model" does not follow best practices
-WARNING:  column type "character varying" used for "block" does not follow best practices
-WARNING:  column type "character varying" used for "message_name" does not follow best practices
-WARNING:  column type "character varying" used for "signal_name" does not follow best practices
-WARNING:  column type "character varying" used for "signal_string_value" does not follow best practices
-  create_hypertable   
-----------------------
- (11,public,bugtab,t)
-
-INSERT INTO bugtab values('2020-01-01 10:00', 'hin1111', 'model111', 'blok111', 'message_here', 'signal1', 12.34, '12.34');
-ALTER TABLE bugtab SET (timescaledb.compress, timescaledb.compress_segmentby = 'hin, signal_name', timescaledb.compress_orderby = 'time');
-SELECT chunk_schema || '.' || chunk_name AS "chunk_table_bugtab"
-       FROM timescaledb_information.chunks
-       WHERE hypertable_name = 'bugtab' ORDER BY range_start LIMIT 1 \gset
-SELECT compress_chunk(i) FROM show_chunks('bugtab') i;
-              compress_chunk              
-------------------------------------------
- _timescaledb_internal._hyper_11_23_chunk
-
-ANALYZE bugtab;
-set timescaledb.debug_require_batch_sorted_merge to 'force';
-:PREFIX
-SELECT "time","hin"::text,"model"::text,"block"::text,"message_name"::text,"signal_name"::text,"signal_numeric_value","signal_string_value"::text FROM :chunk_table_bugtab ORDER BY "time" DESC;
---- QUERY PLAN ---
- Result (actual rows=1.00 loops=1)
-   Output: _hyper_11_23_chunk."time", (_hyper_11_23_chunk.hin)::text, (_hyper_11_23_chunk.model)::text, (_hyper_11_23_chunk.block)::text, (_hyper_11_23_chunk.message_name)::text, (_hyper_11_23_chunk.signal_name)::text, _hyper_11_23_chunk.signal_numeric_value, (_hyper_11_23_chunk.signal_string_value)::text
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_11_23_chunk (actual rows=1.00 loops=1)
-         Output: _hyper_11_23_chunk."time", _hyper_11_23_chunk.hin, _hyper_11_23_chunk.model, _hyper_11_23_chunk.block, _hyper_11_23_chunk.message_name, _hyper_11_23_chunk.signal_name, _hyper_11_23_chunk.signal_numeric_value, _hyper_11_23_chunk.signal_string_value
-         Batch Sorted Merge: true
-         Reverse: true
-         Bulk Decompression: false
-         ->  Sort (actual rows=1.00 loops=1)
-               Output: compress_hyper_12_24_chunk._ts_meta_count, compress_hyper_12_24_chunk.hin, compress_hyper_12_24_chunk.signal_name, compress_hyper_12_24_chunk._ts_meta_min_1, compress_hyper_12_24_chunk._ts_meta_max_1, compress_hyper_12_24_chunk."time", compress_hyper_12_24_chunk.model, compress_hyper_12_24_chunk.block, compress_hyper_12_24_chunk.message_name, compress_hyper_12_24_chunk.signal_numeric_value, compress_hyper_12_24_chunk.signal_string_value
-               Sort Key: compress_hyper_12_24_chunk._ts_meta_max_1 DESC
-               Sort Method: quicksort 
-               ->  Seq Scan on _timescaledb_internal.compress_hyper_12_24_chunk (actual rows=1.00 loops=1)
-                     Output: compress_hyper_12_24_chunk._ts_meta_count, compress_hyper_12_24_chunk.hin, compress_hyper_12_24_chunk.signal_name, compress_hyper_12_24_chunk._ts_meta_min_1, compress_hyper_12_24_chunk._ts_meta_max_1, compress_hyper_12_24_chunk."time", compress_hyper_12_24_chunk.model, compress_hyper_12_24_chunk.block, compress_hyper_12_24_chunk.message_name, compress_hyper_12_24_chunk.signal_numeric_value, compress_hyper_12_24_chunk.signal_string_value
-
-SELECT "time","hin"::text,"model"::text,"block"::text,"message_name"::text,"signal_name"::text,"signal_numeric_value","signal_string_value"::text FROM :chunk_table_bugtab ORDER BY "time" DESC;
-           time           |   hin   |  model   |  block  | message_name | signal_name | signal_numeric_value | signal_string_value 
---------------------------+---------+----------+---------+--------------+-------------+----------------------+---------------------
- Wed Jan 01 10:00:00 2020 | hin1111 | model111 | blok111 | message_here | signal1     |                12.34 | 12.34
-
-SELECT "time","hin"::text,"model"::text,"block"::text,"message_name"::text,"signal_name"::text,"signal_numeric_value","signal_string_value"::text FROM bugtab ORDER BY "time" DESC;
-           time           |   hin   |  model   |  block  | message_name | signal_name | signal_numeric_value | signal_string_value 
---------------------------+---------+----------+---------+--------------+-------------+----------------------+---------------------
- Wed Jan 01 10:00:00 2020 | hin1111 | model111 | blok111 | message_here | signal1     |                12.34 | 12.34
-
--- Condition that filter the first tuple of a batch - Issue 5797
-CREATE TABLE test (
-    id      bigint,
-    dttm    timestamp,
-    otherId    int,
-    valueFk int,
-    otherFk int,
-    measure double precision
-);
-SELECT create_hypertable('test', 'dttm');
-WARNING:  column type "timestamp without time zone" used for "dttm" does not follow best practices
- create_hypertable  
---------------------
- (13,public,test,t)
-
-ALTER TABLE test SET (
-    timescaledb.compress,
-    timescaledb.compress_segmentby = 'otherId,valueFk,otherFk'
-);
-INSERT INTO public.test (id, dttm, otherid, valuefk, otherfk, measure)
-VALUES  (109288, '2023-05-25 23:12:13.000000', 130, 14499, 13, 0.13216569884001217),
-        (109286, '2023-05-25 23:12:13.000000', 130, 14500, 13, 0.3740651978942786),
-        (107617, '2023-05-25 14:24:12.000000', 130, 14850, 13, 0.5978259144311195),
-        (103864, '2023-05-25 13:30:51.000000', 130, 16760, 13, 0.4733429856616205),
-        (104977, '2023-05-25 12:11:47.000000', 133, 14843, 13, 0.24366893909655118),
-        (108321, '2023-05-25 18:39:07.000000', 133, 15294, 13, 0.8768629101819378),
-        (108320, '2023-05-25 16:09:17.000000', 133, 15294, 13, 0.6185638532799445),
-        (104987, '2023-05-25 13:27:19.000000', 133, 15294, 13, 0.9830846939109854),
-        (104737, '2023-05-25 19:59:54.000000', 135, 14238, 13, 0.2388520055224177),
-        (106278, '2023-05-25 19:59:54.000000', 135, 14238, 13, 0.6305156586688518),
-        (104741, '2023-05-25 19:59:54.000000', 135, 14238, 13, 0.4990673076480263),
-        (106277, '2023-05-25 12:53:34.000000', 135, 14238, 13, 0.46086278330000496),
-        (97409, '2023-05-25 12:38:48.000000', 137, 14533, 13, 0.8308173375978924),
-        (105234, '2023-05-25 12:38:45.000000', 137, 14533, 13, 0.10860962941223917),
-        (105233, '2023-05-25 12:06:35.000000', 137, 14533, 13, 0.09058791972962155),
-        (97434, '2023-05-25 12:39:46.000000', 137, 14657, 13, 0.023315916140422388),
-        (108167, '2023-05-25 15:41:30.000000', 137, 14964, 13, 0.21757999385617666),
-        (107741, '2023-05-25 14:40:37.000000', 137, 14964, 13, 0.3449447147508202),
-        (106312, '2023-05-25 14:40:16.000000', 137, 14964, 13, 0.11890456868959376),
-        (106134, '2023-05-25 12:56:18.000000', 137, 14964, 13, 0.8004332371337775),
-        (103696, '2023-05-25 12:54:31.000000', 137, 14964, 13, 0.30147495793613643),
-        (106311, '2023-05-25 12:44:22.000000', 137, 14964, 13, 0.7412968055185551),
-        (106133, '2023-05-25 12:44:22.000000', 137, 14964, 13, 0.12940337622720932),
-        (105711, '2023-05-25 12:43:57.000000', 137, 14964, 13, 0.1044849979830822),
-        (105710, '2023-05-25 12:34:04.000000', 137, 14964, 13, 0.9113563410974876),
-        (108787, '2023-05-25 17:59:35.000000', 137, 15377, 13, 0.921829256160489),
-        (107833, '2023-05-25 14:53:08.000000', 137, 16302, 13, 0.9663117845438407),
-        (105435, '2023-05-25 12:30:59.000000', 137, 16568, 13, 0.13774896612028797),
-        (105434, '2023-05-25 12:29:29.000000', 137, 16568, 13, 0.3891495411502035),
-        (108357, '2023-05-25 16:18:39.000000', 137, 16665, 13, 0.44701901843246716),
-        (98564, '2023-05-25 17:12:43.000000', 138, 14760, 13, 0.8463114782142114),
-        (109032, '2023-05-25 19:00:00.000000', 138, 14992, 13, 0.025578609447126865),
-        (108800, '2023-05-25 18:43:18.000000', 138, 14992, 13, 0.5397724043221928),
-        (108799, '2023-05-25 18:00:00.000000', 138, 14992, 13, 0.0321658507434357),
-        (107320, '2023-05-25 14:00:01.000000', 138, 14992, 13, 0.9042941365487067),
-        (107296, '2023-05-25 14:00:00.000000', 138, 14992, 13, 0.7821178685669885),
-        (104700, '2023-05-25 12:36:55.000000', 138, 14992, 13, 0.6854496458178119),
-        (105177, '2023-05-25 12:00:01.000000', 138, 14992, 13, 0.23780719110724746),
-        (109330, '2023-05-25 23:59:13.000000', 138, 15080, 13, 0.5409015970284159),
-        (107400, '2023-05-25 16:45:13.000000', 138, 15080, 13, 0.6233594483468217),
-        (107399, '2023-05-25 14:03:49.000000', 138, 15080, 13, 0.8192327792045404),
-        (105004, '2023-05-25 13:37:49.000000', 138, 15080, 13, 0.2993620446103442),
-        (102592, '2023-05-25 13:31:48.000000', 138, 15080, 13, 0.24649704579496046),
-        (109028, '2023-05-25 19:00:00.000000', 138, 15123, 13, 0.5442767942906279),
-        (108794, '2023-05-25 18:43:18.000000', 138, 15123, 13, 0.29095714680616425),
-        (108793, '2023-05-25 18:00:00.000000', 138, 15123, 13, 0.681894893772391),
-        (107314, '2023-05-25 14:00:01.000000', 138, 15123, 13, 0.9637603904838059),
-        (107292, '2023-05-25 14:00:00.000000', 138, 15123, 13, 0.05956707862994293),
-        (104696, '2023-05-25 12:36:55.000000', 138, 15123, 13, 0.27039489547807705),
-        (105171, '2023-05-25 12:00:01.000000', 138, 15123, 13, 0.1269705046788907),
-        (106625, '2023-05-25 13:22:19.000000', 138, 15326, 13, 0.7712280764026431),
-        (106624, '2023-05-25 13:15:49.000000', 138, 15326, 13, 0.585381418741779),
-        (105699, '2023-05-25 12:44:33.000000', 138, 15326, 13, 0.3710994669938259),
-        (105698, '2023-05-25 12:33:41.000000', 138, 15326, 13, 0.8992328857980105),
-        (108514, '2023-05-25 16:47:37.000000', 138, 15620, 13, 0.40346934167556725),
-        (102691, '2023-05-25 13:33:57.000000', 138, 15620, 13, 0.8046719989908304),
-        (103655, '2023-05-25 13:34:39.000000', 138, 15740, 13, 0.2541099322817928),
-        (106987, '2023-05-25 13:37:36.000000', 138, 15766, 13, 0.8407818724583045),
-        (102180, '2023-05-25 13:37:11.000000', 138, 15766, 13, 0.19149633299917213),
-        (102717, '2023-05-25 13:38:17.000000', 138, 15868, 13, 0.03196157886032225),
-        (102719, '2023-05-25 13:38:42.000000', 138, 15921, 13, 0.9986438564169191),
-        (103659, '2023-05-25 13:35:11.000000', 138, 15926, 13, 0.8549591705597201),
-        (108796, '2023-05-25 18:43:18.000000', 138, 15932, 13, 0.6213586835883191),
-        (108795, '2023-05-25 18:00:00.000000', 138, 15932, 13, 0.6730718577847092),
-        (107326, '2023-05-25 14:00:01.000000', 138, 15932, 13, 0.278131899094646),
-        (107298, '2023-05-25 14:00:00.000000', 138, 15932, 13, 0.92423751071723),
-        (104702, '2023-05-25 12:36:55.000000', 138, 15932, 13, 0.22221315122722984),
-        (105175, '2023-05-25 12:00:01.000000', 138, 15932, 13, 0.28839114292751233),
-        (102736, '2023-05-25 16:15:29.000000', 138, 16052, 13, 0.431037595792759),
-        (99163, '2023-05-25 13:47:30.000000', 138, 16419, 13, 0.5291021511946319),
-        (102738, '2023-05-25 13:45:05.000000', 138, 16420, 13, 0.6506497895856924),
-        (99109, '2023-05-25 13:37:49.000000', 138, 16420, 13, 0.019501542758906254),
-        (108798, '2023-05-25 18:43:18.000000', 138, 16590, 13, 0.8990882904615916),
-        (108797, '2023-05-25 18:00:00.000000', 138, 16590, 13, 0.8888186371755147),
-        (107328, '2023-05-25 14:00:01.000000', 138, 16590, 13, 0.019486942610562608),
-        (107300, '2023-05-25 14:00:00.000000', 138, 16590, 13, 0.5614292991802508),
-        (104698, '2023-05-25 12:36:55.000000', 138, 16590, 13, 0.01866956387405594),
-        (105173, '2023-05-25 12:00:01.000000', 138, 16590, 13, 0.25661478763909074),
-        (107224, '2023-05-25 13:51:57.000000', 138, 16633, 13, 0.0010321723593804677),
-        (99064, '2023-05-25 13:37:49.000000', 138, 16633, 13, 0.8675616866165861),
-        (109225, '2023-05-25 22:13:01.000000', 138, 16669, 13, 0.1076822852142385),
-        (109224, '2023-05-25 21:11:56.000000', 138, 16669, 13, 0.24001365186054713);
-SELECT compress_chunk(show_chunks('test', older_than => INTERVAL '1 week'), true);
-              compress_chunk              
-------------------------------------------
- _timescaledb_internal._hyper_13_25_chunk
-
-SELECT t.dttm FROM test t WHERE t.dttm > '2023-05-25T14:23:12' ORDER BY t.dttm;
-           dttm           
---------------------------
- Thu May 25 14:24:12 2023
- Thu May 25 14:40:16 2023
- Thu May 25 14:40:37 2023
- Thu May 25 14:53:08 2023
- Thu May 25 15:41:30 2023
- Thu May 25 16:09:17 2023
- Thu May 25 16:15:29 2023
- Thu May 25 16:18:39 2023
- Thu May 25 16:45:13 2023
- Thu May 25 16:47:37 2023
- Thu May 25 17:12:43 2023
- Thu May 25 17:59:35 2023
- Thu May 25 18:00:00 2023
- Thu May 25 18:00:00 2023
- Thu May 25 18:00:00 2023
- Thu May 25 18:00:00 2023
- Thu May 25 18:39:07 2023
- Thu May 25 18:43:18 2023
- Thu May 25 18:43:18 2023
- Thu May 25 18:43:18 2023
- Thu May 25 18:43:18 2023
- Thu May 25 19:00:00 2023
- Thu May 25 19:00:00 2023
- Thu May 25 19:59:54 2023
- Thu May 25 19:59:54 2023
- Thu May 25 19:59:54 2023
- Thu May 25 21:11:56 2023
- Thu May 25 22:13:01 2023
- Thu May 25 23:12:13 2023
- Thu May 25 23:12:13 2023
- Thu May 25 23:59:13 2023
-
--- Test that the enable_sort GUC doesn't disable the batch sorted merge plan.
-SET enable_sort TO OFF;
-set timescaledb.debug_require_batch_sorted_merge = 'require';
-:PREFIX
-SELECT t.dttm FROM test t ORDER BY t.dttm LIMIT 1;
---- QUERY PLAN ---
- Limit (actual rows=1.00 loops=1)
-   Output: t.dttm
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_13_25_chunk t (actual rows=1.00 loops=1)
-         Output: t.dttm
-         Batch Sorted Merge: true
-         Reverse: true
-         Bulk Decompression: false
-         ->  Sort (actual rows=5.00 loops=1)
-               Output: compress_hyper_14_26_chunk._ts_meta_count, compress_hyper_14_26_chunk.otherid, compress_hyper_14_26_chunk.valuefk, compress_hyper_14_26_chunk.otherfk, compress_hyper_14_26_chunk.id, compress_hyper_14_26_chunk._ts_meta_min_1, compress_hyper_14_26_chunk._ts_meta_max_1, compress_hyper_14_26_chunk.dttm, compress_hyper_14_26_chunk.measure
-               Sort Key: compress_hyper_14_26_chunk._ts_meta_min_1
-               Sort Method: quicksort 
-               ->  Seq Scan on _timescaledb_internal.compress_hyper_14_26_chunk (actual rows=32.00 loops=1)
-                     Output: compress_hyper_14_26_chunk._ts_meta_count, compress_hyper_14_26_chunk.otherid, compress_hyper_14_26_chunk.valuefk, compress_hyper_14_26_chunk.otherfk, compress_hyper_14_26_chunk.id, compress_hyper_14_26_chunk._ts_meta_min_1, compress_hyper_14_26_chunk._ts_meta_max_1, compress_hyper_14_26_chunk.dttm, compress_hyper_14_26_chunk.measure
-
-RESET enable_sort;
-reset timescaledb.debug_require_batch_sorted_merge;
+ERROR:  debug: batch sorted merge is required but not used
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_sorted_merge_distinct.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_sorted_merge_distinct.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_sorted_merge_distinct.out	2025-11-06 02:35:39.291068524 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_sorted_merge_distinct.out	2025-11-06 02:46:43.035549025 +0000
@@ -44,9 +44,9 @@
 
 explain (buffers off, costs off) select * from t where high_card = 1 order by ts;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk
-   ->  Sort
-         Sort Key: compress_hyper_2_2_chunk._ts_meta_min_1
+ Sort
+   Sort Key: _hyper_1_1_chunk.ts
+   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
          ->  Index Scan using compress_hyper_2_2_chunk_low_card_high_card__ts_meta_min_1__idx on compress_hyper_2_2_chunk
                Index Cond: (high_card = 1)
 
@@ -73,9 +73,9 @@
 -- Test that inequality conditions in WHERE also influence the estimates.
 explain (buffers off, costs off) select * from t where high_card < 10 order by ts;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk
-   ->  Sort
-         Sort Key: compress_hyper_2_2_chunk._ts_meta_min_1
+ Sort
+   Sort Key: _hyper_1_1_chunk.ts
+   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
          ->  Index Scan using compress_hyper_2_2_chunk_low_card_high_card__ts_meta_min_1__idx on compress_hyper_2_2_chunk
                Index Cond: (high_card < 10)
 
@@ -106,9 +106,9 @@
 set work_mem to :large_work_mem;
 explain (buffers off, costs off) select * from t where high_card < 10 order by ts;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk
-   ->  Sort
-         Sort Key: compress_hyper_2_2_chunk._ts_meta_min_1
+ Sort
+   Sort Key: _hyper_1_1_chunk.ts
+   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
          ->  Index Scan using compress_hyper_2_2_chunk_low_card_high_card__ts_meta_min_1__idx on compress_hyper_2_2_chunk
                Index Cond: (high_card < 10)
 
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_update_delete-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_update_delete-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_update_delete-17.out	2025-11-06 02:35:39.292068513 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_update_delete-17.out	2025-11-06 02:46:38.902600398 +0000
@@ -2588,29 +2588,18 @@
 -- All 3 chunks will now become partially compressed chunks
 EXPLAIN (buffers off, costs off) SELECT * FROM test_partials ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on test_partials
-   Order: test_partials."time"
-   ->  Merge Append
-         Sort Key: test_partials."time"
+ Sort
+   Sort Key: test_partials."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_35_68_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_71_chunk._ts_meta_min_1, compress_hyper_36_71_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_71_chunk
-         ->  Index Scan Backward using _hyper_35_68_chunk_test_partials_time_idx on _hyper_35_68_chunk
-   ->  Merge Append
-         Sort Key: test_partials."time"
+               ->  Seq Scan on compress_hyper_36_71_chunk
+         ->  Seq Scan on _hyper_35_68_chunk
          ->  Custom Scan (ColumnarScan) on _hyper_35_69_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_72_chunk._ts_meta_min_1, compress_hyper_36_72_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_72_chunk
-         ->  Index Scan Backward using _hyper_35_69_chunk_test_partials_time_idx on _hyper_35_69_chunk
-   ->  Merge Append
-         Sort Key: test_partials."time"
+               ->  Seq Scan on compress_hyper_36_72_chunk
+         ->  Seq Scan on _hyper_35_69_chunk
          ->  Custom Scan (ColumnarScan) on _hyper_35_70_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_73_chunk._ts_meta_min_1, compress_hyper_36_73_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_73_chunk
-         ->  Index Scan Backward using _hyper_35_70_chunk_test_partials_time_idx on _hyper_35_70_chunk
+               ->  Seq Scan on compress_hyper_36_73_chunk
+         ->  Seq Scan on _hyper_35_70_chunk
 
 -- verify correct results
 SELECT * FROM test_partials ORDER BY time;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/decompress_index.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/decompress_index.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/decompress_index.out	2025-11-06 02:35:39.293068503 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/decompress_index.out	2025-11-06 02:46:54.252409691 +0000
@@ -127,9 +127,8 @@
 explain (buffers off, costs off) SELECT DISTINCT ON(data) * FROM record;
 --- QUERY PLAN ---
  Unique
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk
-               ->  Index Scan using compress_hyper_4_6_chunk_data__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_6_chunk
+   ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk
+         ->  Index Scan using compress_hyper_4_6_chunk_data__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_6_chunk
 
 -- (seg_col = const) condition is checked even when seg_col is coerced
 explain (buffers off, costs off) SELECT * FROM record WHERE data='Yes' ORDER BY data;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/merge_append_partially_compressed.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/merge_append_partially_compressed.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/merge_append_partially_compressed.out	2025-11-06 02:35:39.296068470 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/merge_append_partially_compressed.out	2025-11-06 02:47:28.494992490 +0000
@@ -66,48 +66,28 @@
 
 :PREFIX SELECT device FROM :CHUNK UNION ALL SELECT device FROM :CHUNK ORDER BY device DESC;
 --- QUERY PLAN ---
- Merge Append (actual rows=282.00 loops=1)
+ Sort (actual rows=282.00 loops=1)
    Sort Key: _hyper_1_1_chunk.device DESC
-   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=84.00 loops=1)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_2_4_chunk.device DESC
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=282.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=84.00 loops=1)
                ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=3.00 loops=1)
-   ->  Sort (actual rows=57.00 loops=1)
-         Sort Key: _hyper_1_1_chunk.device DESC
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_1_1_chunk (actual rows=57.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=84.00 loops=1)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_2_4_chunk_1.device DESC
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=84.00 loops=1)
                ->  Seq Scan on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=3.00 loops=1)
-   ->  Sort (actual rows=57.00 loops=1)
-         Sort Key: _hyper_1_1_chunk_1.device DESC
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=57.00 loops=1)
 
 :PREFIX SELECT value FROM :CHUNK UNION ALL SELECT value FROM :CHUNK ORDER BY value DESC;
 --- QUERY PLAN ---
- Merge Append (actual rows=282.00 loops=1)
+ Sort (actual rows=282.00 loops=1)
    Sort Key: _hyper_1_1_chunk.value DESC
-   ->  Sort (actual rows=84.00 loops=1)
-         Sort Key: _hyper_1_1_chunk.value DESC
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=282.00 loops=1)
          ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=84.00 loops=1)
                ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=3.00 loops=1)
-   ->  Sort (actual rows=57.00 loops=1)
-         Sort Key: _hyper_1_1_chunk.value DESC
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_1_1_chunk (actual rows=57.00 loops=1)
-   ->  Sort (actual rows=84.00 loops=1)
-         Sort Key: _hyper_1_1_chunk_1.value DESC
-         Sort Method: quicksort 
          ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=84.00 loops=1)
                ->  Seq Scan on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=3.00 loops=1)
-   ->  Sort (actual rows=57.00 loops=1)
-         Sort Key: _hyper_1_1_chunk_1.value DESC
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=57.00 loops=1)
 
 -- chunkAppend eligible queries (from tsbench)
@@ -617,18 +597,15 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Index Scan using _hyper_3_7_chunk_test1_time_idx on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
 -- requires resorting
@@ -636,146 +613,107 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 -- all these require resorting, no pushdown can happen
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST, x4 ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3, test1.x4
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3, test1.x4
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3, test1.x4
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST, x4 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3, test1.x4 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3, test1.x4 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3, test1.x4 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time"
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time"
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time"
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Index Scan Backward using _hyper_3_7_chunk_test1_time_idx on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time"
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST, x3 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time", test1.x3 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time", test1.x3 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time", test1.x3 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST, x3 DESC NULLS FIRST, x4 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time", test1.x3 DESC, test1.x4 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time", test1.x3 DESC, test1.x4 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time", test1.x3 DESC, test1.x4 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS FIRST, x3 DESC NULLS LAST, x4 ASC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" NULLS FIRST, _hyper_3_7_chunk.x3 DESC NULLS LAST, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" NULLS FIRST, _hyper_3_7_chunk.x3 DESC NULLS LAST, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 set enable_hashagg to off; -- different on PG13
 :PREFIX
@@ -786,41 +724,31 @@
    ->  GroupAggregate (actual rows=5.00 loops=1)
          Group Key: test1."time", test1.x1, test1.x2
          ->  Limit (actual rows=5.00 loops=1)
-               ->  Result (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-                           Order: test1."time", test1.x1, test1.x2
-                           ->  Merge Append (actual rows=5.00 loops=1)
-                                 Sort Key: test1."time", test1.x1, test1.x2
-                                 ->  Sort (actual rows=4.00 loops=1)
-                                       Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2
-                                       Sort Method: quicksort 
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                                             Filter: ((x4 % 11) <> 0)
-                                             Rows Removed by Filter: 10000
-                                             ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-                                 ->  Sort (actual rows=1.00 loops=1)
-                                       Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2
-                                       Sort Method: quicksort 
-                                       ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                                             Filter: ((x4 % 11) <> 0)
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: test1."time", test1.x1, test1.x2
+                     Sort Method: quicksort 
+                     ->  Result (actual rows=5.00 loops=1)
+                           ->  Append (actual rows=5.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                                       Filter: ((x4 % 11) <> 0)
+                                       Rows Removed by Filter: 10000
+                                       ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+                                 ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                                       Filter: ((x4 % 11) <> 0)
 
 reset enable_hashagg;
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1.x4, test1."time"
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk.x4, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk.x4, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -828,18 +756,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -847,18 +771,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -866,18 +786,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3, test1.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -885,18 +801,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x4 DESC LIMIT 10; -- no pushdown because orderby does not match
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x4 DESC
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -905,18 +817,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1, compress_hyper_4_8_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -924,18 +832,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time DESC, x3 ASC, x4 ASC LIMIT 10; -- pushdown
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time" DESC, test1.x3, test1.x4
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1 DESC, compress_hyper_4_8_chunk._ts_meta_max_1 DESC, compress_hyper_4_8_chunk._ts_meta_min_2, compress_hyper_4_8_chunk._ts_meta_max_2, compress_hyper_4_8_chunk._ts_meta_min_3, compress_hyper_4_8_chunk._ts_meta_max_3
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -943,18 +847,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time ASC, x3 DESC, x4 DESC LIMIT 10; -- pushdown
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3 DESC, test1.x4 DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1, compress_hyper_4_8_chunk._ts_meta_max_1, compress_hyper_4_8_chunk._ts_meta_min_2 DESC, compress_hyper_4_8_chunk._ts_meta_max_2 DESC, compress_hyper_4_8_chunk._ts_meta_min_3 DESC, compress_hyper_4_8_chunk._ts_meta_max_3 DESC
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -962,18 +862,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3 DESC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3 DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1, compress_hyper_4_8_chunk._ts_meta_max_1, compress_hyper_4_8_chunk._ts_meta_min_2 DESC, compress_hyper_4_8_chunk._ts_meta_max_2 DESC
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -987,17 +883,25 @@
 SELECT * FROM test1 t1 JOIN join_table jt ON t1.x1 = jt.x1
 ORDER BY t1.x1, jt.y1;
 --- QUERY PLAN ---
- Sort (actual rows=4.00 loops=1)
+ Incremental Sort (actual rows=4.00 loops=1)
    Sort Key: t1.x1, jt.y1
-   Sort Method: quicksort 
-   ->  Hash Join (actual rows=4.00 loops=1)
-         Hash Cond: (jt.x1 = t1.x1)
-         ->  Seq Scan on join_table jt (actual rows=2.00 loops=1)
-         ->  Hash (actual rows=10005.00 loops=1)
-               ->  Append (actual rows=10005.00 loops=1)
+   Presorted Key: t1.x1
+   Full-sort Groups: 1  Sort Method: quicksort 
+   ->  Nested Loop (actual rows=4.00 loops=1)
+         Join Filter: (t1.x1 = jt.x1)
+         Rows Removed by Join Filter: 20006
+         ->  Merge Append (actual rows=10005.00 loops=1)
+               Sort Key: t1.x1
+               ->  Sort (actual rows=10004.00 loops=1)
+                     Sort Key: t1_1.x1
+                     Sort Method: quicksort 
                      ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk t1_1 (actual rows=10004.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Sort (actual rows=1.00 loops=1)
+                     Sort Key: t1_1.x1
+                     Sort Method: quicksort 
                      ->  Seq Scan on _hyper_3_7_chunk t1_1 (actual rows=1.00 loops=1)
+         ->  Seq Scan on join_table jt (actual rows=2.00 loops=10005)
 
 ---------------------------------------------------------------------------
 -- test queries without ordered append, but still eligible for sort pushdown
@@ -1043,30 +947,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2.x3
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_11_chunk.x1, compress_hyper_6_11_chunk.x2, compress_hyper_6_11_chunk.x5, compress_hyper_6_11_chunk._ts_meta_min_1, compress_hyper_6_11_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_12_chunk.x1, compress_hyper_6_12_chunk.x2, compress_hyper_6_12_chunk.x5, compress_hyper_6_12_chunk._ts_meta_min_1, compress_hyper_6_12_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1087,30 +981,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2.x3, test2.x4
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_11_chunk.x1, compress_hyper_6_11_chunk.x2, compress_hyper_6_11_chunk.x5, compress_hyper_6_11_chunk._ts_meta_min_1, compress_hyper_6_11_chunk._ts_meta_max_1, compress_hyper_6_11_chunk._ts_meta_min_2, compress_hyper_6_11_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x3, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_12_chunk.x1, compress_hyper_6_12_chunk.x2, compress_hyper_6_12_chunk.x5, compress_hyper_6_12_chunk._ts_meta_min_1, compress_hyper_6_12_chunk._ts_meta_max_1, compress_hyper_6_12_chunk._ts_meta_min_2, compress_hyper_6_12_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x3, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1132,30 +1016,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x3
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1176,30 +1050,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1220,30 +1084,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2."time"
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1317,54 +1171,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3.x3
-         ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_17_chunk.x1, compress_hyper_8_17_chunk.x2, compress_hyper_8_17_chunk.x5, compress_hyper_8_17_chunk._ts_meta_min_1, compress_hyper_8_17_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_18_chunk.x1, compress_hyper_8_18_chunk.x2, compress_hyper_8_18_chunk.x5, compress_hyper_8_18_chunk._ts_meta_min_1, compress_hyper_8_18_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_19_chunk.x1, compress_hyper_8_19_chunk.x2, compress_hyper_8_19_chunk.x5, compress_hyper_8_19_chunk._ts_meta_min_1, compress_hyper_8_19_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_20_chunk.x1, compress_hyper_8_20_chunk.x2, compress_hyper_8_20_chunk.x5, compress_hyper_8_20_chunk._ts_meta_min_1, compress_hyper_8_20_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1385,54 +1217,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3.x3, test3.x4
-         ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_17_chunk.x1, compress_hyper_8_17_chunk.x2, compress_hyper_8_17_chunk.x5, compress_hyper_8_17_chunk._ts_meta_min_1, compress_hyper_8_17_chunk._ts_meta_max_1, compress_hyper_8_17_chunk._ts_meta_min_2, compress_hyper_8_17_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x3, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_18_chunk.x1, compress_hyper_8_18_chunk.x2, compress_hyper_8_18_chunk.x5, compress_hyper_8_18_chunk._ts_meta_min_1, compress_hyper_8_18_chunk._ts_meta_max_1, compress_hyper_8_18_chunk._ts_meta_min_2, compress_hyper_8_18_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x3, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_19_chunk.x1, compress_hyper_8_19_chunk.x2, compress_hyper_8_19_chunk.x5, compress_hyper_8_19_chunk._ts_meta_min_1, compress_hyper_8_19_chunk._ts_meta_max_1, compress_hyper_8_19_chunk._ts_meta_min_2, compress_hyper_8_19_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x3, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_20_chunk.x1, compress_hyper_8_20_chunk.x2, compress_hyper_8_20_chunk.x5, compress_hyper_8_20_chunk._ts_meta_min_1, compress_hyper_8_20_chunk._ts_meta_max_1, compress_hyper_8_20_chunk._ts_meta_min_2, compress_hyper_8_20_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x3, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1454,54 +1264,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x3
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1522,54 +1310,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3.x4
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1590,54 +1356,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3."time"
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/ordered_append-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/ordered_append-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/ordered_append-17.out	2025-11-06 02:35:39.300068427 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/ordered_append-17.out	2025-11-06 02:47:54.919695080 +0000
@@ -1810,21 +1810,16 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-         Order: metrics_compressed."time"
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_13_chunk."time"
-               Sort Method: top-N heapsort 
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_14_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_15_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- test DESC for ordered chunks
 :PREFIX
@@ -1834,21 +1829,16 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-         Order: metrics_compressed."time" DESC
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_15_chunk."time" DESC
-               Sort Method: top-N heapsort 
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_14_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_13_chunk."time" DESC
-               ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_16_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
 
 -- test query with ORDER BY column not in targetlist
 :PREFIX
@@ -1859,22 +1849,17 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-               Order: metrics_compressed."time"
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_13_chunk."time"
-                     Sort Method: top-N heapsort 
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_3_14_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_3_15_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- ORDER BY may include other columns after time column
 :PREFIX
@@ -1888,17 +1873,22 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-         Order: metrics_compressed."time" DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_4_18_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (device_id = 1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-               ->  Index Scan using compress_hyper_4_17_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_17_chunk (never executed)
-                     Index Cond: (device_id = 1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (never executed)
-               ->  Index Scan using compress_hyper_4_16_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_16_chunk (never executed)
-                     Index Cond: (device_id = 1)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=13674.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=6.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 24
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=6.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 24
+               ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=4.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 16
 
 -- test RECORD in targetlist
 :PREFIX
@@ -1912,18 +1902,23 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-               Order: metrics_compressed."time" DESC
-               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (device_id = 1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                     ->  Index Scan using compress_hyper_4_17_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_17_chunk (never executed)
-                           Index Cond: (device_id = 1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (never executed)
-                     ->  Index Scan using compress_hyper_4_16_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_16_chunk (never executed)
-                           Index Cond: (device_id = 1)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=13674.00 loops=1)
+               ->  Append (actual rows=13674.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = 1)
+                                 Rows Removed by Filter: 24
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = 1)
+                                 Rows Removed by Filter: 24
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=4.00 loops=1)
+                                 Filter: (device_id = 1)
+                                 Rows Removed by Filter: 16
 
 -- test sort column not in targetlist
 :PREFIX
@@ -1933,22 +1928,17 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-               Order: metrics_compressed."time" DESC
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_15_chunk."time" DESC
-                     Sort Method: top-N heapsort 
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_3_14_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_3_13_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_4_16_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
 
 -- queries with ORDER BY non-time column shouldn't use ordered append
 :PREFIX
@@ -1958,14 +1948,16 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=1.00 loops=1)
          Sort Key: metrics_compressed.device_id
-         ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_4_16_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_16_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_4_17_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_17_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_4_18_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- time column must be primary sort order
 SET enable_seqscan TO false;
@@ -1979,24 +1971,17 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=1.00 loops=1)
          Sort Key: metrics_compressed.device_id, metrics_compressed."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_4_16_chunk.device_id, compress_hyper_4_16_chunk._ts_meta_min_1, compress_hyper_4_16_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=27348.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=7196.00 loops=1)
                      ->  Index Scan using compress_hyper_4_16_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_16_chunk (actual rows=8.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
-         ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_4_17_chunk.device_id, compress_hyper_4_17_chunk._ts_meta_min_1, compress_hyper_4_17_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=10076.00 loops=1)
                      ->  Index Scan using compress_hyper_4_17_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_17_chunk (actual rows=12.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
-         ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_4_18_chunk.device_id, compress_hyper_4_18_chunk._ts_meta_min_1, compress_hyper_4_18_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=10076.00 loops=1)
                      ->  Index Scan using compress_hyper_4_18_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_4_18_chunk (actual rows=12.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
 
@@ -2336,22 +2321,17 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-               Order: metrics_compressed."time"
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_13_chunk."time"
-                     Sort Method: top-N heapsort 
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_3_14_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_3_15_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- test query with ORDER BY time_bucket
 :PREFIX
@@ -2361,25 +2341,17 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-               Order: time_bucket('@ 1 day'::interval, metrics_compressed."time")
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_3_13_chunk."time"))
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=17990.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-               ->  Sort (never executed)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_3_14_chunk."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_3_15_chunk."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (time_bucket('@ 1 day'::interval, metrics_compressed."time"))
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- test query with ORDER BY time_bucket, device_id
 -- must not use ordered append
@@ -2394,33 +2366,23 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=1.00 loops=1)
-               Sort Key: (time_bucket('@ 1 day'::interval, metrics_compressed."time")), metrics_compressed.device_id
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_3_13_chunk."time")), _hyper_3_13_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=7196.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=7196.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=8.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 12
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_3_14_chunk."time")), _hyper_3_14_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=10076.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=10076.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=12.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 18
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_3_15_chunk."time")), _hyper_3_15_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=10076.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=10076.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=12.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 18
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (time_bucket('@ 1 day'::interval, metrics_compressed."time")), metrics_compressed.device_id
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=27348.00 loops=1)
+               ->  Append (actual rows=27348.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=7196.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=8.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 12
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=10076.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=12.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 18
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=10076.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=12.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 18
 
 -- test query with ORDER BY date_trunc
 :PREFIX
@@ -2430,25 +2392,17 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-               Order: date_trunc('day'::text, metrics_compressed."time")
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_13_chunk."time"))
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=17990.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-               ->  Sort (never executed)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_14_chunk."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_15_chunk."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (date_trunc('day'::text, metrics_compressed."time"))
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- test query with ORDER BY date_trunc
 :PREFIX
@@ -2458,25 +2412,17 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=1.00 loops=1)
-               Order: date_trunc('day'::text, metrics_compressed."time")
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_13_chunk."time"))
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=17990.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-               ->  Sort (never executed)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_14_chunk."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_15_chunk."time"))
-                     ->  Result (never executed)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (date_trunc('day'::text, metrics_compressed."time"))
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- test query with ORDER BY date_trunc, device_id
 -- must not use ordered append
@@ -2491,33 +2437,23 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=1.00 loops=1)
-               Sort Key: (date_trunc('day'::text, metrics_compressed."time")), metrics_compressed.device_id
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_13_chunk."time")), _hyper_3_13_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=7196.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=7196.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=8.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 12
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_14_chunk."time")), _hyper_3_14_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=10076.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=10076.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=12.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 18
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_3_15_chunk."time")), _hyper_3_15_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=10076.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=10076.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=12.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 18
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (date_trunc('day'::text, metrics_compressed."time")), metrics_compressed.device_id
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=27348.00 loops=1)
+               ->  Append (actual rows=27348.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=7196.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=8.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 12
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=10076.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=12.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 18
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=10076.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=12.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 18
 
 -- test query with now() should result in ordered ChunkAppend
 :PREFIX
@@ -2672,21 +2608,16 @@
  Limit (actual rows=4.00 loops=1)
    InitPlan 1
      ->  Result (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=4.00 loops=1)
-         Order: metrics_compressed."time"
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_13_chunk."time"
-               Sort Method: quicksort 
+   ->  Sort (actual rows=4.00 loops=1)
+         Sort Key: metrics_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_14_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_15_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- test with ordered guc disabled
 SET timescaledb.enable_ordered_append TO OFF;
@@ -2697,21 +2628,14 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=3.00 loops=1)
+   ->  Sort (actual rows=3.00 loops=1)
          Sort Key: metrics_compressed."time"
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_3_13_chunk."time"
-               Sort Method: top-N heapsort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_14_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_15_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
@@ -2723,21 +2647,16 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=3.00 loops=1)
-         Order: metrics_compressed."time"
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_3_13_chunk."time"
-               Sort Method: top-N heapsort 
+   ->  Sort (actual rows=3.00 loops=1)
+         Sort Key: metrics_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_14_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_15_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 -- test with chunk append disabled
 SET timescaledb.enable_chunk_append TO OFF;
@@ -2748,21 +2667,14 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=3.00 loops=1)
+   ->  Sort (actual rows=3.00 loops=1)
          Sort Key: metrics_compressed."time"
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_3_13_chunk."time"
-               Sort Method: top-N heapsort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_14_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_15_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
@@ -2774,21 +2686,16 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=3.00 loops=1)
-         Order: metrics_compressed."time"
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_3_13_chunk."time"
-               Sort Method: top-N heapsort 
+   ->  Sort (actual rows=3.00 loops=1)
+         Sort Key: metrics_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_13_chunk (actual rows=17990.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_16_chunk (actual rows=20.00 loops=1)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_14_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_17_chunk (never executed)
-         ->  Sort (never executed)
-               Sort Key: _hyper_3_15_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_4_18_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_14_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_15_chunk (actual rows=25190.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=30.00 loops=1)
 
 \set TEST_TABLE 'metrics_space_compressed'
 \ir :TEST_QUERY_NAME
@@ -2811,53 +2718,28 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-         Order: metrics_space_compressed."time"
-         ->  Merge Append (actual rows=1.00 loops=1)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_19_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_20_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_21_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_22_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_23_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_24_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_25_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_26_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_27_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- test DESC for ordered chunks
 :PREFIX
@@ -2867,53 +2749,28 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-         Order: metrics_space_compressed."time" DESC
-         ->  Merge Append (actual rows=1.00 loops=1)
-               Sort Key: metrics_space_compressed."time" DESC
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_27_chunk."time" DESC
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_26_chunk."time" DESC
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_25_chunk."time" DESC
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time" DESC
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_24_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_23_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_22_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time" DESC
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_21_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_30_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_20_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_29_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_19_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_28_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_space_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
 
 -- test query with ORDER BY column not in targetlist
 :PREFIX
@@ -2924,54 +2781,29 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-               Order: metrics_space_compressed."time"
-               ->  Merge Append (actual rows=1.00 loops=1)
-                     Sort Key: metrics_space_compressed."time"
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_19_chunk."time"
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_20_chunk."time"
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_21_chunk."time"
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-               ->  Merge Append (never executed)
-                     Sort Key: metrics_space_compressed."time"
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_22_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_23_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_24_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-               ->  Merge Append (never executed)
-                     Sort Key: metrics_space_compressed."time"
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_25_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_26_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_27_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- ORDER BY may include other columns after time column
 :PREFIX
@@ -2985,17 +2817,19 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-         Order: metrics_space_compressed."time" DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_34_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_34_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (device_id = 1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-               ->  Index Scan using compress_hyper_6_31_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_31_chunk (never executed)
-                     Index Cond: (device_id = 1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (never executed)
-               ->  Index Scan using compress_hyper_6_28_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_28_chunk (never executed)
-                     Index Cond: (device_id = 1)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_space_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=13674.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                           Filter: (device_id = 1)
 
 -- test RECORD in targetlist
 :PREFIX
@@ -3009,18 +2843,20 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-               Order: metrics_space_compressed."time" DESC
-               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_34_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_34_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (device_id = 1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                     ->  Index Scan using compress_hyper_6_31_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_31_chunk (never executed)
-                           Index Cond: (device_id = 1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (never executed)
-                     ->  Index Scan using compress_hyper_6_28_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_28_chunk (never executed)
-                           Index Cond: (device_id = 1)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_space_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=13674.00 loops=1)
+               ->  Append (actual rows=13674.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                                 Filter: (device_id = 1)
 
 -- test sort column not in targetlist
 :PREFIX
@@ -3030,54 +2866,29 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-               Order: metrics_space_compressed."time" DESC
-               ->  Merge Append (actual rows=1.00 loops=1)
-                     Sort Key: metrics_space_compressed."time" DESC
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_27_chunk."time" DESC
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_26_chunk."time" DESC
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_25_chunk."time" DESC
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
-               ->  Merge Append (never executed)
-                     Sort Key: metrics_space_compressed."time" DESC
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_24_chunk."time" DESC
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_23_chunk."time" DESC
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_22_chunk."time" DESC
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-               ->  Merge Append (never executed)
-                     Sort Key: metrics_space_compressed."time" DESC
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_21_chunk."time" DESC
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_30_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_20_chunk."time" DESC
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_29_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_19_chunk."time" DESC
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_28_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_space_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
 
 -- queries with ORDER BY non-time column shouldn't use ordered append
 :PREFIX
@@ -3087,26 +2898,28 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=1.00 loops=1)
          Sort Key: metrics_space_compressed.device_id
-         ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_28_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_28_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_29_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_29_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_30_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_30_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_31_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_31_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_32_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_32_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_33_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_33_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_34_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_34_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_35_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_35_chunk (actual rows=1.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_36_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_36_chunk (actual rows=1.00 loops=1)
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- time column must be primary sort order
 SET enable_seqscan TO false;
@@ -3120,42 +2933,26 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=1.00 loops=1)
          Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_28_chunk.device_id, compress_hyper_6_28_chunk._ts_meta_min_1, compress_hyper_6_28_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=27348.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
                      ->  Index Scan using compress_hyper_6_28_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
-         ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_29_chunk.device_id, compress_hyper_6_29_chunk._ts_meta_min_1, compress_hyper_6_29_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=3598.00 loops=1)
                      ->  Index Scan using compress_hyper_6_29_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_29_chunk (actual rows=4.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
-         ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_31_chunk.device_id, compress_hyper_6_31_chunk._ts_meta_min_1, compress_hyper_6_31_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
                      ->  Index Scan using compress_hyper_6_31_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
-         ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_32_chunk.device_id, compress_hyper_6_32_chunk._ts_meta_min_1, compress_hyper_6_32_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=5038.00 loops=1)
                      ->  Index Scan using compress_hyper_6_32_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_32_chunk (actual rows=6.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
-         ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_34_chunk.device_id, compress_hyper_6_34_chunk._ts_meta_min_1, compress_hyper_6_34_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
                      ->  Index Scan using compress_hyper_6_34_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
-         ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=1.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_35_chunk.device_id, compress_hyper_6_35_chunk._ts_meta_min_1, compress_hyper_6_35_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=5038.00 loops=1)
                      ->  Index Scan using compress_hyper_6_35_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_6_35_chunk (actual rows=6.00 loops=1)
                            Index Cond: (device_id = ANY ('{1,2}'::integer[]))
 
@@ -3195,83 +2992,52 @@
 WHERE device_id IN (1, 2) OR time > '2000-01-06'
 ORDER BY time ASC;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=56853.00 loops=1)
-   Order: metrics_space_compressed."time"
-   ->  Merge Append (actual rows=7196.00 loops=1)
-         Sort Key: metrics_space_compressed."time"
-         ->  Sort (actual rows=3598.00 loops=1)
-               Sort Key: _hyper_5_19_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Sort (actual rows=3598.00 loops=1)
-               Sort Key: _hyper_5_20_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=3598.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=4.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                           Rows Removed by Filter: 8
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: _hyper_5_21_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=0.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=0.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                           Rows Removed by Filter: 4
-   ->  Merge Append (actual rows=24467.00 loops=1)
-         Sort Key: metrics_space_compressed."time"
-         ->  Sort (actual rows=5038.00 loops=1)
-               Sort Key: _hyper_5_22_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Sort (actual rows=14632.00 loops=1)
-               Sort Key: _hyper_5_23_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=14632.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     Rows Removed by Filter: 406
-                     ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=16.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                           Rows Removed by Filter: 2
-         ->  Sort (actual rows=4797.00 loops=1)
-               Sort Key: _hyper_5_24_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=4797.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     Rows Removed by Filter: 203
-                     ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=5.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                           Rows Removed by Filter: 1
-   ->  Merge Append (actual rows=25190.00 loops=1)
-         Sort Key: metrics_space_compressed."time"
-         ->  Sort (actual rows=5038.00 loops=1)
-               Sort Key: _hyper_5_25_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Sort (actual rows=15114.00 loops=1)
-               Sort Key: _hyper_5_26_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Sort (actual rows=5038.00 loops=1)
-               Sort Key: _hyper_5_27_chunk."time"
-               Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
-                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
-                     ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
-                           Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+ Sort (actual rows=56853.00 loops=1)
+   Sort Key: metrics_space_compressed."time"
+   Sort Method: quicksort 
+   ->  Append (actual rows=56853.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=3598.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=4.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+                     Rows Removed by Filter: 8
+         ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=0.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=0.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+                     Rows Removed by Filter: 4
+         ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=14632.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               Rows Removed by Filter: 406
+               ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=16.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+                     Rows Removed by Filter: 2
+         ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=4797.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               Rows Removed by Filter: 203
+               ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=5.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+                     Rows Removed by Filter: 1
+         ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+               Filter: ((device_id = ANY ('{1,2}'::integer[])) OR ("time" > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
+                     Filter: ((device_id = ANY ('{1,2}'::integer[])) OR (_ts_meta_max_1 > 'Thu Jan 06 00:00:00 2000 PST'::timestamp with time zone))
 
 -- queries without ORDER BY shouldnt use ordered append
 SET enable_seqscan TO false;
@@ -3942,54 +3708,29 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-               Order: metrics_space_compressed."time"
-               ->  Merge Append (actual rows=1.00 loops=1)
-                     Sort Key: metrics_space_compressed."time"
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_19_chunk."time"
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_20_chunk."time"
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: _hyper_5_21_chunk."time"
-                           Sort Method: top-N heapsort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-               ->  Merge Append (never executed)
-                     Sort Key: metrics_space_compressed."time"
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_22_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_23_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_24_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-               ->  Merge Append (never executed)
-                     Sort Key: metrics_space_compressed."time"
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_25_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_26_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: _hyper_5_27_chunk."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                                 ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- test query with ORDER BY time_bucket
 :PREFIX
@@ -3999,63 +3740,29 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-               Order: time_bucket('@ 1 day'::interval, metrics_space_compressed."time")
-               ->  Merge Append (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, metrics_space_compressed."time"))
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_19_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=3598.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_20_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=10794.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_21_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=3598.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-               ->  Merge Append (never executed)
-                     Sort Key: (time_bucket('@ 1 day'::interval, metrics_space_compressed."time"))
-                     ->  Sort (never executed)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_22_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_23_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_24_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-               ->  Merge Append (never executed)
-                     Sort Key: (time_bucket('@ 1 day'::interval, metrics_space_compressed."time"))
-                     ->  Sort (never executed)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_25_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_26_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_27_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (time_bucket('@ 1 day'::interval, metrics_space_compressed."time"))
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- test query with ORDER BY time_bucket, device_id
 -- must not use ordered append
@@ -4070,54 +3777,32 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=1.00 loops=1)
-               Sort Key: (time_bucket('@ 1 day'::interval, metrics_space_compressed."time")), metrics_space_compressed.device_id
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_19_chunk."time")), _hyper_5_19_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=3598.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_20_chunk."time")), _hyper_5_20_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=3598.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=4.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 8
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_22_chunk."time")), _hyper_5_22_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_23_chunk."time")), _hyper_5_23_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 12
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_25_chunk."time")), _hyper_5_25_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (time_bucket('@ 1 day'::interval, _hyper_5_26_chunk."time")), _hyper_5_26_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 12
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (time_bucket('@ 1 day'::interval, metrics_space_compressed."time")), metrics_space_compressed.device_id
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=27348.00 loops=1)
+               ->  Append (actual rows=27348.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=4.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 8
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 12
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 12
 
 -- test query with ORDER BY date_trunc
 :PREFIX
@@ -4127,63 +3812,29 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-               Order: date_trunc('day'::text, metrics_space_compressed."time")
-               ->  Merge Append (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_19_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=3598.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_20_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=10794.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_21_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=3598.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-               ->  Merge Append (never executed)
-                     Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_22_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_23_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_24_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-               ->  Merge Append (never executed)
-                     Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_25_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_26_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_27_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- test query with ORDER BY date_trunc
 :PREFIX
@@ -4193,63 +3844,29 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=1.00 loops=1)
-               Order: date_trunc('day'::text, metrics_space_compressed."time")
-               ->  Merge Append (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_19_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=3598.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_20_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=10794.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_21_chunk."time"))
-                           Sort Method: top-N heapsort 
-                           ->  Result (actual rows=3598.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-               ->  Merge Append (never executed)
-                     Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_22_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_23_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_24_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-               ->  Merge Append (never executed)
-                     Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_25_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_26_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: (date_trunc('day'::text, _hyper_5_27_chunk."time"))
-                           ->  Result (never executed)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                                       ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (date_trunc('day'::text, metrics_space_compressed."time"))
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=68370.00 loops=1)
+               ->  Append (actual rows=68370.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- test query with ORDER BY date_trunc, device_id
 -- must not use ordered append
@@ -4264,54 +3881,32 @@
 LIMIT 1;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Result (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=1.00 loops=1)
-               Sort Key: (date_trunc('day'::text, metrics_space_compressed."time")), metrics_space_compressed.device_id
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_5_19_chunk."time")), _hyper_5_19_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=3598.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_5_20_chunk."time")), _hyper_5_20_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=3598.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=3598.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=4.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 8
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_5_22_chunk."time")), _hyper_5_22_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_5_23_chunk."time")), _hyper_5_23_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 12
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_5_25_chunk."time")), _hyper_5_25_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: (date_trunc('day'::text, _hyper_5_26_chunk."time")), _hyper_5_26_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Result (actual rows=5038.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=5038.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=6.00 loops=1)
-                                       Filter: (device_id = ANY ('{1,2}'::integer[]))
-                                       Rows Removed by Filter: 12
+   ->  Sort (actual rows=1.00 loops=1)
+         Sort Key: (date_trunc('day'::text, metrics_space_compressed."time")), metrics_space_compressed.device_id
+         Sort Method: top-N heapsort 
+         ->  Result (actual rows=27348.00 loops=1)
+               ->  Append (actual rows=27348.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=3598.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=4.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 8
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 12
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=6.00 loops=1)
+                                 Filter: (device_id = ANY ('{1,2}'::integer[]))
+                                 Rows Removed by Filter: 12
 
 -- test query with now() should result in ordered ChunkAppend
 :PREFIX
@@ -4400,70 +3995,48 @@
 FROM i;
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=100.00 loops=1)
-         Order: metrics_space_compressed."time" DESC
-         ->  Merge Append (actual rows=100.00 loops=1)
-               Sort Key: metrics_space_compressed."time" DESC
-               ->  Sort (actual rows=21.00 loops=1)
-                     Sort Key: _hyper_5_27_chunk."time" DESC
-                     Sort Method: top-N heapsort 
+   ->  Sort (actual rows=100.00 loops=1)
+         Sort Key: metrics_space_compressed."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=68370.00 loops=1)
+               ->  Merge Append (actual rows=25190.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
                            Vectorized Filter: ("time" < now())
                            ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-               ->  Sort (actual rows=60.00 loops=1)
-                     Sort Key: _hyper_5_26_chunk."time" DESC
-                     Sort Method: top-N heapsort 
                      ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
                            Vectorized Filter: ("time" < now())
                            ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-               ->  Sort (actual rows=21.00 loops=1)
-                     Sort Key: _hyper_5_25_chunk."time" DESC
-                     Sort Method: top-N heapsort 
                      ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
                            Vectorized Filter: ("time" < now())
                            ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time" DESC
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_24_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
+               ->  Merge Append (actual rows=25190.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
                            Vectorized Filter: ("time" < now())
-                           ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
+                           ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_23_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
                            Vectorized Filter: ("time" < now())
-                           ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
+                           ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_22_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
                            Vectorized Filter: ("time" < now())
-                           ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
+                           ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time" DESC
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_21_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (never executed)
+               ->  Merge Append (actual rows=17990.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
                            Vectorized Filter: ("time" < now())
-                           ->  Seq Scan on compress_hyper_6_30_chunk (never executed)
+                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_20_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
                            Vectorized Filter: ("time" < now())
-                           ->  Seq Scan on compress_hyper_6_29_chunk (never executed)
+                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_19_chunk."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
                            Vectorized Filter: ("time" < now())
-                           ->  Seq Scan on compress_hyper_6_28_chunk (never executed)
+                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
                                  Filter: (_ts_meta_min_1 < now())
 
 -- test CTE
@@ -4620,53 +4193,28 @@
  Limit (actual rows=4.00 loops=1)
    InitPlan 1
      ->  Result (actual rows=1.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=4.00 loops=1)
-         Order: metrics_space_compressed."time"
-         ->  Merge Append (actual rows=4.00 loops=1)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (actual rows=2.00 loops=1)
-                     Sort Key: _hyper_5_19_chunk."time"
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_5_20_chunk."time"
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_21_chunk."time"
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_22_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_23_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_24_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_25_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_26_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_27_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=4.00 loops=1)
+         Sort Key: metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- test with ordered guc disabled
 SET timescaledb.enable_ordered_append TO OFF;
@@ -4677,51 +4225,26 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=3.00 loops=1)
+   ->  Sort (actual rows=3.00 loops=1)
          Sort Key: metrics_space_compressed."time"
-         ->  Sort (actual rows=2.00 loops=1)
-               Sort Key: _hyper_5_19_chunk."time"
-               Sort Method: top-N heapsort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-         ->  Sort (actual rows=2.00 loops=1)
-               Sort Key: _hyper_5_20_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_21_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_22_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_23_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_24_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_25_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_26_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_27_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
@@ -4733,53 +4256,28 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=3.00 loops=1)
-         Order: metrics_space_compressed."time"
-         ->  Merge Append (actual rows=3.00 loops=1)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (actual rows=2.00 loops=1)
-                     Sort Key: _hyper_5_19_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-               ->  Sort (actual rows=2.00 loops=1)
-                     Sort Key: _hyper_5_20_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_21_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_22_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_23_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_24_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_25_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_26_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_27_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=3.00 loops=1)
+         Sort Key: metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- test with chunk append disabled
 SET timescaledb.enable_chunk_append TO OFF;
@@ -4790,51 +4288,26 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=3.00 loops=1)
+   ->  Sort (actual rows=3.00 loops=1)
          Sort Key: metrics_space_compressed."time"
-         ->  Sort (actual rows=2.00 loops=1)
-               Sort Key: _hyper_5_19_chunk."time"
-               Sort Method: top-N heapsort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-         ->  Sort (actual rows=2.00 loops=1)
-               Sort Key: _hyper_5_20_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_21_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_22_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_23_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_24_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_25_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_26_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_27_chunk."time"
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
                      ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
@@ -4846,53 +4319,28 @@
 LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=3.00 loops=1)
-         Order: metrics_space_compressed."time"
-         ->  Merge Append (actual rows=3.00 loops=1)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (actual rows=2.00 loops=1)
-                     Sort Key: _hyper_5_19_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
-               ->  Sort (actual rows=2.00 loops=1)
-                     Sort Key: _hyper_5_20_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_5_21_chunk."time"
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_22_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_31_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_23_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_32_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_24_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_33_chunk (never executed)
-         ->  Merge Append (never executed)
-               Sort Key: metrics_space_compressed."time"
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_25_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_34_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_26_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_35_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: _hyper_5_27_chunk."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (never executed)
-                           ->  Seq Scan on compress_hyper_6_36_chunk (never executed)
+   ->  Sort (actual rows=3.00 loops=1)
+         Sort Key: metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=68370.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_19_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_28_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_20_chunk (actual rows=10794.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_29_chunk (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_21_chunk (actual rows=3598.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_30_chunk (actual rows=4.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_22_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_31_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_23_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_32_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_24_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_33_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_25_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_34_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_26_chunk (actual rows=15114.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_35_chunk (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_27_chunk (actual rows=5038.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_36_chunk (actual rows=6.00 loops=1)
 
 -- get results for all the queries
 -- run queries on uncompressed hypertable and store result
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan-17.out	2025-11-06 02:35:39.303068395 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan-17.out	2025-11-06 02:47:54.005705797 +0000
@@ -3751,128 +3751,123 @@
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev DESC NULLS FIRST;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 -- Test not-NULL mode
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev IS NOT NULL ORDER BY dev;
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev IS NOT NULL ORDER BY dev DESC NULLS FIRST;
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 -- NULLS FIRST doesn't match segmentby NULL direction
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev NULLS FIRST;
 --- QUERY PLAN ---
- Sort (actual rows=11.00 loops=1)
-   Sort Key: skip_scan_htc.dev NULLS FIRST
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=11.00 loops=1)
-         Group Key: skip_scan_htc.dev
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev NULLS FIRST
+         Sort Method: quicksort 
          ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
@@ -3887,87 +3882,75 @@
 :PREFIX SELECT DISTINCT ON (dev) dev, time FROM :TABLE ORDER BY dev, time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev, skip_scan_htc."time" DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 -- Test not-NULL mode
 :PREFIX SELECT DISTINCT ON (dev) dev, time FROM :TABLE WHERE dev IS NOT NULL ORDER BY dev, time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev, skip_scan_htc."time" DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT DISTINCT ON (dev) dev, time FROM :TABLE ORDER BY dev DESC, time;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC, skip_scan_htc."time"
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 -- multicolumn sort not matching compression index
 :PREFIX SELECT DISTINCT ON (dev) dev, time FROM :TABLE ORDER BY dev DESC, time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC, skip_scan_htc."time" DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_18_chunk.dev DESC, compress_hyper_4_18_chunk._ts_meta_min_1 DESC, compress_hyper_4_18_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_19_chunk.dev DESC, compress_hyper_4_19_chunk._ts_meta_min_1 DESC, compress_hyper_4_19_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_20_chunk.dev DESC, compress_hyper_4_20_chunk._ts_meta_min_1 DESC, compress_hyper_4_20_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_21_chunk.dev DESC, compress_hyper_4_21_chunk._ts_meta_min_1 DESC, compress_hyper_4_21_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 -- same result when we use compressed IndexPath with pathkeys not matching DecompressChunk path required path keys
@@ -3975,27 +3958,17 @@
 :PREFIX SELECT DISTINCT ON (dev) dev, time FROM :TABLE ORDER BY dev DESC, time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC, skip_scan_htc."time" DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_18_chunk.dev DESC, compress_hyper_4_18_chunk._ts_meta_min_1 DESC, compress_hyper_4_18_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_19_chunk.dev DESC, compress_hyper_4_19_chunk._ts_meta_min_1 DESC, compress_hyper_4_19_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_20_chunk.dev DESC, compress_hyper_4_20_chunk._ts_meta_min_1 DESC, compress_hyper_4_20_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_21_chunk.dev DESC, compress_hyper_4_21_chunk._ts_meta_min_1 DESC, compress_hyper_4_21_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 RESET enable_seqscan;
@@ -4023,12 +3996,11 @@
 :PREFIX SELECT DISTINCT time, dev FROM :TABLE WHERE time = 100 ORDER BY time, dev;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 1492
-               ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-                     Index Cond: ((_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 2494
+         ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 -- multicolumn "segmentby = 'dev, dev_name'"
 SELECT decompress_chunk(ch) FROM show_chunks('skip_scan_htc') ch;
@@ -4052,169 +4024,139 @@
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, dev_name FROM :TABLE ORDER BY dev, dev_name;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev, skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, dev_name FROM :TABLE ORDER BY dev DESC, dev_name DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC, skip_scan_htc.dev_name DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
 
 -- query sort doesn't match "segmentby" sort
 :PREFIX SELECT DISTINCT ON (dev) dev, dev_name FROM :TABLE ORDER BY dev, dev_name DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev, skip_scan_htc.dev_name DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_22_chunk.dev, compress_hyper_4_22_chunk.dev_name DESC
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_23_chunk.dev, compress_hyper_4_23_chunk.dev_name DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_24_chunk.dev, compress_hyper_4_24_chunk.dev_name DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_25_chunk.dev, compress_hyper_4_25_chunk.dev_name DESC
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
 
 -- dev_name is not a leading column
 :PREFIX SELECT DISTINCT dev_name FROM :TABLE WHERE dev = 1 ORDER BY dev_name;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
 
 -- Test not-NULL mode
 :PREFIX SELECT DISTINCT dev_name FROM :TABLE WHERE dev = 1 AND dev_name IS NOT NULL ORDER BY dev_name;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name FROM :TABLE WHERE dev = 1;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev = 1)
 
 -- Basic tests for "segmentby = 'dev'"
 -----------------------------------------
@@ -4239,62 +4181,56 @@
 basic DISTINCT queries on skip_scan_htc
 :PREFIX SELECT DISTINCT dev, 'q1_1' FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT dev, 'q1_3', NULL FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 \qecho stable expression in targetlist on :TABLE
 stable expression in targetlist on skip_scan_htc
 :PREFIX SELECT DISTINCT dev, 'q1_4', length(md5(now()::text)) FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- volatile expression in targetlist counts as extra distinct column, no SkipScan
 :PREFIX SELECT DISTINCT dev, 'q1_6', length(md5(random()::text)) FROM :TABLE ORDER BY dev;
@@ -4317,11 +4253,10 @@
 -- queries without skipscan because distinct is not limited to specific column
 :PREFIX SELECT DISTINCT * FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Sort (actual rows=10020.00 loops=1)
-   Sort Key: skip_scan_htc.dev
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=10020.00 loops=1)
-         Group Key: skip_scan_htc.dev, skip_scan_htc."time", skip_scan_htc.dev_name, skip_scan_htc.val
+ Unique (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev, skip_scan_htc."time", skip_scan_htc.dev_name, skip_scan_htc.val
+         Sort Method: quicksort 
          ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
@@ -4334,11 +4269,10 @@
 
 :PREFIX SELECT DISTINCT *, 'q1_9' FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Sort (actual rows=10020.00 loops=1)
-   Sort Key: skip_scan_htc.dev
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=10020.00 loops=1)
-         Group Key: skip_scan_htc.dev, skip_scan_htc."time", skip_scan_htc.dev_name, skip_scan_htc.val
+ Unique (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev, skip_scan_htc."time", skip_scan_htc.dev_name, skip_scan_htc.val
+         Sort Method: quicksort 
          ->  Result (actual rows=10020.00 loops=1)
                ->  Append (actual rows=10020.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
@@ -4352,11 +4286,10 @@
 
 :PREFIX SELECT DISTINCT dev, time, 'q1_10' FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Sort (actual rows=10020.00 loops=1)
-   Sort Key: skip_scan_htc.dev
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=10020.00 loops=1)
-         Group Key: skip_scan_htc.dev, skip_scan_htc."time"
+ Unique (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev, skip_scan_htc."time"
+         Sort Method: quicksort 
          ->  Result (actual rows=10020.00 loops=1)
                ->  Append (actual rows=10020.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
@@ -4371,29 +4304,48 @@
 -- use SkipScan as only one non-const distinct column
 :PREFIX SELECT DISTINCT dev, NULL, 'q1_11' FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- distinct on expressions not supported
 :PREFIX SELECT DISTINCT dev + 1, 'q1_13' FROM :TABLE;
 --- QUERY PLAN ---
- HashAggregate (actual rows=11.00 loops=1)
-   Group Key: (skip_scan_htc.dev + 1)
+ Unique (actual rows=11.00 loops=1)
    ->  Result (actual rows=10020.00 loops=1)
+         ->  Merge Append (actual rows=10020.00 loops=1)
+               Sort Key: ((skip_scan_htc.dev + 1))
+               ->  Result (actual rows=2505.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Result (actual rows=2505.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Result (actual rows=2505.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Result (actual rows=2505.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+
+-- DISTINCT ON queries
+:PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE;
+--- QUERY PLAN ---
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
          ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
@@ -4404,332 +4356,285 @@
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
--- DISTINCT ON queries
-:PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE;
---- QUERY PLAN ---
- Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
-         Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
-
 -- Test not-NULL mode
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE dev_name IS NOT NULL;
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
                      Vectorized Filter: (dev_name IS NOT NULL)
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
                      Vectorized Filter: (dev_name IS NOT NULL)
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
                      Vectorized Filter: (dev_name IS NOT NULL)
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
                      Vectorized Filter: (dev_name IS NOT NULL)
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_2' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_3', NULL FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_4', length(md5(now()::text)) FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_5', length(md5(random()::text)) FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) *, 'q2_7' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, time, 'q2_8' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, NULL, 'q2_9' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) time, 'q2_10' FROM :TABLE ORDER by dev, time DESC;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev, skip_scan_htc."time" DESC
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev, skip_scan_htc."time" DESC
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, tableoid::regclass, 'q2_11' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, int_func_immutable(), 'q2_12' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, int_func_stable(), 'q2_13' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, int_func_volatile(), 'q2_14' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 \qecho DISTINCT with wholerow var
 DISTINCT with wholerow var
 :PREFIX SELECT DISTINCT ON (dev) :TABLE FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- should not use SkipScan since we only support SkipScan on single-column distinct
 :PREFIX SELECT DISTINCT :TABLE FROM :TABLE;
 --- QUERY PLAN ---
- HashAggregate (actual rows=10020.00 loops=1)
-   Group Key: ((skip_scan_htc.*)::skip_scan_htc)
-   ->  Append (actual rows=10020.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
-               ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
-               ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
-               ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
-               ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: ((skip_scan_htc.*)::skip_scan_htc)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 \qecho LIMIT queries on :TABLE
 LIMIT queries on skip_scan_htc
@@ -4737,96 +4642,94 @@
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  Unique (actual rows=3.00 loops=1)
-         ->  Merge Append (actual rows=9.00 loops=1)
+         ->  Sort (actual rows=2001.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=3.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE ORDER BY dev DESC, time LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  Unique (actual rows=3.00 loops=1)
-         ->  Merge Append (actual rows=9.00 loops=1)
+         ->  Sort (actual rows=1021.00 loops=1)
                Sort Key: skip_scan_htc.dev DESC, skip_scan_htc."time"
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=3.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE ORDER BY dev, time DESC LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  Unique (actual rows=3.00 loops=1)
-         ->  Merge Append (actual rows=9.00 loops=1)
+         ->  Sort (actual rows=2001.00 loops=1)
                Sort Key: skip_scan_htc.dev, skip_scan_htc."time" DESC
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=3.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 \qecho range queries on :TABLE
 range queries on skip_scan_htc
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time BETWEEN 100 AND 300;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time < 200;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=2004.00 loops=1)
+         Sort Key: _hyper_3_5_chunk.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2004.00 loops=1)
                Vectorized Filter: ("time" < 200)
                Rows Removed by Filter: 501
-               ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_min_1 < 200)
+               ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     Filter: (_ts_meta_min_1 < 200)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time > 800;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=1993.00 loops=1)
+         Sort Key: _hyper_3_8_chunk.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1993.00 loops=1)
                Vectorized Filter: ("time" > 800)
-               ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_max_1 > 800)
+               Rows Removed by Filter: 512
+               ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+                     Filter: (_ts_meta_max_1 > 800)
 
 -- Basic tests for text index "segmentby = 'dev_name'"
 ------------------------------------------------------
@@ -4849,43 +4752,39 @@
 
 :PREFIX SELECT DISTINCT dev_name, 'q1_2' FROM :TABLE ORDER BY dev_name;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 \qecho stable expression in targetlist on :TABLE
 stable expression in targetlist on skip_scan_htc
 :PREFIX SELECT DISTINCT dev_name, 'q1_5', length(md5(now()::text)) FROM :TABLE ORDER BY dev_name;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 -- volatile expression in targetlist counts as extra distinct column, no SkipScan
 :PREFIX SELECT DISTINCT dev_name, 'q1_7', length(md5(random()::text)) FROM :TABLE ORDER BY dev_name;
@@ -4908,9 +4807,28 @@
 -- distinct on expressions not supported
 :PREFIX SELECT DISTINCT 'Device ' || dev_name FROM :TABLE;
 --- QUERY PLAN ---
- HashAggregate (actual rows=11.00 loops=1)
-   Group Key: ('Device '::text || skip_scan_htc.dev_name)
-   ->  Result (actual rows=10020.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: (('Device '::text || skip_scan_htc.dev_name))
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+
+-- DISTINCT ON queries on TEXT column
+:PREFIX SELECT DISTINCT ON (dev_name) dev_name FROM :TABLE;
+--- QUERY PLAN ---
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
          ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
@@ -4921,334 +4839,285 @@
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
--- DISTINCT ON queries on TEXT column
-:PREFIX SELECT DISTINCT ON (dev_name) dev_name FROM :TABLE;
---- QUERY PLAN ---
- Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
-         Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
-
 -- Test not-NULL mode
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name FROM :TABLE WHERE dev_name IS NOT NULL;
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name, 'q3_2' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name, 'q3_3', NULL FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name, 'q3_4', length(md5(now()::text)) FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name, 'q3_5', length(md5(random()::text)) FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) * FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) *, 'q3_7' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name, time, 'q3_8' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name, NULL, 'q3_9' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) time, 'q3_10' FROM :TABLE ORDER by dev_name, time DESC;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name, skip_scan_htc."time" DESC
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name, skip_scan_htc."time" DESC
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name, tableoid::regclass, 'q3_11' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name::varchar) dev_name::varchar FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: ((skip_scan_htc.dev_name)::character varying)
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev, int_func_immutable(), 'q3_13' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev, int_func_stable(), 'q3_14' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev, int_func_volatile(), 'q3_15' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htc.dev_name
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev_name) dev_name FROM :TABLE WHERE dev_name IS NULL;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev_name IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev_name IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev_name IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev_name IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev_name IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev_name IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev_name IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev_name IS NULL)
 
 -- Various tests for "segmentby = 'dev'"
 ---------------------------------------
@@ -5274,387 +5143,339 @@
 :PREFIX SELECT time, dev, val, 'q4_1' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htc.dev
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT NULL, dev, NULL, 'q4_3' FROM (SELECT DISTINCT ON (dev) dev FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT time, dev, NULL, 'q4_4' FROM (SELECT DISTINCT ON (dev) dev, time FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 \qecho ORDER BY
 ORDER BY
 :PREFIX SELECT time, dev, val, 'q5_1' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE ORDER BY dev, time) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htc.dev, skip_scan_htc."time"
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htc.dev, skip_scan_htc."time"
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT time, dev, val, 'q5_2' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE ORDER BY dev DESC, time DESC) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htc.dev DESC, skip_scan_htc."time" DESC
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htc.dev DESC, skip_scan_htc."time" DESC
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 \qecho WHERE CLAUSES
 WHERE CLAUSES
 :PREFIX SELECT time, dev, val, 'q6_1' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev > 5) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=5.00 loops=1)
-   ->  Result (actual rows=5.00 loops=1)
-         ->  Unique (actual rows=5.00 loops=1)
-               ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Unique (actual rows=5.00 loops=1)
+         ->  Result (actual rows=5000.00 loops=1)
+               ->  Merge Append (actual rows=5000.00 loops=1)
                      Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
 
 :PREFIX SELECT time, dev, val, 'q6_2' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE WHERE time > 5) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=9959.00 loops=1)
+               Sort Key: skip_scan_htc.dev
+               Sort Method: quicksort 
+               ->  Result (actual rows=9959.00 loops=1)
+                     ->  Append (actual rows=9959.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2444.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
                                  Rows Removed by Filter: 61
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
+                                 ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
 
 :PREFIX SELECT time, dev, val, 'q6_3' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE) a WHERE dev > 5;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=5.00 loops=1)
-   ->  Result (actual rows=5.00 loops=1)
-         ->  Unique (actual rows=5.00 loops=1)
-               ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Unique (actual rows=5.00 loops=1)
+         ->  Result (actual rows=5000.00 loops=1)
+               ->  Merge Append (actual rows=5000.00 loops=1)
                      Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
 
 :PREFIX SELECT time, dev, val, 'q6_4' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE) a WHERE time > 5;
 --- QUERY PLAN ---
- Subquery Scan on a (actual rows=7.00 loops=1)
+ Subquery Scan on a (actual rows=10.00 loops=1)
    Filter: (a."time" > 5)
-   Rows Removed by Filter: 4
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+   Rows Removed by Filter: 1
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htc.dev
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 --\qecho immutable func in WHERE clause on :TABLE
 :PREFIX SELECT DISTINCT ON (dev) *, 'q6_5' FROM :TABLE WHERE dev > int_func_immutable();
 --- QUERY PLAN ---
- Result (actual rows=9.00 loops=1)
-   ->  Unique (actual rows=9.00 loops=1)
-         ->  Merge Append (actual rows=36.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
+ Unique (actual rows=9.00 loops=1)
+   ->  Result (actual rows=9000.00 loops=1)
+         ->  Merge Append (actual rows=9000.00 loops=1)
+               Sort Key: skip_scan_htc.dev
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
 
 --\qecho stable func in WHERE clause on :TABLE
 :PREFIX SELECT DISTINCT ON (dev) *, 'q6_6' FROM :TABLE WHERE dev > int_func_stable();
 --- QUERY PLAN ---
- Result (actual rows=8.00 loops=1)
-   ->  Unique (actual rows=8.00 loops=1)
-         ->  Custom Scan (ConstraintAwareAppend) (actual rows=32.00 loops=1)
+ Unique (actual rows=8.00 loops=1)
+   ->  Result (actual rows=8000.00 loops=1)
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=8000.00 loops=1)
                Hypertable: skip_scan_htc
                Chunks excluded during startup: 0
-               ->  Merge Append (actual rows=32.00 loops=1)
+               ->  Merge Append (actual rows=8000.00 loops=1)
                      Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
 
 --\qecho volatile func in WHERE clause on :TABLE
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev > int_func_volatile();
 --- QUERY PLAN ---
  Unique (actual rows=7.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=28.00 loops=1)
-         Hypertable: skip_scan_htc
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=28.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=7000.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=7000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = ANY(inta_func_immutable());
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=12.00 loops=1)
+   ->  Merge Append (actual rows=3000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = ANY(inta_func_stable());
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
+   ->  Custom Scan (ConstraintAwareAppend) (actual rows=3000.00 loops=1)
          Hypertable: skip_scan_htc
          Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
+         ->  Merge Append (actual rows=3000.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = ANY(inta_func_volatile());
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
-         Hypertable: skip_scan_htc
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=3000.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=3000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 -- RowCompareExpr
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE (dev, time) > (5,100);
 --- QUERY PLAN ---
  Unique (actual rows=6.00 loops=1)
-   ->  Merge Append (actual rows=24.00 loops=1)
+   ->  Sort (actual rows=5899.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=6.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=5899.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1399.00 loops=1)
                      Filter: (ROW(dev, "time") > ROW(5, 100))
                      Rows Removed by Filter: 1106
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=6.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1500.00 loops=1)
                      Filter: (ROW(dev, "time") > ROW(5, 100))
                      Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=6.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1500.00 loops=1)
                      Filter: (ROW(dev, "time") > ROW(5, 100))
                      Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=6.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1500.00 loops=1)
                      Filter: (ROW(dev, "time") > ROW(5, 100))
                      Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 -- always false expr similar to our initial skip qual
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev > NULL;
@@ -5672,114 +5493,96 @@
  Unique (actual rows=0.00 loops=1)
    ->  Merge Append (actual rows=0.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (dev > 20)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
+               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (dev > 20)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
+               ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (dev > 20)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
+               ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (dev > 20)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
+               ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (dev > 20)
 
 -- multiple constraints in WHERE clause
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time = 100;
 --- QUERY PLAN ---
  Unique (actual rows=5.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 500
-               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
-                     Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 1245
+         ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
+               Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time > 200;
 --- QUERY PLAN ---
  Unique (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Merge Append (actual rows=3995.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=245.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               Rows Removed by Filter: 1005
+               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1250.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1250.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1250.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev >= 5 AND dev < 7 AND dev >= 2;
 --- QUERY PLAN ---
  Unique (actual rows=2.00 loops=1)
-   ->  Merge Append (actual rows=8.00 loops=1)
+   ->  Merge Append (actual rows=2000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time,val FROM :TABLE WHERE time > 100 AND time < 200 AND val > 10 AND val < 10000 AND dev > 2 AND dev < 7 ORDER BY dev,time;
 --- QUERY PLAN ---
  Unique (actual rows=0.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
 
 -- test constants in ORDER BY
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = 1 ORDER BY dev, time DESC;
@@ -5807,20 +5610,18 @@
 SELECT * FROM devices;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX WITH devices AS (
 	SELECT DISTINCT dev FROM :TABLE
@@ -5828,76 +5629,68 @@
 SELECT * FROM devices ORDER BY dev;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 -- prepared statements
 PREPARE prep AS SELECT DISTINCT ON (dev) dev FROM :TABLE;
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 DEALLOCATE prep;
 -- ReScan tests
@@ -5921,8 +5714,7 @@
                            ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                            ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
-               ->  Materialize (actual rows=2.00 loops=10020)
-                     ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=10020)
 
 -- have SkipScan as Distinct is over index
 :PREFIX SELECT time, dev, val, 'q7_2' FROM (SELECT * FROM (
@@ -5931,30 +5723,29 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=18.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-   ->  Result (actual rows=9.00 loops=2)
-         ->  Unique (actual rows=9.00 loops=2)
-               ->  Merge Append (actual rows=36.00 loops=2)
-                     Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=9.00 loops=2)
+   ->  Unique (actual rows=9.00 loops=2)
+         ->  Sort (actual rows=9000.00 loops=2)
+               Sort Key: skip_scan_htc.dev
+               Sort Method: quicksort 
+               ->  Result (actual rows=9000.00 loops=2)
+                     ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=9000.00 loops=2)
+                           Hypertables excluded during runtime: 0
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2250.00 loops=2)
+                                 ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=9.00 loops=2)
                                        Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=9.00 loops=2)
+                                       Rows Removed by Filter: 2
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2250.00 loops=2)
+                                 ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=9.00 loops=2)
                                        Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=9.00 loops=2)
+                                       Rows Removed by Filter: 2
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2250.00 loops=2)
+                                 ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=9.00 loops=2)
                                        Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=9.00 loops=2)
+                                       Rows Removed by Filter: 2
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2250.00 loops=2)
+                                 ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=9.00 loops=2)
                                        Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
+                                       Rows Removed by Filter: 2
 
 -- RuntimeKeys
 :PREFIX SELECT time, dev, val, 'q8_1' FROM (SELECT * FROM (
@@ -5963,26 +5754,22 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=19.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-   ->  Result (actual rows=10.00 loops=2)
-         ->  Unique (actual rows=10.00 loops=2)
-               ->  Merge Append (actual rows=38.00 loops=2)
+   ->  Unique (actual rows=10.00 loops=2)
+         ->  Result (actual rows=9500.00 loops=2)
+               ->  Merge Append (actual rows=9500.00 loops=2)
                      Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
 
 -- Emulate multi-column DISTINCT using multiple SkipSkans
 -- "segmentby = 'dev, val'"
@@ -6010,40 +5797,34 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=20.00 loops=1)
    ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
-   ->  Result (actual rows=2.00 loops=11)
-         ->  Unique (actual rows=2.00 loops=11)
-               ->  Merge Append (actual rows=7.00 loops=11)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
+   ->  Unique (actual rows=2.00 loops=11)
+         ->  Result (actual rows=909.00 loops=11)
+               ->  Merge Append (actual rows=909.00 loops=11)
                      Sort Key: skip_scan_htc_1.val
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                                 ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=11)
-                                       Index Cond: (dev = skip_scan_htc.dev)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                                 ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=11)
-                                       Index Cond: (dev = skip_scan_htc.dev)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                                 ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=11)
-                                       Index Cond: (dev = skip_scan_htc.dev)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                                 ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=11)
-                                       Index Cond: (dev = skip_scan_htc.dev)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=227.00 loops=11)
+                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=11)
+                                 Index Cond: (dev = skip_scan_htc.dev)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=227.00 loops=11)
+                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=11)
+                                 Index Cond: (dev = skip_scan_htc.dev)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=227.00 loops=11)
+                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=11)
+                                 Index Cond: (dev = skip_scan_htc.dev)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=227.00 loops=11)
+                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=11)
+                                 Index Cond: (dev = skip_scan_htc.dev)
 
 :PREFIX SELECT val, dev, NULL, 'q9_2' FROM (SELECT b.* FROM
     (SELECT DISTINCT ON (dev) dev FROM :TABLE) a,
@@ -6051,39 +5832,33 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=20.00 loops=1)
    ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
    ->  Unique (actual rows=2.00 loops=11)
-         ->  Merge Append (actual rows=7.00 loops=11)
+         ->  Merge Append (actual rows=909.00 loops=11)
                Sort Key: skip_scan_htc_1.val
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
 
 -- Test that the multi-column DISTINCT emulation is equivalent to a real multi-column DISTINCT
 :PREFIX SELECT * FROM
@@ -6092,58 +5867,58 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=20.00 loops=1)
    ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
    ->  Unique (actual rows=2.00 loops=11)
-         ->  Merge Append (actual rows=7.00 loops=11)
+         ->  Merge Append (actual rows=909.00 loops=11)
                Sort Key: skip_scan_htc_1.val
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=11)
-                                 Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=227.00 loops=11)
+                     ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=11)
+                           Index Cond: (dev = skip_scan_htc.dev)
 
 -- no SkipScan: 2 distinct columns
 :PREFIX SELECT DISTINCT ON (dev, val) dev, val FROM :TABLE WHERE dev IS NOT NULL;
 --- QUERY PLAN ---
  Unique (actual rows=20.00 loops=1)
-   ->  Merge Append (actual rows=10000.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev, skip_scan_htc.val
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
-               ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=20.00 loops=1)
-                     Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
-               ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=20.00 loops=1)
-                     Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
-               ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=20.00 loops=1)
-                     Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
-               ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=20.00 loops=1)
-                     Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=20.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=20.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=20.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=20.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT DISTINCT ON (dev, val) dev, val FROM :TABLE WHERE dev IS NOT NULL
 UNION SELECT b.* FROM
@@ -6151,83 +5926,80 @@
    LATERAL (SELECT DISTINCT ON (val) dev, val FROM :TABLE WHERE dev = a.dev) b;
 --- QUERY PLAN ---
  Unique (actual rows=20.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=40.00 loops=1)
          Sort Key: skip_scan_htc.dev, skip_scan_htc.val
-         ->  Unique (actual rows=20.00 loops=1)
-               ->  Merge Append (actual rows=10000.00 loops=1)
-                     Sort Key: skip_scan_htc.dev, skip_scan_htc.val
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=20.00 loops=1)
-                                 Index Cond: (dev IS NOT NULL)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=20.00 loops=1)
-                                 Index Cond: (dev IS NOT NULL)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=20.00 loops=1)
-                                 Index Cond: (dev IS NOT NULL)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=20.00 loops=1)
-                                 Index Cond: (dev IS NOT NULL)
-         ->  Sort (actual rows=20.00 loops=1)
-               Sort Key: skip_scan_htc_2.dev, skip_scan_htc_2.val
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=40.00 loops=1)
+               ->  Unique (actual rows=20.00 loops=1)
+                     ->  Sort (actual rows=10000.00 loops=1)
+                           Sort Key: skip_scan_htc.dev, skip_scan_htc.val
+                           Sort Method: quicksort 
+                           ->  Append (actual rows=10000.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=20.00 loops=1)
+                                             Filter: (dev IS NOT NULL)
+                                             Rows Removed by Filter: 1
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=20.00 loops=1)
+                                             Filter: (dev IS NOT NULL)
+                                             Rows Removed by Filter: 1
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=20.00 loops=1)
+                                             Filter: (dev IS NOT NULL)
+                                             Rows Removed by Filter: 1
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=20.00 loops=1)
+                                             Filter: (dev IS NOT NULL)
+                                             Rows Removed by Filter: 1
                ->  Nested Loop (actual rows=20.00 loops=1)
                      ->  Unique (actual rows=11.00 loops=1)
-                           ->  Merge Append (actual rows=44.00 loops=1)
+                           ->  Sort (actual rows=10020.00 loops=1)
                                  Sort Key: skip_scan_htc_1.dev
-                                 ->  Custom Scan (SkipScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=11.00 loops=1)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=11.00 loops=1)
-                                             ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=11.00 loops=1)
-                                 ->  Custom Scan (SkipScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=11.00 loops=1)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=11.00 loops=1)
-                                             ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=11.00 loops=1)
-                                 ->  Custom Scan (SkipScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=11.00 loops=1)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=11.00 loops=1)
-                                             ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=11.00 loops=1)
-                                 ->  Custom Scan (SkipScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=11.00 loops=1)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=11.00 loops=1)
-                                             ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=11.00 loops=1)
+                                 Sort Method: quicksort 
+                                 ->  Append (actual rows=10020.00 loops=1)
+                                       ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2505.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=21.00 loops=1)
+                                       ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2505.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=21.00 loops=1)
+                                       ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2505.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=21.00 loops=1)
+                                       ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2505.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=21.00 loops=1)
                      ->  Unique (actual rows=2.00 loops=11)
-                           ->  Merge Append (actual rows=7.00 loops=11)
+                           ->  Merge Append (actual rows=909.00 loops=11)
                                  Sort Key: skip_scan_htc_2.val
-                                 ->  Custom Scan (SkipScan) on _hyper_3_5_chunk _hyper_3_5_chunk_2 (actual rows=2.00 loops=11)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_2 (actual rows=2.00 loops=11)
-                                             ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_2 (actual rows=2.00 loops=11)
-                                                   Index Cond: (dev = skip_scan_htc_1.dev)
-                                 ->  Custom Scan (SkipScan) on _hyper_3_6_chunk _hyper_3_6_chunk_2 (actual rows=2.00 loops=11)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_2 (actual rows=2.00 loops=11)
-                                             ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_2 (actual rows=2.00 loops=11)
-                                                   Index Cond: (dev = skip_scan_htc_1.dev)
-                                 ->  Custom Scan (SkipScan) on _hyper_3_7_chunk _hyper_3_7_chunk_2 (actual rows=2.00 loops=11)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_2 (actual rows=2.00 loops=11)
-                                             ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_2 (actual rows=2.00 loops=11)
-                                                   Index Cond: (dev = skip_scan_htc_1.dev)
-                                 ->  Custom Scan (SkipScan) on _hyper_3_8_chunk _hyper_3_8_chunk_2 (actual rows=2.00 loops=11)
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_2 (actual rows=2.00 loops=11)
-                                             ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_2 (actual rows=2.00 loops=11)
-                                                   Index Cond: (dev = skip_scan_htc_1.dev)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_2 (actual rows=227.00 loops=11)
+                                       ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_2 (actual rows=2.00 loops=11)
+                                             Index Cond: (dev = skip_scan_htc_1.dev)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_2 (actual rows=227.00 loops=11)
+                                       ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_2 (actual rows=2.00 loops=11)
+                                             Index Cond: (dev = skip_scan_htc_1.dev)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_2 (actual rows=227.00 loops=11)
+                                       ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_2 (actual rows=2.00 loops=11)
+                                             Index Cond: (dev = skip_scan_htc_1.dev)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_2 (actual rows=227.00 loops=11)
+                                       ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_2 (actual rows=2.00 loops=11)
+                                             Index Cond: (dev = skip_scan_htc_1.dev)
 
 -- SkipScan into INSERT
 :PREFIX INSERT INTO skip_scan_insert(time, dev, val, query) SELECT time, dev, val, 'q10_1' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE) a;
 --- QUERY PLAN ---
  Insert on skip_scan_insert (actual rows=0.00 loops=1)
    ->  Subquery Scan on a (actual rows=11.00 loops=1)
-         ->  Result (actual rows=11.00 loops=1)
-               ->  Unique (actual rows=11.00 loops=1)
-                     ->  Merge Append (actual rows=44.00 loops=1)
-                           Sort Key: skip_scan_htc.dev
-                           ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                       ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                       ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                       ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                       ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+         ->  Unique (actual rows=11.00 loops=1)
+               ->  Sort (actual rows=10020.00 loops=1)
+                     Sort Key: skip_scan_htc.dev
+                     Sort Method: quicksort 
+                     ->  Result (actual rows=10020.00 loops=1)
+                           ->  Append (actual rows=10020.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
 
 -- parallel query
 RESET max_parallel_workers_per_gather;
@@ -6238,21 +6010,23 @@
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
-         Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+ Gather (actual rows=11.00 loops=1)
+   Workers Planned: 1
+   Workers Launched: 1
+   Single Copy: true
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htc.dev
+               Worker 0:  Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
 
 SELECT set_config(CASE WHEN current_setting('server_version_num')::int < 160000 THEN 'force_parallel_mode' ELSE 'debug_parallel_query' END,'off', false);
  set_config 
@@ -6264,44 +6038,38 @@
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE where val IS NULL;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (val IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (val IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (val IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (val IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (val IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (val IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (val IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (val IS NULL)
 
 -- no tuples in resultset
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE val IS NULL AND dev > 100;
 --- QUERY PLAN ---
  Unique (actual rows=0.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
@@ -6334,417 +6102,373 @@
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE ORDER BY dev DESC NULLS FIRST;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- multicolumn sort with dev as leading column matching (segmentby dev, order by time DESC) compression index
 :PREFIX SELECT DISTINCT ON (dev) dev, time FROM :TABLE ORDER BY dev, time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev, skip_scan_htcl."time" DESC
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, time FROM :TABLE ORDER BY dev DESC, time;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev DESC, skip_scan_htcl."time"
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho stable expression in targetlist on :TABLE
 stable expression in targetlist on skip_scan_htcl
 :PREFIX SELECT DISTINCT dev, 'q1_4', length(md5(now()::text)) FROM :TABLE ORDER BY dev;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- DISTINCT ON queries
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_2' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_3', NULL FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_4', length(md5(now()::text)) FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, 'q2_5', length(md5(random()::text)) FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) *, 'q2_7' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, time, 'q2_8' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, NULL, 'q2_9' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) time, 'q2_10' FROM :TABLE ORDER by dev, time DESC;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev, skip_scan_htcl."time" DESC
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev, skip_scan_htcl."time" DESC
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, tableoid::regclass, 'q2_11' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, int_func_immutable(), 'q2_12' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, int_func_stable(), 'q2_13' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev, int_func_volatile(), 'q2_14' FROM :TABLE;
 --- QUERY PLAN ---
- Result (actual rows=11.00 loops=1)
-   ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+ Unique (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho DISTINCT with wholerow var
 DISTINCT with wholerow var
 :PREFIX SELECT DISTINCT ON (dev) :TABLE FROM :TABLE;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho LIMIT queries on :TABLE
 LIMIT queries on skip_scan_htcl
@@ -6752,58 +6476,52 @@
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  Unique (actual rows=3.00 loops=1)
-         ->  Merge Append (actual rows=9.00 loops=1)
+         ->  Sort (actual rows=2001.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE ORDER BY dev DESC, time LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  Unique (actual rows=3.00 loops=1)
-         ->  Merge Append (actual rows=9.00 loops=1)
+         ->  Sort (actual rows=1021.00 loops=1)
                Sort Key: skip_scan_htcl.dev DESC, skip_scan_htcl."time"
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE ORDER BY dev, time DESC LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  Unique (actual rows=3.00 loops=1)
-         ->  Merge Append (actual rows=9.00 loops=1)
+         ->  Sort (actual rows=2001.00 loops=1)
                Sort Key: skip_scan_htcl.dev, skip_scan_htcl."time" DESC
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho range queries on :TABLE
 range queries on skip_scan_htcl
@@ -6811,38 +6529,36 @@
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time BETWEEN 100 AND 300;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time < 200;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               Vectorized Filter: ("time" < 200)
-               Rows Removed by Filter: 501
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_min_1 < 200)
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2004.00 loops=1)
+         Vectorized Filter: ("time" < 200)
+         Rows Removed by Filter: 501
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               Index Cond: (_ts_meta_min_1 < 200)
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time > 800;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               Vectorized Filter: ("time" > 800)
-               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_max_1 > 800)
+   ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1993.00 loops=1)
+         Vectorized Filter: ("time" > 800)
+         Rows Removed by Filter: 512
+         ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Index Cond: (_ts_meta_max_1 > 800)
 
 reset enable_seqscan;
 -- Various tests for "segmentby = 'dev'"
@@ -6852,153 +6568,141 @@
 :PREFIX SELECT time, dev, val, 'q4_1' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htcl.dev
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT NULL, dev, NULL, 'q4_3' FROM (SELECT DISTINCT ON (dev) dev FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT time, dev, NULL, 'q4_4' FROM (SELECT DISTINCT ON (dev) dev, time FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  Unique (actual rows=11.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho ORDER BY
 ORDER BY
 :PREFIX SELECT time, dev, val, 'q5_1' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE ORDER BY dev, time DESC) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htcl.dev, skip_scan_htcl."time" DESC
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htcl.dev, skip_scan_htcl."time" DESC
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT time, dev, val, 'q5_2' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE ORDER BY dev DESC, time) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htcl.dev DESC, skip_scan_htcl."time"
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htcl.dev DESC, skip_scan_htcl."time"
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho WHERE CLAUSES
 WHERE CLAUSES
 :PREFIX SELECT time, dev, val, 'q6_2' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE WHERE time > 5) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=9959.00 loops=1)
+               Sort Key: skip_scan_htcl.dev
+               Sort Method: quicksort 
+               ->  Result (actual rows=9959.00 loops=1)
+                     ->  Append (actual rows=9959.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2444.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
+                                 Rows Removed by Filter: 61
+                                 ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
                                  Vectorized Filter: ("time" > 5)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
-                                       Index Cond: (_ts_meta_max_1 > 5)
+                                 ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+                                       Filter: (_ts_meta_max_1 > 5)
 
 :PREFIX SELECT time, dev, val, 'q6_4' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE) a WHERE time > 5;
 --- QUERY PLAN ---
- Subquery Scan on a (actual rows=11.00 loops=1)
+ Subquery Scan on a (actual rows=10.00 loops=1)
    Filter: (a."time" > 5)
-   ->  Result (actual rows=11.00 loops=1)
-         ->  Unique (actual rows=11.00 loops=1)
-               ->  Merge Append (actual rows=44.00 loops=1)
-                     Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+   Rows Removed by Filter: 1
+   ->  Unique (actual rows=11.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htcl.dev
+               Sort Method: quicksort 
+               ->  Result (actual rows=10020.00 loops=1)
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- Force not choosing SeqScan under DecompressChunks before SkipScan can evaluate it,
 -- as cost of scanning and sorting a small dataset can be less than scanning an index, including startup cost.
@@ -7009,234 +6713,198 @@
 :PREFIX SELECT time, dev, val, 'q6_1' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev > 5) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=5.00 loops=1)
-   ->  Result (actual rows=5.00 loops=1)
-         ->  Unique (actual rows=5.00 loops=1)
-               ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Unique (actual rows=5.00 loops=1)
+         ->  Result (actual rows=5000.00 loops=1)
+               ->  Merge Append (actual rows=5000.00 loops=1)
                      Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
 
 :PREFIX SELECT time, dev, val, 'q6_3' FROM (SELECT DISTINCT ON (dev) * FROM :TABLE) a WHERE dev > 5;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=5.00 loops=1)
-   ->  Result (actual rows=5.00 loops=1)
-         ->  Unique (actual rows=5.00 loops=1)
-               ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Unique (actual rows=5.00 loops=1)
+         ->  Result (actual rows=5000.00 loops=1)
+               ->  Merge Append (actual rows=5000.00 loops=1)
                      Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
-                                       Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1250.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
+                                 Index Cond: (dev > 5)
 
 --\qecho immutable func in WHERE clause on :TABLE
 :PREFIX SELECT DISTINCT ON (dev) *, 'q6_5' FROM :TABLE WHERE dev > int_func_immutable();
 --- QUERY PLAN ---
- Result (actual rows=9.00 loops=1)
-   ->  Unique (actual rows=9.00 loops=1)
-         ->  Merge Append (actual rows=36.00 loops=1)
+ Unique (actual rows=9.00 loops=1)
+   ->  Result (actual rows=9000.00 loops=1)
+         ->  Merge Append (actual rows=9000.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=9.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=9.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=9.00 loops=1)
-                                 Index Cond: (dev > 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=9.00 loops=1)
+                           Index Cond: (dev > 1)
 
 --\qecho stable func in WHERE clause on :TABLE
 :PREFIX SELECT DISTINCT ON (dev) *, 'q6_6' FROM :TABLE WHERE dev > int_func_stable();
 --- QUERY PLAN ---
- Result (actual rows=8.00 loops=1)
-   ->  Unique (actual rows=8.00 loops=1)
-         ->  Custom Scan (ConstraintAwareAppend) (actual rows=32.00 loops=1)
+ Unique (actual rows=8.00 loops=1)
+   ->  Result (actual rows=8000.00 loops=1)
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=8000.00 loops=1)
                Hypertable: skip_scan_htcl
                Chunks excluded during startup: 0
-               ->  Merge Append (actual rows=32.00 loops=1)
+               ->  Merge Append (actual rows=8000.00 loops=1)
                      Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=8.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=8.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=8.00 loops=1)
-                                       Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2000.00 loops=1)
+                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=8.00 loops=1)
+                                 Index Cond: (dev > int_func_stable())
 
 --\qecho volatile func in WHERE clause on :TABLE
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev > int_func_volatile();
 --- QUERY PLAN ---
  Unique (actual rows=7.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=28.00 loops=1)
+   ->  Custom Scan (ConstraintAwareAppend) (actual rows=7000.00 loops=1)
          Hypertable: skip_scan_htcl
          Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=28.00 loops=1)
+         ->  Merge Append (actual rows=7000.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = ANY(inta_func_immutable());
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=12.00 loops=1)
+   ->  Merge Append (actual rows=3000.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = ANY(inta_func_stable());
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
+   ->  Custom Scan (ConstraintAwareAppend) (actual rows=3000.00 loops=1)
          Hypertable: skip_scan_htcl
          Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
+         ->  Merge Append (actual rows=3000.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = ANY(inta_func_volatile());
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
+   ->  Custom Scan (ConstraintAwareAppend) (actual rows=3000.00 loops=1)
          Hypertable: skip_scan_htcl
          Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
+         ->  Merge Append (actual rows=3000.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- RowCompareExpr
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE (dev, time) > (5,100);
 --- QUERY PLAN ---
  Unique (actual rows=6.00 loops=1)
-   ->  Merge Append (actual rows=24.00 loops=1)
+   ->  Merge Append (actual rows=5899.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=6.00 loops=1)
-                     Filter: (ROW(dev, "time") > ROW(5, 100))
-                     Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=6.00 loops=1)
-                     Filter: (ROW(dev, "time") > ROW(5, 100))
-                     Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=6.00 loops=1)
-                     Filter: (ROW(dev, "time") > ROW(5, 100))
-                     Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=6.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=6.00 loops=1)
-                     Filter: (ROW(dev, "time") > ROW(5, 100))
-                     Rows Removed by Filter: 1005
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1399.00 loops=1)
+               Filter: (ROW(dev, "time") > ROW(5, 100))
+               Rows Removed by Filter: 1106
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1500.00 loops=1)
+               Filter: (ROW(dev, "time") > ROW(5, 100))
+               Rows Removed by Filter: 1005
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1500.00 loops=1)
+               Filter: (ROW(dev, "time") > ROW(5, 100))
+               Rows Removed by Filter: 1005
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1500.00 loops=1)
+               Filter: (ROW(dev, "time") > ROW(5, 100))
+               Rows Removed by Filter: 1005
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev > NULL;
 --- QUERY PLAN ---
@@ -7251,21 +6919,19 @@
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev > 20;
 --- QUERY PLAN ---
  Unique (actual rows=0.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
@@ -7274,90 +6940,79 @@
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time = 100;
 --- QUERY PLAN ---
  Unique (actual rows=5.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 745
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                     Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 1245
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+               Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time > 200;
 --- QUERY PLAN ---
  Unique (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Merge Append (actual rows=3995.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                     Vectorized Filter: ("time" > 200)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=245.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               Rows Removed by Filter: 1005
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1250.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1250.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1250.00 loops=1)
+               Vectorized Filter: ("time" > 200)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev >= 5 AND dev < 7 AND dev >= 2;
 --- QUERY PLAN ---
  Unique (actual rows=2.00 loops=1)
-   ->  Merge Append (actual rows=8.00 loops=1)
+   ->  Merge Append (actual rows=2000.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=2.00 loops=1)
-                           Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=500.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=2.00 loops=1)
+                     Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time,val FROM :TABLE WHERE time > 100 AND time < 200 AND val > 10 AND val < 10000 AND dev > 2 AND dev < 7 ORDER BY dev,time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=0.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=20.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
 
@@ -7365,20 +7020,22 @@
 :PREFIX SELECT DISTINCT ON (dev) * FROM :TABLE WHERE dev = 1 ORDER BY dev, time DESC;
 --- QUERY PLAN ---
  Limit (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=1.00 loops=1)
          Sort Key: skip_scan_htcl."time" DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev = 1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev = 1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev = 1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1.00 loops=1)
-               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev = 1)
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=1000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
 
 -- CTE
 :PREFIX WITH devices AS (
@@ -7387,20 +7044,16 @@
 SELECT * FROM devices;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Merge Append (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX WITH devices AS (
 	SELECT DISTINCT dev FROM :TABLE
@@ -7408,76 +7061,60 @@
 SELECT * FROM devices ORDER BY dev;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Merge Append (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- prepared statements
 PREPARE prep AS SELECT DISTINCT ON (dev) dev FROM :TABLE;
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Merge Append (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Merge Append (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Merge Append (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 DEALLOCATE prep;
 -- ReScan tests
@@ -7488,30 +7125,26 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=18.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-   ->  Result (actual rows=9.00 loops=2)
-         ->  Unique (actual rows=9.00 loops=2)
-               ->  Merge Append (actual rows=36.00 loops=2)
+   ->  Unique (actual rows=9.00 loops=2)
+         ->  Result (actual rows=9000.00 loops=2)
+               ->  Merge Append (actual rows=9000.00 loops=2)
                      Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=9.00 loops=2)
-                                       Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=9.00 loops=2)
-                                       Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=9.00 loops=2)
-                                       Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=9.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=9.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=9.00 loops=2)
-                                       Filter: (dev <> "*VALUES*".column1)
-                                       Rows Removed by Filter: 1
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2250.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=9.00 loops=2)
+                                 Filter: (dev <> "*VALUES*".column1)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2250.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=9.00 loops=2)
+                                 Filter: (dev <> "*VALUES*".column1)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2250.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=9.00 loops=2)
+                                 Filter: (dev <> "*VALUES*".column1)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2250.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=9.00 loops=2)
+                                 Filter: (dev <> "*VALUES*".column1)
+                                 Rows Removed by Filter: 2
 
 -- RuntimeKeys
 :PREFIX SELECT time, dev, val, 'q8_1' FROM (SELECT * FROM (
@@ -7520,26 +7153,22 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=19.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-   ->  Result (actual rows=10.00 loops=2)
-         ->  Unique (actual rows=10.00 loops=2)
-               ->  Merge Append (actual rows=38.00 loops=2)
+   ->  Unique (actual rows=10.00 loops=2)
+         ->  Result (actual rows=9500.00 loops=2)
+               ->  Merge Append (actual rows=9500.00 loops=2)
                      Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=10.00 loops=2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=10.00 loops=2)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=10.00 loops=2)
-                                       Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2375.00 loops=2)
+                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=10.00 loops=2)
+                                 Index Cond: (dev >= "*VALUES*".column1)
 
 RESET max_parallel_workers_per_gather;
 RESET enable_seqscan;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_dagg-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_dagg-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_dagg-17.out	2025-11-06 02:35:39.305068373 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_dagg-17.out	2025-11-06 02:47:52.779720173 +0000
@@ -2882,12 +2882,12 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE time = 100;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=11.00 loops=1)
-         Vectorized Filter: ("time" = 100)
-         Rows Removed by Filter: 2494
-         ->  Sort (actual rows=11.00 loops=1)
-               Sort Key: compress_hyper_2_17_chunk.dev
-               Sort Method: quicksort 
+   ->  Sort (actual rows=11.00 loops=1)
+         Sort Key: _hyper_1_1_chunk.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=11.00 loops=1)
+               Vectorized Filter: ("time" = 100)
+               Rows Removed by Filter: 2494
                ->  Seq Scan on compress_hyper_2_17_chunk (actual rows=11.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
@@ -2994,132 +2994,120 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev DESC;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev DESC NULLS FIRST;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 -- Test not-NULL mode
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE dev IS NOT NULL GROUP BY dev ORDER BY dev DESC NULLS FIRST;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=10.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE dev IS NOT NULL GROUP BY dev ORDER BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=10.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_21_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 -- NULLS FIRST doesn't match segmentby NULL direction
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev NULLS FIRST;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev NULLS FIRST
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_18_chunk.dev NULLS FIRST
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_19_chunk.dev NULLS FIRST
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_20_chunk.dev NULLS FIRST
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_4_21_chunk.dev NULLS FIRST
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_21_chunk (actual rows=11.00 loops=1)
 
 -- multicolumn "segmentby = 'dev, dev_name'"
@@ -3144,104 +3132,102 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev DESC;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=11.00 loops=1)
 
 -- Test not-NULL mode
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE dev IS NOT NULL GROUP BY dev ORDER BY dev DESC;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=10.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_22_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_23_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_24_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_25_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 -- multicolumn compressed index with dev as leading column and with extra distinct column pinned
 -- TODO: should be able to apply SkipScan here, issue created: #7998
 :PREFIX SELECT count(DISTINCT dev), count(DISTINCT dev_name) FROM :TABLE WHERE dev_name = 'device_1';
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=1000.00 loops=1)
+   ->  Sort (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
-               ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev_name = 'device_1'::text)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
-               ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev_name = 'device_1'::text)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
-               ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev_name = 'device_1'::text)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
-               ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
-                     Index Cond: (dev_name = 'device_1'::text)
+         Sort Method: quicksort 
+         ->  Append (actual rows=1000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev_name = 'device_1'::text)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev_name = 'device_1'::text)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev_name = 'device_1'::text)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev_name = 'device_1'::text)
 
 -- multicolumn compressed index with dev as non-leading column
 :PREFIX SELECT count(DISTINCT dev_name) FROM :TABLE WHERE dev = 1;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=1000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev = 1)
 
@@ -3249,30 +3235,6 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=1.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=4.00 loops=1)
-         Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev = 1)
-
--- multicolumn compressed index with dev as non-leading column and with leading column pinned
--- TODO: should be able to apply SkipScan here, issue created: #7998
-:PREFIX SELECT count(DISTINCT dev), count(DISTINCT dev_name) FROM :TABLE WHERE dev = 1;
---- QUERY PLAN ---
- Aggregate (actual rows=1.00 loops=1)
    ->  Merge Append (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
          ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
@@ -3288,6 +3250,28 @@
                ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
                      Index Cond: (dev = 1)
 
+-- multicolumn compressed index with dev as non-leading column and with leading column pinned
+-- TODO: should be able to apply SkipScan here, issue created: #7998
+:PREFIX SELECT count(DISTINCT dev), count(DISTINCT dev_name) FROM :TABLE WHERE dev = 1;
+--- QUERY PLAN ---
+ Aggregate (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=1000.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name
+         Sort Method: quicksort 
+         ->  Append (actual rows=1000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_22_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_22_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_23_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_23_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_24_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_24_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_25_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_25_chunk (actual rows=1.00 loops=1)
+                           Index Cond: (dev = 1)
+
 -- Basic tests for "segmentby = 'dev'"
 -----------------------------------------
 SELECT decompress_chunk(ch) FROM show_chunks('skip_scan_htc') ch;
@@ -3313,332 +3297,300 @@
 :PREFIX SELECT count(DISTINCT dev), sum(DISTINCT dev), 'q1_1' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- Distinct agg over Const is OK
 :PREFIX SELECT count(DISTINCT dev), count(DISTINCT 2), 'q1_3', NULL FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- DISTINCT over distinct agg is OK
 :PREFIX SELECT DISTINCT count(DISTINCT dev), dev, 'q1_4' FROM :TABLE GROUP BY dev ORDER BY dev;
 --- QUERY PLAN ---
- Sort (actual rows=11.00 loops=1)
-   Sort Key: skip_scan_htc.dev
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=11.00 loops=1)
-         Group Key: skip_scan_htc.dev, count(DISTINCT skip_scan_htc.dev)
+ Unique (actual rows=11.00 loops=1)
+   ->  Incremental Sort (actual rows=11.00 loops=1)
+         Sort Key: skip_scan_htc.dev, (count(DISTINCT skip_scan_htc.dev))
+         Presorted Key: skip_scan_htc.dev
+         Full-sort Groups: 1  Sort Method: quicksort 
          ->  GroupAggregate (actual rows=11.00 loops=1)
                Group Key: skip_scan_htc.dev
-               ->  Merge Append (actual rows=44.00 loops=1)
+               ->  Sort (actual rows=10020.00 loops=1)
                      Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+                     Sort Method: quicksort 
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 \qecho stable expression in targetlist on :TABLE
 stable expression in targetlist on skip_scan_htc
 :PREFIX SELECT count(DISTINCT dev), 'q1_5', length(md5(now()::text)) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- volatile expression in targetlist
 :PREFIX SELECT count(DISTINCT dev), 'q1_7', length(md5(random()::text)) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- Mix of aggregates on different columns and distinct/not distinct
 -- currently not supported by skipscan
 :PREFIX SELECT count(DISTINCT dev), max(DISTINCT dev_name), 'q1_9' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), sum(dev), 'q1_10' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
-               ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
-
-:PREFIX SELECT count(DISTINCT dev), dev_name, 'q1_11' FROM :TABLE GROUP BY dev_name ORDER BY dev_name;
---- QUERY PLAN ---
- GroupAggregate (actual rows=11.00 loops=1)
-   Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=10020.00 loops=1)
-         Sort Key: skip_scan_htc.dev_name, skip_scan_htc.dev
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_5_chunk.dev_name, _hyper_3_5_chunk.dev
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_6_chunk.dev_name, _hyper_3_6_chunk.dev
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.dev_name, _hyper_3_7_chunk.dev
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_8_chunk.dev_name, _hyper_3_8_chunk.dev
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
+:PREFIX SELECT count(DISTINCT dev), dev_name, 'q1_11' FROM :TABLE GROUP BY dev_name ORDER BY dev_name;
+--- QUERY PLAN ---
+ GroupAggregate (actual rows=11.00 loops=1)
+   Group Key: skip_scan_htc.dev_name
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev_name, skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+
 -- distinct on expressions not supported
 :PREFIX SELECT count(DISTINCT dev + 1), 'q1_13' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: ((skip_scan_htc.dev + 1))
-         ->  Result (actual rows=2505.00 loops=1)
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+
+-- But expressions over distinct aggregates are supported
+:PREFIX SELECT count(DISTINCT dev) + 1, sum(DISTINCT dev)/count(DISTINCT dev), 'q1_15' FROM :TABLE;
+--- QUERY PLAN ---
+ Aggregate (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Result (actual rows=2505.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Result (actual rows=2505.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Result (actual rows=2505.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
--- But expressions over distinct aggregates are supported
-:PREFIX SELECT count(DISTINCT dev) + 1, sum(DISTINCT dev)/count(DISTINCT dev), 'q1_15' FROM :TABLE;
---- QUERY PLAN ---
- Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
-         Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
-
 -- DISTINCT aggs grouped on their args
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_1' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_2', NULL FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_3', length(md5(now()::text)) FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_4', length(md5(random()::text)) FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, int_func_immutable(), 'q2_5' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, int_func_stable(), 'q2_6' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, int_func_volatile(), 'q2_7' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev+1, 'q2_8' FROM :TABLE GROUP BY dev ORDER BY 2;
 --- QUERY PLAN ---
@@ -3647,65 +3599,51 @@
    Sort Method: quicksort 
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev+1, dev+2, 'q2_9' FROM :TABLE GROUP BY dev, dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 -- Cannot do SkipScan as we group on a column which is not the distinct agg argument
 :PREFIX SELECT time, count(DISTINCT dev), 'q2_10' FROM :TABLE GROUP BY time;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=1000.00 loops=1)
    Group Key: skip_scan_htc."time"
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc."time", skip_scan_htc.dev
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_5_chunk."time", _hyper_3_5_chunk.dev
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_6_chunk."time", _hyper_3_6_chunk.dev
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.dev
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_8_chunk."time", _hyper_3_8_chunk.dev
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
@@ -3714,26 +3652,16 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=44.00 loops=1)
    Group Key: skip_scan_htc.dev, skip_scan_htc.tableoid
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev, skip_scan_htc.tableoid
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_5_chunk.dev, _hyper_3_5_chunk.tableoid
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_6_chunk.dev, _hyper_3_6_chunk.tableoid
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.dev, _hyper_3_7_chunk.tableoid
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_8_chunk.dev, _hyper_3_8_chunk.tableoid
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
@@ -3744,40 +3672,36 @@
  Limit (actual rows=3.00 loops=1)
    ->  GroupAggregate (actual rows=3.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=13.00 loops=1)
+         ->  Sort (actual rows=3001.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=4.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev DESC LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  GroupAggregate (actual rows=3.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=13.00 loops=1)
+         ->  Sort (actual rows=2021.00 loops=1)
                Sort Key: skip_scan_htc.dev DESC
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_28_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_28_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=4.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_28_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
 
 \qecho range queries on :TABLE
 range queries on skip_scan_htc
@@ -3785,40 +3709,44 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_4_27_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_27_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE time < 200 GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: _hyper_3_5_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=2004.00 loops=1)
+         Sort Key: _hyper_3_5_chunk.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2004.00 loops=1)
                Vectorized Filter: ("time" < 200)
                Rows Removed by Filter: 501
-               ->  Index Scan using compress_hyper_4_26_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_min_1 < 200)
+               ->  Seq Scan on compress_hyper_4_26_chunk (actual rows=11.00 loops=1)
+                     Filter: (_ts_meta_min_1 < 200)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE time > 800 GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: _hyper_3_8_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=1993.00 loops=1)
+         Sort Key: _hyper_3_8_chunk.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1993.00 loops=1)
                Vectorized Filter: ("time" > 800)
-               ->  Index Scan using compress_hyper_4_29_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_max_1 > 800)
+               Rows Removed by Filter: 512
+               ->  Seq Scan on compress_hyper_4_29_chunk (actual rows=11.00 loops=1)
+                     Filter: (_ts_meta_max_1 > 800)
 
 -- Basic tests for text index "segmentby = 'dev_name'"
 ------------------------------------------------------
@@ -3843,79 +3771,71 @@
 :PREFIX SELECT count(DISTINCT dev_name), max(DISTINCT dev_name), 'q1_2' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 \qecho stable expression in targetlist on :TABLE
 stable expression in targetlist on skip_scan_htc
 :PREFIX SELECT count(DISTINCT dev_name), 'q1_6', length(md5(now()::text)) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 -- volatile expression in targetlist
 :PREFIX SELECT count(DISTINCT dev_name), 'q1_8', length(md5(random()::text)) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev_name) FROM :TABLE WHERE dev_name IS NULL;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=20.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev_name IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev_name IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev_name IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev_name IS NULL)
 
@@ -3923,30 +3843,17 @@
 :PREFIX SELECT count(DISTINCT length(dev_name)), 'q1_13' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: (length(skip_scan_htc.dev_name))
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: (length(_hyper_3_5_chunk.dev_name))
-               Sort Method: quicksort 
-               ->  Result (actual rows=2505.00 loops=1)
+         Sort Method: quicksort 
+         ->  Result (actual rows=10020.00 loops=1)
+               ->  Append (actual rows=10020.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: (length(_hyper_3_6_chunk.dev_name))
-               Sort Method: quicksort 
-               ->  Result (actual rows=2505.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: (length(_hyper_3_7_chunk.dev_name))
-               Sort Method: quicksort 
-               ->  Result (actual rows=2505.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: (length(_hyper_3_8_chunk.dev_name))
-               Sort Method: quicksort 
-               ->  Result (actual rows=2505.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                            ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
@@ -3955,203 +3862,179 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 -- Test not-NULL mode
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, 'q3_11' FROM :TABLE WHERE dev_name IS NOT NULL GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=10.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev_name IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev_name IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, 'q3_2', NULL FROM :TABLE GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, 'q3_3', length(md5(now()::text)) FROM :TABLE GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, 'q3_4', length(md5(random()::text)) FROM :TABLE GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev_name::varchar), dev_name::varchar, 'q3_5' FROM :TABLE GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, int_func_immutable(), 'q3_6' FROM :TABLE GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, int_func_stable(), 'q3_7' FROM :TABLE GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, int_func_volatile(), 'q3_8' FROM :TABLE GROUP BY dev_name;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 -- Cannot do SkipScan as we group on a column which is not the distinct agg argument
 :PREFIX SELECT count(DISTINCT dev_name), dev_name, tableoid::regclass, 'q3_9' FROM :TABLE GROUP BY dev_name, tableoid ORDER BY dev_name, tableoid;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=44.00 loops=1)
    Group Key: skip_scan_htc.dev_name, skip_scan_htc.tableoid
-   ->  Merge Append (actual rows=10020.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev_name, skip_scan_htc.tableoid
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_5_chunk.dev_name, _hyper_3_5_chunk.tableoid
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_6_chunk.dev_name, _hyper_3_6_chunk.tableoid
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.dev_name, _hyper_3_7_chunk.tableoid
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=2505.00 loops=1)
-               Sort Key: _hyper_3_8_chunk.dev_name, _hyper_3_8_chunk.tableoid
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                      ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
@@ -4161,28 +4044,26 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=1.00 loops=1)
    Group Key: skip_scan_htc.dev_name
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=1000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
                      Vectorized Filter: (dev = 1)
                      Rows Removed by Filter: 2255
-                     ->  Index Scan using compress_hyper_4_30_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
                      Vectorized Filter: (dev = 1)
                      Rows Removed by Filter: 2255
-                     ->  Index Scan using compress_hyper_4_31_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_31_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
                      Vectorized Filter: (dev = 1)
                      Rows Removed by Filter: 2255
-                     ->  Index Scan using compress_hyper_4_32_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_32_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
                      Vectorized Filter: (dev = 1)
                      Rows Removed by Filter: 2255
-                     ->  Index Scan using compress_hyper_4_33_chunk_dev_name__ts_meta_min_1__ts_meta__idx on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_33_chunk (actual rows=11.00 loops=1)
 
 -- Various tests for "segmentby = 'dev'"
 ---------------------------------------
@@ -4209,59 +4090,53 @@
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=1.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT NULL, dev, NULL, 'q4_2' FROM (SELECT count(DISTINCT dev) as dev FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=1.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT NULL, dev, NULL, c1, 2, c3, 'q4_3' FROM (SELECT count(DISTINCT dev) as c1, dev, 1 as c3 FROM :TABLE GROUP BY dev) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 \qecho ORDER BY
 ORDER BY
@@ -4270,40 +4145,36 @@
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT c, dev, 'q5_2' FROM (SELECT count(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev ORDER BY dev DESC) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev DESC
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 \qecho WHERE CLAUSES
 WHERE CLAUSES
@@ -4312,24 +4183,20 @@
  Subquery Scan on a (actual rows=5.00 loops=1)
    ->  GroupAggregate (actual rows=5.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=20.00 loops=1)
+         ->  Merge Append (actual rows=5000.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
 
 :PREFIX SELECT c, dev, 'q6_2' FROM (SELECT sum(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev HAVING sum(DISTINCT dev)>2) a;
 --- QUERY PLAN ---
@@ -4338,44 +4205,38 @@
          Group Key: skip_scan_htc.dev
          Filter: (sum(DISTINCT skip_scan_htc.dev) > 2)
          Rows Removed by Filter: 3
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT c, dev, 'q6_3' FROM (SELECT count(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev) a WHERE dev > 5;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=5.00 loops=1)
    ->  GroupAggregate (actual rows=5.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=20.00 loops=1)
+         ->  Merge Append (actual rows=5000.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
 
 :PREFIX SELECT c, dev, 'q6_4' FROM (SELECT sum(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev) a WHERE c > 2;
 --- QUERY PLAN ---
@@ -4384,41 +4245,37 @@
          Group Key: skip_scan_htc.dev
          Filter: (sum(DISTINCT skip_scan_htc.dev) > 2)
          Rows Removed by Filter: 3
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 --\qecho immutable func in WHERE clause on :TABLE
 :PREFIX SELECT count(DISTINCT dev), 'q6_5' FROM :TABLE WHERE dev > int_func_immutable();
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=36.00 loops=1)
+   ->  Sort (actual rows=9000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=9000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
 
@@ -4426,104 +4283,90 @@
 :PREFIX SELECT count(DISTINCT dev), 'q6_6' FROM :TABLE WHERE dev > int_func_stable();
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=32.00 loops=1)
-         Hypertable: skip_scan_htc
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=32.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
+   ->  Sort (actual rows=8000.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=8000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
 
 --\qecho volatile func in WHERE clause on :TABLE:PREFIX SELECT count(DISTINCT dev), 'q6_7' FROM :TABLE WHERE dev > int_func_volatile();
 :PREFIX SELECT count(DISTINCT dev), 'q6_8' FROM :TABLE WHERE dev = ANY(inta_func_immutable());
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=12.00 loops=1)
+   ->  Sort (actual rows=3000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=3000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
 
 :PREFIX SELECT count(DISTINCT dev), 'q6_9' FROM :TABLE WHERE dev = ANY(inta_func_stable());
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
-         Hypertable: skip_scan_htc
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
+   ->  Sort (actual rows=3000.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=3000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
 
 :PREFIX SELECT count(DISTINCT dev), 'q6_10' FROM :TABLE WHERE dev = ANY(inta_func_volatile());
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
-         Hypertable: skip_scan_htc
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
-               Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=3000.00 loops=1)
+         Sort Key: skip_scan_htc.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=3000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 -- always false expr similar to our initial skip qual
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > NULL;
@@ -4539,21 +4382,19 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 20;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
@@ -4562,36 +4403,33 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 5 AND time = 100;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 500
-               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
-                     Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 1245
+         ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
+               Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 5 AND time > 200;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Sort (actual rows=3995.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=3995.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=245.00 loops=1)
                      Vectorized Filter: ("time" > 200)
                      Rows Removed by Filter: 1005
                      ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1250.00 loops=1)
                      Vectorized Filter: ("time" > 200)
                      ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1250.00 loops=1)
                      Vectorized Filter: ("time" > 200)
                      ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1250.00 loops=1)
                      Vectorized Filter: ("time" > 200)
                      ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
@@ -4599,22 +4437,20 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev >= 5 AND dev < 7 AND dev >= 2;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=8.00 loops=1)
+   ->  Sort (actual rows=2000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=2000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
 
@@ -4622,32 +4458,29 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=0.00 loops=1)
    Group Key: _hyper_3_5_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=20.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
 
@@ -4696,20 +4529,18 @@
 SELECT * FROM devices;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX WITH devices AS (
 	SELECT dev, count(DISTINCT dev) FROM :TABLE GROUP BY dev
@@ -4718,76 +4549,68 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htc.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 -- prepared statements
 PREPARE prep AS SELECT count(DISTINCT dev) FROM :TABLE;
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
 
 DEALLOCATE prep;
 -- ReScan tests
@@ -4810,8 +4633,7 @@
                            ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=11.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
                            ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=11.00 loops=1)
-               ->  Materialize (actual rows=2.00 loops=10020)
-                     ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=10020)
 
 :PREFIX SELECT c, 'q7_2' FROM (SELECT * FROM (
     VALUES (1), (2)) a(v),
@@ -4820,28 +4642,27 @@
  Nested Loop (actual rows=2.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=2)
-         ->  Merge Append (actual rows=36.00 loops=2)
+         ->  Sort (actual rows=9000.00 loops=2)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=9.00 loops=2)
-                           ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=9.00 loops=2)
+               Sort Method: quicksort 
+               ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=9000.00 loops=2)
+                     Hypertables excluded during runtime: 0
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2250.00 loops=2)
+                           ->  Seq Scan on compress_hyper_4_34_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=9.00 loops=2)
-                           ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=9.00 loops=2)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2250.00 loops=2)
+                           ->  Seq Scan on compress_hyper_4_35_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=9.00 loops=2)
-                           ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=9.00 loops=2)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2250.00 loops=2)
+                           ->  Seq Scan on compress_hyper_4_36_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=9.00 loops=2)
-                           ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=9.00 loops=2)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2250.00 loops=2)
+                           ->  Seq Scan on compress_hyper_4_37_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
+                                 Rows Removed by Filter: 2
 
 -- RuntimeKeys
 :PREFIX SELECT c, 'q8_1' FROM (SELECT * FROM (VALUES (1), (2)) a(v), LATERAL (SELECT count(DISTINCT dev) c FROM :TABLE WHERE dev >= a.v) b) c;
@@ -4849,22 +4670,21 @@
  Nested Loop (actual rows=2.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=2)
-         ->  Merge Append (actual rows=38.00 loops=2)
+         ->  Sort (actual rows=9500.00 loops=2)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=2)
+               Sort Method: quicksort 
+               ->  Custom Scan (ChunkAppend) on skip_scan_htc (actual rows=9500.00 loops=2)
+                     Hypertables excluded during runtime: 0
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_4_34_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_34_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_4_35_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_35_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_4_36_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_36_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_4_37_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_37_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
 
@@ -4892,37 +4712,33 @@
 --- QUERY PLAN ---
  Append (actual rows=2.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=8.00 loops=1)
+         ->  Sort (actual rows=1000.00 loops=1)
                Sort Key: skip_scan_htc_1.val
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=1000.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=250.00 loops=1)
                            ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=1)
                                  Index Cond: (dev = 1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=250.00 loops=1)
                            ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=1)
                                  Index Cond: (dev = 1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=250.00 loops=1)
                            ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=1)
                                  Index Cond: (dev = 1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=250.00 loops=1)
                            ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=1)
                                  Index Cond: (dev = 1)
 
@@ -4931,38 +4747,35 @@
  Nested Loop (actual rows=11.00 loops=1)
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htc.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htc.dev
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=11)
-         ->  Merge Append (actual rows=7.00 loops=11)
+         ->  Sort (actual rows=909.00 loops=11)
                Sort Key: skip_scan_htc_1.val
-               ->  Custom Scan (SkipScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=11)
+               Sort Method: quicksort 
+               ->  Custom Scan (ChunkAppend) on skip_scan_htc skip_scan_htc_1 (actual rows=909.00 loops=11)
+                     Hypertables excluded during runtime: 0
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk _hyper_3_5_chunk_1 (actual rows=250.00 loops=10)
+                           ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk compress_hyper_4_38_chunk_1 (actual rows=2.00 loops=10)
                                  Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=11)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk _hyper_3_6_chunk_1 (actual rows=250.00 loops=10)
+                           ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk compress_hyper_4_39_chunk_1 (actual rows=2.00 loops=10)
                                  Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=11)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk _hyper_3_7_chunk_1 (actual rows=250.00 loops=10)
+                           ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk compress_hyper_4_40_chunk_1 (actual rows=2.00 loops=10)
                                  Index Cond: (dev = skip_scan_htc.dev)
-               ->  Custom Scan (SkipScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=2.00 loops=11)
-                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=11)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk _hyper_3_8_chunk_1 (actual rows=250.00 loops=10)
+                           ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk compress_hyper_4_41_chunk_1 (actual rows=2.00 loops=10)
                                  Index Cond: (dev = skip_scan_htc.dev)
 
 -- SkipScan into INSERT
@@ -4972,20 +4785,18 @@
    ->  Subquery Scan on a (actual rows=11.00 loops=1)
          ->  GroupAggregate (actual rows=11.00 loops=1)
                Group Key: skip_scan_htc.dev
-               ->  Merge Append (actual rows=44.00 loops=1)
+               ->  Sort (actual rows=10020.00 loops=1)
                      Sort Key: skip_scan_htc.dev
-                     ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+                     Sort Method: quicksort 
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
 
 -- parallel query
 RESET max_parallel_workers_per_gather;
@@ -4996,21 +4807,23 @@
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE;
 --- QUERY PLAN ---
- Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
-         Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=11.00 loops=1)
+ Gather (actual rows=1.00 loops=1)
+   Workers Planned: 1
+   Workers Launched: 1
+   Single Copy: true
+   ->  Aggregate (actual rows=1.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
+               Sort Key: skip_scan_htc.dev
+               Worker 0:  Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_38_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_39_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_40_chunk (actual rows=21.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_4_41_chunk (actual rows=21.00 loops=1)
 
 SELECT set_config(CASE WHEN current_setting('server_version_num')::int < 160000 THEN 'force_parallel_mode' ELSE 'debug_parallel_query' END,'off', false);
  set_config 
@@ -5022,22 +4835,20 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE where val IS NULL;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=20.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=1.00 loops=1)
                            Index Cond: (val IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=1.00 loops=1)
                            Index Cond: (val IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=1.00 loops=1)
                            Index Cond: (val IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=1.00 loops=1)
                            Index Cond: (val IS NULL)
 
@@ -5045,21 +4856,19 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE val IS NULL AND dev > 100;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_38_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_38_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_39_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_39_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_40_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_40_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_4_41_chunk_dev_val__ts_meta_min_1__ts_meta_m_idx on compress_hyper_4_41_chunk (actual rows=0.00 loops=1)
                            Index Cond: ((dev > 100) AND (val IS NULL))
@@ -5092,58 +4901,52 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev DESC;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev DESC NULLS FIRST;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho basic DISTINCT queries on :TABLE
 basic DISTINCT queries on skip_scan_htcl
@@ -5151,256 +4954,230 @@
 :PREFIX SELECT count(DISTINCT dev), sum(DISTINCT dev), 'q1_1' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- Distinct agg over Const is OK
 :PREFIX SELECT count(DISTINCT dev), count(DISTINCT 2), 'q1_3', NULL FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- DISTINCT over distinct agg is OK
 :PREFIX SELECT DISTINCT count(DISTINCT dev), dev, 'q1_4' FROM :TABLE GROUP BY dev ORDER BY dev;
 --- QUERY PLAN ---
- Unique (actual rows=11.00 loops=1)
-   ->  Incremental Sort (actual rows=11.00 loops=1)
-         Sort Key: skip_scan_htcl.dev, (count(DISTINCT skip_scan_htcl.dev))
-         Presorted Key: skip_scan_htcl.dev
-         Full-sort Groups: 1  Sort Method: quicksort 
+ Sort (actual rows=11.00 loops=1)
+   Sort Key: skip_scan_htcl.dev
+   Sort Method: quicksort 
+   ->  HashAggregate (actual rows=11.00 loops=1)
+         Group Key: skip_scan_htcl.dev, count(DISTINCT skip_scan_htcl.dev)
          ->  GroupAggregate (actual rows=11.00 loops=1)
                Group Key: skip_scan_htcl.dev
-               ->  Merge Append (actual rows=44.00 loops=1)
+               ->  Sort (actual rows=10020.00 loops=1)
                      Sort Key: skip_scan_htcl.dev
-                     ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                                 ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+                     Sort Method: quicksort 
+                     ->  Append (actual rows=10020.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho stable expression in targetlist on :TABLE
 stable expression in targetlist on skip_scan_htcl
 :PREFIX SELECT count(DISTINCT dev), 'q1_5', length(md5(now()::text)) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- volatile expression in targetlist
 :PREFIX SELECT count(DISTINCT dev), 'q1_7', length(md5(random()::text)) FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- expressions over distinct aggregates are supported
 :PREFIX SELECT count(DISTINCT dev) + 1, sum(DISTINCT dev)/count(DISTINCT dev), 'q1_15' FROM :TABLE;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- DISTINCT aggs grouped on their args
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_1' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_2', NULL FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_3', length(md5(now()::text)) FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, 'q2_4', length(md5(random()::text)) FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, int_func_immutable(), 'q2_5' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, int_func_stable(), 'q2_6' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev, int_func_volatile(), 'q2_7' FROM :TABLE GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev+1, 'q2_8' FROM :TABLE GROUP BY dev ORDER BY 2;
 --- QUERY PLAN ---
@@ -5409,39 +5186,35 @@
    Sort Method: quicksort 
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev+1, dev+2, 'q2_9' FROM :TABLE GROUP BY dev, dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho LIMIT queries on :TABLE
 LIMIT queries on skip_scan_htcl
@@ -5450,40 +5223,36 @@
  Limit (actual rows=3.00 loops=1)
    ->  GroupAggregate (actual rows=3.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=13.00 loops=1)
+         ->  Sort (actual rows=3001.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=4.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE GROUP BY dev ORDER BY dev DESC LIMIT 3;
 --- QUERY PLAN ---
  Limit (actual rows=3.00 loops=1)
    ->  GroupAggregate (actual rows=3.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=13.00 loops=1)
+         ->  Sort (actual rows=2021.00 loops=1)
                Sort Key: skip_scan_htcl.dev DESC
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=4.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=4.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=4.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=4.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho range queries on :TABLE
 range queries on skip_scan_htcl
@@ -5492,40 +5261,38 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE time < 200 GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: _hyper_5_9_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               Vectorized Filter: ("time" < 200)
-               Rows Removed by Filter: 501
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_min_1 < 200)
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2004.00 loops=1)
+         Vectorized Filter: ("time" < 200)
+         Rows Removed by Filter: 501
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               Index Cond: (_ts_meta_min_1 < 200)
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE time > 800 GROUP BY dev;
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: _hyper_5_13_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               Vectorized Filter: ("time" > 800)
-               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
-                     Index Cond: (_ts_meta_max_1 > 800)
+   ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1993.00 loops=1)
+         Vectorized Filter: ("time" > 800)
+         Rows Removed by Filter: 512
+         ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Index Cond: (_ts_meta_max_1 > 800)
 
 reset enable_seqscan;
 -- Various tests for "segmentby = 'dev'"
@@ -5536,59 +5303,53 @@
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=1.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT NULL, dev, NULL, 'q4_2' FROM (SELECT count(DISTINCT dev) as dev FROM :TABLE) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=1.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=1)
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT NULL, dev, NULL, c1, 2, c3, 'q4_3' FROM (SELECT count(DISTINCT dev) as c1, dev, 1 as c3 FROM :TABLE GROUP BY dev) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 \qecho ORDER BY
 ORDER BY
@@ -5597,40 +5358,36 @@
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT c, dev, 'q5_2' FROM (SELECT count(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev ORDER BY dev DESC) a;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=11.00 loops=1)
    ->  GroupAggregate (actual rows=11.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Sort (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev DESC
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan Backward using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=10020.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- Force not choosing SeqScan under DecompressChunks before SkipScan can evaluate it,
 -- as cost of scanning and sorting a small dataset can be less than scanning an index, including startup cost.
@@ -5645,24 +5402,20 @@
  Subquery Scan on a (actual rows=5.00 loops=1)
    ->  GroupAggregate (actual rows=5.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=20.00 loops=1)
+         ->  Merge Append (actual rows=5000.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
 
 :PREFIX SELECT c, dev, 'q6_2' FROM (SELECT sum(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev HAVING sum(DISTINCT dev)>2) a;
 --- QUERY PLAN ---
@@ -5671,44 +5424,36 @@
          Group Key: skip_scan_htcl.dev
          Filter: (sum(DISTINCT skip_scan_htcl.dev) > 2)
          Rows Removed by Filter: 3
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Merge Append (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT c, dev, 'q6_3' FROM (SELECT count(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev) a WHERE dev > 5;
 --- QUERY PLAN ---
  Subquery Scan on a (actual rows=5.00 loops=1)
    ->  GroupAggregate (actual rows=5.00 loops=1)
          Group Key: skip_scan_htcl.dev
-         ->  Merge Append (actual rows=20.00 loops=1)
+         ->  Merge Append (actual rows=5000.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
-                                 Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1250.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
+                           Index Cond: (dev > 5)
 
 :PREFIX SELECT c, dev, 'q6_4' FROM (SELECT sum(DISTINCT dev) as c, dev FROM :TABLE GROUP BY dev) a WHERE c > 2;
 --- QUERY PLAN ---
@@ -5717,41 +5462,35 @@
          Group Key: skip_scan_htcl.dev
          Filter: (sum(DISTINCT skip_scan_htcl.dev) > 2)
          Rows Removed by Filter: 3
-         ->  Merge Append (actual rows=44.00 loops=1)
+         ->  Merge Append (actual rows=10020.00 loops=1)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 --\qecho immutable func in WHERE clause on :TABLE
 :PREFIX SELECT count(DISTINCT dev), 'q6_5' FROM :TABLE WHERE dev > int_func_immutable();
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=36.00 loops=1)
+   ->  Sort (actual rows=9000.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=9.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=9000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=9.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=9.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=9.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2250.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=9.00 loops=1)
                            Index Cond: (dev > 1)
 
@@ -5759,133 +5498,115 @@
 :PREFIX SELECT count(DISTINCT dev), 'q6_6' FROM :TABLE WHERE dev > int_func_stable();
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=32.00 loops=1)
-         Hypertable: skip_scan_htcl
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=32.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=8.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=8.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=8.00 loops=1)
-                                 Index Cond: (dev > int_func_stable())
+   ->  Sort (actual rows=8000.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htcl (actual rows=8000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2000.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=8.00 loops=1)
+                           Index Cond: (dev > int_func_stable())
 
 --\qecho volatile func in WHERE clause on :TABLE
 :PREFIX SELECT count(DISTINCT dev), 'q6_7' FROM :TABLE WHERE dev > int_func_volatile();
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=28.00 loops=1)
-         Hypertable: skip_scan_htcl
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=28.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=7.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=7.00 loops=1)
-                           Filter: (dev > int_func_volatile())
-                           Rows Removed by Filter: 755
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=7000.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htcl (actual rows=7000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1750.00 loops=1)
+                     Filter: (dev > int_func_volatile())
+                     Rows Removed by Filter: 755
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT count(DISTINCT dev), 'q6_8' FROM :TABLE WHERE dev = ANY(inta_func_immutable());
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=12.00 loops=1)
+   ->  Sort (actual rows=3000.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=3000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=750.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
                            Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
 
 :PREFIX SELECT count(DISTINCT dev), 'q6_9' FROM :TABLE WHERE dev = ANY(inta_func_stable());
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
-         Hypertable: skip_scan_htcl
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
-                                 Index Cond: (dev = ANY (inta_func_stable()))
+   ->  Sort (actual rows=3000.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htcl (actual rows=3000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=750.00 loops=1)
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=3.00 loops=1)
+                           Index Cond: (dev = ANY (inta_func_stable()))
 
 :PREFIX SELECT count(DISTINCT dev), 'q6_10' FROM :TABLE WHERE dev = ANY(inta_func_volatile());
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=12.00 loops=1)
-         Hypertable: skip_scan_htcl
-         Chunks excluded during startup: 0
-         ->  Merge Append (actual rows=12.00 loops=1)
-               Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=3.00 loops=1)
-                           Filter: (dev = ANY (inta_func_volatile()))
-                           Rows Removed by Filter: 1755
-                           ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=3000.00 loops=1)
+         Sort Key: skip_scan_htcl.dev
+         Sort Method: quicksort 
+         ->  Custom Scan (ChunkAppend) on skip_scan_htcl (actual rows=3000.00 loops=1)
+               Chunks excluded during startup: 0
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=750.00 loops=1)
+                     Filter: (dev = ANY (inta_func_volatile()))
+                     Rows Removed by Filter: 1755
+                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- always false expr similar to our initial skip qual
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > NULL;
@@ -5901,21 +5622,19 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 20;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=0.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=0.00 loops=1)
                            Index Cond: (dev > 20)
@@ -5924,35 +5643,33 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 5 AND time = 100;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 745
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                     Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 1245
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+               Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 5 AND time > 200;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Sort (actual rows=3995.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=3995.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=245.00 loops=1)
                      Vectorized Filter: ("time" > 200)
+                     Rows Removed by Filter: 1005
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1250.00 loops=1)
                      Vectorized Filter: ("time" > 200)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1250.00 loops=1)
                      Vectorized Filter: ("time" > 200)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1250.00 loops=1)
                      Vectorized Filter: ("time" > 200)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=5.00 loops=1)
                            Index Cond: ((dev > 5) AND (_ts_meta_max_1 > 200))
@@ -5960,22 +5677,20 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev >= 5 AND dev < 7 AND dev >= 2;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=8.00 loops=1)
+   ->  Sort (actual rows=2000.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=2000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=500.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=2.00 loops=1)
                            Index Cond: ((dev >= 5) AND (dev < 7) AND (dev >= 2))
 
@@ -5983,32 +5698,29 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=0.00 loops=1)
    Group Key: _hyper_5_9_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=20.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=1.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=1.00 loops=1)
                            Index Cond: (dev IS NULL)
 
@@ -6019,19 +5731,17 @@
 SELECT * FROM devices;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX WITH devices AS (
@@ -6041,75 +5751,65 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Merge Append (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
+               ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 -- prepared statements
 PREPARE prep AS SELECT count(DISTINCT dev) FROM :TABLE;
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
                      ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
 
 DEALLOCATE prep;
@@ -6133,8 +5833,7 @@
                            ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=11.00 loops=1)
                      ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2505.00 loops=1)
                            ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=11.00 loops=1)
-               ->  Materialize (actual rows=2.00 loops=10020)
-                     ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=10020)
 
 :PREFIX SELECT c, 'q7_2' FROM (SELECT * FROM (
     VALUES (1), (2)) a(v),
@@ -6143,28 +5842,27 @@
  Nested Loop (actual rows=2.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=2)
-         ->  Merge Append (actual rows=36.00 loops=2)
+         ->  Sort (actual rows=9000.00 loops=2)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=9.00 loops=2)
+               Sort Method: quicksort 
+               ->  Custom Scan (ChunkAppend) on skip_scan_htcl (actual rows=9000.00 loops=2)
+                     Hypertables excluded during runtime: 0
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2250.00 loops=2)
                            ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=9.00 loops=2)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2250.00 loops=2)
                            ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=9.00 loops=2)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2250.00 loops=2)
                            ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=9.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=9.00 loops=2)
+                                 Rows Removed by Filter: 2
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2250.00 loops=2)
                            ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=9.00 loops=2)
                                  Filter: (dev <> "*VALUES*".column1)
-                                 Rows Removed by Filter: 1
+                                 Rows Removed by Filter: 2
 
 -- RuntimeKeys
 :PREFIX SELECT c, 'q8_1' FROM (SELECT * FROM (VALUES (1), (2)) a(v), LATERAL (SELECT count(DISTINCT dev) c FROM :TABLE WHERE dev >= a.v) b) c;
@@ -6172,22 +5870,21 @@
  Nested Loop (actual rows=2.00 loops=1)
    ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
    ->  Aggregate (actual rows=1.00 loops=2)
-         ->  Merge Append (actual rows=38.00 loops=2)
+         ->  Sort (actual rows=9500.00 loops=2)
                Sort Key: skip_scan_htcl.dev
-               ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=10.00 loops=2)
+               Sort Method: quicksort 
+               ->  Custom Scan (ChunkAppend) on skip_scan_htcl (actual rows=9500.00 loops=2)
+                     Hypertables excluded during runtime: 0
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
-               ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=10.00 loops=2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
-               ->  Custom Scan (SkipScan) on _hyper_5_12_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=10.00 loops=2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_12_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_6_15_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_15_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
-               ->  Custom Scan (SkipScan) on _hyper_5_13_chunk (actual rows=10.00 loops=2)
-                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=10.00 loops=2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_5_13_chunk (actual rows=2375.00 loops=2)
                            ->  Index Scan using compress_hyper_6_16_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_16_chunk (actual rows=10.00 loops=2)
                                  Index Cond: (dev >= "*VALUES*".column1)
 
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_notnull.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_notnull.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_notnull.out	2025-11-06 02:35:39.306068363 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_notnull.out	2025-11-06 02:47:50.538746450 +0000
@@ -1078,719 +1078,569 @@
 -- LICENSE-TIMESCALE for a copy of the license.
 -- Base queries with regular NULL mode
 :PREFIX SELECT DISTINCT dev FROM :TABLE;
-psql:include/skip_scan_notnull.sql:6: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:6: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:6: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:6: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE order by dev DESC;
-psql:include/skip_scan_notnull.sql:8: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS FIRST)
-psql:include/skip_scan_notnull.sql:8: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS FIRST)
-psql:include/skip_scan_notnull.sql:8: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS FIRST)
-psql:include/skip_scan_notnull.sql:8: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS FIRST)
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=44.00 loops=1)
+   ->  Sort (actual rows=10020.00 loops=1)
          Sort Key: skip_scan_htc.dev DESC
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10020.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2505.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- Index quals except IS NULL discard NULLs
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev IS NOT NULL;
-psql:include/skip_scan_notnull.sql:11: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:11: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:11: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:11: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
-                           Index Cond: (dev IS NOT NULL)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                           Filter: (dev IS NOT NULL)
+                           Rows Removed by Filter: 1
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev > 2;
-psql:include/skip_scan_notnull.sql:13: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:13: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:13: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:13: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=8.00 loops=1)
-   ->  Merge Append (actual rows=32.00 loops=1)
+   ->  Merge Append (actual rows=8000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=8.00 loops=1)
-                           Index Cond: (dev > 2)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=8.00 loops=1)
-                           Index Cond: (dev > 2)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=8.00 loops=1)
-                           Index Cond: (dev > 2)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=8.00 loops=1)
-                           Index Cond: (dev > 2)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=8.00 loops=1)
+                     Index Cond: (dev > 2)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=8.00 loops=1)
+                     Index Cond: (dev > 2)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=8.00 loops=1)
+                     Index Cond: (dev > 2)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=8.00 loops=1)
+                     Index Cond: (dev > 2)
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev BETWEEN 1 AND 5;
-psql:include/skip_scan_notnull.sql:15: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:15: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:15: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:15: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=20.00 loops=1)
+   ->  Merge Append (actual rows=5000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev >= 1) AND (dev <= 5))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev >= 1) AND (dev <= 5))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev >= 1) AND (dev <= 5))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=5.00 loops=1)
-                           Index Cond: ((dev >= 1) AND (dev <= 5))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev >= 1) AND (dev <= 5))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev >= 1) AND (dev <= 5))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev >= 1) AND (dev <= 5))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=5.00 loops=1)
+                     Index Cond: ((dev >= 1) AND (dev <= 5))
 
 -- next two filters produce small output for which we may select seqscan, don't want it
 set enable_seqscan=0;
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev in (1,2,3);
-psql:include/skip_scan_notnull.sql:19: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:19: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:19: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:19: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=12.00 loops=1)
+   ->  Merge Append (actual rows=3000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=3.00 loops=1)
-                           Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=3.00 loops=1)
+                     Index Cond: (dev = ANY ('{1,2,3}'::integer[]))
 
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev IS NULL;
-psql:include/skip_scan_notnull.sql:21: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:21: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:21: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:21: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
 
 -- PG is smart enough to convert negation of IS NOT NULL to IS NULL index condition
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE (dev IS NOT NULL) = false;
-psql:include/skip_scan_notnull.sql:24: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:24: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:24: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:24: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=1.00 loops=1)
+                     Index Cond: (dev IS NULL)
 
 -- Complex expressions over IS NOT NULL are non-strict filters
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE ((dev is null) = false)::int + 1 > 1;
-psql:include/skip_scan_notnull.sql:27: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:27: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:27: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:27: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Merge Append (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
-                           Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
-                           Rows Removed by Filter: 1
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-                           Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
-                           Rows Removed by Filter: 1
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-                           Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
-                           Rows Removed by Filter: 1
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
-                           Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
-                           Rows Removed by Filter: 1
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
+                     Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
+                     Rows Removed by Filter: 1
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+                     Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
+                     Rows Removed by Filter: 1
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+                     Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
+                     Rows Removed by Filter: 1
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                     Filter: ((((dev IS NOT NULL))::integer + 1) > 1)
+                     Rows Removed by Filter: 1
 
 reset enable_seqscan;
 -- Strict Index filters discard NULLs
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev * 2 < 8;
-psql:include/skip_scan_notnull.sql:31: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:31: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:31: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:31: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=3.00 loops=1)
-   ->  Merge Append (actual rows=12.00 loops=1)
+   ->  Sort (actual rows=3000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=3.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=3000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=750.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=3.00 loops=1)
                            Filter: ((dev * 2) < 8)
-                           Rows Removed by Filter: 7
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=3.00 loops=1)
+                           Rows Removed by Filter: 8
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=750.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=3.00 loops=1)
                            Filter: ((dev * 2) < 8)
-                           Rows Removed by Filter: 7
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=3.00 loops=1)
+                           Rows Removed by Filter: 8
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=750.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=3.00 loops=1)
                            Filter: ((dev * 2) < 8)
-                           Rows Removed by Filter: 7
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=3.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=3.00 loops=1)
+                           Rows Removed by Filter: 8
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=750.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=3.00 loops=1)
                            Filter: ((dev * 2) < 8)
-                           Rows Removed by Filter: 7
+                           Rows Removed by Filter: 8
 
 -- OR is non-strict
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev < 2 OR dev > 0;
-psql:include/skip_scan_notnull.sql:34: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:34: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:34: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:34: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
                            Filter: ((dev < 2) OR (dev > 0))
                            Rows Removed by Filter: 1
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
                            Filter: ((dev < 2) OR (dev > 0))
                            Rows Removed by Filter: 1
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
                            Filter: ((dev < 2) OR (dev > 0))
                            Rows Removed by Filter: 1
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
                            Filter: ((dev < 2) OR (dev > 0))
                            Rows Removed by Filter: 1
 
 -- Coalesce is non-strict
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE coalesce(dev,-1) < 1;
-psql:include/skip_scan_notnull.sql:36: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:36: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:36: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:36: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Sort (actual rows=20.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=20.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=5.00 loops=1)
                      Filter: (COALESCE(dev, '-1'::integer) < 1)
                      Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=5.00 loops=1)
                      Filter: (COALESCE(dev, '-1'::integer) < 1)
                      Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=5.00 loops=1)
                      Filter: (COALESCE(dev, '-1'::integer) < 1)
                      Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=5.00 loops=1)
                      Filter: (COALESCE(dev, '-1'::integer) < 1)
                      Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- Strict non-index filters on relation discard NULLs
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev + time < 100;
-psql:include/skip_scan_notnull.sql:39: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:39: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:39: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:39: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=945.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=945.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=945.00 loops=1)
                      Filter: ((dev + "time") < 100)
-                     Rows Removed by Filter: 1555
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
+                     Rows Removed by Filter: 1560
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                      Filter: ((dev + "time") < 100)
-                     Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
+                     Rows Removed by Filter: 2505
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                      Filter: ((dev + "time") < 100)
-                     Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
+                     Rows Removed by Filter: 2505
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                      Filter: ((dev + "time") < 100)
-                     Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                     Rows Removed by Filter: 2505
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- OR is non-strict
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev + time < 100 OR dev > 0;
-psql:include/skip_scan_notnull.sql:42: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:42: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:42: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:42: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
                      Filter: (((dev + "time") < 100) OR (dev > 0))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
                      Filter: (((dev + "time") < 100) OR (dev > 0))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
                      Filter: (((dev + "time") < 100) OR (dev > 0))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
                      Filter: (((dev + "time") < 100) OR (dev > 0))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- Coalesce is non-strict
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE coalesce(dev,20) + time < 100;
-psql:include/skip_scan_notnull.sql:44: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:44: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:44: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:44: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=11.00 loops=1)
+   ->  Sort (actual rows=947.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=947.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=947.00 loops=1)
                      Filter: ((COALESCE(dev, 20) + "time") < 100)
                      Rows Removed by Filter: 1558
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                      Filter: ((COALESCE(dev, 20) + "time") < 100)
                      Rows Removed by Filter: 2505
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                      Filter: ((COALESCE(dev, 20) + "time") < 100)
                      Rows Removed by Filter: 2505
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                      Filter: ((COALESCE(dev, 20) + "time") < 100)
                      Rows Removed by Filter: 2505
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- If at least one filter is strict then it filters out NULLs
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE coalesce(dev,20) + time < 100 and dev + time < 100;
-psql:include/skip_scan_notnull.sql:47: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:47: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:47: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:47: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=945.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=945.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=945.00 loops=1)
                      Filter: (((COALESCE(dev, 20) + "time") < 100) AND ((dev + "time") < 100))
-                     Rows Removed by Filter: 1555
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=10.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
+                     Rows Removed by Filter: 1560
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=0.00 loops=1)
                      Filter: (((COALESCE(dev, 20) + "time") < 100) AND ((dev + "time") < 100))
-                     Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=10.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
+                     Rows Removed by Filter: 2505
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=0.00 loops=1)
                      Filter: (((COALESCE(dev, 20) + "time") < 100) AND ((dev + "time") < 100))
-                     Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=10.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
+                     Rows Removed by Filter: 2505
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=0.00 loops=1)
                      Filter: (((COALESCE(dev, 20) + "time") < 100) AND ((dev + "time") < 100))
-                     Rows Removed by Filter: 2500
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=10.00 loops=1)
+                     Rows Removed by Filter: 2505
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- Index qual on a non-skip key: skip key can be NULL
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev_name > 'device_1';
-psql:include/skip_scan_notnull.sql:50: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:50: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:50: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:50: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=9.00 loops=1)
-   ->  Merge Append (actual rows=36.00 loops=1)
+   ->  Sort (actual rows=9000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=9.00 loops=1)
-                           Index Cond: (dev_name > 'device_1'::text)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=9.00 loops=1)
-                           Index Cond: (dev_name > 'device_1'::text)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=9.00 loops=1)
-                           Index Cond: (dev_name > 'device_1'::text)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=9.00 loops=1)
-                           Index Cond: (dev_name > 'device_1'::text)
+         Sort Method: quicksort 
+         ->  Append (actual rows=9000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2250.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=9.00 loops=1)
+                           Filter: (dev_name > 'device_1'::text)
+                           Rows Removed by Filter: 2
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2250.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=9.00 loops=1)
+                           Filter: (dev_name > 'device_1'::text)
+                           Rows Removed by Filter: 2
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2250.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=9.00 loops=1)
+                           Filter: (dev_name > 'device_1'::text)
+                           Rows Removed by Filter: 2
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2250.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=9.00 loops=1)
+                           Filter: (dev_name > 'device_1'::text)
+                           Rows Removed by Filter: 2
 
 -- Index quals on several keys including skip key
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE dev_name > 'device_1' and dev > 2;
-psql:include/skip_scan_notnull.sql:53: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:53: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:53: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:53: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=8.00 loops=1)
-   ->  Merge Append (actual rows=32.00 loops=1)
+   ->  Merge Append (actual rows=8000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=8.00 loops=1)
-                           Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=8.00 loops=1)
-                           Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=8.00 loops=1)
-                           Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=8.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=8.00 loops=1)
-                           Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=8.00 loops=1)
+                     Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=8.00 loops=1)
+                     Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=8.00 loops=1)
+                     Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2000.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=8.00 loops=1)
+                     Index Cond: ((dev > 2) AND (dev_name > 'device_1'::text))
 
 -- Index qual row comparison will filter out NULLs in skip key when skip key is a leading column
 -- But for compressed chunks ROW is not pushed into index quals, it is treated as a filter and is not strict
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE row(dev,dev_name) > row(1,'device_1');
-psql:include/skip_scan_notnull.sql:57: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:57: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:57: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:57: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=9.00 loops=1)
-   ->  Merge Append (actual rows=36.00 loops=1)
+   ->  Sort (actual rows=9000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=9000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev, dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev, dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev, dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev, dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- Satisfying (dev_name>'device_1') may allow NULLs into dev
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE row(dev_name,dev) > row('device_1',1);
-psql:include/skip_scan_notnull.sql:60: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:60: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:60: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:60: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=9.00 loops=1)
-   ->  Merge Append (actual rows=36.00 loops=1)
+   ->  Sort (actual rows=9000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=9.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=9000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev_name, dev) > ROW('device_1'::text, 1))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=9.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev_name, dev) > ROW('device_1'::text, 1))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=9.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev_name, dev) > ROW('device_1'::text, 1))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=9.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2250.00 loops=1)
                      Filter: (ROW(dev_name, dev) > ROW('device_1'::text, 1))
                      Rows Removed by Filter: 255
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- Non-index qual row comparison: row comparison in general is not strict
 :PREFIX SELECT DISTINCT dev FROM :TABLE WHERE row(dev+1,dev_name) > row(1,'device_1');
-psql:include/skip_scan_notnull.sql:63: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:63: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:63: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
-psql:include/skip_scan_notnull.sql:63: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=40.00 loops=1)
+   ->  Sort (actual rows=10000.00 loops=1)
          Sort Key: skip_scan_htc.dev
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=10.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=2500.00 loops=1)
                      Filter: (ROW((dev + 1), dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_17_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=2500.00 loops=1)
                      Filter: (ROW((dev + 1), dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=2500.00 loops=1)
                      Filter: (ROW((dev + 1), dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_19_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=2500.00 loops=1)
                      Filter: (ROW((dev + 1), dev_name) > ROW(1, 'device_1'::text))
                      Rows Removed by Filter: 5
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
+                     ->  Seq Scan on compress_hyper_4_20_chunk (actual rows=11.00 loops=1)
 
 -- Different SkipScan column
 :PREFIX SELECT DISTINCT dev_name FROM :TABLE WHERE dev=1 and dev_name IS NOT NULL;
-psql:include/skip_scan_notnull.sql:66: INFO:  SkipScan used on compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev_name NOT NULL)
-psql:include/skip_scan_notnull.sql:66: INFO:  SkipScan used on compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev_name NOT NULL)
-psql:include/skip_scan_notnull.sql:66: INFO:  SkipScan used on compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev_name NOT NULL)
-psql:include/skip_scan_notnull.sql:66: INFO:  SkipScan used on compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx(dev_name NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=4.00 loops=1)
+   ->  Merge Append (actual rows=1000.00 loops=1)
          Sort Key: skip_scan_htc.dev_name
-         ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
-         ->  Custom Scan (SkipScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=1.00 loops=1)
-                           Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_17_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_17_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_6_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_18_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_18_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_19_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_19_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
+         ->  Custom Scan (ColumnarScan) on _hyper_3_8_chunk (actual rows=250.00 loops=1)
+               ->  Index Scan using compress_hyper_4_20_chunk_dev_dev_name__ts_meta_min_1__ts_m_idx on compress_hyper_4_20_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((dev = 1) AND (dev_name IS NOT NULL))
 
 -- Boolean and NOT NULL constraint tests
 -- Boolean column index qual is strict
 :PREFIX SELECT DISTINCT b FROM skip_scan_b WHERE b;
-psql:include/skip_scan_notnull.sql:71: INFO:  SkipScan used on compress_hyper_9_27_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NOT NULL)
-psql:include/skip_scan_notnull.sql:71: INFO:  SkipScan used on compress_hyper_9_28_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NOT NULL)
-psql:include/skip_scan_notnull.sql:71: INFO:  SkipScan used on compress_hyper_9_29_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=3.00 loops=1)
+   ->  Sort (actual rows=4000.00 loops=1)
          Sort Key: skip_scan_b.b
-         ->  Custom Scan (SkipScan) on _hyper_7_21_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_21_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_9_27_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_27_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (b = true)
-         ->  Custom Scan (SkipScan) on _hyper_7_22_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_22_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_9_28_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_28_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (b = true)
-         ->  Custom Scan (SkipScan) on _hyper_7_23_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_23_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_9_29_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_29_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (b = true)
+         Sort Method: quicksort 
+         ->  Append (actual rows=4000.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_21_chunk (actual rows=1996.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_27_chunk (actual rows=2.00 loops=1)
+                           Filter: b
+                           Rows Removed by Filter: 4
+               ->  Custom Scan (ColumnarScan) on _hyper_7_22_chunk (actual rows=2000.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_28_chunk (actual rows=2.00 loops=1)
+                           Filter: b
+                           Rows Removed by Filter: 4
+               ->  Custom Scan (ColumnarScan) on _hyper_7_23_chunk (actual rows=4.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_29_chunk (actual rows=1.00 loops=1)
+                           Filter: b
+                           Rows Removed by Filter: 2
 
 :PREFIX SELECT DISTINCT b FROM skip_scan_b WHERE b != true;
-psql:include/skip_scan_notnull.sql:72: INFO:  SkipScan used on compress_hyper_9_27_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NOT NULL)
-psql:include/skip_scan_notnull.sql:72: INFO:  SkipScan used on compress_hyper_9_28_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NOT NULL)
-psql:include/skip_scan_notnull.sql:72: INFO:  SkipScan used on compress_hyper_9_29_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Merge Append (actual rows=3.00 loops=1)
+   ->  Sort (actual rows=3001.00 loops=1)
          Sort Key: skip_scan_b.b
-         ->  Custom Scan (SkipScan) on _hyper_7_21_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_21_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_9_27_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_27_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (b = false)
-         ->  Custom Scan (SkipScan) on _hyper_7_22_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_22_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_9_28_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_28_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (b = false)
-         ->  Custom Scan (SkipScan) on _hyper_7_23_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_23_chunk (actual rows=1.00 loops=1)
-                     ->  Index Scan using compress_hyper_9_29_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_29_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (b = false)
+         Sort Method: quicksort 
+         ->  Append (actual rows=3001.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_21_chunk (actual rows=1498.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_27_chunk (actual rows=2.00 loops=1)
+                           Filter: (NOT b)
+                           Rows Removed by Filter: 4
+               ->  Custom Scan (ColumnarScan) on _hyper_7_22_chunk (actual rows=1500.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_28_chunk (actual rows=2.00 loops=1)
+                           Filter: (NOT b)
+                           Rows Removed by Filter: 4
+               ->  Custom Scan (ColumnarScan) on _hyper_7_23_chunk (actual rows=3.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_29_chunk (actual rows=1.00 loops=1)
+                           Filter: (NOT b)
+                           Rows Removed by Filter: 2
 
 -- Boolean column predicates could be non-strict filters, below filter can accept NULLs
 :PREFIX SELECT DISTINCT b FROM skip_scan_b WHERE b IS NOT true;
-psql:include/skip_scan_notnull.sql:74: INFO:  SkipScan used on compress_hyper_9_27_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NULLS LAST)
-psql:include/skip_scan_notnull.sql:74: INFO:  SkipScan used on compress_hyper_9_28_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NULLS LAST)
-psql:include/skip_scan_notnull.sql:74: INFO:  SkipScan used on compress_hyper_9_29_chunk_b__ts_meta_min_1__ts_meta_max_1_idx(b NULLS LAST)
 --- QUERY PLAN ---
  Unique (actual rows=2.00 loops=1)
-   ->  Merge Append (actual rows=6.00 loops=1)
+   ->  Sort (actual rows=6022.00 loops=1)
          Sort Key: skip_scan_b.b
-         ->  Custom Scan (SkipScan) on _hyper_7_21_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_21_chunk (actual rows=2.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=6022.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_21_chunk (actual rows=3006.00 loops=1)
                      Filter: (b IS NOT TRUE)
                      Rows Removed by Filter: 1996
-                     ->  Index Scan using compress_hyper_9_27_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_27_chunk (actual rows=4.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_7_22_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_22_chunk (actual rows=2.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_27_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_22_chunk (actual rows=3010.00 loops=1)
                      Filter: (b IS NOT TRUE)
                      Rows Removed by Filter: 2000
-                     ->  Index Scan using compress_hyper_9_28_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_28_chunk (actual rows=4.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_7_23_chunk (actual rows=2.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_7_23_chunk (actual rows=2.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_28_chunk (actual rows=6.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_23_chunk (actual rows=6.00 loops=1)
                      Filter: (b IS NOT TRUE)
                      Rows Removed by Filter: 4
-                     ->  Index Scan using compress_hyper_9_29_chunk_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_9_29_chunk (actual rows=3.00 loops=1)
+                     ->  Seq Scan on compress_hyper_9_29_chunk (actual rows=3.00 loops=1)
 
 -- dev is declared NOT NULL
 :PREFIX SELECT DISTINCT dev FROM skip_scan_nn;
-psql:include/skip_scan_notnull.sql:77: INFO:  SkipScan used on compress_hyper_10_30_chunk_dev__ts_meta_min_1__ts_meta_max__idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:77: INFO:  SkipScan used on compress_hyper_10_31_chunk_dev__ts_meta_min_1__ts_meta_max__idx(dev NOT NULL)
-psql:include/skip_scan_notnull.sql:77: INFO:  SkipScan used on compress_hyper_10_32_chunk_dev__ts_meta_min_1__ts_meta_max__idx(dev NOT NULL)
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=32.00 loops=1)
+   ->  Sort (actual rows=10022.00 loops=1)
          Sort Key: skip_scan_nn.dev
-         ->  Custom Scan (SkipScan) on _hyper_8_24_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_8_24_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_10_30_chunk_dev__ts_meta_min_1__ts_meta_max__idx on compress_hyper_10_30_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_8_25_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_8_25_chunk (actual rows=11.00 loops=1)
-                     ->  Index Scan using compress_hyper_10_31_chunk_dev__ts_meta_min_1__ts_meta_max__idx on compress_hyper_10_31_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (SkipScan) on _hyper_8_26_chunk (actual rows=10.00 loops=1)
+         Sort Method: quicksort 
+         ->  Append (actual rows=10022.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_8_24_chunk (actual rows=5002.00 loops=1)
+                     ->  Seq Scan on compress_hyper_10_30_chunk (actual rows=11.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_8_25_chunk (actual rows=5010.00 loops=1)
+                     ->  Seq Scan on compress_hyper_10_31_chunk (actual rows=11.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_8_26_chunk (actual rows=10.00 loops=1)
-                     ->  Index Scan using compress_hyper_10_32_chunk_dev__ts_meta_min_1__ts_meta_max__idx on compress_hyper_10_32_chunk (actual rows=10.00 loops=1)
+                     ->  Seq Scan on compress_hyper_10_32_chunk (actual rows=10.00 loops=1)
 
 RESET timescaledb.debug_skip_scan_info;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/recompress_chunk_segmentwise.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/recompress_chunk_segmentwise.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/recompress_chunk_segmentwise.out	2025-11-06 02:35:39.307068352 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/recompress_chunk_segmentwise.out	2025-11-06 02:47:50.109751652 +0000
@@ -342,9 +342,9 @@
 VACUUM ANALYZE mytab_prep;
 EXPLAIN (BUFFERS OFF, COSTS OFF) EXECUTE p1;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_9_10_chunk
-   ->  Sort
-         Sort Key: compress_hyper_10_11_chunk.a, compress_hyper_10_11_chunk.c, compress_hyper_10_11_chunk._ts_meta_min_1 DESC, compress_hyper_10_11_chunk._ts_meta_max_1 DESC
+ Sort
+   Sort Key: _hyper_9_10_chunk.a, _hyper_9_10_chunk.c, _hyper_9_10_chunk."time" DESC
+   ->  Custom Scan (ColumnarScan) on _hyper_9_10_chunk
          ->  Seq Scan on compress_hyper_10_11_chunk
 
 EXECUTE p1;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/skip_scan.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/skip_scan.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/skip_scan.out	2025-11-06 02:35:39.307068352 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/skip_scan.out	2025-11-06 02:48:18.158428867 +0000
@@ -2779,85 +2779,32 @@
 SELECT current_setting('timescaledb.enable_multikey_skipscan') AS enable_multikey_skipscan;
 -- multicolumn index with uniform order
 :PREFIX SELECT DISTINCT ON(status, region, dev, dev_name) * FROM :TABLE ORDER BY status, region, dev, dev_name;
-psql:include/skip_scan_multi_query.sql:9: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:9: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:9: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:9: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 :PREFIX SELECT DISTINCT ON(region, dev) * FROM :TABLE WHERE status = 1 ORDER BY region DESC, dev DESC;
-psql:include/skip_scan_multi_query.sql:10: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:10: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:10: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:10: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 -- index with reverse column orders (applied to non-columnstore ony)
 :PREFIX SELECT DISTINCT ON (status, region, dev) * FROM :TABLE ORDER BY status, region DESC, dev;
 :PREFIX SELECT DISTINCT ON(region, dev) * FROM :TABLE WHERE status = 1 ORDER BY region, dev DESC;
 set enable_seqscan=0;
 -- (1,N) distinct scenario
 :PREFIX SELECT DISTINCT status, dev FROM :TABLE WHERE time < 100 AND region = 'reg_1' ORDER BY 1,2;
-psql:include/skip_scan_multi_query.sql:18: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, dev NOT NULL)
 -- (N,1) distinct scenario
 :PREFIX SELECT DISTINCT dev, dev_name FROM :TABLE WHERE status = 1 AND region = 'reg_1' ORDER BY 1,2;
-psql:include/skip_scan_multi_query.sql:21: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:21: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:21: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:21: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(dev NOT NULL, dev_name NOT NULL)
 -- SELECT list order of distinct columns shouldn't matter if OBY matches index order
 :PREFIX SELECT DISTINCT dev, status, dev_name FROM :TABLE WHERE region = 'reg_2' ORDER BY status, dev, dev_name;
-psql:include/skip_scan_multi_query.sql:24: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:24: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:24: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:24: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, dev NOT NULL, dev_name NOT NULL)
 reset enable_seqscan;
 -- Basic queries
 :PREFIX SELECT DISTINCT region, dev, 'q1_3', NULL FROM :TABLE WHERE status = 1 ORDER BY region, dev;
-psql:include/skip_scan_multi_query.sql:28: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:28: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:28: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:28: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 -- DISTINCT ON queries
 :PREFIX SELECT DISTINCT ON (region, dev, dev_name) region, dev, dev_name, tableoid::regclass, 'q2_11' FROM :TABLE WHERE status = 1;
-psql:include/skip_scan_multi_query.sql:31: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:31: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:31: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:31: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 :PREFIX SELECT DISTINCT ON (region, dev, dev_name) region, dev, dev_name, int_func_immutable(), 'q2_12' FROM :TABLE WHERE status = 1;
-psql:include/skip_scan_multi_query.sql:32: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:32: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:32: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:32: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 :PREFIX SELECT DISTINCT ON (region, dev, dev_name) region, dev, dev_name, int_func_stable(), 'q2_13' FROM :TABLE WHERE status = 1;
-psql:include/skip_scan_multi_query.sql:33: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:33: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:33: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:33: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 :PREFIX SELECT DISTINCT ON (region, dev, dev_name) region, dev, dev_name, int_func_volatile(), 'q2_14' FROM :TABLE WHERE status = 1;
-psql:include/skip_scan_multi_query.sql:34: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:34: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:34: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:34: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 \qecho ordered append on :TABLE
 :PREFIX SELECT DISTINCT ON (region, dev) region, dev FROM :TABLE WHERE status = 1 AND time BETWEEN 0 AND 5000;
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 \qecho SUBSELECTS on :TABLE
 :PREFIX SELECT time, region, dev, val, 'q4_1' FROM (SELECT DISTINCT ON (region, dev) * FROM :TABLE WHERE status = 1) a;
-psql:include/skip_scan_multi_query.sql:40: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:40: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:40: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:40: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 :PREFIX SELECT NULL, region, dev, NULL, 'q4_3' FROM (SELECT DISTINCT ON (region, dev) region, dev FROM :TABLE WHERE status = 1) a;
-psql:include/skip_scan_multi_query.sql:41: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:41: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:41: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:41: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 \qecho ORDER BY
 :PREFIX SELECT time, dev, val, 'q4_1' FROM (SELECT DISTINCT ON (region, dev) * FROM :TABLE WHERE status = 1 ORDER BY region, dev) a;
-psql:include/skip_scan_multi_query.sql:44: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:44: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:44: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:44: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 -- RowCompareExpr
 :PREFIX SELECT DISTINCT ON (status, dev) * FROM :TABLE WHERE region = 'reg_1' and (status, dev) > (1,2);
 -- always false expr similar to our initial skip qual
@@ -2866,10 +2813,6 @@
 :PREFIX SELECT DISTINCT ON (status, region, dev) * FROM :TABLE WHERE dev > 20;
 -- test constants in ORDER BY
 :PREFIX SELECT DISTINCT ON (status, region, dev) * FROM :TABLE WHERE status = 1 ORDER BY status, region;
-psql:include/skip_scan_multi_query.sql:54: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:54: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:54: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:54: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 -- test distinct PathKey with sortref = 0 in PG15 due to FALSE filter not pushed into relation (should not crash in PG15)
 :PREFIX SELECT DISTINCT sq.dev FROM (SELECT status, region, dev FROM :TABLE) sq JOIN :TABLE ref
 ON (sq.dev = ref.dev) AND (sq.status = ref.status) AND (sq.region = ref.region) WHERE 1 > 2;
@@ -2878,25 +2821,13 @@
 	SELECT DISTINCT ON (region, dev) region, dev FROM :TABLE WHERE status = 1
 )
 SELECT * FROM devices;
-psql:include/skip_scan_multi_query.sql:64: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:64: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:64: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:64: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 :PREFIX WITH devices AS (
 	SELECT DISTINCT ON (region, dev) region, dev FROM :TABLE WHERE status = 1
 )
 SELECT * FROM devices ORDER BY region, dev;
-psql:include/skip_scan_multi_query.sql:69: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:69: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:69: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:69: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 -- prepared statements
 PREPARE prep AS SELECT DISTINCT ON (region, dev, dev_name) region, dev, dev_name FROM :TABLE WHERE status = 1;
 :PREFIX EXECUTE prep;
-psql:include/skip_scan_multi_query.sql:73: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:73: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:73: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
-psql:include/skip_scan_multi_query.sql:73: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 :PREFIX EXECUTE prep;
 :PREFIX EXECUTE prep;
 DEALLOCATE prep;
@@ -2908,26 +2839,14 @@
 :PREFIX SELECT time, status, region, dev, val, 'q7_2' FROM (SELECT * FROM (
     VALUES (1), (2)) a(v),
     LATERAL (SELECT DISTINCT ON (status, region, dev) * FROM :TABLE WHERE dev != a.v) b) a;
-psql:include/skip_scan_multi_query.sql:86: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:86: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:86: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:86: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
 -- RuntimeKeys
 :PREFIX SELECT time, status, region, dev, val, 'q8_1' FROM (SELECT * FROM (
     VALUES (1), (2)) a(v),
     LATERAL (SELECT DISTINCT ON (status, region, dev) * FROM :TABLE WHERE dev >= a.v) b) c;
-psql:include/skip_scan_multi_query.sql:91: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:91: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:91: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:91: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
 reset enable_seqscan;
 -- parallel query
 SELECT set_config(CASE WHEN current_setting('server_version_num')::int < 160000 THEN 'force_parallel_mode' ELSE 'debug_parallel_query' END,'on', false);
 :PREFIX SELECT DISTINCT status, region, dev FROM :TABLE ORDER BY status, region, dev;
-psql:include/skip_scan_multi_query.sql:96: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:96: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:96: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:96: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(status NOT NULL, region NOT NULL, dev NOT NULL)
 SELECT set_config(CASE WHEN current_setting('server_version_num')::int < 160000 THEN 'force_parallel_mode' ELSE 'debug_parallel_query' END,'off', false);
 \o
 RESET timescaledb.debug_skip_scan_info;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression-17.out	2025-11-06 02:35:39.310068320 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression-17.out	2025-11-06 02:48:15.337460266 +0000
@@ -445,22 +445,21 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics (actual rows=10.00 loops=1)
-         Order: metrics."time"
-         ->  Sort (actual rows=10.00 loops=1)
-               Sort Key: _hyper_1_1_chunk."time"
-               Sort Method: top-N heapsort 
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: metrics."time"
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=1728.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=720.00 loops=1)
                      ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=1.00 loops=1)
                            Filter: (device_id = 1)
                            Rows Removed by Filter: 4
-         ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk (never executed)
-               Filter: (device_id = 1)
-         ->  Sort (never executed)
-               Sort Key: _hyper_1_3_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
-                     ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
+               ->  Seq Scan on _hyper_1_2_chunk (actual rows=672.00 loops=1)
+                     Filter: (device_id = 1)
+                     Rows Removed by Filter: 2688
+               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=336.00 loops=1)
+                     ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=1.00 loops=1)
                            Filter: (device_id = 1)
+                           Rows Removed by Filter: 4
 
 RESET enable_sort;
 -- test IS NULL / IS NOT NULL
@@ -707,12 +706,12 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=5.00 loops=1)
-         Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-         Rows Removed by Filter: 3595
-         ->  Sort (actual rows=5.00 loops=1)
-               Sort Key: compress_hyper_5_15_chunk.device_id
-               Sort Method: quicksort 
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: _hyper_1_1_chunk.device_id
+         Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=5.00 loops=1)
+               Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               Rows Removed by Filter: 3595
                ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
                      Filter: ((_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone) AND (_ts_meta_max_3 >= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone))
 
@@ -1231,24 +1230,19 @@
     v1 DESC,
     time;
 --- QUERY PLAN ---
- Merge Append (actual rows=3915.00 loops=1)
+ Sort (actual rows=3915.00 loops=1)
+   Output: metrics."time", metrics.device_id, metrics.device_id_peer, metrics.v0, metrics.v1, metrics.v2, metrics.v3
    Sort Key: metrics.device_id, metrics.device_id_peer, metrics.v0, metrics.v1 DESC, metrics."time"
-   ->  Sort (actual rows=2235.00 loops=1)
-         Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0, _hyper_1_2_chunk.v1, _hyper_1_2_chunk.v2, _hyper_1_2_chunk.v3
-         Sort Key: _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0, _hyper_1_2_chunk.v1 DESC, _hyper_1_2_chunk."time"
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=3915.00 loops=1)
          ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=2235.00 loops=1)
                Output: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0, _hyper_1_2_chunk.v1, _hyper_1_2_chunk.v2, _hyper_1_2_chunk.v3
                Filter: (_hyper_1_2_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
                Rows Removed by Filter: 1125
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
-         Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.v0, _hyper_1_3_chunk.v1, _hyper_1_3_chunk.v2, _hyper_1_3_chunk.v3
-         Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-         Bulk Decompression: true
-         ->  Sort (actual rows=5.00 loops=1)
-               Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-               Sort Key: compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk._ts_meta_min_2 DESC, compress_hyper_5_16_chunk._ts_meta_max_2 DESC, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
+               Output: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.v0, _hyper_1_3_chunk.v1, _hyper_1_3_chunk.v2, _hyper_1_3_chunk.v3
+               Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+               Bulk Decompression: true
                ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
                      Filter: (compress_hyper_5_16_chunk._ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
@@ -1282,9 +1276,13 @@
                Output: _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.v0, _hyper_1_3_chunk.v1, _hyper_1_3_chunk."time"
                Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
                Bulk Decompression: true
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=1.00 loops=1)
+               ->  Sort (actual rows=1.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-                     Index Cond: (compress_hyper_5_16_chunk._ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+                     Sort Key: compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk._ts_meta_min_2 DESC, compress_hyper_5_16_chunk._ts_meta_max_2 DESC, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3
+                     Sort Method: quicksort 
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+                           Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
+                           Filter: (compress_hyper_5_16_chunk._ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
 
 -- test ordering only by segmentby columns
 -- should produce ordered path and not have sequence number in targetlist of compressed scan
@@ -1313,9 +1311,13 @@
                Output: _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer
                Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
                Bulk Decompression: true
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=1.00 loops=1)
+               ->  Sort (actual rows=1.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-                     Index Cond: (compress_hyper_5_16_chunk._ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+                     Sort Key: compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer
+                     Sort Method: quicksort 
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+                           Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
+                           Filter: (compress_hyper_5_16_chunk._ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
 
 -- should produce ordered path
 -- only referencing PREFIX_VERBOSE should work
@@ -1329,24 +1331,19 @@
     device_id_peer,
     v0;
 --- QUERY PLAN ---
- Merge Append (actual rows=3915.00 loops=1)
+ Sort (actual rows=3915.00 loops=1)
+   Output: metrics.device_id, metrics.device_id_peer, metrics.v0
    Sort Key: metrics.device_id, metrics.device_id_peer, metrics.v0
-   ->  Sort (actual rows=2235.00 loops=1)
-         Output: _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0
-         Sort Key: _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=3915.00 loops=1)
          ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=2235.00 loops=1)
                Output: _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0
                Filter: (_hyper_1_2_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
                Rows Removed by Filter: 1125
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
-         Output: _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.v0
-         Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-         Bulk Decompression: true
-         ->  Sort (actual rows=5.00 loops=1)
-               Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-               Sort Key: compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
+               Output: _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.v0
+               Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+               Bulk Decompression: true
                ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
                      Filter: (compress_hyper_5_16_chunk._ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
@@ -1365,24 +1362,19 @@
     v0,
     v1 DESC;
 --- QUERY PLAN ---
- Merge Append (actual rows=3915.00 loops=1)
+ Sort (actual rows=3915.00 loops=1)
+   Output: metrics.device_id, metrics.device_id_peer, metrics.v0, metrics.v1
    Sort Key: metrics.device_id, metrics.device_id_peer, metrics.v0, metrics.v1 DESC
-   ->  Sort (actual rows=2235.00 loops=1)
-         Output: _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0, _hyper_1_2_chunk.v1
-         Sort Key: _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0, _hyper_1_2_chunk.v1 DESC
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=3915.00 loops=1)
          ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=2235.00 loops=1)
                Output: _hyper_1_2_chunk.device_id, _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.v0, _hyper_1_2_chunk.v1
                Filter: (_hyper_1_2_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
                Rows Removed by Filter: 1125
-   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
-         Output: _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.v0, _hyper_1_3_chunk.v1
-         Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-         Bulk Decompression: true
-         ->  Sort (actual rows=5.00 loops=1)
-               Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-               Sort Key: compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk._ts_meta_min_2 DESC, compress_hyper_5_16_chunk._ts_meta_max_2 DESC
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
+               Output: _hyper_1_3_chunk.device_id, _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.v0, _hyper_1_3_chunk.v1
+               Vectorized Filter: (_hyper_1_3_chunk."time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+               Bulk Decompression: true
                ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
                      Filter: (compress_hyper_5_16_chunk._ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
@@ -1556,26 +1548,30 @@
 --- QUERY PLAN ---
  Finalize GroupAggregate (actual rows=5.00 loops=1)
    Group Key: metrics.device_id
-   ->  Merge Append (actual rows=15.00 loops=1)
+   ->  Sort (actual rows=15.00 loops=1)
          Sort Key: metrics.device_id
-         ->  Custom Scan (VectorAgg) (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=3600.00 loops=1)
-                     ->  Sort (actual rows=5.00 loops=1)
-                           Sort Key: compress_hyper_5_15_chunk.device_id
+         Sort Method: quicksort 
+         ->  Append (actual rows=15.00 loops=1)
+               ->  Partial GroupAggregate (actual rows=5.00 loops=1)
+                     Group Key: _hyper_1_1_chunk.device_id
+                     ->  Sort (actual rows=3600.00 loops=1)
+                           Sort Key: _hyper_1_1_chunk.device_id
                            Sort Method: quicksort 
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-         ->  Partial GroupAggregate (actual rows=5.00 loops=1)
-               Group Key: _hyper_1_2_chunk.device_id
-               ->  Sort (actual rows=3360.00 loops=1)
-                     Sort Key: _hyper_1_2_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_1_2_chunk (actual rows=3360.00 loops=1)
-         ->  Custom Scan (VectorAgg) (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=1680.00 loops=1)
-                     ->  Sort (actual rows=5.00 loops=1)
-                           Sort Key: compress_hyper_5_16_chunk.device_id
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=3600.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+               ->  Partial GroupAggregate (actual rows=5.00 loops=1)
+                     Group Key: _hyper_1_2_chunk.device_id
+                     ->  Sort (actual rows=3360.00 loops=1)
+                           Sort Key: _hyper_1_2_chunk.device_id
                            Sort Method: quicksort 
-                           ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+                           ->  Seq Scan on _hyper_1_2_chunk (actual rows=3360.00 loops=1)
+               ->  Partial GroupAggregate (actual rows=5.00 loops=1)
+                     Group Key: _hyper_1_3_chunk.device_id
+                     ->  Sort (actual rows=1680.00 loops=1)
+                           Sort Key: _hyper_1_3_chunk.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=1680.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
 
 -- test window functions with GROUP BY
 :PREFIX
@@ -1587,26 +1583,30 @@
  WindowAgg (actual rows=5.00 loops=1)
    ->  Finalize GroupAggregate (actual rows=5.00 loops=1)
          Group Key: metrics.device_id
-         ->  Merge Append (actual rows=15.00 loops=1)
+         ->  Sort (actual rows=15.00 loops=1)
                Sort Key: metrics.device_id
-               ->  Custom Scan (VectorAgg) (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=3600.00 loops=1)
-                           ->  Sort (actual rows=5.00 loops=1)
-                                 Sort Key: compress_hyper_5_15_chunk.device_id
+               Sort Method: quicksort 
+               ->  Append (actual rows=15.00 loops=1)
+                     ->  Partial GroupAggregate (actual rows=5.00 loops=1)
+                           Group Key: _hyper_1_1_chunk.device_id
+                           ->  Sort (actual rows=3600.00 loops=1)
+                                 Sort Key: _hyper_1_1_chunk.device_id
                                  Sort Method: quicksort 
-                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-               ->  Partial GroupAggregate (actual rows=5.00 loops=1)
-                     Group Key: _hyper_1_2_chunk.device_id
-                     ->  Sort (actual rows=3360.00 loops=1)
-                           Sort Key: _hyper_1_2_chunk.device_id
-                           Sort Method: quicksort 
-                           ->  Seq Scan on _hyper_1_2_chunk (actual rows=3360.00 loops=1)
-               ->  Custom Scan (VectorAgg) (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=1680.00 loops=1)
-                           ->  Sort (actual rows=5.00 loops=1)
-                                 Sort Key: compress_hyper_5_16_chunk.device_id
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=3600.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+                     ->  Partial GroupAggregate (actual rows=5.00 loops=1)
+                           Group Key: _hyper_1_2_chunk.device_id
+                           ->  Sort (actual rows=3360.00 loops=1)
+                                 Sort Key: _hyper_1_2_chunk.device_id
                                  Sort Method: quicksort 
-                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+                                 ->  Seq Scan on _hyper_1_2_chunk (actual rows=3360.00 loops=1)
+                     ->  Partial GroupAggregate (actual rows=5.00 loops=1)
+                           Group Key: _hyper_1_3_chunk.device_id
+                           ->  Sort (actual rows=1680.00 loops=1)
+                                 Sort Key: _hyper_1_3_chunk.device_id
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=1680.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
 
 SET enable_hashagg = ON;
 -- test CTE
@@ -2151,33 +2151,27 @@
         VALUES (1),
             (2));
 --- QUERY PLAN ---
- Nested Loop (actual rows=3456.00 loops=1)
+ Nested Loop Semi Join (actual rows=3456.00 loops=1)
    Output: metrics.device_id_peer
-   ->  Unique (actual rows=2.00 loops=1)
-         Output: "*VALUES*".column1
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               Sort Method: quicksort 
-               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-                     Output: "*VALUES*".column1
-   ->  Append (actual rows=1728.00 loops=2)
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=720.00 loops=2)
+   Join Filter: (metrics.device_id = "*VALUES*".column1)
+   Rows Removed by Join Filter: 12096
+   ->  Append (actual rows=8640.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=3600.00 loops=1)
                Output: _hyper_1_1_chunk.device_id_peer, _hyper_1_1_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_15_chunk._ts_meta_count, compress_hyper_5_15_chunk.device_id, compress_hyper_5_15_chunk.device_id_peer, compress_hyper_5_15_chunk._ts_meta_min_3, compress_hyper_5_15_chunk._ts_meta_max_3, compress_hyper_5_15_chunk."time", compress_hyper_5_15_chunk._ts_meta_min_1, compress_hyper_5_15_chunk._ts_meta_max_1, compress_hyper_5_15_chunk.v0, compress_hyper_5_15_chunk._ts_meta_min_2, compress_hyper_5_15_chunk._ts_meta_max_2, compress_hyper_5_15_chunk.v1, compress_hyper_5_15_chunk.v2, compress_hyper_5_15_chunk.v3
-                     Index Cond: (compress_hyper_5_15_chunk.device_id = "*VALUES*".column1)
-         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=672.00 loops=2)
+         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=3360.00 loops=1)
                Output: _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.device_id
-               Filter: ("*VALUES*".column1 = _hyper_1_2_chunk.device_id)
-               Rows Removed by Filter: 2688
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=336.00 loops=2)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
                Output: _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-                     Index Cond: (compress_hyper_5_16_chunk.device_id = "*VALUES*".column1)
+   ->  Materialize (actual rows=2.00 loops=8640)
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               Output: "*VALUES*".column1
 
 RESET enable_hashjoin;
 RESET enable_mergejoin;
@@ -2243,33 +2237,26 @@
         VALUES (1),
             (2));
 --- QUERY PLAN ---
- Nested Loop (actual rows=3456.00 loops=1)
+ Hash Semi Join (actual rows=3456.00 loops=1)
    Output: metrics.device_id_peer
-   ->  Unique (actual rows=2.00 loops=1)
-         Output: "*VALUES*".column1
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               Sort Method: quicksort 
-               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-                     Output: "*VALUES*".column1
-   ->  Append (actual rows=1728.00 loops=2)
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=720.00 loops=2)
+   Hash Cond: (metrics.device_id = "*VALUES*".column1)
+   ->  Append (actual rows=8640.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=3600.00 loops=1)
                Output: _hyper_1_1_chunk.device_id_peer, _hyper_1_1_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_15_chunk._ts_meta_count, compress_hyper_5_15_chunk.device_id, compress_hyper_5_15_chunk.device_id_peer, compress_hyper_5_15_chunk._ts_meta_min_3, compress_hyper_5_15_chunk._ts_meta_max_3, compress_hyper_5_15_chunk."time", compress_hyper_5_15_chunk._ts_meta_min_1, compress_hyper_5_15_chunk._ts_meta_max_1, compress_hyper_5_15_chunk.v0, compress_hyper_5_15_chunk._ts_meta_min_2, compress_hyper_5_15_chunk._ts_meta_max_2, compress_hyper_5_15_chunk.v1, compress_hyper_5_15_chunk.v2, compress_hyper_5_15_chunk.v3
-                     Index Cond: (compress_hyper_5_15_chunk.device_id = "*VALUES*".column1)
-         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=672.00 loops=2)
+         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=3360.00 loops=1)
                Output: _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.device_id
-               Filter: ("*VALUES*".column1 = _hyper_1_2_chunk.device_id)
-               Rows Removed by Filter: 2688
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=336.00 loops=2)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
                Output: _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-                     Index Cond: (compress_hyper_5_16_chunk.device_id = "*VALUES*".column1)
+   ->  Hash (actual rows=2.00 loops=1)
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               Output: "*VALUES*".column1
 
 -- test view
 CREATE OR REPLACE VIEW compressed_view AS
@@ -2361,8 +2348,7 @@
  Limit (actual rows=10.00 loops=1)
    ->  Merge Join (actual rows=10.00 loops=1)
          Merge Cond: (m1."time" = m3."time")
-         ->  Merge Join (actual rows=10.00 loops=1)
-               Merge Cond: ((m1."time" = m2."time") AND (m1.device_id = m2.device_id))
+         ->  Nested Loop (actual rows=10.00 loops=1)
                ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=10.00 loops=1)
                      Order: m1."time", m1.device_id
                      ->  Sort (actual rows=10.00 loops=1)
@@ -2377,21 +2363,24 @@
                            Sort Key: m1_3."time", m1_3.device_id
                            ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (never executed)
                                  ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
-               ->  Materialize (actual rows=10.00 loops=1)
-                     ->  Custom Scan (ChunkAppend) on metrics m2 (actual rows=10.00 loops=1)
-                           Order: m2."time", m2.device_id
-                           ->  Sort (actual rows=10.00 loops=1)
-                                 Sort Key: m2_1."time", m2_1.device_id
-                                 Sort Method: quicksort 
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=3600.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=5.00 loops=1)
-                           ->  Sort (never executed)
-                                 Sort Key: m2_2."time", m2_2.device_id
-                                 ->  Seq Scan on _hyper_1_2_chunk m2_2 (never executed)
-                           ->  Sort (never executed)
-                                 Sort Key: m2_3."time", m2_3.device_id
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (never executed)
-                                       ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (never executed)
+               ->  Memoize (actual rows=1.00 loops=10)
+                     Cache Key: m1."time", m1.device_id
+                     Cache Mode: logical
+                     Hits: 0  Misses: 10  Evictions: 0  Overflows: 0 
+                     ->  Append (actual rows=1.00 loops=10)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=1.00 loops=10)
+                                 Filter: ("time" = m1."time")
+                                 Rows Removed by Filter: 647
+                                 ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=1.00 loops=10)
+                                       Index Cond: (device_id = m1.device_id)
+                           ->  Index Scan using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m2_2 (actual rows=0.00 loops=9)
+                                 Index Cond: ("time" = m1."time")
+                                 Filter: (m1.device_id = device_id)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (actual rows=0.00 loops=9)
+                                 Filter: ("time" = m1."time")
+                                 Rows Removed by Filter: 336
+                                 ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (actual rows=1.00 loops=9)
+                                       Index Cond: (device_id = m1.device_id)
          ->  Materialize (actual rows=10.00 loops=1)
                ->  Merge Append (actual rows=3.00 loops=1)
                      Sort Key: m3."time"
@@ -2574,12 +2563,22 @@
                Hash Cond: (m1."time" = m2."time")
                Join Filter: (m1.device_id = 1)
                Rows Removed by Join Filter: 6912
-               ->  Append (actual rows=8640.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-                     ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=8640.00 loops=1)
+                     Order: m1."time", m1.device_id
+                     ->  Sort (actual rows=3600.00 loops=1)
+                           Sort Key: m1_1."time", m1_1.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=3360.00 loops=1)
+                           Sort Key: m1_2."time", m1_2.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
+                     ->  Sort (actual rows=1680.00 loops=1)
+                           Sort Key: m1_3."time", m1_3.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                ->  Hash (actual rows=1728.00 loops=1)
                      ->  Append (actual rows=1728.00 loops=1)
                            ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=720.00 loops=1)
@@ -2610,46 +2609,78 @@
    ->  Sort (actual rows=100.00 loops=1)
          Sort Key: m1."time", m1.device_id, m2."time", m2.device_id
          Sort Method: top-N heapsort 
-         ->  Hash Left Join (actual rows=8640.00 loops=1)
-               Hash Cond: (m1."time" = m2."time")
+         ->  Merge Left Join (actual rows=8640.00 loops=1)
+               Merge Cond: (m1."time" = m2."time")
                Join Filter: (m1.device_id = 1)
                Rows Removed by Join Filter: 6912
-               ->  Append (actual rows=8640.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-                     ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
-               ->  Hash (actual rows=1728.00 loops=1)
-                     ->  Append (actual rows=1728.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m2_1 (actual rows=0.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=0.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 1
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_2 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 2
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m2_3 (actual rows=0.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=0.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 1
-                           ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_device_id_time_idx on _hyper_2_7_chunk m2_4 (actual rows=0.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                           ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_5 (actual rows=672.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                           ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_device_id_time_idx on _hyper_2_9_chunk m2_6 (actual rows=0.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m2_7 (actual rows=0.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=0.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 1
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_8 (actual rows=336.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 2
-                           ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_device_id_time_idx on _hyper_2_12_chunk m2_9 (actual rows=0.00 loops=1)
-                                 Index Cond: (device_id = 2)
+               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=8640.00 loops=1)
+                     Order: m1."time", m1.device_id
+                     ->  Sort (actual rows=3600.00 loops=1)
+                           Sort Key: m1_1."time", m1_1.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=3360.00 loops=1)
+                           Sort Key: m1_2."time", m1_2.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
+                     ->  Sort (actual rows=1680.00 loops=1)
+                           Sort Key: m1_3."time", m1_3.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+               ->  Materialize (actual rows=8636.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=1728.00 loops=1)
+                           Order: m2."time"
+                           ->  Merge Append (actual rows=720.00 loops=1)
+                                 Sort Key: m2."time"
+                                 ->  Sort (actual rows=0.00 loops=1)
+                                       Sort Key: m2_1."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m2_1 (actual rows=0.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=0.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 1
+                                 ->  Sort (actual rows=720.00 loops=1)
+                                       Sort Key: m2_2."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_2 (actual rows=720.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 2
+                                 ->  Sort (actual rows=0.00 loops=1)
+                                       Sort Key: m2_3."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m2_3 (actual rows=0.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=0.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 1
+                           ->  Merge Append (actual rows=672.00 loops=1)
+                                 Sort Key: m2."time"
+                                 ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_device_id_time_idx on _hyper_2_7_chunk m2_4 (actual rows=0.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                                 ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_5 (actual rows=672.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                                 ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_device_id_time_idx on _hyper_2_9_chunk m2_6 (actual rows=0.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Merge Append (actual rows=336.00 loops=1)
+                                 Sort Key: m2."time"
+                                 ->  Sort (actual rows=0.00 loops=1)
+                                       Sort Key: m2_7."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m2_7 (actual rows=0.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=0.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 1
+                                 ->  Sort (actual rows=336.00 loops=1)
+                                       Sort Key: m2_8."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_8 (actual rows=336.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 2
+                                 ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_device_id_time_idx on _hyper_2_12_chunk m2_9 (actual rows=0.00 loops=1)
+                                       Index Cond: (device_id = 2)
 
 -- test implicit self-join
 :PREFIX
@@ -2667,21 +2698,38 @@
    ->  Sort (actual rows=20.00 loops=1)
          Sort Key: m1."time", m1.device_id, m2.device_id
          Sort Method: top-N heapsort 
-         ->  Hash Join (actual rows=43200.00 loops=1)
-               Hash Cond: (m1."time" = m2."time")
-               ->  Append (actual rows=8640.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-                     ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
-               ->  Hash (actual rows=8640.00 loops=1)
-                     ->  Append (actual rows=8640.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=3600.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=5.00 loops=1)
-                           ->  Seq Scan on _hyper_1_2_chunk m2_2 (actual rows=3360.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (actual rows=1680.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (actual rows=5.00 loops=1)
+         ->  Merge Join (actual rows=43200.00 loops=1)
+               Merge Cond: (m1."time" = m2."time")
+               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=8640.00 loops=1)
+                     Order: m1."time", m1.device_id
+                     ->  Sort (actual rows=3600.00 loops=1)
+                           Sort Key: m1_1."time", m1_1.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=3360.00 loops=1)
+                           Sort Key: m1_2."time", m1_2.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
+                     ->  Sort (actual rows=1680.00 loops=1)
+                           Sort Key: m1_3."time", m1_3.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+               ->  Materialize (actual rows=43196.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics m2 (actual rows=8640.00 loops=1)
+                           Order: m2."time"
+                           ->  Sort (actual rows=3600.00 loops=1)
+                                 Sort Key: m2_1."time"
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=3600.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=5.00 loops=1)
+                           ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m2_2 (actual rows=3360.00 loops=1)
+                           ->  Sort (actual rows=1680.00 loops=1)
+                                 Sort Key: m2_3."time"
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (actual rows=1680.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (actual rows=5.00 loops=1)
 
 -- test self-join with sub-query
 :PREFIX
@@ -2701,21 +2749,38 @@
    ->  Sort (actual rows=10.00 loops=1)
          Sort Key: m1."time", m1.device_id, m2.device_id
          Sort Method: top-N heapsort 
-         ->  Hash Join (actual rows=43200.00 loops=1)
-               Hash Cond: (m1."time" = m2."time")
-               ->  Append (actual rows=8640.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-                     ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
-               ->  Hash (actual rows=8640.00 loops=1)
-                     ->  Append (actual rows=8640.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=3600.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=5.00 loops=1)
-                           ->  Seq Scan on _hyper_1_2_chunk m2_2 (actual rows=3360.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (actual rows=1680.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (actual rows=5.00 loops=1)
+         ->  Merge Join (actual rows=43200.00 loops=1)
+               Merge Cond: (m1."time" = m2."time")
+               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=8640.00 loops=1)
+                     Order: m1."time", m1.device_id
+                     ->  Sort (actual rows=3600.00 loops=1)
+                           Sort Key: m1_1."time", m1_1.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=3360.00 loops=1)
+                           Sort Key: m1_2."time", m1_2.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
+                     ->  Sort (actual rows=1680.00 loops=1)
+                           Sort Key: m1_3."time", m1_3.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+               ->  Materialize (actual rows=43196.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics m2 (actual rows=8640.00 loops=1)
+                           Order: m2."time"
+                           ->  Sort (actual rows=3600.00 loops=1)
+                                 Sort Key: m2_1."time"
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=3600.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=5.00 loops=1)
+                           ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m2_2 (actual rows=3360.00 loops=1)
+                           ->  Sort (actual rows=1680.00 loops=1)
+                                 Sort Key: m2_3."time"
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (actual rows=1680.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (actual rows=5.00 loops=1)
 
 :PREFIX
 SELECT *
@@ -2966,20 +3031,24 @@
          ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=1008.00 loops=1)
                ->  Index Scan using compress_hyper_6_21_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_6_21_chunk (actual rows=3.00 loops=1)
          ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_device_id_device_id_peer_v0_v_2 on _hyper_2_12_chunk (actual rows=336.00 loops=1)
-   ->  Append (actual rows=0.00 loops=8640)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=0.00 loops=8640)
-               Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
-               Rows Removed by Filter: 720
-               ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_15_chunk (actual rows=1.00 loops=8640)
-                     Index Cond: (device_id = metrics_space.device_id)
-         ->  Index Scan using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk (actual rows=0.00 loops=8640)
-               Index Cond: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
-               Filter: (metrics_space.device_id = device_id)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=0.00 loops=8640)
-               Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
-               Rows Removed by Filter: 336
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_16_chunk (actual rows=1.00 loops=8640)
-                     Index Cond: (device_id = metrics_space.device_id)
+   ->  Memoize (actual rows=0.00 loops=8640)
+         Cache Key: metrics_space."time", metrics_space.device_id
+         Cache Mode: binary
+         Hits: 0  Misses: 8640  Evictions: 0  Overflows: 0 
+         ->  Append (actual rows=0.00 loops=8640)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=0.00 loops=8640)
+                     Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
+                     Rows Removed by Filter: 720
+                     ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_15_chunk (actual rows=1.00 loops=8640)
+                           Index Cond: (device_id = metrics_space.device_id)
+               ->  Index Scan using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk (actual rows=0.00 loops=8640)
+                     Index Cond: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
+                     Filter: (metrics_space.device_id = device_id)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=0.00 loops=8640)
+                     Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
+                     Rows Removed by Filter: 336
+                     ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_16_chunk (actual rows=1.00 loops=8640)
+                           Index Cond: (device_id = metrics_space.device_id)
 
 SET enable_seqscan = TRUE;
 SET enable_bitmapscan = TRUE;
@@ -3401,69 +3470,38 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=0.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space (actual rows=0.00 loops=1)
-         Order: metrics_space."time", metrics_space.device_id
-         ->  Merge Append (actual rows=0.00 loops=1)
-               Sort Key: metrics_space."time", metrics_space.device_id
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_4_chunk."time", _hyper_2_4_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=0.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=0.00 loops=1)
-                                 Filter: (device_id IS NULL)
-                                 Rows Removed by Filter: 1
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_5_chunk."time", _hyper_2_5_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=0.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=0.00 loops=1)
-                                 Filter: (device_id IS NULL)
-                                 Rows Removed by Filter: 3
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_6_chunk."time", _hyper_2_6_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=0.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=0.00 loops=1)
-                                 Filter: (device_id IS NULL)
-                                 Rows Removed by Filter: 1
-         ->  Merge Append (actual rows=0.00 loops=1)
-               Sort Key: metrics_space."time", metrics_space.device_id
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_7_chunk."time", _hyper_2_7_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Index Scan using _hyper_2_7_chunk_metrics_space_device_id_device_id_peer_v0_v1_2 on _hyper_2_7_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (device_id IS NULL)
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_8_chunk."time", _hyper_2_8_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Index Scan using _hyper_2_8_chunk_metrics_space_device_id_device_id_peer_v0_v1_2 on _hyper_2_8_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (device_id IS NULL)
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_9_chunk."time", _hyper_2_9_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Index Scan using _hyper_2_9_chunk_metrics_space_device_id_device_id_peer_v0_v1_2 on _hyper_2_9_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (device_id IS NULL)
-         ->  Merge Append (actual rows=0.00 loops=1)
-               Sort Key: metrics_space."time", metrics_space.device_id
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_10_chunk."time", _hyper_2_10_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk (actual rows=0.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=0.00 loops=1)
-                                 Filter: (device_id IS NULL)
-                                 Rows Removed by Filter: 1
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_11_chunk."time", _hyper_2_11_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=0.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=0.00 loops=1)
-                                 Filter: (device_id IS NULL)
-                                 Rows Removed by Filter: 3
-               ->  Sort (actual rows=0.00 loops=1)
-                     Sort Key: _hyper_2_12_chunk."time", _hyper_2_12_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Index Scan using _hyper_2_12_chunk_metrics_space_device_id_device_id_peer_v0_v_2 on _hyper_2_12_chunk (actual rows=0.00 loops=1)
-                           Index Cond: (device_id IS NULL)
+   ->  Sort (actual rows=0.00 loops=1)
+         Sort Key: metrics_space."time", metrics_space.device_id
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=0.00 loops=1)
+                           Filter: (device_id IS NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=0.00 loops=1)
+                           Filter: (device_id IS NULL)
+                           Rows Removed by Filter: 3
+               ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=0.00 loops=1)
+                           Filter: (device_id IS NULL)
+                           Rows Removed by Filter: 1
+               ->  Index Scan using _hyper_2_7_chunk_metrics_space_device_id_device_id_peer_v0_v1_2 on _hyper_2_7_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (device_id IS NULL)
+               ->  Index Scan using _hyper_2_8_chunk_metrics_space_device_id_device_id_peer_v0_v1_2 on _hyper_2_8_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (device_id IS NULL)
+               ->  Index Scan using _hyper_2_9_chunk_metrics_space_device_id_device_id_peer_v0_v1_2 on _hyper_2_9_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (device_id IS NULL)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=0.00 loops=1)
+                           Filter: (device_id IS NULL)
+                           Rows Removed by Filter: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=0.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=0.00 loops=1)
+                           Filter: (device_id IS NULL)
+                           Rows Removed by Filter: 3
+               ->  Index Scan using _hyper_2_12_chunk_metrics_space_device_id_device_id_peer_v0_v_2 on _hyper_2_12_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (device_id IS NULL)
 
 -- test IN (Const,Const)
 :PREFIX
@@ -3774,30 +3812,23 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: metrics_space.device_id
-         ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=1.00 loops=1)
-               Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               Rows Removed by Filter: 719
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_17_chunk.device_id
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=1.00 loops=1)
+                     Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 719
                      ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
                            Filter: ((_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone) AND (_ts_meta_max_3 >= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=3.00 loops=1)
-               Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               Rows Removed by Filter: 2157
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: compress_hyper_6_18_chunk.device_id
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=3.00 loops=1)
+                     Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 2157
                      ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
                            Filter: ((_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone) AND (_ts_meta_max_3 >= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=1.00 loops=1)
-               Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               Rows Removed by Filter: 719
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_6_19_chunk.device_id
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=1.00 loops=1)
+                     Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 719
                      ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
                            Filter: ((_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone) AND (_ts_meta_max_3 >= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone))
 
@@ -3810,34 +3841,25 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space (actual rows=10.00 loops=1)
-         Order: metrics_space."time", metrics_space.device_id
-         ->  Merge Append (actual rows=10.00 loops=1)
-               Sort Key: metrics_space."time", metrics_space.device_id
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_4_chunk."time", _hyper_2_4_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=6.00 loops=1)
-                           Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 714
-                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=6.00 loops=1)
-                     Sort Key: _hyper_2_5_chunk."time", _hyper_2_5_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=18.00 loops=1)
-                           Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 2142
-                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
-                                 Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_6_chunk."time", _hyper_2_6_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=6.00 loops=1)
-                           Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 714
-                           ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: metrics_space."time", metrics_space.device_id
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=6.00 loops=1)
+                     Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 714
+                     ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=18.00 loops=1)
+                     Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 2142
+                     ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
+                           Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=6.00 loops=1)
+                     Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 714
+                     ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX
 SELECT *
@@ -3848,34 +3870,25 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space (actual rows=10.00 loops=1)
-         Order: metrics_space."time", metrics_space.device_id
-         ->  Merge Append (actual rows=10.00 loops=1)
-               Sort Key: metrics_space."time", metrics_space.device_id
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_4_chunk."time", _hyper_2_4_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=7.00 loops=1)
-                           Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 713
-                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=6.00 loops=1)
-                     Sort Key: _hyper_2_5_chunk."time", _hyper_2_5_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=21.00 loops=1)
-                           Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 2139
-                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
-                                 Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_6_chunk."time", _hyper_2_6_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=7.00 loops=1)
-                           Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 713
-                           ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: metrics_space."time", metrics_space.device_id
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=35.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=7.00 loops=1)
+                     Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 713
+                     ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=21.00 loops=1)
+                     Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 2139
+                     ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
+                           Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=7.00 loops=1)
+                     Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 713
+                     ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX
 SELECT *
@@ -5570,38 +5583,38 @@
    ->  Custom Scan (ChunkAppend) on metrics_space (actual rows=1728.00 loops=1)
          Order: metrics_space."time"
          ->  Sort (actual rows=720.00 loops=1)
-               Sort Key: _hyper_2_5_chunk."time"
+               Sort Key: _hyper_2_4_chunk."time"
                Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=720.00 loops=1)
-                     ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
-                           Filter: (device_id = 2)
-                           Rows Removed by Filter: 2
-         ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk (actual rows=672.00 loops=1)
-               Index Cond: (device_id = 2)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=720.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+         ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk (actual rows=672.00 loops=1)
+               Filter: (device_id = 1)
          ->  Sort (actual rows=336.00 loops=1)
-               Sort Key: _hyper_2_11_chunk."time"
+               Sort Key: _hyper_2_10_chunk."time"
                Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=336.00 loops=1)
-                     ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
-                           Filter: (device_id = 2)
-                           Rows Removed by Filter: 2
+               ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk (actual rows=336.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
    ->  Materialize (actual rows=1728.00 loops=1)
          ->  Custom Scan (ChunkAppend) on metrics_space metrics_space_1 (actual rows=1728.00 loops=1)
                Order: metrics_space_1."time"
                ->  Sort (actual rows=720.00 loops=1)
-                     Sort Key: _hyper_2_4_chunk."time"
+                     Sort Key: _hyper_2_5_chunk."time"
                      Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=720.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-               ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk (actual rows=672.00 loops=1)
-                     Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=720.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 2
+               ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk (actual rows=672.00 loops=1)
+                     Index Cond: (device_id = 2)
                ->  Sort (actual rows=336.00 loops=1)
-                     Sort Key: _hyper_2_10_chunk."time"
+                     Sort Key: _hyper_2_11_chunk."time"
                      Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk (actual rows=336.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=336.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 2
 
 :PREFIX WITH q1 AS (
     SELECT time,
@@ -6375,7 +6388,9 @@
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
    ->  Merge Join (actual rows=10.00 loops=1)
-         Merge Cond: ((m1."time" = m2."time") AND (m1.device_id = m2.device_id))
+         Merge Cond: (m1."time" = m2."time")
+         Join Filter: (m1.device_id = m2.device_id)
+         Rows Removed by Join Filter: 40
          ->  Custom Scan (ChunkAppend) on metrics_space m1 (actual rows=10.00 loops=1)
                Order: m1."time", m1.device_id
                ->  Merge Append (actual rows=10.00 loops=1)
@@ -6419,17 +6434,17 @@
                      ->  Sort (never executed)
                            Sort Key: m1_9."time", m1_9.device_id
                            ->  Seq Scan on _hyper_2_12_chunk m1_9 (never executed)
-         ->  Materialize (actual rows=10.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=10.00 loops=1)
-                     Order: m2."time", m2.device_id
-                     ->  Merge Append (actual rows=10.00 loops=1)
-                           Sort Key: m2."time", m2.device_id
+         ->  Materialize (actual rows=50.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=11.00 loops=1)
+                     Order: m2."time"
+                     ->  Merge Append (actual rows=11.00 loops=1)
+                           Sort Key: m2."time"
                            ->  Sort (actual rows=3.00 loops=1)
                                  Sort Key: m2_1."time", m2_1.device_id
                                  Sort Method: quicksort 
                                  ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m2_1 (actual rows=720.00 loops=1)
                                        ->  Seq Scan on compress_hyper_6_17_chunk compress_hyper_6_17_chunk_1 (actual rows=1.00 loops=1)
-                           ->  Sort (actual rows=6.00 loops=1)
+                           ->  Sort (actual rows=7.00 loops=1)
                                  Sort Key: m2_2."time", m2_2.device_id
                                  Sort Method: quicksort 
                                  ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_2 (actual rows=2160.00 loops=1)
@@ -6440,18 +6455,12 @@
                                  ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m2_3 (actual rows=720.00 loops=1)
                                        ->  Seq Scan on compress_hyper_6_19_chunk compress_hyper_6_19_chunk_1 (actual rows=1.00 loops=1)
                      ->  Merge Append (never executed)
-                           Sort Key: m2."time", m2.device_id
-                           ->  Sort (never executed)
-                                 Sort Key: m2_4."time", m2_4.device_id
-                                 ->  Seq Scan on _hyper_2_7_chunk m2_4 (never executed)
-                           ->  Sort (never executed)
-                                 Sort Key: m2_5."time", m2_5.device_id
-                                 ->  Seq Scan on _hyper_2_8_chunk m2_5 (never executed)
-                           ->  Sort (never executed)
-                                 Sort Key: m2_6."time", m2_6.device_id
-                                 ->  Seq Scan on _hyper_2_9_chunk m2_6 (never executed)
+                           Sort Key: m2."time"
+                           ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk m2_4 (never executed)
+                           ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_time_idx on _hyper_2_8_chunk m2_5 (never executed)
+                           ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_time_idx on _hyper_2_9_chunk m2_6 (never executed)
                      ->  Merge Append (never executed)
-                           Sort Key: m2."time", m2.device_id
+                           Sort Key: m2."time"
                            ->  Sort (never executed)
                                  Sort Key: m2_7."time", m2_7.device_id
                                  ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m2_7 (never executed)
@@ -6460,9 +6469,7 @@
                                  Sort Key: m2_8."time", m2_8.device_id
                                  ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_8 (never executed)
                                        ->  Seq Scan on compress_hyper_6_21_chunk compress_hyper_6_21_chunk_1 (never executed)
-                           ->  Sort (never executed)
-                                 Sort Key: m2_9."time", m2_9.device_id
-                                 ->  Seq Scan on _hyper_2_12_chunk m2_9 (never executed)
+                           ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_time_idx on _hyper_2_12_chunk m2_9 (never executed)
 
 :PREFIX
 SELECT *
@@ -6477,109 +6484,103 @@
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
    ->  Merge Join (actual rows=10.00 loops=1)
-         Merge Cond: ((m2."time" = m1."time") AND (m2.device_id = m1.device_id))
-         ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=10.00 loops=1)
-               Order: m2."time", m2.device_id
-               ->  Merge Append (actual rows=10.00 loops=1)
-                     Sort Key: m2."time", m2.device_id
-                     ->  Sort (actual rows=3.00 loops=1)
-                           Sort Key: m2_1."time", m2_1.device_id
-                           Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m2_1 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_17_chunk compress_hyper_6_17_chunk_1 (actual rows=1.00 loops=1)
-                     ->  Sort (actual rows=6.00 loops=1)
-                           Sort Key: m2_2."time", m2_2.device_id
-                           Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_2 (actual rows=2160.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_18_chunk compress_hyper_6_18_chunk_1 (actual rows=3.00 loops=1)
-                     ->  Sort (actual rows=3.00 loops=1)
-                           Sort Key: m2_3."time", m2_3.device_id
-                           Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m2_3 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_19_chunk compress_hyper_6_19_chunk_1 (actual rows=1.00 loops=1)
-               ->  Merge Append (never executed)
-                     Sort Key: m2."time", m2.device_id
-                     ->  Sort (never executed)
-                           Sort Key: m2_4."time", m2_4.device_id
-                           ->  Seq Scan on _hyper_2_7_chunk m2_4 (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: m2_5."time", m2_5.device_id
-                           ->  Seq Scan on _hyper_2_8_chunk m2_5 (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: m2_6."time", m2_6.device_id
-                           ->  Seq Scan on _hyper_2_9_chunk m2_6 (never executed)
-               ->  Merge Append (never executed)
-                     Sort Key: m2."time", m2.device_id
-                     ->  Sort (never executed)
-                           Sort Key: m2_7."time", m2_7.device_id
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m2_7 (never executed)
-                                 ->  Seq Scan on compress_hyper_6_20_chunk compress_hyper_6_20_chunk_1 (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: m2_8."time", m2_8.device_id
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_8 (never executed)
-                                 ->  Seq Scan on compress_hyper_6_21_chunk compress_hyper_6_21_chunk_1 (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: m2_9."time", m2_9.device_id
-                           ->  Seq Scan on _hyper_2_12_chunk m2_9 (never executed)
-         ->  Materialize (actual rows=10.00 loops=1)
-               ->  Merge Join (actual rows=10.00 loops=1)
-                     Merge Cond: (m1."time" = m3."time")
-                     ->  Custom Scan (ChunkAppend) on metrics_space m1 (actual rows=10.00 loops=1)
-                           Order: m1."time", m1.device_id
-                           ->  Merge Append (actual rows=10.00 loops=1)
-                                 Sort Key: m1."time", m1.device_id
+         Merge Cond: (m1."time" = m3."time")
+         ->  Merge Join (actual rows=10.00 loops=1)
+               Merge Cond: (m1."time" = m2."time")
+               Join Filter: (m1.device_id = m2.device_id)
+               Rows Removed by Join Filter: 40
+               ->  Custom Scan (ChunkAppend) on metrics_space m1 (actual rows=10.00 loops=1)
+                     Order: m1."time", m1.device_id
+                     ->  Merge Append (actual rows=10.00 loops=1)
+                           Sort Key: m1."time", m1.device_id
+                           ->  Sort (actual rows=3.00 loops=1)
+                                 Sort Key: m1_1."time", m1_1.device_id
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m1_1 (actual rows=720.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                           ->  Sort (actual rows=6.00 loops=1)
+                                 Sort Key: m1_2."time", m1_2.device_id
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m1_2 (actual rows=2160.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
+                           ->  Sort (actual rows=3.00 loops=1)
+                                 Sort Key: m1_3."time", m1_3.device_id
+                                 Sort Method: quicksort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m1_3 (actual rows=720.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
+                     ->  Merge Append (never executed)
+                           Sort Key: m1."time", m1.device_id
+                           ->  Sort (never executed)
+                                 Sort Key: m1_4."time", m1_4.device_id
+                                 ->  Seq Scan on _hyper_2_7_chunk m1_4 (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: m1_5."time", m1_5.device_id
+                                 ->  Seq Scan on _hyper_2_8_chunk m1_5 (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: m1_6."time", m1_6.device_id
+                                 ->  Seq Scan on _hyper_2_9_chunk m1_6 (never executed)
+                     ->  Merge Append (never executed)
+                           Sort Key: m1."time", m1.device_id
+                           ->  Sort (never executed)
+                                 Sort Key: m1_7."time", m1_7.device_id
+                                 ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m1_7 (never executed)
+                                       ->  Seq Scan on compress_hyper_6_20_chunk (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: m1_8."time", m1_8.device_id
+                                 ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m1_8 (never executed)
+                                       ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: m1_9."time", m1_9.device_id
+                                 ->  Seq Scan on _hyper_2_12_chunk m1_9 (never executed)
+               ->  Materialize (actual rows=50.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=11.00 loops=1)
+                           Order: m2."time"
+                           ->  Merge Append (actual rows=11.00 loops=1)
+                                 Sort Key: m2."time"
                                  ->  Sort (actual rows=3.00 loops=1)
-                                       Sort Key: m1_1."time", m1_1.device_id
+                                       Sort Key: m2_1."time", m2_1.device_id
                                        Sort Method: quicksort 
-                                       ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m1_1 (actual rows=720.00 loops=1)
-                                             ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                 ->  Sort (actual rows=6.00 loops=1)
-                                       Sort Key: m1_2."time", m1_2.device_id
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m2_1 (actual rows=720.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_17_chunk compress_hyper_6_17_chunk_1 (actual rows=1.00 loops=1)
+                                 ->  Sort (actual rows=7.00 loops=1)
+                                       Sort Key: m2_2."time", m2_2.device_id
                                        Sort Method: quicksort 
-                                       ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m1_2 (actual rows=2160.00 loops=1)
-                                             ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_2 (actual rows=2160.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_18_chunk compress_hyper_6_18_chunk_1 (actual rows=3.00 loops=1)
                                  ->  Sort (actual rows=3.00 loops=1)
-                                       Sort Key: m1_3."time", m1_3.device_id
+                                       Sort Key: m2_3."time", m2_3.device_id
                                        Sort Method: quicksort 
-                                       ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m1_3 (actual rows=720.00 loops=1)
-                                             ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m2_3 (actual rows=720.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_19_chunk compress_hyper_6_19_chunk_1 (actual rows=1.00 loops=1)
                            ->  Merge Append (never executed)
-                                 Sort Key: m1."time", m1.device_id
-                                 ->  Sort (never executed)
-                                       Sort Key: m1_4."time", m1_4.device_id
-                                       ->  Seq Scan on _hyper_2_7_chunk m1_4 (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: m1_5."time", m1_5.device_id
-                                       ->  Seq Scan on _hyper_2_8_chunk m1_5 (never executed)
-                                 ->  Sort (never executed)
-                                       Sort Key: m1_6."time", m1_6.device_id
-                                       ->  Seq Scan on _hyper_2_9_chunk m1_6 (never executed)
+                                 Sort Key: m2."time"
+                                 ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk m2_4 (never executed)
+                                 ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_time_idx on _hyper_2_8_chunk m2_5 (never executed)
+                                 ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_time_idx on _hyper_2_9_chunk m2_6 (never executed)
                            ->  Merge Append (never executed)
-                                 Sort Key: m1."time", m1.device_id
-                                 ->  Sort (never executed)
-                                       Sort Key: m1_7."time", m1_7.device_id
-                                       ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m1_7 (never executed)
-                                             ->  Seq Scan on compress_hyper_6_20_chunk (never executed)
+                                 Sort Key: m2."time"
                                  ->  Sort (never executed)
-                                       Sort Key: m1_8."time", m1_8.device_id
-                                       ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m1_8 (never executed)
-                                             ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
+                                       Sort Key: m2_7."time", m2_7.device_id
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m2_7 (never executed)
+                                             ->  Seq Scan on compress_hyper_6_20_chunk compress_hyper_6_20_chunk_1 (never executed)
                                  ->  Sort (never executed)
-                                       Sort Key: m1_9."time", m1_9.device_id
-                                       ->  Seq Scan on _hyper_2_12_chunk m1_9 (never executed)
-                     ->  Materialize (actual rows=10.00 loops=1)
-                           ->  Merge Append (actual rows=3.00 loops=1)
-                                 Sort Key: m3."time"
-                                 ->  Sort (actual rows=3.00 loops=1)
-                                       Sort Key: m3_1."time"
-                                       Sort Method: quicksort 
-                                       ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m3_1 (actual rows=720.00 loops=1)
-                                             ->  Seq Scan on compress_hyper_6_19_chunk compress_hyper_6_19_chunk_2 (actual rows=1.00 loops=1)
-                                                   Filter: (device_id = 3)
-                                 ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_time_idx on _hyper_2_9_chunk m3_2 (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 3)
-                                 ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_time_idx on _hyper_2_12_chunk m3_3 (actual rows=1.00 loops=1)
+                                       Sort Key: m2_8."time", m2_8.device_id
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_8 (never executed)
+                                             ->  Seq Scan on compress_hyper_6_21_chunk compress_hyper_6_21_chunk_1 (never executed)
+                                 ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_time_idx on _hyper_2_12_chunk m2_9 (never executed)
+         ->  Materialize (actual rows=10.00 loops=1)
+               ->  Merge Append (actual rows=3.00 loops=1)
+                     Sort Key: m3."time"
+                     ->  Sort (actual rows=3.00 loops=1)
+                           Sort Key: m3_1."time"
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m3_1 (actual rows=720.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_19_chunk compress_hyper_6_19_chunk_2 (actual rows=1.00 loops=1)
                                        Filter: (device_id = 3)
+                     ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_time_idx on _hyper_2_9_chunk m3_2 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 3)
+                     ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_time_idx on _hyper_2_12_chunk m3_3 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 3)
 
 :PREFIX
 SELECT *
@@ -6595,39 +6596,39 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (m2."time" = m1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=100.00 loops=1)
-               Order: m2."time"
+         Merge Cond: (m1."time" = m2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_space m1 (actual rows=100.00 loops=1)
+               Order: m1."time"
                ->  Sort (actual rows=100.00 loops=1)
-                     Sort Key: m2_1."time"
+                     Sort Key: m1_1."time"
                      Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_1 (actual rows=720.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 2)
-                                 Rows Removed by Filter: 2
-               ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_2 (never executed)
-                     Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m1_1 (actual rows=720.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 1)
+               ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk m1_2 (never executed)
+                     Filter: (device_id = 1)
                ->  Sort (never executed)
-                     Sort Key: m2_3."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_3 (never executed)
-                           ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
-                                 Filter: (device_id = 2)
+                     Sort Key: m1_3."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m1_3 (never executed)
+                           ->  Seq Scan on compress_hyper_6_20_chunk (never executed)
+                                 Filter: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_space m1 (actual rows=100.00 loops=1)
-                     Order: m1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=100.00 loops=1)
+                     Order: m2."time"
                      ->  Sort (actual rows=100.00 loops=1)
-                           Sort Key: m1_1."time"
+                           Sort Key: m2_1."time"
                            Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m1_1 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 1)
-                     ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk m1_2 (never executed)
-                           Filter: (device_id = 1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_1 (actual rows=720.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
+                                       Filter: (device_id = 2)
+                                       Rows Removed by Filter: 2
+                     ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_2 (never executed)
+                           Index Cond: (device_id = 2)
                      ->  Sort (never executed)
-                           Sort Key: m1_3."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m1_3 (never executed)
-                                 ->  Seq Scan on compress_hyper_6_20_chunk (never executed)
-                                       Filter: (device_id = 1)
+                           Sort Key: m2_3."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_3 (never executed)
+                                 ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
+                                       Filter: (device_id = 2)
 
 :PREFIX
 SELECT *
@@ -6855,46 +6856,78 @@
    ->  Sort (actual rows=100.00 loops=1)
          Sort Key: m1."time", m1.device_id, m2."time", m2.device_id
          Sort Method: top-N heapsort 
-         ->  Hash Left Join (actual rows=8640.00 loops=1)
-               Hash Cond: (m1."time" = m2."time")
+         ->  Merge Left Join (actual rows=8640.00 loops=1)
+               Merge Cond: (m1."time" = m2."time")
                Join Filter: (m1.device_id = 1)
                Rows Removed by Join Filter: 6912
-               ->  Append (actual rows=8640.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-                     ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
-               ->  Hash (actual rows=1728.00 loops=1)
-                     ->  Append (actual rows=1728.00 loops=1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m2_1 (actual rows=0.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=0.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 1
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_2 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 2
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m2_3 (actual rows=0.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=0.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 1
-                           ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_device_id_time_idx on _hyper_2_7_chunk m2_4 (actual rows=0.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                           ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_5 (actual rows=672.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                           ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_device_id_time_idx on _hyper_2_9_chunk m2_6 (actual rows=0.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m2_7 (actual rows=0.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=0.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 1
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_8 (actual rows=336.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 2
-                           ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_device_id_time_idx on _hyper_2_12_chunk m2_9 (actual rows=0.00 loops=1)
-                                 Index Cond: (device_id = 2)
+               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=8640.00 loops=1)
+                     Order: m1."time", m1.device_id
+                     ->  Sort (actual rows=3600.00 loops=1)
+                           Sort Key: m1_1."time", m1_1.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=3360.00 loops=1)
+                           Sort Key: m1_2."time", m1_2.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
+                     ->  Sort (actual rows=1680.00 loops=1)
+                           Sort Key: m1_3."time", m1_3.device_id
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
+               ->  Materialize (actual rows=8636.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=1728.00 loops=1)
+                           Order: m2."time"
+                           ->  Merge Append (actual rows=720.00 loops=1)
+                                 Sort Key: m2."time"
+                                 ->  Sort (actual rows=0.00 loops=1)
+                                       Sort Key: m2_1."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m2_1 (actual rows=0.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=0.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 1
+                                 ->  Sort (actual rows=720.00 loops=1)
+                                       Sort Key: m2_2."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_2 (actual rows=720.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 2
+                                 ->  Sort (actual rows=0.00 loops=1)
+                                       Sort Key: m2_3."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk m2_3 (actual rows=0.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=0.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 1
+                           ->  Merge Append (actual rows=672.00 loops=1)
+                                 Sort Key: m2."time"
+                                 ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_device_id_time_idx on _hyper_2_7_chunk m2_4 (actual rows=0.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                                 ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_5 (actual rows=672.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                                 ->  Index Scan Backward using _hyper_2_9_chunk_metrics_space_device_id_time_idx on _hyper_2_9_chunk m2_6 (actual rows=0.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Merge Append (actual rows=336.00 loops=1)
+                                 Sort Key: m2."time"
+                                 ->  Sort (actual rows=0.00 loops=1)
+                                       Sort Key: m2_7."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m2_7 (actual rows=0.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=0.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 1
+                                 ->  Sort (actual rows=336.00 loops=1)
+                                       Sort Key: m2_8."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_8 (actual rows=336.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
+                                                   Filter: (device_id = 2)
+                                                   Rows Removed by Filter: 2
+                                 ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_device_id_time_idx on _hyper_2_12_chunk m2_9 (actual rows=0.00 loops=1)
+                                       Index Cond: (device_id = 2)
 
 -- test implicit self-join
 :PREFIX
@@ -7260,20 +7293,24 @@
          ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=1008.00 loops=1)
                ->  Index Scan using compress_hyper_6_21_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_6_21_chunk (actual rows=3.00 loops=1)
          ->  Index Scan Backward using _hyper_2_12_chunk_metrics_space_device_id_device_id_peer_v0_v_2 on _hyper_2_12_chunk (actual rows=336.00 loops=1)
-   ->  Append (actual rows=0.00 loops=8640)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=0.00 loops=8640)
-               Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
-               Rows Removed by Filter: 720
-               ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_15_chunk (actual rows=1.00 loops=8640)
-                     Index Cond: (device_id = metrics_space.device_id)
-         ->  Index Scan using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk (actual rows=0.00 loops=8640)
-               Index Cond: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
-               Filter: (metrics_space.device_id = device_id)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=0.00 loops=8640)
-               Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
-               Rows Removed by Filter: 336
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_16_chunk (actual rows=1.00 loops=8640)
-                     Index Cond: (device_id = metrics_space.device_id)
+   ->  Memoize (actual rows=0.00 loops=8640)
+         Cache Key: metrics_space."time", metrics_space.device_id
+         Cache Mode: binary
+         Hits: 0  Misses: 8640  Evictions: 0  Overflows: 0 
+         ->  Append (actual rows=0.00 loops=8640)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=0.00 loops=8640)
+                     Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
+                     Rows Removed by Filter: 720
+                     ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_15_chunk (actual rows=1.00 loops=8640)
+                           Index Cond: (device_id = metrics_space.device_id)
+               ->  Index Scan using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk (actual rows=0.00 loops=8640)
+                     Index Cond: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
+                     Filter: (metrics_space.device_id = device_id)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=0.00 loops=8640)
+                     Filter: (("time" > metrics_space."time") AND ("time" < metrics_space."time"))
+                     Rows Removed by Filter: 336
+                     ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_16_chunk (actual rows=1.00 loops=8640)
+                           Index Cond: (device_id = metrics_space.device_id)
 
 SET enable_seqscan = TRUE;
 SET enable_bitmapscan = TRUE;
@@ -7309,21 +7346,16 @@
 :PREFIX SELECT * FROM metrics_ordered ORDER BY time DESC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_ordered (actual rows=10.00 loops=1)
-         Order: metrics_ordered."time" DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_11_28_chunk (actual rows=10.00 loops=1)
-               ->  Sort (actual rows=5.00 loops=1)
-                     Sort Key: compress_hyper_12_31_chunk._ts_meta_max_1 DESC
-                     Sort Method: quicksort 
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: metrics_ordered."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=8640.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_11_28_chunk (actual rows=1680.00 loops=1)
                      ->  Seq Scan on compress_hyper_12_31_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_11_27_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: compress_hyper_12_30_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on compress_hyper_12_30_chunk (never executed)
-         ->  Custom Scan (ColumnarScan) on _hyper_11_26_chunk (never executed)
-               ->  Sort (never executed)
-                     Sort Key: compress_hyper_12_29_chunk._ts_meta_max_1 DESC
-                     ->  Seq Scan on compress_hyper_12_29_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_11_27_chunk (actual rows=3360.00 loops=1)
+                     ->  Seq Scan on compress_hyper_12_30_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_11_26_chunk (actual rows=3600.00 loops=1)
+                     ->  Seq Scan on compress_hyper_12_29_chunk (actual rows=5.00 loops=1)
 
 -- should have ordered DecompressChunk path because segmentby columns have equality constraints
 :PREFIX SELECT * FROM metrics_ordered WHERE device_id = 1 AND device_id_peer = 3 ORDER BY time DESC LIMIT 10;
@@ -7360,11 +7392,20 @@
          ->  Merge Append (actual rows=8640.00 loops=1)
                Sort Key: d.device_id
                ->  Custom Scan (ColumnarScan) on _hyper_11_26_chunk d_1 (actual rows=3600.00 loops=1)
-                     ->  Index Scan using compress_hyper_12_29_chunk_device_id_device_id_peer__ts_met_idx on compress_hyper_12_29_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=5.00 loops=1)
+                           Sort Key: compress_hyper_12_29_chunk.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on compress_hyper_12_29_chunk (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_11_27_chunk d_2 (actual rows=3360.00 loops=1)
-                     ->  Index Scan using compress_hyper_12_30_chunk_device_id_device_id_peer__ts_met_idx on compress_hyper_12_30_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=5.00 loops=1)
+                           Sort Key: compress_hyper_12_30_chunk.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on compress_hyper_12_30_chunk (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_11_28_chunk d_3 (actual rows=1680.00 loops=1)
-                     ->  Index Scan using compress_hyper_12_31_chunk_device_id_device_id_peer__ts_met_idx on compress_hyper_12_31_chunk (actual rows=5.00 loops=1)
+                     ->  Sort (actual rows=5.00 loops=1)
+                           Sort Key: compress_hyper_12_31_chunk.device_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on compress_hyper_12_31_chunk (actual rows=5.00 loops=1)
          ->  Limit (actual rows=0.00 loops=8640)
                ->  Custom Scan (ChunkAppend) on metrics_ordered m (actual rows=0.00 loops=8640)
                      Order: m."time" DESC
@@ -7520,8 +7561,7 @@
 --- QUERY PLAN ---
  HashAggregate
    Group Key: t.fleet
-   ->  Hash Join
-         Hash Cond: (r.tags_id = t.id)
+   ->  Nested Loop
          ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_13_32_chunk r_1
                      ->  Seq Scan on compress_hyper_14_735_chunk
@@ -8929,8 +8969,8 @@
                      ->  Seq Scan on compress_hyper_14_1436_chunk
                ->  Custom Scan (ColumnarScan) on _hyper_13_734_chunk r_703
                      ->  Seq Scan on compress_hyper_14_1437_chunk
-         ->  Hash
-               ->  Seq Scan on tags t
+         ->  Index Scan using tags_pkey on tags t
+               Index Cond: (id = r.tags_id)
 
 -- run query with parallel enabled to ensure nothing is preventing parallel execution
 -- this is just a sanity check, the result queries dont run with parallel disabled
@@ -8940,16 +8980,19 @@
 SET min_parallel_table_scan_size TO '0';
 EXPLAIN (buffers off, costs off) SELECT * FROM metrics ORDER BY time, device_id;
 --- QUERY PLAN ---
- Gather Merge
-   Workers Planned: 3
+ Custom Scan (ChunkAppend) on metrics
+   Order: metrics."time", metrics.device_id
    ->  Sort
-         Sort Key: metrics."time", metrics.device_id
-         ->  Parallel Append
-               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
-                     ->  Parallel Seq Scan on compress_hyper_5_15_chunk
-               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk
-                     ->  Parallel Seq Scan on compress_hyper_5_16_chunk
-               ->  Parallel Seq Scan on _hyper_1_2_chunk
+         Sort Key: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id
+         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
+               ->  Seq Scan on compress_hyper_5_15_chunk
+   ->  Sort
+         Sort Key: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id
+         ->  Seq Scan on _hyper_1_2_chunk
+   ->  Sort
+         Sort Key: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id
+         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk
+               ->  Seq Scan on compress_hyper_5_16_chunk
 
 EXPLAIN (buffers off, costs off) SELECT time_bucket('10 minutes', time) bucket, avg(v0) avg_v0 FROM metrics GROUP BY bucket;
 --- QUERY PLAN ---
@@ -9000,16 +9043,15 @@
 -- (we only EXPLAIN here b/c the resulting order is too inconsistent)
 EXPLAIN (buffers off, costs off) SELECT * FROM metrics WHERE time > '2000-01-08' ORDER BY device_id;
 --- QUERY PLAN ---
- Merge Append
+ Sort
    Sort Key: metrics.device_id
-   ->  Sort
-         Sort Key: _hyper_1_2_chunk.device_id
+   ->  Append
          ->  Index Scan using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk
                Index Cond: ("time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk
-         Vectorized Filter: ("time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-         ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_16_chunk
-               Index Cond: (_ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk
+               Vectorized Filter: ("time" > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_5_16_chunk
+                     Index Cond: (_ts_meta_max_3 > 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
 
 EXPLAIN (buffers off, costs off) SELECT * FROM metrics_space WHERE time > '2000-01-08' ORDER BY device_id;
 --- QUERY PLAN ---
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_join_index.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_join_index.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_join_index.out	2025-11-06 02:35:39.310068320 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_join_index.out	2025-11-06 02:47:57.053670058 +0000
@@ -64,12 +64,11 @@
                Sort Key: compress_hyper_2_2_chunk._ts_meta_min_1
                ->  Index Scan using compress_hyper_2_2_chunk_a_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_2_2_chunk
                      Index Cond: ((_ts_meta_min_1 <= 'Wed Jan 01 00:02:00 2020 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Wed Jan 01 00:00:00 2020 PST'::timestamp with time zone))
-   ->  Materialize
-         ->  Unique
-               ->  Sort
-                     Sort Key: test_copy.a
-                     ->  Seq Scan on test_copy
-                           Filter: (((a)::text = ANY ('{lat,lon}'::text[])) AND (b = 1))
+   ->  Unique
+         ->  Sort
+               Sort Key: test_copy.a
+               ->  Seq Scan on test_copy
+                     Filter: (((a)::text = ANY ('{lat,lon}'::text[])) AND (b = 1))
 
 with query_params as (
 	select distinct a, b
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_ordered_index-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_ordered_index-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_ordered_index-17.out	2025-11-06 02:35:39.311068309 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_ordered_index-17.out	2025-11-06 02:47:58.901648719 +0000
@@ -138,20 +138,20 @@
 :PREFIX SELECT * FROM metrics_ordered_idx2 WHERE device_id = 3 AND device_id_peer = 3 ORDER BY time DESC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_11_chunk (actual rows=10.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_4_12_chunk._ts_meta_min_1 DESC, compress_hyper_4_12_chunk._ts_meta_max_1 DESC
-               Sort Method: quicksort 
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: _hyper_3_11_chunk."time" DESC
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ColumnarScan) on _hyper_3_11_chunk (actual rows=4291.00 loops=1)
                ->  Index Scan using compress_hyper_4_12_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_4_12_chunk (actual rows=5.00 loops=1)
                      Index Cond: ((device_id = 3) AND (device_id_peer = 3))
 
 :PREFIX SELECT * FROM metrics_ordered_idx2 WHERE device_id = 3 AND device_id_peer = 3 ORDER BY time DESC , v0 asc LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_3_11_chunk (actual rows=10.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_4_12_chunk._ts_meta_min_1 DESC, compress_hyper_4_12_chunk._ts_meta_max_1 DESC, compress_hyper_4_12_chunk._ts_meta_min_2, compress_hyper_4_12_chunk._ts_meta_max_2
-               Sort Method: quicksort 
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: _hyper_3_11_chunk."time" DESC, _hyper_3_11_chunk.v0
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ColumnarScan) on _hyper_3_11_chunk (actual rows=4291.00 loops=1)
                ->  Index Scan using compress_hyper_4_12_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_4_12_chunk (actual rows=5.00 loops=1)
                      Index Cond: ((device_id = 3) AND (device_id_peer = 3))
 
@@ -295,12 +295,12 @@
 WHERE extract(minute FROM d.time) = 0;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Sort (actual rows=12.00 loops=1)
-         Sort Key: d.device_id
-         Sort Method: quicksort 
-         ->  Nested Loop (actual rows=12.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_ordered_idx d (actual rows=389.00 loops=1)
-                     Chunks excluded during startup: 0
+   ->  Nested Loop (actual rows=12.00 loops=1)
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=389.00 loops=1)
+               Hypertable: metrics_ordered_idx
+               Chunks excluded during startup: 0
+               ->  Merge Append (actual rows=389.00 loops=1)
+                     Sort Key: d.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk d_1 (actual rows=120.00 loops=1)
                            Filter: (EXTRACT(minute FROM "time") = '0'::numeric)
                            Rows Removed by Filter: 360
@@ -320,28 +320,28 @@
                      ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk d_5 (actual rows=5.00 loops=1)
                            Filter: (EXTRACT(minute FROM "time") = '0'::numeric)
                            ->  Index Scan using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
-               ->  Subquery Scan on m (actual rows=0.00 loops=389)
-                     Filter: (d.device_id_peer = m.device_id_peer)
-                     Rows Removed by Filter: 0
-                     ->  Limit (actual rows=0.00 loops=389)
-                           ->  Custom Scan (ChunkAppend) on metrics_ordered_idx m_1 (actual rows=0.00 loops=389)
-                                 Order: m_1."time" DESC
-                                 Hypertables excluded during runtime: 0
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk m_2 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk compress_hyper_2_10_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk m_3 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk compress_hyper_2_9_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m_4 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk compress_hyper_2_8_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk m_5 (actual rows=0.00 loops=304)
-                                       ->  Index Scan Backward using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk compress_hyper_2_7_chunk_1 (actual rows=0.00 loops=304)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m_6 (actual rows=0.00 loops=304)
-                                       ->  Index Scan Backward using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk compress_hyper_2_6_chunk_1 (actual rows=0.00 loops=304)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+         ->  Subquery Scan on m (actual rows=0.00 loops=389)
+               Filter: (d.device_id_peer = m.device_id_peer)
+               Rows Removed by Filter: 0
+               ->  Limit (actual rows=0.00 loops=389)
+                     ->  Custom Scan (ChunkAppend) on metrics_ordered_idx m_1 (actual rows=0.00 loops=389)
+                           Order: m_1."time" DESC
+                           Hypertables excluded during runtime: 0
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk m_2 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk compress_hyper_2_10_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk m_3 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk compress_hyper_2_9_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m_4 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk compress_hyper_2_8_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk m_5 (actual rows=0.00 loops=304)
+                                 ->  Index Scan Backward using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk compress_hyper_2_7_chunk_1 (actual rows=0.00 loops=304)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m_6 (actual rows=0.00 loops=304)
+                                 ->  Index Scan Backward using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk compress_hyper_2_6_chunk_1 (actual rows=0.00 loops=304)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
 
 :PREFIX
 SELECT d.device_id,
@@ -438,8 +438,7 @@
                      ->  Index Scan using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk mt_5 (actual rows=5.00 loops=1)
                      ->  Index Scan using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
-         ->  Materialize (actual rows=1.00 loops=1541)
-               ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1)
+         ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1541)
 
 :PREFIX
 SELECT nd.node,
@@ -456,15 +455,15 @@
    Rows Removed by Join Filter: 1493
    ->  Custom Scan (ChunkAppend) on metrics_ordered_idx mt (actual rows=1541.00 loops=1)
          Order: mt."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk mt_1 (actual rows=480.00 loops=1)
-               ->  Sort (actual rows=5.00 loops=1)
-                     Sort Key: compress_hyper_2_6_chunk._ts_meta_min_1
-                     Sort Method: quicksort 
+         ->  Sort (actual rows=480.00 loops=1)
+               Sort Key: mt_1."time"
+               Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk mt_1 (actual rows=480.00 loops=1)
                      ->  Index Scan using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk mt_2 (actual rows=960.00 loops=1)
-               ->  Sort (actual rows=5.00 loops=1)
-                     Sort Key: compress_hyper_2_7_chunk._ts_meta_min_1
-                     Sort Method: quicksort 
+         ->  Sort (actual rows=960.00 loops=1)
+               Sort Key: mt_2."time"
+               Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk mt_2 (actual rows=960.00 loops=1)
                      ->  Index Scan using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk (actual rows=5.00 loops=1)
          ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk mt_3 (actual rows=48.00 loops=1)
                ->  Sort (actual rows=1.00 loops=1)
@@ -481,8 +480,7 @@
                      Sort Key: compress_hyper_2_10_chunk._ts_meta_min_1
                      Sort Method: quicksort 
                      ->  Index Scan using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
-   ->  Materialize (actual rows=1.00 loops=1541)
-         ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1)
+   ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1541)
 
 SET enable_seqscan = TRUE;
 SET enable_bitmapscan = TRUE;
@@ -501,31 +499,37 @@
     AND mt.time < nd.stop_time
 ORDER BY time;
 --- QUERY PLAN ---
- Sort (actual rows=48.00 loops=1)
-   Sort Key: mt."time"
-   Sort Method: quicksort 
-   ->  Merge Join (actual rows=48.00 loops=1)
-         Merge Cond: (nd.node = mt.device_id)
-         Join Filter: ((mt."time" > nd.start_time) AND (mt."time" < nd.stop_time))
-         Rows Removed by Join Filter: 289
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: nd.node
+ Nested Loop (actual rows=48.00 loops=1)
+   Join Filter: ((mt."time" > nd.start_time) AND (mt."time" < nd.stop_time) AND (nd.node = mt.device_id))
+   Rows Removed by Join Filter: 1493
+   ->  Custom Scan (ChunkAppend) on metrics_ordered_idx mt (actual rows=1541.00 loops=1)
+         Order: mt."time"
+         ->  Sort (actual rows=480.00 loops=1)
+               Sort Key: mt_1."time"
                Sort Method: quicksort 
-               ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1)
-         ->  Sort (actual rows=1250.00 loops=1)
-               Sort Key: mt.device_id
+               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk mt_1 (actual rows=480.00 loops=1)
+                     ->  Seq Scan on compress_hyper_2_6_chunk (actual rows=5.00 loops=1)
+         ->  Sort (actual rows=960.00 loops=1)
+               Sort Key: mt_2."time"
                Sort Method: quicksort 
-               ->  Append (actual rows=1541.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk mt_1 (actual rows=480.00 loops=1)
-                           ->  Seq Scan on compress_hyper_2_6_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk mt_2 (actual rows=960.00 loops=1)
-                           ->  Seq Scan on compress_hyper_2_7_chunk (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk mt_3 (actual rows=48.00 loops=1)
-                           ->  Seq Scan on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk mt_4 (actual rows=48.00 loops=1)
-                           ->  Seq Scan on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk mt_5 (actual rows=5.00 loops=1)
-                           ->  Seq Scan on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk mt_2 (actual rows=960.00 loops=1)
+                     ->  Seq Scan on compress_hyper_2_7_chunk (actual rows=5.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk mt_3 (actual rows=48.00 loops=1)
+               ->  Sort (actual rows=1.00 loops=1)
+                     Sort Key: compress_hyper_2_8_chunk._ts_meta_min_1
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk mt_4 (actual rows=48.00 loops=1)
+               ->  Sort (actual rows=1.00 loops=1)
+                     Sort Key: compress_hyper_2_9_chunk._ts_meta_min_1
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk mt_5 (actual rows=5.00 loops=1)
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: compress_hyper_2_10_chunk._ts_meta_min_1
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
+   ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1541)
 
 SET enable_mergejoin = FALSE;
 SET enable_hashjoin = TRUE;
@@ -539,26 +543,37 @@
     AND mt.time < nd.stop_time
 ORDER BY time;
 --- QUERY PLAN ---
- Sort (actual rows=48.00 loops=1)
-   Sort Key: mt."time"
-   Sort Method: quicksort 
-   ->  Hash Join (actual rows=48.00 loops=1)
-         Hash Cond: (mt.device_id = nd.node)
-         Join Filter: ((mt."time" > nd.start_time) AND (mt."time" < nd.stop_time))
-         Rows Removed by Join Filter: 289
-         ->  Append (actual rows=1541.00 loops=1)
+ Nested Loop (actual rows=48.00 loops=1)
+   Join Filter: ((mt."time" > nd.start_time) AND (mt."time" < nd.stop_time) AND (nd.node = mt.device_id))
+   Rows Removed by Join Filter: 1493
+   ->  Custom Scan (ChunkAppend) on metrics_ordered_idx mt (actual rows=1541.00 loops=1)
+         Order: mt."time"
+         ->  Sort (actual rows=480.00 loops=1)
+               Sort Key: mt_1."time"
+               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk mt_1 (actual rows=480.00 loops=1)
                      ->  Seq Scan on compress_hyper_2_6_chunk (actual rows=5.00 loops=1)
+         ->  Sort (actual rows=960.00 loops=1)
+               Sort Key: mt_2."time"
+               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk mt_2 (actual rows=960.00 loops=1)
                      ->  Seq Scan on compress_hyper_2_7_chunk (actual rows=5.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk mt_3 (actual rows=48.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk mt_3 (actual rows=48.00 loops=1)
+               ->  Sort (actual rows=1.00 loops=1)
+                     Sort Key: compress_hyper_2_8_chunk._ts_meta_min_1
+                     Sort Method: quicksort 
                      ->  Seq Scan on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk mt_4 (actual rows=48.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk mt_4 (actual rows=48.00 loops=1)
+               ->  Sort (actual rows=1.00 loops=1)
+                     Sort Key: compress_hyper_2_9_chunk._ts_meta_min_1
+                     Sort Method: quicksort 
                      ->  Seq Scan on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk mt_5 (actual rows=5.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk mt_5 (actual rows=5.00 loops=1)
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: compress_hyper_2_10_chunk._ts_meta_min_1
+                     Sort Method: quicksort 
                      ->  Seq Scan on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
-         ->  Hash (actual rows=1.00 loops=1)
-               ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1)
+   ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1541)
 
 --enable all joins after the tests
 SET enable_mergejoin = TRUE;
@@ -581,17 +596,18 @@
       and met.time < '2000-01-20 20:00:00-05'
 ORDER BY v0;
 --- QUERY PLAN ---
- Sort (actual rows=2.00 loops=1)
-   Sort Key: met.v0
-   Sort Method: quicksort 
-   ->  Nested Loop (actual rows=2.00 loops=1)
-         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=1.00 loops=2)
-               Filter: ("*VALUES*".column2 = v0)
-               Rows Removed by Filter: 47
+ Nested Loop (actual rows=2.00 loops=1)
+   Join Filter: ((met.device_id = "*VALUES*".column1) AND ("*VALUES*".column2 = met.v0))
+   Rows Removed by Join Filter: 92
+   ->  Sort (actual rows=47.00 loops=1)
+         Sort Key: met.v0
+         Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=47.00 loops=1)
                Vectorized Filter: (("time" > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND ("time" < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone))
-               ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=2)
-                     Index Cond: ((device_id = "*VALUES*".column1) AND (_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+               Rows Removed by Filter: 1
+               ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+   ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=47)
 
 --add filter to segment by (device_id) and compressed attr column (v0)
 :PREFIX
@@ -604,14 +620,14 @@
       and met.device_id = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=1.00 loops=1)
          Vectorized Filter: (("time" > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND ("time" < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (v0 = 5))
          Rows Removed by Filter: 47
          ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Index Cond: ((device_id = 3) AND (_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
+         Filter: ((column1 = 3) AND (column2 = 5))
+         Rows Removed by Filter: 1
 
 :PREFIX
 WITH lookup as ( SELECT * from (values( 3, 5) , (3, 4) ) as lu( did, version) )
@@ -623,14 +639,13 @@
       and met.device_id_peer = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=0.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=0.00 loops=1)
          Vectorized Filter: ((v0 = 5) AND ("time" = 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
          Rows Removed by Filter: 48
          ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Index Cond: ((device_id = 3) AND (device_id_peer = 3) AND (_ts_meta_min_1 <= 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+   ->  Values Scan on "*VALUES*" (never executed)
+         Filter: ((column1 = 3) AND (column2 = 5))
 
 -- lateral subquery
 :PREFIX
@@ -643,18 +658,17 @@
    and met.v0 = q.v0 and met.v0 > 2 and time = '2018-01-19 20:00:00-05';
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   Join Filter: (met.device_id = nodetime.node)
+   Join Filter: ((met.device_id_peer = "*VALUES*".column2) AND ("*VALUES*".column3 = met.v0))
    ->  Nested Loop (actual rows=1.00 loops=1)
          Join Filter: (nodetime.node = "*VALUES*".column1)
          Rows Removed by Join Filter: 1
          ->  Seq Scan on nodetime (actual rows=1.00 loops=1)
          ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
    ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk met (actual rows=1.00 loops=1)
-         Filter: ("*VALUES*".column3 = v0)
-         Rows Removed by Filter: 47
          Vectorized Filter: ((v0 > 2) AND ("time" = 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
+         Rows Removed by Filter: 47
          ->  Index Scan using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
-               Index Cond: ((device_id = "*VALUES*".column1) AND (device_id_peer = "*VALUES*".column2) AND (_ts_meta_min_1 <= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
+               Index Cond: ((device_id = nodetime.node) AND (_ts_meta_min_1 <= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
 
 -- filter on compressed attr (v0) with seqscan enabled and indexscan
 -- disabled. filters on compressed attr should be above the seq scan.
@@ -672,14 +686,14 @@
       and met.device_id_peer = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=1.00 loops=1)
          Vectorized Filter: (("time" > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND ("time" < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (v0 = 5))
          Rows Removed by Filter: 47
          ->  Seq Scan on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Filter: ((_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (device_id = 3) AND (device_id_peer = 3))
+   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
+         Filter: ((column1 = 3) AND (column2 = 5))
+         Rows Removed by Filter: 1
 
 RESET enable_hashjoin  ;
 RESET enable_mergejoin;
@@ -712,23 +726,19 @@
    Sort Key: metrics_ordered_idx."time", metrics_ordered_idx.device_id, metrics_ordered_idx.device_id_peer, metrics_ordered_idx.v0
    Sort Method: quicksort 
    ->  Limit (actual rows=10.00 loops=1)
-         ->  Custom Scan (ConstraintAwareAppend) (actual rows=10.00 loops=1)
-               Hypertable: metrics_ordered_idx
-               Chunks excluded during startup: 0
-               ->  Merge Append (actual rows=10.00 loops=1)
-                     Sort Key: metrics_ordered_idx."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk (actual rows=5.00 loops=1)
-                           Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
-                           ->  Sort (actual rows=1.00 loops=1)
-                                 Sort Key: compress_hyper_2_9_chunk._ts_meta_max_1 DESC
-                                 Sort Method: quicksort 
+         ->  Sort (actual rows=10.00 loops=1)
+               Sort Key: metrics_ordered_idx."time" DESC
+               Sort Method: top-N heapsort 
+               ->  Custom Scan (ConstraintAwareAppend) (actual rows=53.00 loops=1)
+                     Hypertable: metrics_ordered_idx
+                     Chunks excluded during startup: 0
+                     ->  Append (actual rows=53.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk (actual rows=48.00 loops=1)
+                                 Vectorized Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
                                  ->  Seq Scan on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
                                        Filter: ((_ts_meta_max_1 > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND (_ts_meta_min_1 < now()))
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk (actual rows=5.00 loops=1)
-                           Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
-                           ->  Sort (actual rows=5.00 loops=1)
-                                 Sort Key: compress_hyper_2_10_chunk._ts_meta_max_1 DESC
-                                 Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk (actual rows=5.00 loops=1)
+                                 Vectorized Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
                                  ->  Seq Scan on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
                                        Filter: ((_ts_meta_max_1 > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND (_ts_meta_min_1 < now()))
 
@@ -753,23 +763,19 @@
    Sort Key: metrics_ordered_idx."time", metrics_ordered_idx.device_id, metrics_ordered_idx.device_id_peer, metrics_ordered_idx.v0
    Sort Method: quicksort 
    ->  Limit (actual rows=10.00 loops=1)
-         ->  Custom Scan (ConstraintAwareAppend) (actual rows=10.00 loops=1)
-               Hypertable: metrics_ordered_idx
-               Chunks excluded during startup: 0
-               ->  Merge Append (actual rows=10.00 loops=1)
-                     Sort Key: metrics_ordered_idx."time" DESC
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk (actual rows=9.00 loops=1)
-                           Vectorized Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
-                           ->  Sort (actual rows=1.00 loops=1)
-                                 Sort Key: compress_hyper_2_9_chunk._ts_meta_min_1 DESC, compress_hyper_2_9_chunk._ts_meta_max_1 DESC
-                                 Sort Method: quicksort 
+         ->  Sort (actual rows=10.00 loops=1)
+               Sort Key: metrics_ordered_idx."time" DESC
+               Sort Method: top-N heapsort 
+               ->  Custom Scan (ConstraintAwareAppend) (actual rows=49.00 loops=1)
+                     Hypertable: metrics_ordered_idx
+                     Chunks excluded during startup: 0
+                     ->  Append (actual rows=49.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk (actual rows=48.00 loops=1)
+                                 Vectorized Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
                                  ->  Seq Scan on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
                                        Filter: ((_ts_meta_max_1 > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND (device_id = 4) AND (device_id_peer = 5) AND (_ts_meta_min_1 < now()))
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk (actual rows=1.00 loops=1)
-                           Vectorized Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
-                           ->  Sort (actual rows=1.00 loops=1)
-                                 Sort Key: compress_hyper_2_10_chunk._ts_meta_min_1 DESC, compress_hyper_2_10_chunk._ts_meta_max_1 DESC
-                                 Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk (actual rows=1.00 loops=1)
+                                 Vectorized Filter: (("time" > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND ("time" < now()))
                                  ->  Seq Scan on compress_hyper_2_10_chunk (actual rows=1.00 loops=1)
                                        Filter: ((_ts_meta_max_1 > 'Tue Jan 01 00:00:00 2002 PST'::timestamp with time zone) AND (device_id = 4) AND (device_id_peer = 5) AND (_ts_meta_min_1 < now()))
                                        Rows Removed by Filter: 4
@@ -792,20 +798,19 @@
     2,
     3;
 --- QUERY PLAN ---
- Sort (actual rows=0.00 loops=1)
+ Incremental Sort (actual rows=0.00 loops=1)
    Sort Key: m.device_id, d.v0, (count(*))
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=0.00 loops=1)
+   Presorted Key: m.device_id, d.v0
+   Full-sort Groups: 1  Sort Method: quicksort 
+   ->  GroupAggregate (actual rows=0.00 loops=1)
          Group Key: m.device_id, d.v0
-         ->  Hash Join (actual rows=0.00 loops=1)
-               Hash Cond: ((d.device_id = m.device_id) AND (d."time" = m."time"))
+         ->  Nested Loop (actual rows=0.00 loops=1)
                ->  Custom Scan (ConstraintAwareAppend) (actual rows=0.00 loops=1)
                      Hypertable: metrics_ordered_idx
                      Chunks excluded during startup: 2
-               ->  Hash (never executed)
-                     ->  Custom Scan (ConstraintAwareAppend) (never executed)
-                           Hypertable: metrics_ordered_idx
-                           Chunks excluded during startup: 2
+               ->  Custom Scan (ConstraintAwareAppend) (never executed)
+                     Hypertable: metrics_ordered_idx
+                     Chunks excluded during startup: 2
 
 --query with no results --
 :PREFIX
@@ -938,36 +943,48 @@
 WHERE m.device_id = 7
 ORDER BY m.v0;
 --- QUERY PLAN ---
- Sort (actual rows=1.00 loops=1)
-   Sort Key: m.v0
-   Sort Method: quicksort 
-   ->  Nested Loop Left Join (actual rows=1.00 loops=1)
-         Join Filter: ((m."time" > 'Tue Jan 01 00:00:00 2019 PST'::timestamp with time zone) AND (m."time" < ('2000-01-01 0:00:00+0'::cstring)::timestamp with time zone))
-         ->  Append (actual rows=1.00 loops=1)
+ Nested Loop Left Join (actual rows=1.00 loops=1)
+   Join Filter: ((m."time" > 'Tue Jan 01 00:00:00 2019 PST'::timestamp with time zone) AND (m."time" < ('2000-01-01 0:00:00+0'::cstring)::timestamp with time zone))
+   ->  Merge Append (actual rows=1.00 loops=1)
+         Sort Key: m.v0
+         ->  Sort (actual rows=0.00 loops=1)
+               Sort Key: m_1.v0
+               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m_1 (actual rows=0.00 loops=1)
                      ->  Seq Scan on compress_hyper_2_6_chunk (actual rows=0.00 loops=1)
                            Filter: (device_id = 7)
                            Rows Removed by Filter: 5
+         ->  Sort (actual rows=0.00 loops=1)
+               Sort Key: m_2.v0
+               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk m_2 (actual rows=0.00 loops=1)
                      ->  Seq Scan on compress_hyper_2_7_chunk (actual rows=0.00 loops=1)
                            Filter: (device_id = 7)
                            Rows Removed by Filter: 5
+         ->  Sort (actual rows=0.00 loops=1)
+               Sort Key: m_3.v0
+               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m_3 (actual rows=0.00 loops=1)
                      ->  Seq Scan on compress_hyper_2_8_chunk (actual rows=0.00 loops=1)
                            Filter: (device_id = 7)
                            Rows Removed by Filter: 1
+         ->  Sort (actual rows=0.00 loops=1)
+               Sort Key: m_4.v0
+               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk m_4 (actual rows=0.00 loops=1)
                      ->  Seq Scan on compress_hyper_2_9_chunk (actual rows=0.00 loops=1)
                            Filter: (device_id = 7)
                            Rows Removed by Filter: 1
+         ->  Sort (actual rows=1.00 loops=1)
+               Sort Key: m_5.v0
+               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk m_5 (actual rows=1.00 loops=1)
                      ->  Seq Scan on compress_hyper_2_10_chunk (actual rows=1.00 loops=1)
                            Filter: (device_id = 7)
                            Rows Removed by Filter: 4
-         ->  Materialize (actual rows=0.00 loops=1)
-               ->  Seq Scan on device_tbl d (actual rows=0.00 loops=1)
-                     Filter: (device_id = 7)
-                     Rows Removed by Filter: 7
+   ->  Seq Scan on device_tbl d (actual rows=0.00 loops=1)
+         Filter: (device_id = 7)
+         Rows Removed by Filter: 7
 
 SET timescaledb.enable_chunk_append TO TRUE;
 -- github bug 2917 with UNION ALL that references compressed ht
@@ -1096,34 +1113,24 @@
 :PREFIX select * from metrics_ordered_idx where device_id > 2 order by "time" desc, device_id_peer limit 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_ordered_idx (actual rows=10.00 loops=1)
-         Order: metrics_ordered_idx."time" DESC, metrics_ordered_idx.device_id_peer
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_1_5_chunk."time" DESC, _hyper_1_5_chunk.device_id_peer
-               Sort Method: quicksort 
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: metrics_ordered_idx."time" DESC, metrics_ordered_idx.device_id_peer
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=964.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk (actual rows=4.00 loops=1)
                      ->  Index Scan using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk (actual rows=4.00 loops=1)
                            Index Cond: (device_id > 2)
-         ->  Sort (actual rows=6.00 loops=1)
-               Sort Key: _hyper_1_4_chunk."time" DESC, _hyper_1_4_chunk.device_id_peer
-               Sort Method: top-N heapsort 
                ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk (actual rows=48.00 loops=1)
                      ->  Index Scan using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
                            Index Cond: (device_id > 2)
-         ->  Sort (never executed)
-               Sort Key: _hyper_1_3_chunk."time" DESC, _hyper_1_3_chunk.device_id_peer
-               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (never executed)
-                     ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk (actual rows=48.00 loops=1)
+                     ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                            Index Cond: (device_id > 2)
-         ->  Sort (never executed)
-               Sort Key: _hyper_1_2_chunk."time" DESC, _hyper_1_2_chunk.device_id_peer
-               ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (never executed)
-                     ->  Index Scan using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=576.00 loops=1)
+                     ->  Index Scan using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk (actual rows=3.00 loops=1)
                            Index Cond: (device_id > 2)
-         ->  Sort (never executed)
-               Sort Key: _hyper_1_1_chunk."time" DESC, _hyper_1_1_chunk.device_id_peer
-               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (never executed)
-                     ->  Index Scan using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk (never executed)
+               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=288.00 loops=1)
+                     ->  Index Scan using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk (actual rows=3.00 loops=1)
                            Index Cond: (device_id > 2)
 
 -- Make sure we can use ChunkAppend over sorted decompressed parametrized IndexScans and SeqScans
@@ -1167,8 +1174,7 @@
                      Sort Key: mt_5."time", mt_5.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk mt_5 (never executed)
                            ->  Index Scan using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk (never executed)
-         ->  Materialize (actual rows=1.00 loops=1493)
-               ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1)
+         ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1493)
 
 -- Parametrized SeqScans
 RESET enable_seqscan;
@@ -1212,8 +1218,7 @@
                      Sort Key: mt_5."time", mt_5.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk mt_5 (never executed)
                            ->  Seq Scan on compress_hyper_2_10_chunk (never executed)
-         ->  Materialize (actual rows=1.00 loops=1493)
-               ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1)
+         ->  Seq Scan on nodetime nd (actual rows=1.00 loops=1493)
 
 SET enable_seqscan = false;
 RESET enable_indexscan;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_queries-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_queries-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_queries-17.out	2025-11-06 02:35:39.311068309 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_queries-17.out	2025-11-06 02:48:04.114591224 +0000
@@ -88,8 +88,11 @@
                Sort Key: merge_sort.device_id, merge_sort.measure_id
                ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=86400.00 loops=1)
                      Vectorized Filter: ("time" < "timestamp"(now()))
-                     ->  Index Scan using compress_hyper_4_10_chunk_device_id_measure_id__ts_meta_min_idx on compress_hyper_4_10_chunk (actual rows=87.00 loops=1)
-                           Index Cond: (_ts_meta_min_1 < now())
+                     ->  Sort (actual rows=87.00 loops=1)
+                           Sort Key: compress_hyper_4_10_chunk.device_id, compress_hyper_4_10_chunk.measure_id
+                           Sort Method: quicksort 
+                           ->  Seq Scan on compress_hyper_4_10_chunk (actual rows=87.00 loops=1)
+                                 Filter: (_ts_meta_min_1 < now())
                ->  Sort (actual rows=120960.00 loops=1)
                      Sort Key: _hyper_3_6_chunk.device_id, _hyper_3_6_chunk.measure_id
                      Sort Method: quicksort 
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_filter.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_filter.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_filter.out	2025-11-06 02:35:39.312068298 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_filter.out	2025-11-06 02:48:27.337320555 +0000
@@ -2773,8 +2773,8 @@
 select id, sum(value) from uuid_default group by id;
                   id                  | sum  
 --------------------------------------+------
- 5dd0565f-1ddf-4a6c-9e96-9b2b8c8c3993 | 2000
  842ab294-923a-4f50-be7d-af6c51903a5f | 1000
+ 5dd0565f-1ddf-4a6c-9e96-9b2b8c8c3993 | 2000
 
 select sum(value) filter (where id = '5dd0565f-1ddf-4a6c-9e96-9b2b8c8c3993') from uuid_default;
  sum  
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_groupagg.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_groupagg.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_groupagg.out	2025-11-06 02:35:39.312068298 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_groupagg.out	2025-11-06 02:48:21.469392014 +0000
@@ -32,189 +32,4 @@
 vacuum analyze groupagg;
 set timescaledb.debug_require_vector_agg to 'require';
 select s, sum(value) from groupagg group by s order by s limit 10;
- s  |   sum   
-----+---------
- 10 | 3423074
- 11 | 3433483
- 12 | 3443892
- 14 | 3464710
- 15 | 3475119
- 16 | 3485528
- 17 | 3495937
- 18 | 3506346
- 19 | 3516755
- 20 | 3527164
-
--- The hash grouping policies do not support the GroupAggregate mode in the
--- reverse order.
-set timescaledb.debug_require_vector_agg to 'forbid';
-select s, sum(value) from groupagg group by s order by s desc limit 10;
- s  |   sum   
-----+---------
-  $ | 3454301
- 99 | 4349475
- 98 | 4339066
- 97 | 4328657
- 96 | 4318248
- 95 | 4307839
- 94 | 4297430
- 93 | 4287021
- 92 | 4276612
- 91 | 4266203
-
-reset timescaledb.debug_require_vector_agg;
--- Also test the NULLS FIRST order.
-select count(decompress_chunk(x)) from show_chunks('groupagg') x;
- count 
--------
-     2
-
-alter table groupagg set (timescaledb.compress, timescaledb.compress_segmentby = '',
-    timescaledb.compress_orderby = 's nulls first');
-select count(compress_chunk(x)) from show_chunks('groupagg') x;
- count 
--------
-     2
-
-vacuum analyze groupagg;
-set timescaledb.debug_require_vector_agg to 'require';
-select s, sum(value) from groupagg group by s order by s nulls first limit 10;
- s  |   sum   
-----+---------
-  $ | 3454301
- 10 | 3423074
- 11 | 3433483
- 12 | 3443892
- 14 | 3464710
- 15 | 3475119
- 16 | 3485528
- 17 | 3495937
- 18 | 3506346
- 19 | 3516755
-
-reset timescaledb.debug_require_vector_agg;
--- More tests for dictionary encoding.
-create table text_table(ts int, a text);
-select create_hypertable('text_table', 'ts', chunk_time_interval => 3);
-    create_hypertable    
--------------------------
- (3,public,text_table,t)
-
-alter table text_table set (timescaledb.compress, timescaledb.compress_segmentby = 'a');
-insert into text_table select -1, 'scalar' from generate_series(1, 1000) x;
-select count(compress_chunk(x)) from show_chunks('text_table') x;
- count 
--------
-     1
-
-insert into text_table select 1, '' from generate_series(1, 1000) x;
-insert into text_table select 2, 'same' from generate_series(1, 1000) x;
-insert into text_table select 3, 'different' || x from generate_series(1, 1000) x;
-insert into text_table select 4, case when x % 2 = 0 then null else 'samewithnulls' end from generate_series(1, 1000) x;
-insert into text_table select 5, case when x % 2 = 0 then null else 'differentwithnulls' || x end from generate_series(1, 1000) x;
-alter table text_table set (timescaledb.compress,
-    timescaledb.compress_segmentby = '', timescaledb.compress_orderby = 'a');
-select count(compress_chunk(x)) from show_chunks('text_table') x;
-NOTICE:  chunk "_hyper_3_7_chunk" is already converted to columnstore
- count 
--------
-     3
-
-vacuum analyze text_table;
-set timescaledb.debug_require_vector_agg to 'require';
-select a, count(*) from text_table group by a order by count(*) desc, a limit 10;
-       a       | count 
----------------+-------
-               |  1000
- same          |  1000
- scalar        |  1000
- $             |  1000
- samewithnulls |   500
- different1    |     1
- different10   |     1
- different100  |     1
- different1000 |     1
- different101  |     1
-
--- The hash grouping policies do not support the GroupAggregate mode in the
--- reverse order. We have to filter out the chunk where 'a' is segmentby.
-set timescaledb.debug_require_vector_agg to 'forbid';
-select a, count(*) from text_table where ts >= 0 group by a order by a desc limit 10;
-           a           | count 
------------------------+-------
- $                     |  1000
- samewithnulls         |   500
- same                  |  1000
- differentwithnulls999 |     1
- differentwithnulls997 |     1
- differentwithnulls995 |     1
- differentwithnulls993 |     1
- differentwithnulls991 |     1
- differentwithnulls99  |     1
- differentwithnulls989 |     1
-
-reset timescaledb.debug_require_vector_agg;
-reset enable_sort;
--- with NULLS FIRST
-select count(decompress_chunk(x)) from show_chunks('text_table') x;
- count 
--------
-     3
-
-alter table text_table set (timescaledb.compress,
-    timescaledb.compress_segmentby = '', timescaledb.compress_orderby = 'a nulls first');
-select count(compress_chunk(x)) from show_chunks('text_table') x;
- count 
--------
-     3
-
-set timescaledb.debug_require_vector_agg to 'require';
-select a, count(*) from text_table group by a order by a nulls first limit 10;
-       a       | count 
----------------+-------
- $             |  1000
-               |  1000
- different1    |     1
- different10   |     1
- different100  |     1
- different1000 |     1
- different101  |     1
- different102  |     1
- different103  |     1
- different104  |     1
-
-reset timescaledb.debug_require_vector_agg;
--- TODO verify that this works with the serialized hash grouping strategy
-set timescaledb.debug_require_vector_agg to 'forbid';
-select ts, a, count(*) from text_table group by ts, a order by ts, a limit 10;
- ts |       a       | count 
-----+---------------+-------
- -1 | scalar        |  1000
-  1 |               |  1000
-  2 | same          |  1000
-  3 | different1    |     1
-  3 | different10   |     1
-  3 | different100  |     1
-  3 | different1000 |     1
-  3 | different101  |     1
-  3 | different102  |     1
-  3 | different103  |     1
-
-select a, ts, count(*) from text_table group by a, ts order by a desc, ts desc limit 10;
-           a           | ts | count 
------------------------+----+-------
- $                     |  5 |   500
- $                     |  4 |   500
- scalar                | -1 |  1000
- samewithnulls         |  4 |   500
- same                  |  2 |  1000
- differentwithnulls999 |  5 |     1
- differentwithnulls997 |  5 |     1
- differentwithnulls995 |  5 |     1
- differentwithnulls993 |  5 |     1
- differentwithnulls991 |  5 |     1
-
-reset timescaledb.debug_require_vector_agg;
-reset max_parallel_workers_per_gather;
-reset timescaledb.debug_require_vector_agg;
-reset enable_hashagg;
+ERROR:  postgres partial aggregation nodes inconsistent with debug_require_vector_agg GUC
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_grouping.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_grouping.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_grouping.out	2025-11-06 02:35:39.312068298 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_grouping.out	2025-11-06 02:48:33.340248586 +0000
@@ -696,1247 +696,4 @@
   0 | 0 |    31 |     1
 
 select t, s, ss, x, cint4, cint8, cint2, count(*) from agggroup where cint2 > 0 group by t, s, ss, x, cint4, cint8, cint2 order by count(*), t, s, ss, x, cint4, cint8, cint2 limit 10;
- t  | s | ss | x | cint4  | cint8 | cint2 | count 
-----+---+----+---+--------+-------+-------+-------
-  1 | 0 |  0 | 0 | -15736 | 12910 |  3398 |     1
-  5 | 0 |  0 | 0 |   9267 |  6436 |  4859 |     1
-  6 | 0 |  0 | 0 |  -5203 |  9870 | 12177 |     1
-  7 | 0 |  0 | 0 |   6620 |  -781 |  5174 |     1
-  9 | 0 |  0 | 0 | -14954 | -1593 |  2257 |     1
- 10 | 0 |  0 | 0 |  10047 | -7626 |  3923 |     1
- 14 | 0 |  0 | 0 | -13766 |  -398 |  4669 |     1
- 15 | 0 |  0 | 0 | -13009 | 14045 | 15101 |     1
- 19 | 0 |  0 | 0 | -16257 |  4566 |  7684 |     1
- 22 | 0 |  0 | 0 |  -6345 | -8658 | 11755 |     1
-
-select x, count(*) from agggroup where cint2 > 0 group by x order by count(*), x limit 10;
- x  | count 
-----+-------
- $  |  9877
- 3  |  9884
- 6  |  9890
- 4  |  9897
- 8  |  9898
- 7  |  9973
- 0  | 10012
- 9  | 10018
- 11 | 10105
- 5  | 10110
-
-select cint4, cint2, count(cint2) from agggroup where cint2 > 0 group by cint4, cint2 order by count(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -16383 |   607 |     1
- -16382 |    94 |     1
- -16382 |   569 |     1
- -16382 |  1891 |     1
- -16382 |  4679 |     1
- -16382 | 10118 |     1
- -16382 | 14467 |     1
- -16382 | 15369 |     1
- -16380 |   448 |     1
- -16379 |   390 |     1
-
-select cint4, cint8, count(cint2) from agggroup where cint2 > 0 group by cint4, cint8 order by count(cint2), cint4, cint8 limit 10;
- cint4  | cint8 | count 
---------+-------+-------
- -16383 |  4889 |     1
- -16382 | -8851 |     1
- -16382 | -4489 |     1
- -16382 |  -470 |     1
- -16382 |   411 |     1
- -16382 |  8377 |     1
- -16382 |  8832 |     1
- -16382 | 15709 |     1
- -16380 |  1449 |     1
- -16379 |  1234 |     1
-
-select cint2, cint4, cint8, count(cint2) from agggroup where cint2 > 0 group by cint2, cint4, cint8 order by count(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     1 | -12025 |  -2210 |     1
-     1 | -10344 | -13684 |     1
-     1 |  -4190 |  -2827 |     1
-     1 |  -1493 |  -1043 |     1
-     1 |   1863 |   7650 |     1
-     1 |   9242 |  -9798 |     1
-     1 |  11189 |  -5168 |     1
-     1 |  14078 |   9929 |     1
-     1 |  15656 |  12597 |     1
-     2 | -11410 |   6033 |     1
-
-select s, cint2, count(cint2) from agggroup where cint2 > 0 group by s, cint2 order by count(cint2), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 0 |     4 |     1
- 0 |     7 |     1
- 0 |     8 |     1
- 0 |     9 |     1
- 0 |    10 |     1
- 0 |    11 |     1
- 0 |    18 |     1
- 0 |    24 |     1
- 0 |    28 |     1
- 0 |    31 |     1
-
-select s, ss, count(cint2) from agggroup where cint2 > 0 group by s, ss order by count(cint2), s, ss limit 10;
- s | ss | count 
----+----+-------
- 3 |  $ |     9
- 4 | 11 |     9
- 2 |  $ |  9868
- 3 |  3 |  9884
- 6 |  6 |  9890
- 4 |  4 |  9897
- 8 |  8 |  9898
- 7 |  7 |  9973
- 0 |  0 | 10012
- 9 |  9 | 10018
-
-select s, x, count(cint2) from agggroup where cint2 > 0 group by s, x order by count(cint2), s, x limit 10;
- s | x  | count 
----+----+-------
- 3 | $  |     9
- 4 | 11 |     9
- 2 | $  |  9868
- 3 | 3  |  9884
- 6 | 6  |  9890
- 4 | 4  |  9897
- 8 | 8  |  9898
- 7 | 7  |  9973
- 0 | 0  | 10012
- 9 | 9  | 10018
-
-select ss, cint2, x, count(cint2) from agggroup where cint2 > 0 group by ss, cint2, x order by count(cint2), ss, cint2, x limit 10;
- ss | cint2 | x | count 
-----+-------+---+-------
-  0 |     4 | 0 |     1
-  0 |     7 | 0 |     1
-  0 |     8 | 0 |     1
-  0 |     9 | 0 |     1
-  0 |    10 | 0 |     1
-  0 |    11 | 0 |     1
-  0 |    18 | 0 |     1
-  0 |    24 | 0 |     1
-  0 |    28 | 0 |     1
-  0 |    31 | 0 |     1
-
-select ss, s, count(cint2) from agggroup where cint2 > 0 group by ss, s order by count(cint2), ss, s limit 10;
- ss | s | count 
-----+---+-------
- 11 | 4 |     9
-  $ | 3 |     9
-  $ | 2 |  9868
-  3 | 3 |  9884
-  6 | 6 |  9890
-  4 | 4 |  9897
-  8 | 8 |  9898
-  7 | 7 |  9973
-  0 | 0 | 10012
-  9 | 9 | 10018
-
-select ss, x, cint2, count(cint2) from agggroup where cint2 > 0 group by ss, x, cint2 order by count(cint2), ss, x, cint2 limit 10;
- ss | x | cint2 | count 
-----+---+-------+-------
-  0 | 0 |     4 |     1
-  0 | 0 |     7 |     1
-  0 | 0 |     8 |     1
-  0 | 0 |     9 |     1
-  0 | 0 |    10 |     1
-  0 | 0 |    11 |     1
-  0 | 0 |    18 |     1
-  0 | 0 |    24 |     1
-  0 | 0 |    28 |     1
-  0 | 0 |    31 |     1
-
-select t, s, ss, x, cint4, cint8, cint2, count(cint2) from agggroup where cint2 > 0 group by t, s, ss, x, cint4, cint8, cint2 order by count(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
- t  | s | ss | x | cint4  | cint8 | cint2 | count 
-----+---+----+---+--------+-------+-------+-------
-  1 | 0 |  0 | 0 | -15736 | 12910 |  3398 |     1
-  5 | 0 |  0 | 0 |   9267 |  6436 |  4859 |     1
-  6 | 0 |  0 | 0 |  -5203 |  9870 | 12177 |     1
-  7 | 0 |  0 | 0 |   6620 |  -781 |  5174 |     1
-  9 | 0 |  0 | 0 | -14954 | -1593 |  2257 |     1
- 10 | 0 |  0 | 0 |  10047 | -7626 |  3923 |     1
- 14 | 0 |  0 | 0 | -13766 |  -398 |  4669 |     1
- 15 | 0 |  0 | 0 | -13009 | 14045 | 15101 |     1
- 19 | 0 |  0 | 0 | -16257 |  4566 |  7684 |     1
- 22 | 0 |  0 | 0 |  -6345 | -8658 | 11755 |     1
-
-select x, count(cint2) from agggroup where cint2 > 0 group by x order by count(cint2), x limit 10;
- x  | count 
-----+-------
- $  |  9877
- 3  |  9884
- 6  |  9890
- 4  |  9897
- 8  |  9898
- 7  |  9973
- 0  | 10012
- 9  | 10018
- 11 | 10105
- 5  | 10110
-
-select cint4, cint2, min(cint2) from agggroup where cint2 > 0 group by cint4, cint2 order by min(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | min 
---------+-------+-----
- -12025 |     1 |   1
- -10344 |     1 |   1
-  -4190 |     1 |   1
-  -1493 |     1 |   1
-   1863 |     1 |   1
-   9242 |     1 |   1
-  11189 |     1 |   1
-  14078 |     1 |   1
-  15656 |     1 |   1
- -11410 |     2 |   2
-
-select cint4, cint8, min(cint2) from agggroup where cint2 > 0 group by cint4, cint8 order by min(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | min 
---------+--------+-----
- -12025 |  -2210 |   1
- -10344 | -13684 |   1
-  -4190 |  -2827 |   1
-  -1493 |  -1043 |   1
-   1863 |   7650 |   1
-   9242 |  -9798 |   1
-  11189 |  -5168 |   1
-  14078 |   9929 |   1
-  15656 |  12597 |   1
- -11410 |   6033 |   2
-
-select cint2, cint4, cint8, min(cint2) from agggroup where cint2 > 0 group by cint2, cint4, cint8 order by min(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | min 
--------+--------+--------+-----
-     1 | -12025 |  -2210 |   1
-     1 | -10344 | -13684 |   1
-     1 |  -4190 |  -2827 |   1
-     1 |  -1493 |  -1043 |   1
-     1 |   1863 |   7650 |   1
-     1 |   9242 |  -9798 |   1
-     1 |  11189 |  -5168 |   1
-     1 |  14078 |   9929 |   1
-     1 |  15656 |  12597 |   1
-     2 | -11410 |   6033 |   2
-
-select s, cint2, min(cint2) from agggroup where cint2 > 0 group by s, cint2 order by min(cint2), s, cint2 limit 10;
- s | cint2 | min 
----+-------+-----
- 1 |     1 |   1
- 2 |     1 |   1
- 3 |     1 |   1
- 5 |     1 |   1
- 7 |     1 |   1
- 8 |     1 |   1
- 1 |     2 |   2
- 3 |     2 |   2
- 7 |     2 |   2
- 9 |     2 |   2
-
-select s, ss, min(cint2) from agggroup where cint2 > 0 group by s, ss order by min(cint2), s, ss limit 10;
- s | ss | min 
----+----+-----
- 1 | 11 |   1
- 2 |  $ |   1
- 3 |  3 |   1
- 5 |  5 |   1
- 7 |  7 |   1
- 8 |  8 |   1
- 9 |  9 |   2
- 6 |  6 |   3
- 0 |  0 |   4
- 4 |  4 |   4
-
-select s, x, min(cint2) from agggroup where cint2 > 0 group by s, x order by min(cint2), s, x limit 10;
- s | x  | min 
----+----+-----
- 1 | 11 |   1
- 2 | $  |   1
- 3 | 3  |   1
- 5 | 5  |   1
- 7 | 7  |   1
- 8 | 8  |   1
- 9 | 9  |   2
- 6 | 6  |   3
- 0 | 0  |   4
- 4 | 4  |   4
-
-select ss, cint2, x, min(cint2) from agggroup where cint2 > 0 group by ss, cint2, x order by min(cint2), ss, cint2, x limit 10;
- ss | cint2 | x  | min 
-----+-------+----+-----
-  3 |     1 | 3  |   1
-  5 |     1 | 5  |   1
-  7 |     1 | 7  |   1
-  8 |     1 | 8  |   1
- 11 |     1 | 11 |   1
-  $ |     1 | $  |   1
-  3 |     2 | 3  |   2
-  7 |     2 | 7  |   2
-  9 |     2 | 9  |   2
- 11 |     2 | 11 |   2
-
-select ss, s, min(cint2) from agggroup where cint2 > 0 group by ss, s order by min(cint2), ss, s limit 10;
- ss | s | min 
-----+---+-----
-  3 | 3 |   1
-  5 | 5 |   1
-  7 | 7 |   1
-  8 | 8 |   1
- 11 | 1 |   1
-  $ | 2 |   1
-  9 | 9 |   2
-  6 | 6 |   3
-  0 | 0 |   4
-  4 | 4 |   4
-
-select ss, x, cint2, min(cint2) from agggroup where cint2 > 0 group by ss, x, cint2 order by min(cint2), ss, x, cint2 limit 10;
- ss | x  | cint2 | min 
-----+----+-------+-----
-  3 | 3  |     1 |   1
-  5 | 5  |     1 |   1
-  7 | 7  |     1 |   1
-  8 | 8  |     1 |   1
- 11 | 11 |     1 |   1
-  $ | $  |     1 |   1
-  3 | 3  |     2 |   2
-  7 | 7  |     2 |   2
-  9 | 9  |     2 |   2
- 11 | 11 |     2 |   2
-
-select t, s, ss, x, cint4, cint8, cint2, min(cint2) from agggroup where cint2 > 0 group by t, s, ss, x, cint4, cint8, cint2 order by min(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x  | cint4  | cint8  | cint2 | min 
--------+---+----+----+--------+--------+-------+-----
- 11611 | 1 | 11 | 11 | -12025 |  -2210 |     1 |   1
- 28649 | 2 |  $ | $  |  -1493 |  -1043 |     1 |   1
- 28786 | 1 | 11 | 11 |  -4190 |  -2827 |     1 |   1
- 41774 | 3 |  3 | 3  |   1863 |   7650 |     1 |   1
- 41779 | 3 |  3 | 3  |  14078 |   9929 |     1 |   1
- 51152 | 5 |  5 | 5  |   9242 |  -9798 |     1 |   1
- 70932 | 7 |  7 | 7  | -10344 | -13684 |     1 |   1
- 86957 | 7 |  7 | 7  |  15656 |  12597 |     1 |   1
- 89689 | 8 |  8 | 8  |  11189 |  -5168 |     1 |   1
- 22147 | 1 | 11 | 11 |  -9569 |   9760 |     2 |   2
-
-select x, min(cint2) from agggroup where cint2 > 0 group by x order by min(cint2), x limit 10;
- x  | min 
-----+-----
- 11 |   1
- 3  |   1
- 5  |   1
- 7  |   1
- 8  |   1
- $  |   1
- 9  |   2
- 6  |   3
- 0  |   4
- 4  |   4
-
-select cint4, cint2, count(*) from agggroup where cint2 is null group by cint4, cint2 order by count(*), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -16291 |     $ |     1
- -16091 |     $ |     1
- -15799 |     $ |     1
- -15724 |     $ |     1
- -15328 |     $ |     1
- -15279 |     $ |     1
- -15063 |     $ |     1
- -14998 |     $ |     1
- -14949 |     $ |     1
- -14848 |     $ |     1
-
-select cint4, cint8, count(*) from agggroup where cint2 is null group by cint4, cint8 order by count(*), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -16291 |    113 |     1
- -16091 |  -4084 |     1
- -15799 |  12603 |     1
- -15724 |  15426 |     1
- -15328 |  -6092 |     1
- -15279 |  -3475 |     1
- -15063 |   3990 |     1
- -14998 |  14464 |     1
- -14949 | -10395 |     1
- -14848 |   3110 |     1
-
-select cint2, cint4, cint8, count(*) from agggroup where cint2 is null group by cint2, cint4, cint8 order by count(*), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -16291 |    113 |     1
-     $ | -16091 |  -4084 |     1
-     $ | -15799 |  12603 |     1
-     $ | -15724 |  15426 |     1
-     $ | -15328 |  -6092 |     1
-     $ | -15279 |  -3475 |     1
-     $ | -15063 |   3990 |     1
-     $ | -14998 |  14464 |     1
-     $ | -14949 | -10395 |     1
-     $ | -14848 |   3110 |     1
-
-select s, cint2, count(*) from agggroup where cint2 is null group by s, cint2 order by count(*), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 0 |     $ |    19
- 1 |     $ |    19
- 2 |     $ |    19
- 3 |     $ |    19
- 4 |     $ |    19
- 5 |     $ |    19
- 6 |     $ |    19
- 7 |     $ |    19
- 8 |     $ |    19
- 9 |     $ |    19
-
-select s, ss, count(*) from agggroup where cint2 is null group by s, ss order by count(*), s, ss limit 10;
- s | ss | count 
----+----+-------
- 0 |  0 |    19
- 1 | 11 |    19
- 2 |  $ |    19
- 3 |  3 |    19
- 4 |  4 |    19
- 5 |  5 |    19
- 6 |  6 |    19
- 7 |  7 |    19
- 8 |  8 |    19
- 9 |  9 |    19
-
-select s, x, count(*) from agggroup where cint2 is null group by s, x order by count(*), s, x limit 10;
- s | x  | count 
----+----+-------
- 0 | 0  |    19
- 1 | 11 |    19
- 2 | $  |    19
- 3 | 3  |    19
- 4 | 4  |    19
- 5 | 5  |    19
- 6 | 6  |    19
- 7 | 7  |    19
- 8 | 8  |    19
- 9 | 9  |    19
-
-select ss, cint2, x, count(*) from agggroup where cint2 is null group by ss, cint2, x order by count(*), ss, cint2, x limit 10;
- ss | cint2 | x  | count 
-----+-------+----+-------
-  0 |     $ | 0  |    19
-  3 |     $ | 3  |    19
-  4 |     $ | 4  |    19
-  5 |     $ | 5  |    19
-  6 |     $ | 6  |    19
-  7 |     $ | 7  |    19
-  8 |     $ | 8  |    19
-  9 |     $ | 9  |    19
- 11 |     $ | 11 |    19
-  $ |     $ | $  |    19
-
-select ss, s, count(*) from agggroup where cint2 is null group by ss, s order by count(*), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  0 | 0 |    19
-  3 | 3 |    19
-  4 | 4 |    19
-  5 | 5 |    19
-  6 | 6 |    19
-  7 | 7 |    19
-  8 | 8 |    19
-  9 | 9 |    19
- 11 | 1 |    19
-  $ | 2 |    19
-
-select ss, x, cint2, count(*) from agggroup where cint2 is null group by ss, x, cint2 order by count(*), ss, x, cint2 limit 10;
- ss | x  | cint2 | count 
-----+----+-------+-------
-  0 | 0  |     $ |    19
-  3 | 3  |     $ |    19
-  4 | 4  |     $ |    19
-  5 | 5  |     $ |    19
-  6 | 6  |     $ |    19
-  7 | 7  |     $ |    19
-  8 | 8  |     $ |    19
-  9 | 9  |     $ |    19
- 11 | 11 |     $ |    19
-  $ | $  |     $ |    19
-
-select t, s, ss, x, cint4, cint8, cint2, count(*) from agggroup where cint2 is null group by t, s, ss, x, cint4, cint8, cint2 order by count(*), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
-  1051 | 0 |  0 | 0 |  -8612 |  14327 |     $ |     1
-  2102 | 0 |  0 | 0 |  11069 |  16047 |     $ |     1
-  3153 | 0 |  0 | 0 |   6192 |  12700 |     $ |     1
-  4204 | 0 |  0 | 0 |   4165 | -10102 |     $ |     1
-  5255 | 0 |  0 | 0 |  16314 |  13418 |     $ |     1
-  6306 | 0 |  0 | 0 |    701 |  -3029 |     $ |     1
-  7357 | 0 |  0 | 0 |   1115 |   4913 |     $ |     1
-  8408 | 0 |  0 | 0 |  15553 |   1743 |     $ |     1
-  9459 | 0 |  0 | 0 | -14640 |  11933 |     $ |     1
- 10510 | 0 |  0 | 0 | -14725 |   6531 |     $ |     1
-
-select x, count(*) from agggroup where cint2 is null group by x order by count(*), x limit 10;
- x  | count 
-----+-------
- 0  |    19
- 11 |    19
- 3  |    19
- 4  |    19
- 5  |    19
- 6  |    19
- 7  |    19
- 8  |    19
- 9  |    19
- $  |    19
-
-select cint4, cint2, count(cint2) from agggroup where cint2 is null group by cint4, cint2 order by count(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -16291 |     $ |     0
- -16091 |     $ |     0
- -15799 |     $ |     0
- -15724 |     $ |     0
- -15328 |     $ |     0
- -15279 |     $ |     0
- -15063 |     $ |     0
- -14998 |     $ |     0
- -14949 |     $ |     0
- -14848 |     $ |     0
-
-select cint4, cint8, count(cint2) from agggroup where cint2 is null group by cint4, cint8 order by count(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -16291 |    113 |     0
- -16091 |  -4084 |     0
- -15799 |  12603 |     0
- -15724 |  15426 |     0
- -15328 |  -6092 |     0
- -15279 |  -3475 |     0
- -15063 |   3990 |     0
- -14998 |  14464 |     0
- -14949 | -10395 |     0
- -14848 |   3110 |     0
-
-select cint2, cint4, cint8, count(cint2) from agggroup where cint2 is null group by cint2, cint4, cint8 order by count(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -16291 |    113 |     0
-     $ | -16091 |  -4084 |     0
-     $ | -15799 |  12603 |     0
-     $ | -15724 |  15426 |     0
-     $ | -15328 |  -6092 |     0
-     $ | -15279 |  -3475 |     0
-     $ | -15063 |   3990 |     0
-     $ | -14998 |  14464 |     0
-     $ | -14949 | -10395 |     0
-     $ | -14848 |   3110 |     0
-
-select s, cint2, count(cint2) from agggroup where cint2 is null group by s, cint2 order by count(cint2), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 0 |     $ |     0
- 1 |     $ |     0
- 2 |     $ |     0
- 3 |     $ |     0
- 4 |     $ |     0
- 5 |     $ |     0
- 6 |     $ |     0
- 7 |     $ |     0
- 8 |     $ |     0
- 9 |     $ |     0
-
-select s, ss, count(cint2) from agggroup where cint2 is null group by s, ss order by count(cint2), s, ss limit 10;
- s | ss | count 
----+----+-------
- 0 |  0 |     0
- 1 | 11 |     0
- 2 |  $ |     0
- 3 |  3 |     0
- 4 |  4 |     0
- 5 |  5 |     0
- 6 |  6 |     0
- 7 |  7 |     0
- 8 |  8 |     0
- 9 |  9 |     0
-
-select s, x, count(cint2) from agggroup where cint2 is null group by s, x order by count(cint2), s, x limit 10;
- s | x  | count 
----+----+-------
- 0 | 0  |     0
- 1 | 11 |     0
- 2 | $  |     0
- 3 | 3  |     0
- 4 | 4  |     0
- 5 | 5  |     0
- 6 | 6  |     0
- 7 | 7  |     0
- 8 | 8  |     0
- 9 | 9  |     0
-
-select ss, cint2, x, count(cint2) from agggroup where cint2 is null group by ss, cint2, x order by count(cint2), ss, cint2, x limit 10;
- ss | cint2 | x  | count 
-----+-------+----+-------
-  0 |     $ | 0  |     0
-  3 |     $ | 3  |     0
-  4 |     $ | 4  |     0
-  5 |     $ | 5  |     0
-  6 |     $ | 6  |     0
-  7 |     $ | 7  |     0
-  8 |     $ | 8  |     0
-  9 |     $ | 9  |     0
- 11 |     $ | 11 |     0
-  $ |     $ | $  |     0
-
-select ss, s, count(cint2) from agggroup where cint2 is null group by ss, s order by count(cint2), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  0 | 0 |     0
-  3 | 3 |     0
-  4 | 4 |     0
-  5 | 5 |     0
-  6 | 6 |     0
-  7 | 7 |     0
-  8 | 8 |     0
-  9 | 9 |     0
- 11 | 1 |     0
-  $ | 2 |     0
-
-select ss, x, cint2, count(cint2) from agggroup where cint2 is null group by ss, x, cint2 order by count(cint2), ss, x, cint2 limit 10;
- ss | x  | cint2 | count 
-----+----+-------+-------
-  0 | 0  |     $ |     0
-  3 | 3  |     $ |     0
-  4 | 4  |     $ |     0
-  5 | 5  |     $ |     0
-  6 | 6  |     $ |     0
-  7 | 7  |     $ |     0
-  8 | 8  |     $ |     0
-  9 | 9  |     $ |     0
- 11 | 11 |     $ |     0
-  $ | $  |     $ |     0
-
-select t, s, ss, x, cint4, cint8, cint2, count(cint2) from agggroup where cint2 is null group by t, s, ss, x, cint4, cint8, cint2 order by count(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
-  1051 | 0 |  0 | 0 |  -8612 |  14327 |     $ |     0
-  2102 | 0 |  0 | 0 |  11069 |  16047 |     $ |     0
-  3153 | 0 |  0 | 0 |   6192 |  12700 |     $ |     0
-  4204 | 0 |  0 | 0 |   4165 | -10102 |     $ |     0
-  5255 | 0 |  0 | 0 |  16314 |  13418 |     $ |     0
-  6306 | 0 |  0 | 0 |    701 |  -3029 |     $ |     0
-  7357 | 0 |  0 | 0 |   1115 |   4913 |     $ |     0
-  8408 | 0 |  0 | 0 |  15553 |   1743 |     $ |     0
-  9459 | 0 |  0 | 0 | -14640 |  11933 |     $ |     0
- 10510 | 0 |  0 | 0 | -14725 |   6531 |     $ |     0
-
-select x, count(cint2) from agggroup where cint2 is null group by x order by count(cint2), x limit 10;
- x  | count 
-----+-------
- 0  |     0
- 11 |     0
- 3  |     0
- 4  |     0
- 5  |     0
- 6  |     0
- 7  |     0
- 8  |     0
- 9  |     0
- $  |     0
-
-select cint4, cint2, min(cint2) from agggroup where cint2 is null group by cint4, cint2 order by min(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | min 
---------+-------+-----
- -16291 |     $ |   $
- -16091 |     $ |   $
- -15799 |     $ |   $
- -15724 |     $ |   $
- -15328 |     $ |   $
- -15279 |     $ |   $
- -15063 |     $ |   $
- -14998 |     $ |   $
- -14949 |     $ |   $
- -14848 |     $ |   $
-
-select cint4, cint8, min(cint2) from agggroup where cint2 is null group by cint4, cint8 order by min(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | min 
---------+--------+-----
- -16291 |    113 |   $
- -16091 |  -4084 |   $
- -15799 |  12603 |   $
- -15724 |  15426 |   $
- -15328 |  -6092 |   $
- -15279 |  -3475 |   $
- -15063 |   3990 |   $
- -14998 |  14464 |   $
- -14949 | -10395 |   $
- -14848 |   3110 |   $
-
-select cint2, cint4, cint8, min(cint2) from agggroup where cint2 is null group by cint2, cint4, cint8 order by min(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | min 
--------+--------+--------+-----
-     $ | -16291 |    113 |   $
-     $ | -16091 |  -4084 |   $
-     $ | -15799 |  12603 |   $
-     $ | -15724 |  15426 |   $
-     $ | -15328 |  -6092 |   $
-     $ | -15279 |  -3475 |   $
-     $ | -15063 |   3990 |   $
-     $ | -14998 |  14464 |   $
-     $ | -14949 | -10395 |   $
-     $ | -14848 |   3110 |   $
-
-select s, cint2, min(cint2) from agggroup where cint2 is null group by s, cint2 order by min(cint2), s, cint2 limit 10;
- s | cint2 | min 
----+-------+-----
- 0 |     $ |   $
- 1 |     $ |   $
- 2 |     $ |   $
- 3 |     $ |   $
- 4 |     $ |   $
- 5 |     $ |   $
- 6 |     $ |   $
- 7 |     $ |   $
- 8 |     $ |   $
- 9 |     $ |   $
-
-select s, ss, min(cint2) from agggroup where cint2 is null group by s, ss order by min(cint2), s, ss limit 10;
- s | ss | min 
----+----+-----
- 0 |  0 |   $
- 1 | 11 |   $
- 2 |  $ |   $
- 3 |  3 |   $
- 4 |  4 |   $
- 5 |  5 |   $
- 6 |  6 |   $
- 7 |  7 |   $
- 8 |  8 |   $
- 9 |  9 |   $
-
-select s, x, min(cint2) from agggroup where cint2 is null group by s, x order by min(cint2), s, x limit 10;
- s | x  | min 
----+----+-----
- 0 | 0  |   $
- 1 | 11 |   $
- 2 | $  |   $
- 3 | 3  |   $
- 4 | 4  |   $
- 5 | 5  |   $
- 6 | 6  |   $
- 7 | 7  |   $
- 8 | 8  |   $
- 9 | 9  |   $
-
-select ss, cint2, x, min(cint2) from agggroup where cint2 is null group by ss, cint2, x order by min(cint2), ss, cint2, x limit 10;
- ss | cint2 | x  | min 
-----+-------+----+-----
-  0 |     $ | 0  |   $
-  3 |     $ | 3  |   $
-  4 |     $ | 4  |   $
-  5 |     $ | 5  |   $
-  6 |     $ | 6  |   $
-  7 |     $ | 7  |   $
-  8 |     $ | 8  |   $
-  9 |     $ | 9  |   $
- 11 |     $ | 11 |   $
-  $ |     $ | $  |   $
-
-select ss, s, min(cint2) from agggroup where cint2 is null group by ss, s order by min(cint2), ss, s limit 10;
- ss | s | min 
-----+---+-----
-  0 | 0 |   $
-  3 | 3 |   $
-  4 | 4 |   $
-  5 | 5 |   $
-  6 | 6 |   $
-  7 | 7 |   $
-  8 | 8 |   $
-  9 | 9 |   $
- 11 | 1 |   $
-  $ | 2 |   $
-
-select ss, x, cint2, min(cint2) from agggroup where cint2 is null group by ss, x, cint2 order by min(cint2), ss, x, cint2 limit 10;
- ss | x  | cint2 | min 
-----+----+-------+-----
-  0 | 0  |     $ |   $
-  3 | 3  |     $ |   $
-  4 | 4  |     $ |   $
-  5 | 5  |     $ |   $
-  6 | 6  |     $ |   $
-  7 | 7  |     $ |   $
-  8 | 8  |     $ |   $
-  9 | 9  |     $ |   $
- 11 | 11 |     $ |   $
-  $ | $  |     $ |   $
-
-select t, s, ss, x, cint4, cint8, cint2, min(cint2) from agggroup where cint2 is null group by t, s, ss, x, cint4, cint8, cint2 order by min(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | min 
--------+---+----+---+--------+--------+-------+-----
-  1051 | 0 |  0 | 0 |  -8612 |  14327 |     $ |   $
-  2102 | 0 |  0 | 0 |  11069 |  16047 |     $ |   $
-  3153 | 0 |  0 | 0 |   6192 |  12700 |     $ |   $
-  4204 | 0 |  0 | 0 |   4165 | -10102 |     $ |   $
-  5255 | 0 |  0 | 0 |  16314 |  13418 |     $ |   $
-  6306 | 0 |  0 | 0 |    701 |  -3029 |     $ |   $
-  7357 | 0 |  0 | 0 |   1115 |   4913 |     $ |   $
-  8408 | 0 |  0 | 0 |  15553 |   1743 |     $ |   $
-  9459 | 0 |  0 | 0 | -14640 |  11933 |     $ |   $
- 10510 | 0 |  0 | 0 | -14725 |   6531 |     $ |   $
-
-select x, min(cint2) from agggroup where cint2 is null group by x order by min(cint2), x limit 10;
- x  | min 
-----+-----
- 0  |   $
- 11 |   $
- 3  |   $
- 4  |   $
- 5  |   $
- 6  |   $
- 7  |   $
- 8  |   $
- 9  |   $
- $  |   $
-
-select cint4, cint2, count(*) from agggroup where cint2 is null and x is null group by cint4, cint2 order by count(*), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -15063 |     $ |     1
- -14949 |     $ |     1
- -14443 |     $ |     1
- -11240 |     $ |     1
-  -8873 |     $ |     1
-  -7170 |     $ |     1
-  -4740 |     $ |     1
-  -1217 |     $ |     1
-   -166 |     $ |     1
-   -119 |     $ |     1
-
-select cint4, cint8, count(*) from agggroup where cint2 is null and x is null group by cint4, cint8 order by count(*), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -15063 |   3990 |     1
- -14949 | -10395 |     1
- -14443 | -12710 |     1
- -11240 |  -8825 |     1
-  -8873 | -12094 |     1
-  -7170 |   7723 |     1
-  -4740 |   7720 |     1
-  -1217 |   6383 |     1
-   -166 | -10858 |     1
-   -119 |   -231 |     1
-
-select cint2, cint4, cint8, count(*) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by count(*), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -15063 |   3990 |     1
-     $ | -14949 | -10395 |     1
-     $ | -14443 | -12710 |     1
-     $ | -11240 |  -8825 |     1
-     $ |  -8873 | -12094 |     1
-     $ |  -7170 |   7723 |     1
-     $ |  -4740 |   7720 |     1
-     $ |  -1217 |   6383 |     1
-     $ |   -166 | -10858 |     1
-     $ |   -119 |   -231 |     1
-
-select s, cint2, count(*) from agggroup where cint2 is null and x is null group by s, cint2 order by count(*), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 2 |     $ |    19
-
-select s, ss, count(*) from agggroup where cint2 is null and x is null group by s, ss order by count(*), s, ss limit 10;
- s | ss | count 
----+----+-------
- 2 |  $ |    19
-
-select s, x, count(*) from agggroup where cint2 is null and x is null group by s, x order by count(*), s, x limit 10;
- s | x | count 
----+---+-------
- 2 | $ |    19
-
-select ss, cint2, x, count(*) from agggroup where cint2 is null and x is null group by ss, cint2, x order by count(*), ss, cint2, x limit 10;
- ss | cint2 | x | count 
-----+-------+---+-------
-  $ |     $ | $ |    19
-
-select ss, s, count(*) from agggroup where cint2 is null and x is null group by ss, s order by count(*), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  $ | 2 |    19
-
-select ss, x, cint2, count(*) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by count(*), ss, x, cint2 limit 10;
- ss | x | cint2 | count 
-----+---+-------+-------
-  $ | $ |     $ |    19
-
-select t, s, ss, x, cint4, cint8, cint2, count(*) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by count(*), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |     1
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |     1
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |     1
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |     1
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |     1
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |     1
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |     1
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |     1
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |     1
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |     1
-
-select x, count(*) from agggroup where cint2 is null and x is null group by x order by count(*), x limit 10;
- x | count 
----+-------
- $ |    19
-
-select cint4, cint2, count(cint2) from agggroup where cint2 is null and x is null group by cint4, cint2 order by count(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -15063 |     $ |     0
- -14949 |     $ |     0
- -14443 |     $ |     0
- -11240 |     $ |     0
-  -8873 |     $ |     0
-  -7170 |     $ |     0
-  -4740 |     $ |     0
-  -1217 |     $ |     0
-   -166 |     $ |     0
-   -119 |     $ |     0
-
-select cint4, cint8, count(cint2) from agggroup where cint2 is null and x is null group by cint4, cint8 order by count(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -15063 |   3990 |     0
- -14949 | -10395 |     0
- -14443 | -12710 |     0
- -11240 |  -8825 |     0
-  -8873 | -12094 |     0
-  -7170 |   7723 |     0
-  -4740 |   7720 |     0
-  -1217 |   6383 |     0
-   -166 | -10858 |     0
-   -119 |   -231 |     0
-
-select cint2, cint4, cint8, count(cint2) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by count(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -15063 |   3990 |     0
-     $ | -14949 | -10395 |     0
-     $ | -14443 | -12710 |     0
-     $ | -11240 |  -8825 |     0
-     $ |  -8873 | -12094 |     0
-     $ |  -7170 |   7723 |     0
-     $ |  -4740 |   7720 |     0
-     $ |  -1217 |   6383 |     0
-     $ |   -166 | -10858 |     0
-     $ |   -119 |   -231 |     0
-
-select s, cint2, count(cint2) from agggroup where cint2 is null and x is null group by s, cint2 order by count(cint2), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 2 |     $ |     0
-
-select s, ss, count(cint2) from agggroup where cint2 is null and x is null group by s, ss order by count(cint2), s, ss limit 10;
- s | ss | count 
----+----+-------
- 2 |  $ |     0
-
-select s, x, count(cint2) from agggroup where cint2 is null and x is null group by s, x order by count(cint2), s, x limit 10;
- s | x | count 
----+---+-------
- 2 | $ |     0
-
-select ss, cint2, x, count(cint2) from agggroup where cint2 is null and x is null group by ss, cint2, x order by count(cint2), ss, cint2, x limit 10;
- ss | cint2 | x | count 
-----+-------+---+-------
-  $ |     $ | $ |     0
-
-select ss, s, count(cint2) from agggroup where cint2 is null and x is null group by ss, s order by count(cint2), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  $ | 2 |     0
-
-select ss, x, cint2, count(cint2) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by count(cint2), ss, x, cint2 limit 10;
- ss | x | cint2 | count 
-----+---+-------+-------
-  $ | $ |     $ |     0
-
-select t, s, ss, x, cint4, cint8, cint2, count(cint2) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by count(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |     0
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |     0
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |     0
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |     0
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |     0
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |     0
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |     0
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |     0
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |     0
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |     0
-
-select x, count(cint2) from agggroup where cint2 is null and x is null group by x order by count(cint2), x limit 10;
- x | count 
----+-------
- $ |     0
-
-select cint4, cint2, min(cint2) from agggroup where cint2 is null and x is null group by cint4, cint2 order by min(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | min 
---------+-------+-----
- -15063 |     $ |   $
- -14949 |     $ |   $
- -14443 |     $ |   $
- -11240 |     $ |   $
-  -8873 |     $ |   $
-  -7170 |     $ |   $
-  -4740 |     $ |   $
-  -1217 |     $ |   $
-   -166 |     $ |   $
-   -119 |     $ |   $
-
-select cint4, cint8, min(cint2) from agggroup where cint2 is null and x is null group by cint4, cint8 order by min(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | min 
---------+--------+-----
- -15063 |   3990 |   $
- -14949 | -10395 |   $
- -14443 | -12710 |   $
- -11240 |  -8825 |   $
-  -8873 | -12094 |   $
-  -7170 |   7723 |   $
-  -4740 |   7720 |   $
-  -1217 |   6383 |   $
-   -166 | -10858 |   $
-   -119 |   -231 |   $
-
-select cint2, cint4, cint8, min(cint2) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by min(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | min 
--------+--------+--------+-----
-     $ | -15063 |   3990 |   $
-     $ | -14949 | -10395 |   $
-     $ | -14443 | -12710 |   $
-     $ | -11240 |  -8825 |   $
-     $ |  -8873 | -12094 |   $
-     $ |  -7170 |   7723 |   $
-     $ |  -4740 |   7720 |   $
-     $ |  -1217 |   6383 |   $
-     $ |   -166 | -10858 |   $
-     $ |   -119 |   -231 |   $
-
-select s, cint2, min(cint2) from agggroup where cint2 is null and x is null group by s, cint2 order by min(cint2), s, cint2 limit 10;
- s | cint2 | min 
----+-------+-----
- 2 |     $ |   $
-
-select s, ss, min(cint2) from agggroup where cint2 is null and x is null group by s, ss order by min(cint2), s, ss limit 10;
- s | ss | min 
----+----+-----
- 2 |  $ |   $
-
-select s, x, min(cint2) from agggroup where cint2 is null and x is null group by s, x order by min(cint2), s, x limit 10;
- s | x | min 
----+---+-----
- 2 | $ |   $
-
-select ss, cint2, x, min(cint2) from agggroup where cint2 is null and x is null group by ss, cint2, x order by min(cint2), ss, cint2, x limit 10;
- ss | cint2 | x | min 
-----+-------+---+-----
-  $ |     $ | $ |   $
-
-select ss, s, min(cint2) from agggroup where cint2 is null and x is null group by ss, s order by min(cint2), ss, s limit 10;
- ss | s | min 
-----+---+-----
-  $ | 2 |   $
-
-select ss, x, cint2, min(cint2) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by min(cint2), ss, x, cint2 limit 10;
- ss | x | cint2 | min 
-----+---+-------+-----
-  $ | $ |     $ |   $
-
-select t, s, ss, x, cint4, cint8, cint2, min(cint2) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by min(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | min 
--------+---+----+---+--------+--------+-------+-----
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |   $
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |   $
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |   $
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |   $
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |   $
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |   $
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |   $
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |   $
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |   $
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |   $
-
-select x, min(cint2) from agggroup where cint2 is null and x is null group by x order by min(cint2), x limit 10;
- x | min 
----+-----
- $ |   $
-
-reset timescaledb.debug_require_vector_agg;
--- Test long text columns. Also make one of them a segmentby, so that we can
--- test the long scalar values.
-create table long(t int, a text, b text, c text, d text);
-select create_hypertable('long', 't');
- create_hypertable 
--------------------
- (3,public,long,t)
-
-insert into long select n, a, x, x, x from (
-    select n, 'short' || m a, repeat('1', 100 * 4 + n) x
-    from generate_series(1, 4) n,
-        generate_series(1, 4) m) t
-;
-insert into long values (-1, 'a', 'b', 'c', 'd');
-insert into long values (-2, repeat('long', 1000), 'b', 'c', 'd');
-alter table long set (timescaledb.compress, timescaledb.compress_segmentby = 'a',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('long') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
--- Various placements of long scalar column
-select sum(t) from long group by a, b, c, d order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
-select sum(t) from long group by d, b, c, a order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
-select sum(t) from long group by d, b, a, c order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
--- Just the scalar column
-select sum(t) from long group by a order by 1;
- sum 
------
-  -2
-  -1
-  10
-  10
-  10
-  10
-
--- No scalar columns
-select sum(t) from long group by b, c, d order by 1 limit 10;
- sum 
------
-  -3
-   4
-   8
-  12
-  16
-
-reset timescaledb.debug_require_vector_agg;
--- Test various serialized key lengths. We want to touch the transition from short
--- to long varlena header for the serialized key.
-create table keylength(t int, a text, b text);
-select create_hypertable('keylength', 't');
-   create_hypertable    
-------------------------
- (5,public,keylength,t)
-
-insert into keylength select t, 'a', repeat('b', t) from generate_series(1, 1000) t;
-insert into keylength values (-1, '', ''); -- second chunk
-alter table keylength set (timescaledb.compress, timescaledb.compress_segmentby = '',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('keylength') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
-select sum(t) from keylength group by a, b order by 1 desc limit 10;
- sum  
-------
- 1000
-  999
-  998
-  997
-  996
-  995
-  994
-  993
-  992
-  991
-
-select sum(t) from keylength group by b, a order by 1 desc limit 10;
- sum  
-------
- 1000
-  999
-  998
-  997
-  996
-  995
-  994
-  993
-  992
-  991
-
-reset timescaledb.debug_require_vector_agg;
--- Add a very simple test for NULLs. We also have some null values in the general
--- grouping test above.
-create table groupnull(t int, a text, b text);
-select create_hypertable('groupnull', 't');
-   create_hypertable    
-------------------------
- (7,public,groupnull,t)
-
-insert into groupnull values (1, '1', null), (2, null, '2'), (3000000, '3', '3');
-alter table groupnull set (timescaledb.compress, timescaledb.compress_segmentby = '',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('groupnull') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
-select sum(t), a, b from groupnull group by a, b order by 1;
-   sum   | a | b 
----------+---+---
-       1 | 1 | $
-       2 | $ | 2
- 3000000 | 3 | 3
-
-select sum(t), a, b from groupnull group by b, a order by 1;
-   sum   | a | b 
----------+---+---
-       1 | 1 | $
-       2 | $ | 2
- 3000000 | 3 | 3
-
-reset timescaledb.debug_require_vector_agg;
+ERROR:  postgres partial aggregation nodes inconsistent with debug_require_vector_agg GUC
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_memory.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_memory.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_memory.out	2025-11-06 02:35:39.313068287 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_memory.out	2025-11-06 02:48:36.001217293 +0000
@@ -40,16 +40,17 @@
 --- QUERY PLAN ---
  Result
    ->  Unique
-         ->  Merge Append
+         ->  Sort
                Sort Key: mvagg.s0, mvagg.s1, mvagg.t DESC
-               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
-                     Vectorized Filter: ((t >= '-1'::integer) AND (t < 1000000))
-                     ->  Index Scan using compress_hyper_2_3_chunk_s0_s1__ts_meta_min_1__ts_meta_max__idx on compress_hyper_2_3_chunk
-                           Index Cond: ((_ts_meta_min_1 < 1000000) AND (_ts_meta_max_1 >= '-1'::integer))
-               ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk
-                     Vectorized Filter: ((t >= '-1'::integer) AND (t < 1000000))
-                     ->  Index Scan using compress_hyper_2_4_chunk_s0_s1__ts_meta_min_1__ts_meta_max__idx on compress_hyper_2_4_chunk
-                           Index Cond: ((_ts_meta_min_1 < 1000000) AND (_ts_meta_max_1 >= '-1'::integer))
+               ->  Append
+                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
+                           Vectorized Filter: ((t >= '-1'::integer) AND (t < 1000000))
+                           ->  Seq Scan on compress_hyper_2_3_chunk
+                                 Filter: ((_ts_meta_max_1 >= '-1'::integer) AND (_ts_meta_min_1 < 1000000))
+                     ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk
+                           Vectorized Filter: ((t >= '-1'::integer) AND (t < 1000000))
+                           ->  Index Scan using compress_hyper_2_4_chunk_s0_s1__ts_meta_min_1__ts_meta_max__idx on compress_hyper_2_4_chunk
+                                 Index Cond: ((_ts_meta_min_1 < 1000000) AND (_ts_meta_max_1 >= '-1'::integer))
 
 truncate log;
 \set ECHO none
@@ -58,8 +59,15 @@
     -- small spurious changes to make this test more robust.
     select regr_slope(bytes, n) > 1/65536 from log
 );
- n | bytes | a | b | c | d | e | f 
----+-------+---+---+---+---+---+---
+    n     |  bytes  | a | b | c | d | e | f 
+----------+---------+---+---+---+---+---+---
+       10 |  497776 | 0 | 0 | 0 | 0 | 0 | 0
+      100 |  497776 | 0 | 0 | 0 | 0 | 0 | 0
+     1000 |  620656 | 0 | 0 | 0 | 0 | 0 | 0
+    10000 |  440368 | 0 | 0 | 0 | 0 | 0 | 0
+   100000 |  440368 | 0 | 0 | 0 | 0 | 0 | 0
+  1000000 | 4763232 | 0 | 0 | 0 | 0 | 0 | 0
+ 10000000 | 4763296 | 0 | 0 | 0 | 0 | 0 | 0
 
 -- Test the vectorized aggregation with grouping by segmentby with various number
 -- of input row. We expect approximately constant memory usage.
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_segmentby.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_segmentby.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_segmentby.out	2025-11-06 02:35:39.313068287 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_segmentby.out	2025-11-06 02:48:26.184334712 +0000
@@ -138,16 +138,17 @@
 explain (buffers off, costs off)
 select sum(t), s, count(*) from svagg group by s order by s;
 --- QUERY PLAN ---
- Finalize GroupAggregate
-   Group Key: svagg.s
-   ->  Custom Scan (ChunkAppend) on svagg
-         Order: svagg.s
-         ->  Custom Scan (VectorAgg)
-               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
-                     ->  Index Scan using compress_hyper_2_3_chunk_s__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_2_3_chunk
-         ->  Custom Scan (VectorAgg)
-               ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk
-                     ->  Index Scan using compress_hyper_2_4_chunk_s__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_2_4_chunk
+ Sort
+   Sort Key: svagg.s
+   ->  Finalize HashAggregate
+         Group Key: svagg.s
+         ->  Append
+               ->  Custom Scan (VectorAgg)
+                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
+                           ->  Seq Scan on compress_hyper_2_3_chunk
+               ->  Custom Scan (VectorAgg)
+                     ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk
+                           ->  Seq Scan on compress_hyper_2_4_chunk
 
 select sum(t) from svagg group by s order by 1;
     sum     
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_uuid.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_uuid.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_uuid.out	2025-11-06 02:35:39.313068287 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_uuid.out	2025-11-06 02:48:21.116395943 +0000
@@ -132,12 +132,12 @@
 -----+--------------------------------------+----+-------------------------------------
    7 | 01941f29-7c00-706a-bea9-105dad841304 | 17 | Tue Dec 31 16:00:00.000025 2024 PST
    7 | 01941f2a-665f-7722-b4b5-cf4e70e666d0 | 18 | Tue Dec 31 16:00:59.999445 2024 PST
-   7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  4 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  3 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  2 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  1 | Wed Jun 25 08:16:46.347777 2025 PDT
-   7 | 0197a7a9-b48b-7c75-a810-8acf630e634f |  5 | Wed Jun 25 08:16:46.347778 2025 PDT
+   7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  4 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c75-a810-8acf630e634f |  6 | Wed Jun 25 08:16:46.347778 2025 PDT
+   7 | 0197a7a9-b48b-7c75-a810-8acf630e634f |  5 | Wed Jun 25 08:16:46.347778 2025 PDT
    7 | 0197a7a9-b48b-7c76-b616-69e64a802b5c |  7 | Wed Jun 25 08:16:46.347778 2025 PDT
 
 SELECT ver, u, count(*), sum(ts) from uuid_table
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vectorized_aggregation.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vectorized_aggregation.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vectorized_aggregation.out	2025-11-06 02:35:39.313068287 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vectorized_aggregation.out	2025-11-06 02:48:23.343369601 +0000
@@ -2287,90 +2287,87 @@
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.int_value)
-   ->  Gather
-         Output: (PARTIAL sum(testtable.int_value))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_41_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_41_chunk
-                           Output: _hyper_1_41_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_51_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_51_chunk
-                                 Output: compress_hyper_2_51_chunk._ts_meta_count, compress_hyper_2_51_chunk.segment_by_value, compress_hyper_2_51_chunk._ts_meta_min_1, compress_hyper_2_51_chunk._ts_meta_max_1, compress_hyper_2_51_chunk."time", compress_hyper_2_51_chunk.int_value, compress_hyper_2_51_chunk.float_value
-                                 Index Cond: (compress_hyper_2_51_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_42_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_42_chunk
-                           Output: _hyper_1_42_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_52_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_52_chunk
-                                 Output: compress_hyper_2_52_chunk._ts_meta_count, compress_hyper_2_52_chunk.segment_by_value, compress_hyper_2_52_chunk._ts_meta_min_1, compress_hyper_2_52_chunk._ts_meta_max_1, compress_hyper_2_52_chunk."time", compress_hyper_2_52_chunk.int_value, compress_hyper_2_52_chunk.float_value
-                                 Index Cond: (compress_hyper_2_52_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_43_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_43_chunk
-                           Output: _hyper_1_43_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_53_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_53_chunk
-                                 Output: compress_hyper_2_53_chunk._ts_meta_count, compress_hyper_2_53_chunk.segment_by_value, compress_hyper_2_53_chunk._ts_meta_min_1, compress_hyper_2_53_chunk._ts_meta_max_1, compress_hyper_2_53_chunk."time", compress_hyper_2_53_chunk.int_value, compress_hyper_2_53_chunk.float_value
-                                 Index Cond: (compress_hyper_2_53_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_44_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_44_chunk
-                           Output: _hyper_1_44_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_54_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_54_chunk
-                                 Output: compress_hyper_2_54_chunk._ts_meta_count, compress_hyper_2_54_chunk.segment_by_value, compress_hyper_2_54_chunk._ts_meta_min_1, compress_hyper_2_54_chunk._ts_meta_max_1, compress_hyper_2_54_chunk."time", compress_hyper_2_54_chunk.int_value, compress_hyper_2_54_chunk.float_value
-                                 Index Cond: (compress_hyper_2_54_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_45_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_45_chunk
-                           Output: _hyper_1_45_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_55_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_55_chunk
-                                 Output: compress_hyper_2_55_chunk._ts_meta_count, compress_hyper_2_55_chunk.segment_by_value, compress_hyper_2_55_chunk._ts_meta_min_1, compress_hyper_2_55_chunk._ts_meta_max_1, compress_hyper_2_55_chunk."time", compress_hyper_2_55_chunk.int_value, compress_hyper_2_55_chunk.float_value
-                                 Index Cond: (compress_hyper_2_55_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_46_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_46_chunk
-                           Output: _hyper_1_46_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_56_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_56_chunk
-                                 Output: compress_hyper_2_56_chunk._ts_meta_count, compress_hyper_2_56_chunk.segment_by_value, compress_hyper_2_56_chunk._ts_meta_min_1, compress_hyper_2_56_chunk._ts_meta_max_1, compress_hyper_2_56_chunk."time", compress_hyper_2_56_chunk.int_value, compress_hyper_2_56_chunk.float_value
-                                 Index Cond: (compress_hyper_2_56_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_47_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_47_chunk
-                           Output: _hyper_1_47_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_57_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_57_chunk
-                                 Output: compress_hyper_2_57_chunk._ts_meta_count, compress_hyper_2_57_chunk.segment_by_value, compress_hyper_2_57_chunk._ts_meta_min_1, compress_hyper_2_57_chunk._ts_meta_max_1, compress_hyper_2_57_chunk."time", compress_hyper_2_57_chunk.int_value, compress_hyper_2_57_chunk.float_value
-                                 Index Cond: (compress_hyper_2_57_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_48_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_48_chunk
-                           Output: _hyper_1_48_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_58_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_58_chunk
-                                 Output: compress_hyper_2_58_chunk._ts_meta_count, compress_hyper_2_58_chunk.segment_by_value, compress_hyper_2_58_chunk._ts_meta_min_1, compress_hyper_2_58_chunk._ts_meta_max_1, compress_hyper_2_58_chunk."time", compress_hyper_2_58_chunk.int_value, compress_hyper_2_58_chunk.float_value
-                                 Index Cond: (compress_hyper_2_58_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_49_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_49_chunk
-                           Output: _hyper_1_49_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_59_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_59_chunk
-                                 Output: compress_hyper_2_59_chunk._ts_meta_count, compress_hyper_2_59_chunk.segment_by_value, compress_hyper_2_59_chunk._ts_meta_min_1, compress_hyper_2_59_chunk._ts_meta_max_1, compress_hyper_2_59_chunk."time", compress_hyper_2_59_chunk.int_value, compress_hyper_2_59_chunk.float_value
-                                 Index Cond: (compress_hyper_2_59_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_50_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_50_chunk
-                           Output: _hyper_1_50_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_60_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_60_chunk
-                                 Output: compress_hyper_2_60_chunk._ts_meta_count, compress_hyper_2_60_chunk.segment_by_value, compress_hyper_2_60_chunk._ts_meta_min_1, compress_hyper_2_60_chunk._ts_meta_max_1, compress_hyper_2_60_chunk."time", compress_hyper_2_60_chunk.int_value, compress_hyper_2_60_chunk.float_value
-                                 Index Cond: (compress_hyper_2_60_chunk.segment_by_value > 5)
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_41_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_41_chunk
+                     Output: _hyper_1_41_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_51_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_51_chunk
+                           Output: compress_hyper_2_51_chunk._ts_meta_count, compress_hyper_2_51_chunk.segment_by_value, compress_hyper_2_51_chunk._ts_meta_min_1, compress_hyper_2_51_chunk._ts_meta_max_1, compress_hyper_2_51_chunk."time", compress_hyper_2_51_chunk.int_value, compress_hyper_2_51_chunk.float_value
+                           Index Cond: (compress_hyper_2_51_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_42_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_42_chunk
+                     Output: _hyper_1_42_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_52_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_52_chunk
+                           Output: compress_hyper_2_52_chunk._ts_meta_count, compress_hyper_2_52_chunk.segment_by_value, compress_hyper_2_52_chunk._ts_meta_min_1, compress_hyper_2_52_chunk._ts_meta_max_1, compress_hyper_2_52_chunk."time", compress_hyper_2_52_chunk.int_value, compress_hyper_2_52_chunk.float_value
+                           Index Cond: (compress_hyper_2_52_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_43_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_43_chunk
+                     Output: _hyper_1_43_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_53_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_53_chunk
+                           Output: compress_hyper_2_53_chunk._ts_meta_count, compress_hyper_2_53_chunk.segment_by_value, compress_hyper_2_53_chunk._ts_meta_min_1, compress_hyper_2_53_chunk._ts_meta_max_1, compress_hyper_2_53_chunk."time", compress_hyper_2_53_chunk.int_value, compress_hyper_2_53_chunk.float_value
+                           Index Cond: (compress_hyper_2_53_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_44_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_44_chunk
+                     Output: _hyper_1_44_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_54_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_54_chunk
+                           Output: compress_hyper_2_54_chunk._ts_meta_count, compress_hyper_2_54_chunk.segment_by_value, compress_hyper_2_54_chunk._ts_meta_min_1, compress_hyper_2_54_chunk._ts_meta_max_1, compress_hyper_2_54_chunk."time", compress_hyper_2_54_chunk.int_value, compress_hyper_2_54_chunk.float_value
+                           Index Cond: (compress_hyper_2_54_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_45_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_45_chunk
+                     Output: _hyper_1_45_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_55_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_55_chunk
+                           Output: compress_hyper_2_55_chunk._ts_meta_count, compress_hyper_2_55_chunk.segment_by_value, compress_hyper_2_55_chunk._ts_meta_min_1, compress_hyper_2_55_chunk._ts_meta_max_1, compress_hyper_2_55_chunk."time", compress_hyper_2_55_chunk.int_value, compress_hyper_2_55_chunk.float_value
+                           Index Cond: (compress_hyper_2_55_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_46_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_46_chunk
+                     Output: _hyper_1_46_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_56_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_56_chunk
+                           Output: compress_hyper_2_56_chunk._ts_meta_count, compress_hyper_2_56_chunk.segment_by_value, compress_hyper_2_56_chunk._ts_meta_min_1, compress_hyper_2_56_chunk._ts_meta_max_1, compress_hyper_2_56_chunk."time", compress_hyper_2_56_chunk.int_value, compress_hyper_2_56_chunk.float_value
+                           Index Cond: (compress_hyper_2_56_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_47_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_47_chunk
+                     Output: _hyper_1_47_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_57_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_57_chunk
+                           Output: compress_hyper_2_57_chunk._ts_meta_count, compress_hyper_2_57_chunk.segment_by_value, compress_hyper_2_57_chunk._ts_meta_min_1, compress_hyper_2_57_chunk._ts_meta_max_1, compress_hyper_2_57_chunk."time", compress_hyper_2_57_chunk.int_value, compress_hyper_2_57_chunk.float_value
+                           Index Cond: (compress_hyper_2_57_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_48_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_48_chunk
+                     Output: _hyper_1_48_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_58_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_58_chunk
+                           Output: compress_hyper_2_58_chunk._ts_meta_count, compress_hyper_2_58_chunk.segment_by_value, compress_hyper_2_58_chunk._ts_meta_min_1, compress_hyper_2_58_chunk._ts_meta_max_1, compress_hyper_2_58_chunk."time", compress_hyper_2_58_chunk.int_value, compress_hyper_2_58_chunk.float_value
+                           Index Cond: (compress_hyper_2_58_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_49_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_49_chunk
+                     Output: _hyper_1_49_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_59_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_59_chunk
+                           Output: compress_hyper_2_59_chunk._ts_meta_count, compress_hyper_2_59_chunk.segment_by_value, compress_hyper_2_59_chunk._ts_meta_min_1, compress_hyper_2_59_chunk._ts_meta_max_1, compress_hyper_2_59_chunk."time", compress_hyper_2_59_chunk.int_value, compress_hyper_2_59_chunk.float_value
+                           Index Cond: (compress_hyper_2_59_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_50_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_50_chunk
+                     Output: _hyper_1_50_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_60_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_60_chunk
+                           Output: compress_hyper_2_60_chunk._ts_meta_count, compress_hyper_2_60_chunk.segment_by_value, compress_hyper_2_60_chunk._ts_meta_min_1, compress_hyper_2_60_chunk._ts_meta_max_1, compress_hyper_2_60_chunk."time", compress_hyper_2_60_chunk.int_value, compress_hyper_2_60_chunk.float_value
+                           Index Cond: (compress_hyper_2_60_chunk.segment_by_value > 5)
 
 SELECT sum(int_value) FROM testtable WHERE segment_by_value > 5;
  sum  
@@ -2594,160 +2591,154 @@
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.segment_by_value)
-   ->  Gather
-         Output: (PARTIAL sum(testtable.segment_by_value))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
-                           Output: _hyper_1_81_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
-                                 Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
-                           Output: _hyper_1_82_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
-                                 Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
-                           Output: _hyper_1_83_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
-                                 Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
-                           Output: _hyper_1_84_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
-                                 Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
-                           Output: _hyper_1_85_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
-                                 Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
-                           Output: _hyper_1_86_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
-                                 Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
-                           Output: _hyper_1_87_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
-                                 Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
-                           Output: _hyper_1_88_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
-                                 Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
-                           Output: _hyper_1_89_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
-                                 Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
-                           Output: _hyper_1_90_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
-                                 Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
+                     Output: _hyper_1_81_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
+                           Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
+                     Output: _hyper_1_82_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
+                           Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
+                     Output: _hyper_1_83_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
+                           Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
+                     Output: _hyper_1_84_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
+                           Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
+                     Output: _hyper_1_85_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
+                           Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
+                     Output: _hyper_1_86_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
+                           Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
+                     Output: _hyper_1_87_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
+                           Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
+                     Output: _hyper_1_88_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
+                           Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
+                     Output: _hyper_1_89_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
+                           Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
+                     Output: _hyper_1_90_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
+                           Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
 
 :EXPLAIN
 SELECT sum(int_value) FROM testtable;
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.int_value)
-   ->  Gather
-         Output: (PARTIAL sum(testtable.int_value))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_81_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
-                           Output: _hyper_1_81_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
-                                 Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_82_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
-                           Output: _hyper_1_82_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
-                                 Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_83_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
-                           Output: _hyper_1_83_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
-                                 Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_84_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
-                           Output: _hyper_1_84_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
-                                 Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_85_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
-                           Output: _hyper_1_85_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
-                                 Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_86_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
-                           Output: _hyper_1_86_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
-                                 Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_87_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
-                           Output: _hyper_1_87_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
-                                 Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_88_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
-                           Output: _hyper_1_88_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
-                                 Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_89_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
-                           Output: _hyper_1_89_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
-                                 Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_90_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
-                           Output: _hyper_1_90_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
-                                 Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_81_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
+                     Output: _hyper_1_81_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
+                           Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_82_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
+                     Output: _hyper_1_82_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
+                           Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_83_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
+                     Output: _hyper_1_83_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
+                           Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_84_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
+                     Output: _hyper_1_84_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
+                           Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_85_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
+                     Output: _hyper_1_85_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
+                           Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_86_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
+                     Output: _hyper_1_86_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
+                           Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_87_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
+                     Output: _hyper_1_87_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
+                           Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_88_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
+                     Output: _hyper_1_88_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
+                           Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_89_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
+                     Output: _hyper_1_89_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
+                           Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_90_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
+                     Output: _hyper_1_90_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
+                           Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
 
 SELECT sum(segment_by_value) FROM testtable;
  sum  
@@ -2765,80 +2756,77 @@
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.segment_by_value) FILTER (WHERE (testtable.segment_by_value > 99999))
-   ->  Gather
-         Output: (PARTIAL sum(testtable.segment_by_value) FILTER (WHERE (testtable.segment_by_value > 99999)))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value) FILTER (WHERE (_hyper_1_81_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
-                           Output: _hyper_1_81_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
-                                 Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value) FILTER (WHERE (_hyper_1_82_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
-                           Output: _hyper_1_82_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
-                                 Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value) FILTER (WHERE (_hyper_1_83_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
-                           Output: _hyper_1_83_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
-                                 Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value) FILTER (WHERE (_hyper_1_84_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
-                           Output: _hyper_1_84_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
-                                 Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value) FILTER (WHERE (_hyper_1_85_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
-                           Output: _hyper_1_85_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
-                                 Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value) FILTER (WHERE (_hyper_1_86_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
-                           Output: _hyper_1_86_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
-                                 Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value) FILTER (WHERE (_hyper_1_87_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
-                           Output: _hyper_1_87_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
-                                 Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value) FILTER (WHERE (_hyper_1_88_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
-                           Output: _hyper_1_88_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
-                                 Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value) FILTER (WHERE (_hyper_1_89_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
-                           Output: _hyper_1_89_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
-                                 Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value) FILTER (WHERE (_hyper_1_90_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
-                           Output: _hyper_1_90_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
-                                 Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value) FILTER (WHERE (_hyper_1_81_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
+                     Output: _hyper_1_81_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
+                           Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value) FILTER (WHERE (_hyper_1_82_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
+                     Output: _hyper_1_82_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
+                           Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value) FILTER (WHERE (_hyper_1_83_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
+                     Output: _hyper_1_83_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
+                           Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value) FILTER (WHERE (_hyper_1_84_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
+                     Output: _hyper_1_84_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
+                           Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value) FILTER (WHERE (_hyper_1_85_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
+                     Output: _hyper_1_85_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
+                           Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value) FILTER (WHERE (_hyper_1_86_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
+                     Output: _hyper_1_86_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
+                           Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value) FILTER (WHERE (_hyper_1_87_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
+                     Output: _hyper_1_87_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
+                           Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value) FILTER (WHERE (_hyper_1_88_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
+                     Output: _hyper_1_88_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
+                           Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value) FILTER (WHERE (_hyper_1_89_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
+                     Output: _hyper_1_89_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
+                           Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value) FILTER (WHERE (_hyper_1_90_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
+                     Output: _hyper_1_90_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
+                           Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
 
 SET timescaledb.enable_vectorized_aggregation = OFF;
 SELECT sum(segment_by_value) FILTER (WHERE segment_by_value > 99999) FROM testtable;
@@ -3409,13 +3397,15 @@
 VACUUM FULL ANALYZE testtable3;
 EXPLAIN (buffers off, costs off) SELECT (date_trunc('hour', '2024-01-09'::timestamptz) - interval '1 hour')::timestamp as time, TT.location_id as location_id, TT.device_id as device_id, 0 as sensor_id, date_trunc('day', current_timestamp) as discovered_date FROM testtable3 TT WHERE time >= date_trunc('hour', '2024-01-09'::timestamptz) - interval '1 hour' GROUP BY TT.location_id, TT.device_id;
 --- QUERY PLAN ---
- HashAggregate
+ Group
    Group Key: tt.location_id, tt.device_id
-   ->  Custom Scan (ChunkAppend) on testtable3 tt
-         Chunks excluded during startup: 1
-         ->  Custom Scan (ColumnarScan) on _hyper_5_120_chunk tt_1
-               Vectorized Filter: ("time" >= (date_trunc('hour'::text, 'Tue Jan 09 00:00:00 2024 PST'::timestamp with time zone) - '@ 1 hour'::interval))
-               ->  Seq Scan on compress_hyper_6_122_chunk
-                     Filter: (_ts_meta_max_1 >= (date_trunc('hour'::text, 'Tue Jan 09 00:00:00 2024 PST'::timestamp with time zone) - '@ 1 hour'::interval))
+   ->  Sort
+         Sort Key: tt.location_id, tt.device_id
+         ->  Custom Scan (ChunkAppend) on testtable3 tt
+               Chunks excluded during startup: 1
+               ->  Custom Scan (ColumnarScan) on _hyper_5_120_chunk tt_1
+                     Vectorized Filter: ("time" >= (date_trunc('hour'::text, 'Tue Jan 09 00:00:00 2024 PST'::timestamp with time zone) - '@ 1 hour'::interval))
+                     ->  Seq Scan on compress_hyper_6_122_chunk
+                           Filter: (_ts_meta_max_1 >= (date_trunc('hour'::text, 'Tue Jan 09 00:00:00 2024 PST'::timestamp with time zone) - '@ 1 hour'::interval))
 
 SELECT (date_trunc('hour', '2024-01-09'::timestamptz) - interval '1 hour')::timestamp as time, TT.location_id as location_id, TT.device_id as device_id, 0 as sensor_id, date_trunc('day', current_timestamp) as discovered_date FROM testtable3 TT WHERE time >= date_trunc('hour', '2024-01-09'::timestamptz) - interval '1 hour' GROUP BY TT.location_id, TT.device_id \g :TEST_OUTPUT_DIR/vectorized_aggregation_query_result.out
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/constraint_exclusion_prepared-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/constraint_exclusion_prepared-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/constraint_exclusion_prepared-17.out	2025-11-06 02:35:39.340067997 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/constraint_exclusion_prepared-17.out	2025-11-06 02:48:40.483165384 +0000
@@ -1934,98 +1934,44 @@
 PREPARE prep(timestamptz) AS SELECT device_id, time FROM :TEST_TABLE WHERE time = $1 ORDER BY device_id, time;
 :PREFIX EXECUTE prep('2000-01-01 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=4.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 3996
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 2
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=4.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 3996
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 14
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Index Cond: ("time" = $1)
 
 :PREFIX EXECUTE prep('2000-01-10 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 4995
-         ->  Sort (actual rows=5.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 25
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 3
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 4995
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: compress_hyper_X_X_chunk.device_id
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
+                           Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
+                           Rows Removed by Filter: 25
 
 :PREFIX EXECUTE prep(now());
 --- QUERY PLAN ---
- Merge Append (actual rows=0.00 loops=1)
+ Sort (actual rows=0.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=0.00 loops=1)
+         Chunks excluded during startup: 4
 
 DEALLOCATE prep;
 RESET plan_cache_mode;
@@ -2890,255 +2836,190 @@
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=100.00 loops=1)
-         Hypertable: metrics_space_compressed
-         Chunks excluded during startup: 3
-         ->  Merge Append (actual rows=100.00 loops=1)
-               Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=100.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+   ->  Sort (actual rows=100.00 loops=1)
+         Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=33590.00 loops=1)
+               Hypertable: metrics_space_compressed
+               Chunks excluded during startup: 3
+               ->  Append (actual rows=33590.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=10794.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=12.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=9360.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 2754
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=15.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=100.00 loops=1)
-         Hypertable: metrics_space_compressed
-         Chunks excluded during startup: 3
-         ->  Merge Append (actual rows=100.00 loops=1)
-               Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=100.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+   ->  Sort (actual rows=100.00 loops=1)
+         Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=33590.00 loops=1)
+               Hypertable: metrics_space_compressed
+               Chunks excluded during startup: 3
+               ->  Append (actual rows=33590.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=10794.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=12.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=9360.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 2754
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=15.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=100.00 loops=1)
-         Hypertable: metrics_space_compressed
-         Chunks excluded during startup: 3
-         ->  Merge Append (actual rows=100.00 loops=1)
-               Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=100.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+   ->  Sort (actual rows=100.00 loops=1)
+         Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=33590.00 loops=1)
+               Hypertable: metrics_space_compressed
+               Chunks excluded during startup: 3
+               ->  Append (actual rows=33590.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=10794.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=12.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=9360.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 2754
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=15.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=100.00 loops=1)
-         Hypertable: metrics_space_compressed
-         Chunks excluded during startup: 3
-         ->  Merge Append (actual rows=100.00 loops=1)
-               Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=100.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+   ->  Sort (actual rows=100.00 loops=1)
+         Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=33590.00 loops=1)
+               Hypertable: metrics_space_compressed
+               Chunks excluded during startup: 3
+               ->  Append (actual rows=33590.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=10794.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=12.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=9360.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 2754
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=15.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
 
 :PREFIX EXECUTE prep;
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
-   ->  Custom Scan (ConstraintAwareAppend) (actual rows=100.00 loops=1)
-         Hypertable: metrics_space_compressed
-         Chunks excluded during startup: 3
-         ->  Merge Append (actual rows=100.00 loops=1)
-               Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=100.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+   ->  Sort (actual rows=100.00 loops=1)
+         Sort Key: metrics_space_compressed.device_id, metrics_space_compressed."time"
+         Sort Method: top-N heapsort 
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=33590.00 loops=1)
+               Hypertable: metrics_space_compressed
+               Chunks excluded during startup: 3
+               ->  Append (actual rows=33590.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=10794.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=12.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=9360.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 2754
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=15.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                           Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3120.00 loops=1)
+                           Vectorized Filter: ("time" < ('2000-01-10'::cstring)::timestamp with time zone)
+                           Rows Removed by Filter: 918
                            ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
                                  Index Cond: (_ts_meta_min_1 < ('2000-01-10'::cstring)::timestamp with time zone)
 
@@ -3149,240 +3030,63 @@
 PREPARE prep(timestamptz) AS SELECT device_id, time FROM :TEST_TABLE WHERE time = $1 ORDER BY device_id, time;
 :PREFIX EXECUTE prep('2000-01-01 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_space_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 6
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 3
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 2997
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 2997
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 9
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 3
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
 
 :PREFIX EXECUTE prep('2000-01-10 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_space_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 12
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 6
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 5
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 2997
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 2997
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 15
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 5
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
 
 :PREFIX EXECUTE prep(now());
 --- QUERY PLAN ---
- Merge Append (actual rows=0.00 loops=1)
+ Sort (actual rows=0.00 loops=1)
    Sort Key: metrics_space_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 12
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=0.00 loops=1)
+         Chunks excluded during startup: 9
 
 DEALLOCATE prep;
 RESET plan_cache_mode;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/ordered_append_join-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/ordered_append_join-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/ordered_append_join-17.out	2025-11-06 02:35:39.344067954 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/ordered_append_join-17.out	2025-11-06 02:48:44.297122093 +0000
@@ -1917,55 +1917,71 @@
 ORDER BY o1.time;
 --- QUERY PLAN ---
  Merge Join (actual rows=13674.00 loops=1)
-   Merge Cond: (o2."time" = o1."time")
-   ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=13674.00 loops=1)
-         Order: o2."time"
+   Merge Cond: (o1."time" = o2."time")
+   ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=13674.00 loops=1)
+         Order: o1."time"
          ->  Merge Append (actual rows=3598.00 loops=1)
-               Sort Key: o2."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=3598.00 loops=1)
-                     Filter: (device_id = 2)
+               Sort Key: o1."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=2000.00 loops=1)
+                     Filter: (device_id = 1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                     ->  Sort (actual rows=4.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
+                     ->  Sort (actual rows=2.00 loops=1)
+                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                            Sort Method: quicksort 
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=4.00 loops=1)
-                                 Filter: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-                                 Rows Removed by Filter: 14
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                     Index Cond: ((device_id = 2) AND ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
+                                 Filter: ((_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone) AND (device_id = 1))
+                                 Rows Removed by Filter: 16
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=1598.00 loops=1)
+                     Index Cond: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
+                     Filter: (device_id = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (actual rows=5038.00 loops=1)
                Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
-                     Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (actual rows=5038.00 loops=1)
+               ->  Sort (actual rows=6.00 loops=1)
+                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                           Filter: ((_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone) AND (device_id = 1))
+                           Rows Removed by Filter: 24
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (actual rows=5038.00 loops=1)
                Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
-                     Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Sort (actual rows=6.00 loops=1)
+                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                           Filter: ((_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone) AND (device_id = 1))
+                           Rows Removed by Filter: 24
    ->  Materialize (actual rows=13674.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=13674.00 loops=1)
-               Order: o1."time"
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=13674.00 loops=1)
+               Order: o2."time"
                ->  Merge Append (actual rows=3598.00 loops=1)
-                     Sort Key: o1."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=2000.00 loops=1)
-                           Filter: (device_id = 1)
+                     Sort Key: o2."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=3598.00 loops=1)
+                           Filter: (device_id = 2)
                            Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                           ->  Sort (actual rows=2.00 loops=1)
-                                 Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                           ->  Sort (actual rows=4.00 loops=1)
+                                 Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
                                  Sort Method: quicksort 
-                                 ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
-                                       Filter: ((_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone) AND (device_id = 1))
-                                       Rows Removed by Filter: 16
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=1598.00 loops=1)
-                           Index Cond: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                           Filter: (device_id = 1)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (actual rows=5038.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=4.00 loops=1)
+                                       Filter: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                                       Rows Removed by Filter: 14
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                           Index Cond: ((device_id = 2) AND ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (actual rows=5038.00 loops=1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                           Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (actual rows=5038.00 loops=1)
+                     ->  Sort (actual rows=6.00 loops=1)
+                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
+                           Sort Method: quicksort 
+                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
+                                 Filter: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                                 Rows Removed by Filter: 24
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (actual rows=5038.00 loops=1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                           Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                     ->  Sort (actual rows=6.00 loops=1)
+                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
+                           Sort Method: quicksort 
+                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
+                                 Filter: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                                 Rows Removed by Filter: 24
 
 -- test JOIN
 -- last chunk of o2 should not be executed
@@ -1983,46 +1999,46 @@
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
    ->  Merge Join (actual rows=10.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Result (actual rows=2.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=2.00 loops=1)
-                     Order: o2."time"
-                     ->  Merge Append (actual rows=2.00 loops=1)
-                           Sort Key: o2."time"
-                           ->  Sort (actual rows=2.00 loops=1)
-                                 Sort Key: o2_1."time"
-                                 Sort Method: quicksort 
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=16392.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=18.00 loops=1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o2_1 (actual rows=1.00 loops=1)
-                     ->  Sort (never executed)
-                           Sort Key: o2_2."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: o2_3."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                                 ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
-         ->  Materialize (actual rows=10.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=6.00 loops=1)
-                     Order: o1."time"
-                     ->  Merge Append (actual rows=6.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Sort (actual rows=5.00 loops=1)
-                                 Sort Key: o1_1."time"
-                                 Sort Method: quicksort 
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=16392.00 loops=1)
-                                       Vectorized Filter: ("time" < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-                                       ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=18.00 loops=1)
-                                             Filter: (_ts_meta_min_1 < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=2.00 loops=1)
-                                 Index Cond: ("time" < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-                     ->  Sort (never executed)
-                           Sort Key: o1_2."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=2.00 loops=1)
+               Order: o1."time"
+               ->  Merge Append (actual rows=2.00 loops=1)
+                     Sort Key: o1."time"
+                     ->  Sort (actual rows=2.00 loops=1)
+                           Sort Key: o1_1."time"
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=16392.00 loops=1)
                                  Vectorized Filter: ("time" < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
-                                 ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+                                 ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=18.00 loops=1)
                                        Filter: (_ts_meta_min_1 < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Index Cond: ("time" < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+               ->  Sort (never executed)
+                     Sort Key: o1_2."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                           Vectorized Filter: ("time" < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+                           ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+                                 Filter: (_ts_meta_min_1 < 'Sat Jan 08 00:00:00 2000 PST'::timestamp with time zone)
+         ->  Materialize (actual rows=10.00 loops=1)
+               ->  Result (actual rows=6.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=6.00 loops=1)
+                           Order: o2."time"
+                           ->  Merge Append (actual rows=6.00 loops=1)
+                                 Sort Key: o2."time"
+                                 ->  Sort (actual rows=5.00 loops=1)
+                                       Sort Key: o2_1."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=16392.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=18.00 loops=1)
+                                 ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o2_1 (actual rows=2.00 loops=1)
+                           ->  Sort (never executed)
+                                 Sort Key: o2_2."time"
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: o2_3."time"
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
 
 -- test join against max query
 -- not ChunkAppend so no chunk exclusion
@@ -2055,11 +2071,19 @@
                ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=1598.00 loops=1)
                      Filter: (device_id = 1)
          ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (actual rows=5038.00 loops=1)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                     Index Cond: (device_id = 1)
+               ->  Sort (actual rows=6.00 loops=1)
+                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 24
          ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (actual rows=5038.00 loops=1)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                     Index Cond: (device_id = 1)
+               ->  Sort (actual rows=6.00 loops=1)
+                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 24
    ->  Sort (actual rows=1.00 loops=1)
          Sort Key: ((InitPlan 1).col1)
          Sort Method: quicksort 
@@ -2101,40 +2125,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with USING
 -- should use 2 ChunkAppend
@@ -2149,40 +2173,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test NATURAL JOIN on time column
 -- should use 2 ChunkAppend
@@ -2215,40 +2239,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test RIGHT JOIN on time column
 -- should use 2 ChunkAppend
@@ -2263,40 +2287,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with ON clause expression order switched
 -- should use 2 ChunkAppend
@@ -2311,40 +2335,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with equality condition in WHERE clause
 -- should use 2 ChunkAppend
@@ -2360,40 +2384,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with ORDER BY 2nd hypertable
 -- should use 2 ChunkAppend
@@ -2408,40 +2432,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column and device_id
 -- should use 2 ChunkAppend
@@ -2553,40 +2577,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with 3 hypertables
 -- should use 3 ChunkAppend
@@ -2603,26 +2627,26 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o3."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o3 (actual rows=100.00 loops=1)
-               Order: o3."time"
-               ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o3."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 3)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 3)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o3_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
-                           Index Cond: (device_id = 3)
-         ->  Materialize (actual rows=100.00 loops=1)
-               ->  Merge Join (actual rows=100.00 loops=1)
-                     Merge Cond: (o2."time" = o1."time")
+         Merge Cond: (o1."time" = o3."time")
+         ->  Merge Join (actual rows=100.00 loops=1)
+               Merge Cond: (o1."time" = o2."time")
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+                     Order: o1."time"
+                     ->  Merge Append (actual rows=100.00 loops=1)
+                           Sort Key: o1."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 1)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 1)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+               ->  Materialize (actual rows=100.00 loops=1)
                      ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
                            Order: o2."time"
                            ->  Merge Append (actual rows=100.00 loops=1)
@@ -2639,23 +2663,23 @@
                            ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
                                        Index Cond: (device_id = 2)
-                     ->  Materialize (actual rows=100.00 loops=1)
-                           ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                                 Order: o1."time"
-                                 ->  Merge Append (actual rows=100.00 loops=1)
-                                       Sort Key: o1."time"
-                                       ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                             Filter: (device_id = 1)
-                                             ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                                   Index Cond: (device_id = 1)
-                                       ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                             Filter: (device_id = 1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 1)
+         ->  Materialize (actual rows=100.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o3 (actual rows=100.00 loops=1)
+                     Order: o3."time"
+                     ->  Merge Append (actual rows=100.00 loops=1)
+                           Sort Key: o3."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 3)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 3)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o3_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
+                                 Index Cond: (device_id = 3)
 
 RESET enable_seqscan;
 \set TEST_TABLE 'metrics_space_compressed'
@@ -2733,8 +2757,7 @@
                            Sort Key: _hyper_X_X_chunk."time" DESC
                            ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
                                  ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
-         ->  Materialize (actual rows=2.00 loops=1)
-               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
 
 -- test LATERAL with ordered append in the lateral query
 :PREFIX
@@ -2750,58 +2773,56 @@
     LIMIT 2) l;
 --- QUERY PLAN ---
  Nested Loop (actual rows=4.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-   ->  Materialize (actual rows=2.00 loops=2)
-         ->  Subquery Scan on l (actual rows=2.00 loops=1)
-               ->  Limit (actual rows=2.00 loops=1)
-                     ->  Result (actual rows=2.00 loops=1)
-                           ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=2.00 loops=1)
-                                 Order: metrics_space_compressed."time" DESC
-                                 ->  Merge Append (actual rows=2.00 loops=1)
-                                       Sort Key: metrics_space_compressed."time" DESC
-                                       ->  Sort (actual rows=2.00 loops=1)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             Sort Method: top-N heapsort 
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5038.00 loops=1)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                                       ->  Sort (actual rows=1.00 loops=1)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             Sort Method: top-N heapsort 
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=15114.00 loops=1)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=18.00 loops=1)
-                                       ->  Sort (actual rows=1.00 loops=1)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             Sort Method: top-N heapsort 
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5038.00 loops=1)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                                 ->  Merge Append (never executed)
-                                       Sort Key: metrics_space_compressed."time" DESC
-                                       ->  Sort (never executed)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
-                                       ->  Sort (never executed)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
-                                       ->  Sort (never executed)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
-                                 ->  Merge Append (never executed)
-                                       Sort Key: metrics_space_compressed."time" DESC
-                                       ->  Sort (never executed)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
-                                       ->  Sort (never executed)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
-                                       ->  Sort (never executed)
-                                             Sort Key: _hyper_X_X_chunk."time" DESC
-                                             ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
-                                                   ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+   ->  Limit (actual rows=2.00 loops=1)
+         ->  Result (actual rows=2.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=2.00 loops=1)
+                     Order: metrics_space_compressed."time" DESC
+                     ->  Merge Append (actual rows=2.00 loops=1)
+                           Sort Key: metrics_space_compressed."time" DESC
+                           ->  Sort (actual rows=2.00 loops=1)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 Sort Method: top-N heapsort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5038.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                           ->  Sort (actual rows=1.00 loops=1)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 Sort Method: top-N heapsort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=15114.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=18.00 loops=1)
+                           ->  Sort (actual rows=1.00 loops=1)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 Sort Method: top-N heapsort 
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5038.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                     ->  Merge Append (never executed)
+                           Sort Key: metrics_space_compressed."time" DESC
+                           ->  Sort (never executed)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+                     ->  Merge Append (never executed)
+                           Sort Key: metrics_space_compressed."time" DESC
+                           ->  Sort (never executed)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+                           ->  Sort (never executed)
+                                 Sort Key: _hyper_X_X_chunk."time" DESC
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (never executed)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk (never executed)
+   ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=2)
 
 SET enable_nestloop TO off;
 -- test plan with best index is chosen
@@ -3931,17 +3952,16 @@
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
                      ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
                            Index Cond: (device_id = 1)
-         ->  Materialize (actual rows=100.00 loops=1)
-               ->  Append (actual rows=100.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                           ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                           ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                                 Index Cond: (device_id = 1)
+         ->  Append (actual rows=100.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                     ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                     ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                     ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                           Index Cond: (device_id = 1)
 
 -- test JOIN on time column with implicit join
 -- should use 2 ChunkAppend
@@ -3997,44 +4017,44 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o3."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed o3 (actual rows=100.00 loops=1)
-               Order: o3."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                           Index Cond: (device_id = 3)
-         ->  Materialize (actual rows=100.00 loops=1)
-               ->  Merge Join (actual rows=100.00 loops=1)
-                     Merge Cond: (o1."time" = o2."time")
-                     ->  Custom Scan (ChunkAppend) on metrics_space_compressed o1 (actual rows=100.00 loops=1)
-                           Order: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+         Merge Cond: (o1."time" = o3."time")
+         ->  Merge Join (actual rows=100.00 loops=1)
+               Merge Cond: (o1."time" = o2."time")
+               ->  Custom Scan (ChunkAppend) on metrics_space_compressed o1 (actual rows=100.00 loops=1)
+                     Order: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+               ->  Materialize (actual rows=100.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics_space_compressed o2 (actual rows=100.00 loops=1)
+                           Order: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                                       Index Cond: (device_id = 2)
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                       Index Cond: (device_id = 1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                                       Index Cond: (device_id = 2)
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                       Index Cond: (device_id = 1)
-                     ->  Materialize (actual rows=100.00 loops=1)
-                           ->  Custom Scan (ChunkAppend) on metrics_space_compressed o2 (actual rows=100.00 loops=1)
-                                 Order: o2."time"
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                             Index Cond: (device_id = 2)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 2)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 2)
+                                       Index Cond: (device_id = 2)
+         ->  Materialize (actual rows=100.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_space_compressed o3 (actual rows=100.00 loops=1)
+                     Order: o3."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 3)
 
 RESET enable_seqscan;
 -- Disable plain/sorted aggregation to get a deterministic test output
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/transparent_decompress_chunk-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/transparent_decompress_chunk-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/transparent_decompress_chunk-17.out	2025-11-06 02:35:39.345067943 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/transparent_decompress_chunk-17.out	2025-11-06 02:48:43.745128359 +0000
@@ -62,14 +62,14 @@
 --- QUERY PLAN ---
  Merge Append
    Sort Key: _hyper_X_X_chunk."time"
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
-         ->  Sort
-               Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1
+   ->  Sort
+         Sort Key: _hyper_X_X_chunk."time"
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                ->  Seq Scan on compress_hyper_X_X_chunk
    ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1
-         ->  Sort
-               Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1
+   ->  Sort
+         Sort Key: _hyper_X_X_chunk_1."time"
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1
                ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
    ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk _hyper_X_X_chunk_1
 
@@ -130,38 +130,30 @@
 -- test constraints not present in targetlist
 :PREFIX SELECT v1 FROM :TEST_TABLE WHERE device_id = 1 ORDER BY v1;
 --- QUERY PLAN ---
- Merge Append (actual rows=3598.00 loops=1)
+ Sort (actual rows=3598.00 loops=1)
    Sort Key: _hyper_X_X_chunk.v1
-   ->  Sort (actual rows=2000.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=3598.00 loops=1)
          ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=2000.00 loops=1)
                Filter: (device_id = 1)
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                      Filter: (device_id = 1)
                      Rows Removed by Filter: 16
-   ->  Sort (actual rows=1598.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
                Filter: (device_id = 1)
 
 -- test order not present in targetlist
 :PREFIX SELECT v2 FROM :TEST_TABLE WHERE device_id = 1 ORDER BY v1;
 --- QUERY PLAN ---
- Merge Append (actual rows=3598.00 loops=1)
+ Sort (actual rows=3598.00 loops=1)
    Sort Key: _hyper_X_X_chunk.v1
-   ->  Sort (actual rows=2000.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=3598.00 loops=1)
          ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=2000.00 loops=1)
                Filter: (device_id = 1)
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                      Filter: (device_id = 1)
                      Rows Removed by Filter: 16
-   ->  Sort (actual rows=1598.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
                Filter: (device_id = 1)
 
@@ -238,19 +230,15 @@
 :PREFIX SELECT * FROM :TEST_TABLE WHERE device_id IS NULL ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=0.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
                      Filter: (device_id IS NULL)
                      ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
                            Filter: (device_id IS NULL)
                            Rows Removed by Filter: 18
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
                ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
                      Index Cond: (device_id IS NULL)
 
@@ -295,15 +283,12 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE device_id = v0 ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Filter: (device_id = v0)
                      ->  Seq Scan on compress_hyper_X_X_chunk
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _hyper_X_X_chunk
                      Filter: (device_id = v0)
 
@@ -326,18 +311,17 @@
 :PREFIX SELECT * FROM :TEST_TABLE WHERE device_id = 1 + 4 / 2 ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=10.00 loops=1)
-               Filter: (device_id = 3)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=3598.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                     Filter: (device_id = 3)
                      ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                            Filter: (device_id = 3)
                            Rows Removed by Filter: 14
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-               Index Cond: (device_id = 3)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (device_id = 3)
 
 -- test function calls
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE device_id = length(substring(version(), 1, 3)) ORDER BY time, device_id LIMIT 10;
@@ -345,10 +329,10 @@
  Limit
    ->  Merge Append
          Sort Key: _hyper_X_X_chunk."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
-               Filter: (device_id = length("substring"(version(), 1, 3)))
-               ->  Sort
-                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1
+         ->  Sort
+               Sort Key: _hyper_X_X_chunk."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
+                     Filter: (device_id = length("substring"(version(), 1, 3)))
                      ->  Seq Scan on compress_hyper_X_X_chunk
                            Filter: (device_id = length("substring"(version(), 1, 3)))
          ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk
@@ -361,16 +345,15 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE time = '2000-01-01 1:00:00+0' ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk.device_id
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
-               Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort
-                     Sort Key: compress_hyper_X_X_chunk.device_id
+         ->  Append
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
+                     Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
                      ->  Seq Scan on compress_hyper_X_X_chunk
                            Filter: ((_ts_meta_min_1 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone))
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk
-               Index Cond: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk
+                     Index Cond: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE time < '2000-01-01 1:00:00+0' ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
@@ -456,15 +439,12 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE v0 < 1 ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Vectorized Filter: (v0 < 1)
                      ->  Seq Scan on compress_hyper_X_X_chunk
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _hyper_X_X_chunk
                      Filter: (v0 < 1)
 
@@ -501,15 +481,12 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE v1 = device_id ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Filter: (v1 = device_id)
                      ->  Seq Scan on compress_hyper_X_X_chunk
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _hyper_X_X_chunk
                      Filter: (v1 = device_id)
 
@@ -518,19 +495,15 @@
 --- QUERY PLAN ---
  Limit
    Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
-   ->  Merge Append
+   ->  Sort
+         Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk
                      Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
                      Filter: (_hyper_X_X_chunk.v0 = _hyper_X_X_chunk.v1)
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk
                            Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
-         ->  Sort
-               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _timescaledb_internal._hyper_X_X_chunk
                      Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
                      Filter: (_hyper_X_X_chunk.v0 = _hyper_X_X_chunk.v1)
@@ -601,9 +574,9 @@
  Limit
    ->  Merge Append
          Sort Key: _hyper_X_X_chunk."time" DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_X_X_chunk._ts_meta_max_1 DESC
+         ->  Sort
+               Sort Key: _hyper_X_X_chunk."time" DESC
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      ->  Seq Scan on compress_hyper_X_X_chunk
          ->  Index Only Scan Backward using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk
 
@@ -698,10 +671,10 @@
    ->  Subquery Scan on q (actual rows=17990.00 loops=1)
          ->  Merge Append (actual rows=17990.00 loops=1)
                Sort Key: _hyper_X_X_chunk."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=16392.00 loops=1)
-                     ->  Sort (actual rows=18.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1
-                           Sort Method: quicksort 
+               ->  Sort (actual rows=16392.00 loops=1)
+                     Sort Key: _hyper_X_X_chunk."time"
+                     Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=16392.00 loops=1)
                            ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=18.00 loops=1)
                ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
 
@@ -718,29 +691,28 @@
    Merge Cond: (_hyper_X_X_chunk."time" = _hyper_X_X_chunk_1."time")
    ->  Merge Append (actual rows=3598.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
-               Filter: (device_id = 2)
-               ->  Sort (actual rows=4.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=2000.00 loops=1)
+               Filter: (device_id = 1)
+               ->  Sort (actual rows=2.00 loops=1)
                      Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                      Sort Method: quicksort 
-                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
-                           Filter: (device_id = 2)
-                           Rows Removed by Filter: 14
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-               Index Cond: (device_id = 2)
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 16
+         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
+               Filter: (device_id = 1)
    ->  Materialize (actual rows=3598.00 loops=1)
-         ->  Merge Append (actual rows=3598.00 loops=1)
+         ->  Sort (actual rows=3598.00 loops=1)
                Sort Key: _hyper_X_X_chunk_1."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=2000.00 loops=1)
-                     Filter: (device_id = 1)
-                     ->  Sort (actual rows=2.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
-                           Sort Method: quicksort 
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=2.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 Rows Removed by Filter: 16
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=1598.00 loops=1)
-                     Filter: (device_id = 1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=3598.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=3598.00 loops=1)
+                           Filter: (device_id = 2)
+                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=4.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 14
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=0.00 loops=1)
+                           Index Cond: (device_id = 2)
 
 --
 -- test indexes
@@ -856,27 +828,22 @@
 --with multiple values can get a nested loop.
 :PREFIX_VERBOSE SELECT device_id FROM :TEST_TABLE WHERE device_id IN ( VALUES (1), (2));
 --- QUERY PLAN ---
- Nested Loop (actual rows=7196.00 loops=1)
+ Nested Loop Semi Join (actual rows=7196.00 loops=1)
    Output: _hyper_X_X_chunk.device_id
-   ->  Unique (actual rows=2.00 loops=1)
-         Output: "*VALUES*".column1
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               Sort Method: quicksort 
-               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-                     Output: "*VALUES*".column1
-   ->  Append (actual rows=3598.00 loops=2)
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=2799.00 loops=2)
+   Join Filter: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
+   Rows Removed by Join Filter: 25186
+   ->  Append (actual rows=17990.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=16392.00 loops=1)
                Output: _hyper_X_X_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=3.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=18.00 loops=1)
                      Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
-                     Index Cond: (compress_hyper_X_X_chunk.device_id = "*VALUES*".column1)
-         ->  Seq Scan on _timescaledb_internal._hyper_X_X_chunk (actual rows=799.00 loops=2)
+         ->  Seq Scan on _timescaledb_internal._hyper_X_X_chunk (actual rows=1598.00 loops=1)
                Output: _hyper_X_X_chunk.device_id
-               Filter: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
-               Rows Removed by Filter: 799
+   ->  Materialize (actual rows=2.00 loops=17990)
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               Output: "*VALUES*".column1
 
 RESET enable_hashjoin;
 :PREFIX_VERBOSE SELECT device_id FROM :TEST_TABLE WHERE device_id IN (VALUES (1));
@@ -917,24 +884,20 @@
 -- loop/row counts of this query is different on windows so we run it without analyze
 :PREFIX_NO_ANALYZE SELECT device_id FROM :TEST_TABLE WHERE device_id IN (VALUES (1), (2));
 --- QUERY PLAN ---
- Nested Loop
+ Hash Semi Join
    Output: _hyper_X_X_chunk.device_id
-   ->  Unique
-         Output: "*VALUES*".column1
-         ->  Sort
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               ->  Values Scan on "*VALUES*"
-                     Output: "*VALUES*".column1
+   Hash Cond: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
    ->  Append
          ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk
                Output: _hyper_X_X_chunk.device_id
                ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk
                      Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
-                     Index Cond: (compress_hyper_X_X_chunk.device_id = "*VALUES*".column1)
          ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _timescaledb_internal._hyper_X_X_chunk
                Output: _hyper_X_X_chunk.device_id
-               Index Cond: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
+   ->  Hash
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*"
+               Output: "*VALUES*".column1
 
 RESET seq_page_cost;
 -- test view
@@ -967,19 +930,24 @@
     LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Sort
-         Sort Key: m1."time", m1.device_id
-         ->  Hash Join
-               Hash Cond: ((m1."time" = m2."time") AND (m1.device_id = m2.device_id))
-               ->  Append
+   ->  Nested Loop
+         ->  Merge Append
+               Sort Key: m1."time", m1.device_id
+               ->  Sort
+                     Sort Key: m1."time", m1.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
                            ->  Seq Scan on compress_hyper_X_X_chunk
+               ->  Sort
+                     Sort Key: m1."time", m1.device_id
                      ->  Seq Scan on _hyper_X_X_chunk m1
-               ->  Hash
-                     ->  Append
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
-                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
-                           ->  Seq Scan on _hyper_X_X_chunk m2
+         ->  Append
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
+                     Filter: (m1."time" = "time")
+                     ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
+                           Index Cond: (device_id = m1.device_id)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk m2
+                     Index Cond: ("time" = m1."time")
+                     Filter: (m1.device_id = device_id)
 
 :PREFIX_NO_VERBOSE
 SELECT *
@@ -993,29 +961,36 @@
     LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Sort
-         Sort Key: m1."time", m1.device_id
-         ->  Hash Join
-               Hash Cond: ((m2."time" = m1."time") AND (m2.device_id = m1.device_id))
-               ->  Append
+   ->  Merge Join
+         Merge Cond: (m2."time" = m1."time")
+         Join Filter: (m1.device_id = m2.device_id)
+         ->  Merge Append
+               Sort Key: m2."time", m2.device_id
+               ->  Sort
+                     Sort Key: m2."time", m2.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
                            ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
+               ->  Sort
+                     Sort Key: m2."time", m2.device_id
                      ->  Seq Scan on _hyper_X_X_chunk m2
-               ->  Hash
-                     ->  Hash Join
-                           Hash Cond: (m1."time" = m3."time")
+         ->  Materialize
+               ->  Nested Loop
+                     Join Filter: (m1."time" = m3."time")
+                     ->  Merge Append
+                           Sort Key: m3."time"
+                           ->  Sort
+                                 Sort Key: m3."time"
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m3
+                                       Filter: (device_id = 3)
+                                       ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2
+                                             Filter: (device_id = 3)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m3
+                                 Index Cond: (device_id = 3)
+                     ->  Materialize
                            ->  Append
                                  ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
                                        ->  Seq Scan on compress_hyper_X_X_chunk
                                  ->  Seq Scan on _hyper_X_X_chunk m1
-                           ->  Hash
-                                 ->  Append
-                                       ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m3
-                                             Filter: (device_id = 3)
-                                             ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2
-                                                   Filter: (device_id = 3)
-                                       ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m3
-                                             Index Cond: (device_id = 3)
 
 RESET min_parallel_table_scan_size;
 :PREFIX_NO_VERBOSE
@@ -1032,28 +1007,28 @@
 --- QUERY PLAN ---
  Limit
    ->  Merge Join
-         Merge Cond: (m2."time" = m1."time")
+         Merge Cond: (m1."time" = m2."time")
          ->  Merge Append
-               Sort Key: m2."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
-                     Filter: (device_id = 2)
+               Sort Key: m1."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
+                     Filter: (device_id = 1)
                      ->  Sort
-                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
-                                 Filter: (device_id = 2)
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m2
-                     Index Cond: (device_id = 2)
+                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                           ->  Seq Scan on compress_hyper_X_X_chunk
+                                 Filter: (device_id = 1)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk m1
+                     Filter: (device_id = 1)
          ->  Materialize
                ->  Merge Append
-                     Sort Key: m1."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
-                           Filter: (device_id = 1)
+                     Sort Key: m2."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
+                           Filter: (device_id = 2)
                            ->  Sort
-                                 Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                                 ->  Seq Scan on compress_hyper_X_X_chunk
-                                       Filter: (device_id = 1)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk m1
-                           Filter: (device_id = 1)
+                                 Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
+                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
+                                       Filter: (device_id = 2)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m2
+                           Index Cond: (device_id = 2)
 
 :PREFIX_NO_VERBOSE
 SELECT *
@@ -1107,19 +1082,22 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Sort
-         Sort Key: m1."time", m1.device_id
-         ->  Hash Left Join
-               Hash Cond: ((m1."time" = m2."time") AND (m1.device_id = m2.device_id))
-               ->  Append
+   ->  Nested Loop Left Join
+         Join Filter: ((m1."time" = m2."time") AND (m1.device_id = m2.device_id))
+         ->  Merge Append
+               Sort Key: m1."time", m1.device_id
+               ->  Sort
+                     Sort Key: m1."time", m1.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
                            ->  Seq Scan on compress_hyper_X_X_chunk
+               ->  Sort
+                     Sort Key: m1."time", m1.device_id
                      ->  Seq Scan on _hyper_X_X_chunk m1
-               ->  Hash
-                     ->  Append
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
-                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
-                           ->  Seq Scan on _hyper_X_X_chunk m2
+         ->  Materialize
+               ->  Append
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
+                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
+                     ->  Seq Scan on _hyper_X_X_chunk m2
 
 RESET min_parallel_table_scan_size;
 :PREFIX_NO_VERBOSE
