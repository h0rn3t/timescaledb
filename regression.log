diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/constraint_exclusion_prepared-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/constraint_exclusion_prepared-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/constraint_exclusion_prepared-17.out	2025-11-06 12:29:27
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/constraint_exclusion_prepared-17.out	2025-11-06 12:41:30
@@ -1934,98 +1934,44 @@
 PREPARE prep(timestamptz) AS SELECT device_id, time FROM :TEST_TABLE WHERE time = $1 ORDER BY device_id, time;
 :PREFIX EXECUTE prep('2000-01-01 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=4.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 3996
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 2
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=4.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 3996
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 14
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Index Cond: ("time" = $1)
 
 :PREFIX EXECUTE prep('2000-01-10 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 4995
-         ->  Sort (actual rows=5.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 25
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 3
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 4995
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: compress_hyper_X_X_chunk.device_id
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
+                           Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
+                           Rows Removed by Filter: 25
 
 :PREFIX EXECUTE prep(now());
 --- QUERY PLAN ---
- Merge Append (actual rows=0.00 loops=1)
+ Sort (actual rows=0.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=0.00 loops=1)
+         Chunks excluded during startup: 4
 
 DEALLOCATE prep;
 RESET plan_cache_mode;
@@ -3154,78 +3100,42 @@
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
          Vectorized Filter: ("time" = $1)
          Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 3
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
          Vectorized Filter: ("time" = $1)
          Rows Removed by Filter: 2997
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 9
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
          Vectorized Filter: ("time" = $1)
          Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 3
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
 
 :PREFIX EXECUTE prep('2000-01-10 23:42');
 --- QUERY PLAN ---
@@ -3233,79 +3143,43 @@
    Sort Key: metrics_space_compressed.device_id
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 12
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
          Vectorized Filter: ("time" = $1)
          Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 5
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
          Vectorized Filter: ("time" = $1)
          Rows Removed by Filter: 2997
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 15
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
          Vectorized Filter: ("time" = $1)
          Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 5
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
 
 :PREFIX EXECUTE prep(now());
 --- QUERY PLAN ---
@@ -3313,76 +3187,40 @@
    Sort Key: metrics_space_compressed.device_id
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 12
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
    ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
          Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+         ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
 
 DEALLOCATE prep;
 RESET plan_cache_mode;
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/ordered_append_join-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/ordered_append_join-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/ordered_append_join-17.out	2025-11-06 12:29:27
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/ordered_append_join-17.out	2025-11-06 12:41:36
@@ -2603,59 +2603,59 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o3."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o3 (actual rows=100.00 loops=1)
-               Order: o3."time"
-               ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o3."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 3)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 3)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o3_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
-                           Index Cond: (device_id = 3)
-         ->  Materialize (actual rows=100.00 loops=1)
-               ->  Merge Join (actual rows=100.00 loops=1)
-                     Merge Cond: (o2."time" = o1."time")
-                     ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-                           Order: o2."time"
-                           ->  Merge Append (actual rows=100.00 loops=1)
-                                 Sort Key: o2."time"
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                             Index Cond: (device_id = 2)
-                                 ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+         Merge Cond: (o2."time" = o1."time")
+         ->  Merge Join (actual rows=100.00 loops=1)
+               Merge Cond: (o2."time" = o3."time")
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
+                     ->  Merge Append (actual rows=100.00 loops=1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
                                        Index Cond: (device_id = 2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                                       Index Cond: (device_id = 2)
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                                       Index Cond: (device_id = 2)
-                     ->  Materialize (actual rows=100.00 loops=1)
-                           ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                                 Order: o1."time"
-                                 ->  Merge Append (actual rows=100.00 loops=1)
-                                       Sort Key: o1."time"
-                                       ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                             Filter: (device_id = 1)
-                                             ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                                   Index Cond: (device_id = 1)
-                                       ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                             Filter: (device_id = 1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 1)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+               ->  Materialize (actual rows=100.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics_compressed o3 (actual rows=100.00 loops=1)
+                           Order: o3."time"
+                           ->  Merge Append (actual rows=100.00 loops=1)
+                                 Sort Key: o3."time"
+                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
+                                       Filter: (device_id = 3)
+                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (actual rows=1.00 loops=1)
+                                             Index Cond: (device_id = 3)
+                                 ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o3_1 (actual rows=0.00 loops=1)
+                                       Index Cond: (device_id = 3)
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
+                                       Index Cond: (device_id = 3)
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
+                                       Index Cond: (device_id = 3)
+         ->  Materialize (actual rows=100.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+                     Order: o1."time"
+                     ->  Merge Append (actual rows=100.00 loops=1)
+                           Sort Key: o1."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 1)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 1)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
 
 RESET enable_seqscan;
 \set TEST_TABLE 'metrics_space_compressed'
@@ -3284,37 +3284,40 @@
   AND o2.device_id = 2
 ORDER BY o1.time;
 --- QUERY PLAN ---
- Merge Join (actual rows=13674.00 loops=1)
-   Merge Cond: (o1."time" = o2."time")
-   ->  Custom Scan (ChunkAppend) on metrics_space_compressed o1 (actual rows=13674.00 loops=1)
-         Order: o1."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=3598.00 loops=1)
-               Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (actual rows=5038.00 loops=1)
-               Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                     Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (actual rows=5038.00 loops=1)
-               Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                     Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-   ->  Materialize (actual rows=13674.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed o2 (actual rows=13674.00 loops=1)
-               Order: o2."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=3598.00 loops=1)
+ Sort (actual rows=13674.00 loops=1)
+   Sort Key: o1."time"
+   Sort Method: quicksort 
+   ->  Hash Join (actual rows=13674.00 loops=1)
+         Hash Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_space_compressed o1 (actual rows=13674.00 loops=1)
+               Order: o1."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=3598.00 loops=1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
                      ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
-                           Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (actual rows=5038.00 loops=1)
+                           Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (actual rows=5038.00 loops=1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
                      ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                           Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (actual rows=5038.00 loops=1)
+                           Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (actual rows=5038.00 loops=1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
                      ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                           Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                           Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+         ->  Hash (actual rows=13674.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_space_compressed o2 (actual rows=13674.00 loops=1)
+                     Order: o2."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=3598.00 loops=1)
+                           Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
+                                 Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (actual rows=5038.00 loops=1)
+                           Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                                 Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (actual rows=5038.00 loops=1)
+                           Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                                 Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
 
 -- test JOIN
 -- last chunk of o2 should not be executed
@@ -3997,44 +4000,44 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o3."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_space_compressed o3 (actual rows=100.00 loops=1)
-               Order: o3."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                           Index Cond: (device_id = 3)
-         ->  Materialize (actual rows=100.00 loops=1)
-               ->  Merge Join (actual rows=100.00 loops=1)
-                     Merge Cond: (o1."time" = o2."time")
-                     ->  Custom Scan (ChunkAppend) on metrics_space_compressed o1 (actual rows=100.00 loops=1)
-                           Order: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+         Merge Cond: (o1."time" = o3."time")
+         ->  Merge Join (actual rows=100.00 loops=1)
+               Merge Cond: (o1."time" = o2."time")
+               ->  Custom Scan (ChunkAppend) on metrics_space_compressed o1 (actual rows=100.00 loops=1)
+                     Order: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+               ->  Materialize (actual rows=100.00 loops=1)
+                     ->  Custom Scan (ChunkAppend) on metrics_space_compressed o2 (actual rows=100.00 loops=1)
+                           Order: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                                       Index Cond: (device_id = 2)
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                       Index Cond: (device_id = 1)
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                                       Index Cond: (device_id = 2)
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                       Index Cond: (device_id = 1)
-                     ->  Materialize (actual rows=100.00 loops=1)
-                           ->  Custom Scan (ChunkAppend) on metrics_space_compressed o2 (actual rows=100.00 loops=1)
-                                 Order: o2."time"
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                             Index Cond: (device_id = 2)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 2)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 2)
+                                       Index Cond: (device_id = 2)
+         ->  Materialize (actual rows=100.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_space_compressed o3 (actual rows=100.00 loops=1)
+                     Order: o3."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 3)
 
 RESET enable_seqscan;
 -- Disable plain/sorted aggregation to get a deterministic test output
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/transparent_decompress_chunk-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/transparent_decompress_chunk-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/transparent_decompress_chunk-17.out	2025-11-06 12:29:27
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/transparent_decompress_chunk-17.out	2025-11-06 12:41:35
@@ -130,38 +130,30 @@
 -- test constraints not present in targetlist
 :PREFIX SELECT v1 FROM :TEST_TABLE WHERE device_id = 1 ORDER BY v1;
 --- QUERY PLAN ---
- Merge Append (actual rows=3598.00 loops=1)
+ Sort (actual rows=3598.00 loops=1)
    Sort Key: _hyper_X_X_chunk.v1
-   ->  Sort (actual rows=2000.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=3598.00 loops=1)
          ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=2000.00 loops=1)
                Filter: (device_id = 1)
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                      Filter: (device_id = 1)
                      Rows Removed by Filter: 16
-   ->  Sort (actual rows=1598.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
                Filter: (device_id = 1)
 
 -- test order not present in targetlist
 :PREFIX SELECT v2 FROM :TEST_TABLE WHERE device_id = 1 ORDER BY v1;
 --- QUERY PLAN ---
- Merge Append (actual rows=3598.00 loops=1)
+ Sort (actual rows=3598.00 loops=1)
    Sort Key: _hyper_X_X_chunk.v1
-   ->  Sort (actual rows=2000.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Append (actual rows=3598.00 loops=1)
          ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=2000.00 loops=1)
                Filter: (device_id = 1)
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
                      Filter: (device_id = 1)
                      Rows Removed by Filter: 16
-   ->  Sort (actual rows=1598.00 loops=1)
-         Sort Key: _hyper_X_X_chunk.v1
-         Sort Method: quicksort 
          ->  Seq Scan on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
                Filter: (device_id = 1)
 
@@ -238,19 +230,15 @@
 :PREFIX SELECT * FROM :TEST_TABLE WHERE device_id IS NULL ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=0.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
                      Filter: (device_id IS NULL)
                      ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
                            Filter: (device_id IS NULL)
                            Rows Removed by Filter: 18
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
                ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
                      Index Cond: (device_id IS NULL)
 
@@ -295,15 +283,12 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE device_id = v0 ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Filter: (device_id = v0)
                      ->  Seq Scan on compress_hyper_X_X_chunk
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _hyper_X_X_chunk
                      Filter: (device_id = v0)
 
@@ -361,46 +346,39 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE time = '2000-01-01 1:00:00+0' ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk.device_id
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
-               Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort
-                     Sort Key: compress_hyper_X_X_chunk.device_id
+         ->  Append
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
+                     Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
                      ->  Seq Scan on compress_hyper_X_X_chunk
                            Filter: ((_ts_meta_min_1 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone))
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk
-               Index Cond: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk
+                     Index Cond: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE time < '2000-01-01 1:00:00+0' ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
                      ->  Seq Scan on compress_hyper_X_X_chunk
                            Filter: (_ts_meta_min_1 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk
                      Index Cond: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE time <= '2000-01-01 1:00:00+0' ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
                      ->  Seq Scan on compress_hyper_X_X_chunk
                            Filter: (_ts_meta_min_1 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk
                      Index Cond: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
@@ -456,15 +434,12 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE v0 < 1 ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Vectorized Filter: (v0 < 1)
                      ->  Seq Scan on compress_hyper_X_X_chunk
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _hyper_X_X_chunk
                      Filter: (v0 < 1)
 
@@ -501,15 +476,12 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE v1 = device_id ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Filter: (v1 = device_id)
                      ->  Seq Scan on compress_hyper_X_X_chunk
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _hyper_X_X_chunk
                      Filter: (v1 = device_id)
 
@@ -518,19 +490,15 @@
 --- QUERY PLAN ---
  Limit
    Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
-   ->  Merge Append
+   ->  Sort
+         Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk
                      Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
                      Filter: (_hyper_X_X_chunk.v0 = _hyper_X_X_chunk.v1)
                      ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk
                            Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
-         ->  Sort
-               Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _timescaledb_internal._hyper_X_X_chunk
                      Output: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id, _hyper_X_X_chunk.v0, _hyper_X_X_chunk.v1, _hyper_X_X_chunk.v2, _hyper_X_X_chunk.v3
                      Filter: (_hyper_X_X_chunk.v0 = _hyper_X_X_chunk.v1)
@@ -718,29 +686,29 @@
    Merge Cond: (_hyper_X_X_chunk."time" = _hyper_X_X_chunk_1."time")
    ->  Merge Append (actual rows=3598.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
-               Filter: (device_id = 2)
-               ->  Sort (actual rows=4.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=2000.00 loops=1)
+               Filter: (device_id = 1)
+               ->  Sort (actual rows=2.00 loops=1)
                      Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                      Sort Method: quicksort 
-                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
-                           Filter: (device_id = 2)
-                           Rows Removed by Filter: 14
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-               Index Cond: (device_id = 2)
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 16
+         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
+               Filter: (device_id = 1)
    ->  Materialize (actual rows=3598.00 loops=1)
          ->  Merge Append (actual rows=3598.00 loops=1)
                Sort Key: _hyper_X_X_chunk_1."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=2000.00 loops=1)
-                     Filter: (device_id = 1)
-                     ->  Sort (actual rows=2.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=3598.00 loops=1)
+                     Filter: (device_id = 2)
+                     ->  Sort (actual rows=4.00 loops=1)
                            Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
                            Sort Method: quicksort 
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=2.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 Rows Removed by Filter: 16
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=1598.00 loops=1)
-                     Filter: (device_id = 1)
+                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=4.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 14
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=0.00 loops=1)
+                     Index Cond: (device_id = 2)
 
 --
 -- test indexes
@@ -856,27 +824,22 @@
 --with multiple values can get a nested loop.
 :PREFIX_VERBOSE SELECT device_id FROM :TEST_TABLE WHERE device_id IN ( VALUES (1), (2));
 --- QUERY PLAN ---
- Nested Loop (actual rows=7196.00 loops=1)
+ Nested Loop Semi Join (actual rows=7196.00 loops=1)
    Output: _hyper_X_X_chunk.device_id
-   ->  Unique (actual rows=2.00 loops=1)
-         Output: "*VALUES*".column1
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               Sort Method: quicksort 
-               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-                     Output: "*VALUES*".column1
-   ->  Append (actual rows=3598.00 loops=2)
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=2799.00 loops=2)
+   Join Filter: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
+   Rows Removed by Join Filter: 25186
+   ->  Append (actual rows=17990.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk (actual rows=16392.00 loops=1)
                Output: _hyper_X_X_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=3.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_X_X_chunk (actual rows=18.00 loops=1)
                      Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
-                     Index Cond: (compress_hyper_X_X_chunk.device_id = "*VALUES*".column1)
-         ->  Seq Scan on _timescaledb_internal._hyper_X_X_chunk (actual rows=799.00 loops=2)
+         ->  Seq Scan on _timescaledb_internal._hyper_X_X_chunk (actual rows=1598.00 loops=1)
                Output: _hyper_X_X_chunk.device_id
-               Filter: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
-               Rows Removed by Filter: 799
+   ->  Materialize (actual rows=2.00 loops=17990)
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               Output: "*VALUES*".column1
 
 RESET enable_hashjoin;
 :PREFIX_VERBOSE SELECT device_id FROM :TEST_TABLE WHERE device_id IN (VALUES (1));
@@ -917,24 +880,20 @@
 -- loop/row counts of this query is different on windows so we run it without analyze
 :PREFIX_NO_ANALYZE SELECT device_id FROM :TEST_TABLE WHERE device_id IN (VALUES (1), (2));
 --- QUERY PLAN ---
- Nested Loop
+ Hash Semi Join
    Output: _hyper_X_X_chunk.device_id
-   ->  Unique
-         Output: "*VALUES*".column1
-         ->  Sort
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               ->  Values Scan on "*VALUES*"
-                     Output: "*VALUES*".column1
+   Hash Cond: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
    ->  Append
          ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_X_X_chunk
                Output: _hyper_X_X_chunk.device_id
                ->  Index Scan using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on _timescaledb_internal.compress_hyper_X_X_chunk
                      Output: compress_hyper_X_X_chunk._ts_meta_count, compress_hyper_X_X_chunk.device_id, compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1, compress_hyper_X_X_chunk."time", compress_hyper_X_X_chunk.v0, compress_hyper_X_X_chunk.v1, compress_hyper_X_X_chunk.v2, compress_hyper_X_X_chunk.v3
-                     Index Cond: (compress_hyper_X_X_chunk.device_id = "*VALUES*".column1)
          ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _timescaledb_internal._hyper_X_X_chunk
                Output: _hyper_X_X_chunk.device_id
-               Index Cond: (_hyper_X_X_chunk.device_id = "*VALUES*".column1)
+   ->  Hash
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*"
+               Output: "*VALUES*".column1
 
 RESET seq_page_cost;
 -- test view
@@ -1032,28 +991,28 @@
 --- QUERY PLAN ---
  Limit
    ->  Merge Join
-         Merge Cond: (m2."time" = m1."time")
+         Merge Cond: (m1."time" = m2."time")
          ->  Merge Append
-               Sort Key: m2."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
-                     Filter: (device_id = 2)
+               Sort Key: m1."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
+                     Filter: (device_id = 1)
                      ->  Sort
-                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
-                                 Filter: (device_id = 2)
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m2
-                     Index Cond: (device_id = 2)
+                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                           ->  Seq Scan on compress_hyper_X_X_chunk
+                                 Filter: (device_id = 1)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk m1
+                     Filter: (device_id = 1)
          ->  Materialize
                ->  Merge Append
-                     Sort Key: m1."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
-                           Filter: (device_id = 1)
+                     Sort Key: m2."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
+                           Filter: (device_id = 2)
                            ->  Sort
-                                 Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                                 ->  Seq Scan on compress_hyper_X_X_chunk
-                                       Filter: (device_id = 1)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk m1
-                           Filter: (device_id = 1)
+                                 Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
+                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
+                                       Filter: (device_id = 2)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m2
+                           Index Cond: (device_id = 2)
 
 :PREFIX_NO_VERBOSE
 SELECT *
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/columnar_scan_cost.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/columnar_scan_cost.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/columnar_scan_cost.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/columnar_scan_cost.out	2025-11-06 12:38:13
@@ -27,26 +27,26 @@
 
 explain (buffers off) select * from costtab where s = '1';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..11.12 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..101.12 rows=10000 width=108)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=1 width=142)
          Filter: (s = '1'::text)
 
 explain (buffers off) select * from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=50 width=108)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=142)
 
 explain (buffers off) select * from costtab where ti = '200';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.38..31.12 rows=3000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.38..101.12 rows=50 width=108)
    Vectorized Filter: (ti = '200'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=3 width=142)
          Filter: _timescaledb_functions.bloom1_contains(_ts_meta_v2_bloom1_ti, '200'::text)
 
 explain (buffers off) select * from costtab where fi = 200;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.15 rows=10000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.15 rows=50 width=108)
    Vectorized Filter: (fi = '200'::double precision)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.15 rows=10 width=142)
          Filter: ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision))
@@ -58,13 +58,13 @@
 
 explain (buffers off) select ts from costtab where s = '1';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..11.12 rows=1000 width=4)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..101.12 rows=10000 width=4)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=1 width=46)
          Filter: (s = '1'::text)
 
 explain (buffers off) select ts from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=4)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=50 width=4)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=76)
 
@@ -75,33 +75,33 @@
 
 explain (buffers off) select ts, s from costtab where s = '1';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..11.12 rows=1000 width=36)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.12..101.12 rows=10000 width=36)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=1 width=46)
          Filter: (s = '1'::text)
 
 explain (buffers off) select ts, s from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=36)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=50 width=36)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=78)
 
 explain (buffers off) select * from costtab where ts = 5000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.15..11.15 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.15..101.15 rows=50 width=108)
    Vectorized Filter: (ts = 5000)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.15 rows=1 width=142)
          Filter: ((_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000))
 
 explain (buffers off) select * from costtab where fi = 200 and ts = 5000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.20..11.20 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.20..101.20 rows=1 width=108)
    Vectorized Filter: ((fi = '200'::double precision) AND (ts = 5000))
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.20 rows=1 width=142)
          Filter: ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision) AND (_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000))
 
 explain (buffers off) select * from costtab where s = '1' or (fi = 200 and ts = 5000);
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.23..11.22 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.23..101.22 rows=50 width=108)
    Filter: ((s = '1'::text) OR ((fi = '200'::double precision) AND (ts = 5000)))
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.23 rows=1 width=142)
          Filter: ((s = '1'::text) OR ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision) AND (_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000)))
@@ -269,7 +269,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts > 200000 and ts < 300000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.43..1005.58 rows=99000 width=4) (actual rows=99999.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.43..10015.58 rows=5000 width=4) (actual rows=99999.00 loops=1)
    Vectorized Filter: ((ts > 200000) AND (ts < 300000))
    Rows Removed by Filter: 1
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..15.58 rows=99 width=44) (actual rows=100.00 loops=1)
@@ -278,7 +278,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts = 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=18.70..28.70 rows=1000 width=4) (actual rows=1.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=18.70..10018.70 rows=5000 width=4) (actual rows=1.00 loops=1)
    Vectorized Filter: (ts = 500000)
    Rows Removed by Filter: 999
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..18.70 rows=1 width=44) (actual rows=1.00 loops=1)
@@ -287,7 +287,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts < 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.32..5001.61 rows=498000 width=4) (actual rows=499999.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.32..10021.61 rows=333333 width=4) (actual rows=499999.00 loops=1)
    Vectorized Filter: (ts < 500000)
    Rows Removed by Filter: 1
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..21.61 rows=498 width=44) (actual rows=500.00 loops=1)
@@ -296,7 +296,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts > 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.05..5035.50 rows=501000 width=4) (actual rows=500000.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.05..10025.50 rows=333333 width=4) (actual rows=500000.00 loops=1)
    Vectorized Filter: (ts > 500000)
    ->  Seq Scan on compress_hyper_6_26_chunk  (cost=0.00..25.50 rows=501 width=44) (actual rows=500.00 loops=1)
          Filter: (_ts_meta_max_1 > 500000)
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_bitmap_scan.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_bitmap_scan.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_bitmap_scan.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_bitmap_scan.out	2025-11-06 12:38:22
@@ -114,6 +114,7 @@
 --- QUERY PLAN ---
  Nested Loop (actual rows=324.00 loops=1)
    Output: t1.ts, t1.s, t1.id, t1.payload, t2.ts, t2.s, t2.id, t2.payload
+   Join Filter: (t1.s = t2.s)
    ->  Append (actual rows=18.00 loops=1)
          ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk t2_1 (actual rows=10.00 loops=1)
                Output: t2_1.ts, t2_1.s, t2_1.id, t2_1.payload
@@ -145,27 +146,29 @@
                                  Index Cond: ((compress_hyper_2_4_chunk_1._ts_meta_min_1 <= 1) AND (compress_hyper_2_4_chunk_1._ts_meta_max_1 >= 1))
                            ->  Bitmap Index Scan on compress_hyper_2_4_chunk_s__ts_meta_min_1__ts_meta_max_1__t_idx (actual rows=5.00 loops=1)
                                  Index Cond: ((compress_hyper_2_4_chunk_1._ts_meta_min_1 <= 2) AND (compress_hyper_2_4_chunk_1._ts_meta_max_1 >= 2))
-   ->  Append (actual rows=18.00 loops=18)
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk t1_1 (actual rows=10.00 loops=18)
-               Output: t1_1.ts, t1_1.s, t1_1.id, t1_1.payload
-               Vectorized Filter: (t1_1.payload = '-537'::integer)
-               Rows Removed by Filter: 990
-               Bulk Decompression: true
-               ->  Index Scan using compress_hyper_2_3_chunk_s__ts_meta_min_1__ts_meta_max_1__t_idx on _timescaledb_internal.compress_hyper_2_3_chunk (actual rows=1.00 loops=18)
-                     Output: compress_hyper_2_3_chunk._ts_meta_count, compress_hyper_2_3_chunk.s, compress_hyper_2_3_chunk._ts_meta_min_2, compress_hyper_2_3_chunk._ts_meta_max_2, compress_hyper_2_3_chunk.ts, compress_hyper_2_3_chunk._ts_meta_min_1, compress_hyper_2_3_chunk._ts_meta_max_1, compress_hyper_2_3_chunk.id, compress_hyper_2_3_chunk._ts_meta_v2_bloom1_payload, compress_hyper_2_3_chunk.payload
-                     Index Cond: (compress_hyper_2_3_chunk.s = t2.s)
-                     Filter: _timescaledb_functions.bloom1_contains(compress_hyper_2_3_chunk._ts_meta_v2_bloom1_payload, '-537'::integer)
-                     Rows Removed by Filter: 2
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk t1_2 (actual rows=8.00 loops=18)
-               Output: t1_2.ts, t1_2.s, t1_2.id, t1_2.payload
-               Vectorized Filter: (t1_2.payload = '-537'::integer)
-               Rows Removed by Filter: 992
-               Bulk Decompression: true
-               ->  Index Scan using compress_hyper_2_4_chunk_s__ts_meta_min_1__ts_meta_max_1__t_idx on _timescaledb_internal.compress_hyper_2_4_chunk (actual rows=1.00 loops=18)
-                     Output: compress_hyper_2_4_chunk._ts_meta_count, compress_hyper_2_4_chunk.s, compress_hyper_2_4_chunk._ts_meta_min_2, compress_hyper_2_4_chunk._ts_meta_max_2, compress_hyper_2_4_chunk.ts, compress_hyper_2_4_chunk._ts_meta_min_1, compress_hyper_2_4_chunk._ts_meta_max_1, compress_hyper_2_4_chunk.id, compress_hyper_2_4_chunk._ts_meta_v2_bloom1_payload, compress_hyper_2_4_chunk.payload
-                     Index Cond: (compress_hyper_2_4_chunk.s = t2.s)
-                     Filter: _timescaledb_functions.bloom1_contains(compress_hyper_2_4_chunk._ts_meta_v2_bloom1_payload, '-537'::integer)
-                     Rows Removed by Filter: 2
+   ->  Materialize (actual rows=18.00 loops=18)
+         Output: t1.ts, t1.s, t1.id, t1.payload
+         ->  Append (actual rows=18.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk t1_1 (actual rows=10.00 loops=1)
+                     Output: t1_1.ts, t1_1.s, t1_1.id, t1_1.payload
+                     Vectorized Filter: (t1_1.payload = '-537'::integer)
+                     Rows Removed by Filter: 1262
+                     Batches Removed by Filter: 3
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_3_chunk (actual rows=4.00 loops=1)
+                           Output: compress_hyper_2_3_chunk._ts_meta_count, compress_hyper_2_3_chunk.s, compress_hyper_2_3_chunk._ts_meta_min_2, compress_hyper_2_3_chunk._ts_meta_max_2, compress_hyper_2_3_chunk.ts, compress_hyper_2_3_chunk._ts_meta_min_1, compress_hyper_2_3_chunk._ts_meta_max_1, compress_hyper_2_3_chunk.id, compress_hyper_2_3_chunk._ts_meta_v2_bloom1_payload, compress_hyper_2_3_chunk.payload
+                           Filter: _timescaledb_functions.bloom1_contains(compress_hyper_2_3_chunk._ts_meta_v2_bloom1_payload, '-537'::integer)
+                           Rows Removed by Filter: 713
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_2_chunk t1_2 (actual rows=8.00 loops=1)
+                     Output: t1_2.ts, t1_2.s, t1_2.id, t1_2.payload
+                     Vectorized Filter: (t1_2.payload = '-537'::integer)
+                     Rows Removed by Filter: 1264
+                     Batches Removed by Filter: 3
+                     Bulk Decompression: true
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_4_chunk (actual rows=4.00 loops=1)
+                           Output: compress_hyper_2_4_chunk._ts_meta_count, compress_hyper_2_4_chunk.s, compress_hyper_2_4_chunk._ts_meta_min_2, compress_hyper_2_4_chunk._ts_meta_max_2, compress_hyper_2_4_chunk.ts, compress_hyper_2_4_chunk._ts_meta_min_1, compress_hyper_2_4_chunk._ts_meta_max_1, compress_hyper_2_4_chunk.id, compress_hyper_2_4_chunk._ts_meta_v2_bloom1_payload, compress_hyper_2_4_chunk.payload
+                           Filter: _timescaledb_functions.bloom1_contains(compress_hyper_2_4_chunk._ts_meta_v2_bloom1_payload, '-537'::integer)
+                           Rows Removed by Filter: 713
 
 ;
 reset enable_mergejoin;
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_qualpushdown_saop.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_qualpushdown_saop.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compress_qualpushdown_saop.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compress_qualpushdown_saop.out	2025-11-06 12:38:20
@@ -402,24 +402,24 @@
 select * from saop, arrays where segmentby = any(a);
 --- QUERY PLAN ---
  Nested Loop (actual rows=43480.00 loops=1)
-   ->  Limit (actual rows=10.00 loops=1)
-         ->  Group (actual rows=10.00 loops=1)
-               Group Key: saop_1.segmentby
-               ->  Merge Append (actual rows=39133.00 loops=1)
-                     Sort Key: saop_1.segmentby
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=19567.00 loops=1)
-                           ->  Index Scan using compress_hyper_2_3_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_3_chunk compress_hyper_2_3_chunk_1 (actual rows=28.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk _hyper_1_2_chunk_1 (actual rows=19567.00 loops=1)
-                           ->  Index Scan using compress_hyper_2_4_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=28.00 loops=1)
-   ->  Append (actual rows=4348.00 loops=10)
-         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=2174.00 loops=10)
-               Filter: (segmentby = ANY ((ARRAY[saop_1.segmentby])))
-               ->  Index Scan using compress_hyper_2_3_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_3_chunk (actual rows=3.00 loops=10)
-                     Index Cond: (segmentby = ANY ((ARRAY[saop_1.segmentby])))
-         ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=2174.00 loops=10)
-               Filter: (segmentby = ANY ((ARRAY[saop_1.segmentby])))
-               ->  Index Scan using compress_hyper_2_4_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_4_chunk (actual rows=3.00 loops=10)
-                     Index Cond: (segmentby = ANY ((ARRAY[saop_1.segmentby])))
+   Join Filter: (saop.segmentby = ANY (arrays.a))
+   Rows Removed by Join Filter: 956530
+   ->  Append (actual rows=100001.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=50001.00 loops=1)
+               ->  Seq Scan on compress_hyper_2_3_chunk (actual rows=69.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk (actual rows=50000.00 loops=1)
+               ->  Seq Scan on compress_hyper_2_4_chunk (actual rows=69.00 loops=1)
+   ->  Materialize (actual rows=10.00 loops=100001)
+         ->  Subquery Scan on arrays (actual rows=10.00 loops=1)
+               ->  Limit (actual rows=10.00 loops=1)
+                     ->  Group (actual rows=10.00 loops=1)
+                           Group Key: saop_1.segmentby
+                           ->  Merge Append (actual rows=39133.00 loops=1)
+                                 Sort Key: saop_1.segmentby
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk _hyper_1_1_chunk_1 (actual rows=19567.00 loops=1)
+                                       ->  Index Scan using compress_hyper_2_3_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_3_chunk compress_hyper_2_3_chunk_1 (actual rows=28.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk _hyper_1_2_chunk_1 (actual rows=19567.00 loops=1)
+                                       ->  Index Scan using compress_hyper_2_4_chunk_segmentby__ts_meta_min_1__ts_meta__idx on compress_hyper_2_4_chunk compress_hyper_2_4_chunk_1 (actual rows=28.00 loops=1)
 
 explain (analyze, buffers off, costs off, timing off, summary off)
 with arrays as (select array[segmentby] a from saop group by segmentby order by segmentby limit 10)
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compression.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compression.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression.out	2025-11-06 12:38:33
@@ -1601,18 +1601,12 @@
 :explain
 SELECT sum(cpu) FROM f_sensor_data;
 --- QUERY PLAN ---
- Finalize Aggregate
+ Aggregate
    Output: sum(_hyper_37_73_chunk.cpu)
-   ->  Gather
-         Output: (PARTIAL sum(_hyper_37_73_chunk.cpu))
-         Workers Planned: 4
-         ->  Custom Scan (VectorAgg)
-               Output: (PARTIAL sum(_hyper_37_73_chunk.cpu))
-               Grouping Policy: all compressed batches
-               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_37_73_chunk
-                     Output: _hyper_37_73_chunk.cpu
-                     ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_38_74_chunk
-                           Output: compress_hyper_38_74_chunk._ts_meta_count, compress_hyper_38_74_chunk.sensor_id, compress_hyper_38_74_chunk._ts_meta_min_1, compress_hyper_38_74_chunk._ts_meta_max_1, compress_hyper_38_74_chunk."time", compress_hyper_38_74_chunk.cpu, compress_hyper_38_74_chunk.temperature
+   ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_37_73_chunk
+         Output: _hyper_37_73_chunk.cpu
+         ->  Seq Scan on _timescaledb_internal.compress_hyper_38_74_chunk
+               Output: compress_hyper_38_74_chunk._ts_meta_count, compress_hyper_38_74_chunk.sensor_id, compress_hyper_38_74_chunk._ts_meta_min_1, compress_hyper_38_74_chunk._ts_meta_max_1, compress_hyper_38_74_chunk."time", compress_hyper_38_74_chunk.cpu, compress_hyper_38_74_chunk.temperature
 
 CREATE INDEX ON f_sensor_data (time, sensor_id);
 :explain
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_update_delete-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_update_delete-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/compression_update_delete-17.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/compression_update_delete-17.out	2025-11-06 12:39:50
@@ -2588,29 +2588,18 @@
 -- All 3 chunks will now become partially compressed chunks
 EXPLAIN (buffers off, costs off) SELECT * FROM test_partials ORDER BY time;
 --- QUERY PLAN ---
- Custom Scan (ChunkAppend) on test_partials
-   Order: test_partials."time"
-   ->  Merge Append
-         Sort Key: test_partials."time"
+ Sort
+   Sort Key: test_partials."time"
+   ->  Append
          ->  Custom Scan (ColumnarScan) on _hyper_35_68_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_71_chunk._ts_meta_min_1, compress_hyper_36_71_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_71_chunk
-         ->  Index Scan Backward using _hyper_35_68_chunk_test_partials_time_idx on _hyper_35_68_chunk
-   ->  Merge Append
-         Sort Key: test_partials."time"
+               ->  Seq Scan on compress_hyper_36_71_chunk
+         ->  Seq Scan on _hyper_35_68_chunk
          ->  Custom Scan (ColumnarScan) on _hyper_35_69_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_72_chunk._ts_meta_min_1, compress_hyper_36_72_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_72_chunk
-         ->  Index Scan Backward using _hyper_35_69_chunk_test_partials_time_idx on _hyper_35_69_chunk
-   ->  Merge Append
-         Sort Key: test_partials."time"
+               ->  Seq Scan on compress_hyper_36_72_chunk
+         ->  Seq Scan on _hyper_35_69_chunk
          ->  Custom Scan (ColumnarScan) on _hyper_35_70_chunk
-               ->  Sort
-                     Sort Key: compress_hyper_36_73_chunk._ts_meta_min_1, compress_hyper_36_73_chunk._ts_meta_max_1
-                     ->  Seq Scan on compress_hyper_36_73_chunk
-         ->  Index Scan Backward using _hyper_35_70_chunk_test_partials_time_idx on _hyper_35_70_chunk
+               ->  Seq Scan on compress_hyper_36_73_chunk
+         ->  Seq Scan on _hyper_35_70_chunk
 
 -- verify correct results
 SELECT * FROM test_partials ORDER BY time;
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/merge_append_partially_compressed.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/merge_append_partially_compressed.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/merge_append_partially_compressed.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/merge_append_partially_compressed.out	2025-11-06 12:40:20
@@ -617,165 +617,123 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Index Scan using _hyper_3_7_chunk_test1_time_idx on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 -- requires resorting
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 -- all these require resorting, no pushdown can happen
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST, x4 ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3, test1.x4
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3, test1.x4
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3, test1.x4
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST, x4 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3, test1.x4 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3, test1.x4 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3, test1.x4 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time"
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time"
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time"
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Index Scan Backward using _hyper_3_7_chunk_test1_time_idx on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time"
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST, x3 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time", test1.x3 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time", test1.x3 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time", test1.x3 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST, x3 DESC NULLS FIRST, x4 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time", test1.x3 DESC, test1.x4 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time", test1.x3 DESC, test1.x4 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time", test1.x3 DESC, test1.x4 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS FIRST, x3 DESC NULLS LAST, x4 ASC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" NULLS FIRST, _hyper_3_7_chunk.x3 DESC NULLS LAST, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" NULLS FIRST, _hyper_3_7_chunk.x3 DESC NULLS LAST, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 set enable_hashagg to off; -- different on PG13
 :PREFIX
@@ -786,41 +744,31 @@
    ->  GroupAggregate (actual rows=5.00 loops=1)
          Group Key: test1."time", test1.x1, test1.x2
          ->  Limit (actual rows=5.00 loops=1)
-               ->  Result (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-                           Order: test1."time", test1.x1, test1.x2
-                           ->  Merge Append (actual rows=5.00 loops=1)
-                                 Sort Key: test1."time", test1.x1, test1.x2
-                                 ->  Sort (actual rows=4.00 loops=1)
-                                       Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2
-                                       Sort Method: quicksort 
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                                             Filter: ((x4 % 11) <> 0)
-                                             Rows Removed by Filter: 10000
-                                             ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-                                 ->  Sort (actual rows=1.00 loops=1)
-                                       Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2
-                                       Sort Method: quicksort 
-                                       ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                                             Filter: ((x4 % 11) <> 0)
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: test1."time", test1.x1, test1.x2
+                     Sort Method: quicksort 
+                     ->  Result (actual rows=5.00 loops=1)
+                           ->  Append (actual rows=5.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                                       Filter: ((x4 % 11) <> 0)
+                                       Rows Removed by Filter: 10000
+                                       ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+                                 ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                                       Filter: ((x4 % 11) <> 0)
 
 reset enable_hashagg;
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1.x4, test1."time"
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk.x4, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk.x4, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -828,18 +776,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -847,18 +791,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -866,18 +806,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3, test1.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -885,18 +821,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x4 DESC LIMIT 10; -- no pushdown because orderby does not match
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x4 DESC
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1132,30 +1064,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x3
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1176,30 +1098,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1220,30 +1132,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2."time"
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1454,54 +1356,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x3
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1522,54 +1402,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3.x4
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1590,54 +1448,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3."time"
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan-17.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan-17.out	2025-11-06 12:40:46
@@ -6811,19 +6811,18 @@
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time BETWEEN 100 AND 300;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time < 200;
 --- QUERY PLAN ---
@@ -7274,12 +7273,11 @@
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time = 100;
 --- QUERY PLAN ---
  Unique (actual rows=5.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 745
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                     Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 1245
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+               Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time > 200;
 --- QUERY PLAN ---
@@ -7332,12 +7330,11 @@
 :PREFIX SELECT DISTINCT ON (dev) dev,time,val FROM :TABLE WHERE time > 100 AND time < 200 AND val > 10 AND val < 10000 AND dev > 2 AND dev < 7 ORDER BY dev,time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=0.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_dagg-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_dagg-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_dagg-17.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_dagg-17.out	2025-11-06 12:40:46
@@ -2885,11 +2885,8 @@
    ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=11.00 loops=1)
          Vectorized Filter: ("time" = 100)
          Rows Removed by Filter: 2494
-         ->  Sort (actual rows=11.00 loops=1)
-               Sort Key: compress_hyper_2_17_chunk.dev
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_2_17_chunk (actual rows=11.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+         ->  Index Scan using compress_hyper_2_17_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_2_17_chunk (actual rows=11.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 SELECT decompress_chunk('_timescaledb_internal._hyper_1_1_chunk');
             decompress_chunk            
@@ -5492,19 +5489,18 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE time < 200 GROUP BY dev;
 --- QUERY PLAN ---
@@ -5983,12 +5979,11 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=0.00 loops=1)
    Group Key: _hyper_5_9_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/skip_scan.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/skip_scan.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/skip_scan.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/skip_scan.out	2025-11-06 12:41:06
@@ -2837,10 +2837,6 @@
 psql:include/skip_scan_multi_query.sql:34: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 \qecho ordered append on :TABLE
 :PREFIX SELECT DISTINCT ON (region, dev) region, dev FROM :TABLE WHERE status = 1 AND time BETWEEN 0 AND 5000;
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 \qecho SUBSELECTS on :TABLE
 :PREFIX SELECT time, region, dev, val, 'q4_1' FROM (SELECT DISTINCT ON (region, dev) * FROM :TABLE WHERE status = 1) a;
 psql:include/skip_scan_multi_query.sql:40: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression-17.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression-17.out	2025-11-06 12:41:07
@@ -2151,33 +2151,27 @@
         VALUES (1),
             (2));
 --- QUERY PLAN ---
- Nested Loop (actual rows=3456.00 loops=1)
+ Nested Loop Semi Join (actual rows=3456.00 loops=1)
    Output: metrics.device_id_peer
-   ->  Unique (actual rows=2.00 loops=1)
-         Output: "*VALUES*".column1
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               Sort Method: quicksort 
-               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-                     Output: "*VALUES*".column1
-   ->  Append (actual rows=1728.00 loops=2)
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=720.00 loops=2)
+   Join Filter: (metrics.device_id = "*VALUES*".column1)
+   Rows Removed by Join Filter: 12096
+   ->  Append (actual rows=8640.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=3600.00 loops=1)
                Output: _hyper_1_1_chunk.device_id_peer, _hyper_1_1_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_15_chunk._ts_meta_count, compress_hyper_5_15_chunk.device_id, compress_hyper_5_15_chunk.device_id_peer, compress_hyper_5_15_chunk._ts_meta_min_3, compress_hyper_5_15_chunk._ts_meta_max_3, compress_hyper_5_15_chunk."time", compress_hyper_5_15_chunk._ts_meta_min_1, compress_hyper_5_15_chunk._ts_meta_max_1, compress_hyper_5_15_chunk.v0, compress_hyper_5_15_chunk._ts_meta_min_2, compress_hyper_5_15_chunk._ts_meta_max_2, compress_hyper_5_15_chunk.v1, compress_hyper_5_15_chunk.v2, compress_hyper_5_15_chunk.v3
-                     Index Cond: (compress_hyper_5_15_chunk.device_id = "*VALUES*".column1)
-         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=672.00 loops=2)
+         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=3360.00 loops=1)
                Output: _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.device_id
-               Filter: ("*VALUES*".column1 = _hyper_1_2_chunk.device_id)
-               Rows Removed by Filter: 2688
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=336.00 loops=2)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
                Output: _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-                     Index Cond: (compress_hyper_5_16_chunk.device_id = "*VALUES*".column1)
+   ->  Materialize (actual rows=2.00 loops=8640)
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               Output: "*VALUES*".column1
 
 RESET enable_hashjoin;
 RESET enable_mergejoin;
@@ -2243,33 +2237,26 @@
         VALUES (1),
             (2));
 --- QUERY PLAN ---
- Nested Loop (actual rows=3456.00 loops=1)
+ Hash Semi Join (actual rows=3456.00 loops=1)
    Output: metrics.device_id_peer
-   ->  Unique (actual rows=2.00 loops=1)
-         Output: "*VALUES*".column1
-         ->  Sort (actual rows=2.00 loops=1)
-               Output: "*VALUES*".column1
-               Sort Key: "*VALUES*".column1
-               Sort Method: quicksort 
-               ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-                     Output: "*VALUES*".column1
-   ->  Append (actual rows=1728.00 loops=2)
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=720.00 loops=2)
+   Hash Cond: (metrics.device_id = "*VALUES*".column1)
+   ->  Append (actual rows=8640.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_1_chunk (actual rows=3600.00 loops=1)
                Output: _hyper_1_1_chunk.device_id_peer, _hyper_1_1_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_15_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_15_chunk._ts_meta_count, compress_hyper_5_15_chunk.device_id, compress_hyper_5_15_chunk.device_id_peer, compress_hyper_5_15_chunk._ts_meta_min_3, compress_hyper_5_15_chunk._ts_meta_max_3, compress_hyper_5_15_chunk."time", compress_hyper_5_15_chunk._ts_meta_min_1, compress_hyper_5_15_chunk._ts_meta_max_1, compress_hyper_5_15_chunk.v0, compress_hyper_5_15_chunk._ts_meta_min_2, compress_hyper_5_15_chunk._ts_meta_max_2, compress_hyper_5_15_chunk.v1, compress_hyper_5_15_chunk.v2, compress_hyper_5_15_chunk.v3
-                     Index Cond: (compress_hyper_5_15_chunk.device_id = "*VALUES*".column1)
-         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=672.00 loops=2)
+         ->  Seq Scan on _timescaledb_internal._hyper_1_2_chunk (actual rows=3360.00 loops=1)
                Output: _hyper_1_2_chunk.device_id_peer, _hyper_1_2_chunk.device_id
-               Filter: ("*VALUES*".column1 = _hyper_1_2_chunk.device_id)
-               Rows Removed by Filter: 2688
-         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=336.00 loops=2)
+         ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_3_chunk (actual rows=1680.00 loops=1)
                Output: _hyper_1_3_chunk.device_id_peer, _hyper_1_3_chunk.device_id
                Bulk Decompression: false
-               ->  Index Scan using compress_hyper_5_16_chunk_device_id_device_id_peer__ts_meta_idx on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=1.00 loops=2)
+               ->  Seq Scan on _timescaledb_internal.compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
                      Output: compress_hyper_5_16_chunk._ts_meta_count, compress_hyper_5_16_chunk.device_id, compress_hyper_5_16_chunk.device_id_peer, compress_hyper_5_16_chunk._ts_meta_min_3, compress_hyper_5_16_chunk._ts_meta_max_3, compress_hyper_5_16_chunk."time", compress_hyper_5_16_chunk._ts_meta_min_1, compress_hyper_5_16_chunk._ts_meta_max_1, compress_hyper_5_16_chunk.v0, compress_hyper_5_16_chunk._ts_meta_min_2, compress_hyper_5_16_chunk._ts_meta_max_2, compress_hyper_5_16_chunk.v1, compress_hyper_5_16_chunk.v2, compress_hyper_5_16_chunk.v3
-                     Index Cond: (compress_hyper_5_16_chunk.device_id = "*VALUES*".column1)
+   ->  Hash (actual rows=2.00 loops=1)
+         Output: "*VALUES*".column1
+         ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
+               Output: "*VALUES*".column1
 
 -- test view
 CREATE OR REPLACE VIEW compressed_view AS
@@ -2360,58 +2347,58 @@
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
    ->  Merge Join (actual rows=10.00 loops=1)
-         Merge Cond: (m1."time" = m3."time")
-         ->  Merge Join (actual rows=10.00 loops=1)
-               Merge Cond: ((m1."time" = m2."time") AND (m1.device_id = m2.device_id))
-               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=10.00 loops=1)
-                     Order: m1."time", m1.device_id
-                     ->  Sort (actual rows=10.00 loops=1)
-                           Sort Key: m1_1."time", m1_1.device_id
-                           Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-                     ->  Sort (never executed)
-                           Sort Key: m1_2."time", m1_2.device_id
-                           ->  Seq Scan on _hyper_1_2_chunk m1_2 (never executed)
-                     ->  Sort (never executed)
-                           Sort Key: m1_3."time", m1_3.device_id
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (never executed)
-                                 ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
-               ->  Materialize (actual rows=10.00 loops=1)
-                     ->  Custom Scan (ChunkAppend) on metrics m2 (actual rows=10.00 loops=1)
-                           Order: m2."time", m2.device_id
+         Merge Cond: ((m2."time" = m1."time") AND (m2.device_id = m1.device_id))
+         ->  Custom Scan (ChunkAppend) on metrics m2 (actual rows=10.00 loops=1)
+               Order: m2."time", m2.device_id
+               ->  Sort (actual rows=10.00 loops=1)
+                     Sort Key: m2_1."time", m2_1.device_id
+                     Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=3600.00 loops=1)
+                           ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=5.00 loops=1)
+               ->  Sort (never executed)
+                     Sort Key: m2_2."time", m2_2.device_id
+                     ->  Seq Scan on _hyper_1_2_chunk m2_2 (never executed)
+               ->  Sort (never executed)
+                     Sort Key: m2_3."time", m2_3.device_id
+                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (never executed)
+                           ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (never executed)
+         ->  Materialize (actual rows=10.00 loops=1)
+               ->  Merge Join (actual rows=10.00 loops=1)
+                     Merge Cond: (m1."time" = m3."time")
+                     ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=10.00 loops=1)
+                           Order: m1."time", m1.device_id
                            ->  Sort (actual rows=10.00 loops=1)
-                                 Sort Key: m2_1."time", m2_1.device_id
+                                 Sort Key: m1_1."time", m1_1.device_id
                                  Sort Method: quicksort 
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=3600.00 loops=1)
-                                       ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=5.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
+                                       ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
                            ->  Sort (never executed)
-                                 Sort Key: m2_2."time", m2_2.device_id
-                                 ->  Seq Scan on _hyper_1_2_chunk m2_2 (never executed)
+                                 Sort Key: m1_2."time", m1_2.device_id
+                                 ->  Seq Scan on _hyper_1_2_chunk m1_2 (never executed)
                            ->  Sort (never executed)
-                                 Sort Key: m2_3."time", m2_3.device_id
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (never executed)
-                                       ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (never executed)
-         ->  Materialize (actual rows=10.00 loops=1)
-               ->  Merge Append (actual rows=3.00 loops=1)
-                     Sort Key: m3."time"
-                     ->  Sort (actual rows=3.00 loops=1)
-                           Sort Key: m3_1."time"
-                           Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m3_1 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_2 (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 3)
-                                       Rows Removed by Filter: 4
-                     ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m3_2 (actual rows=1.00 loops=1)
-                           Filter: (device_id = 3)
-                           Rows Removed by Filter: 2
-                     ->  Sort (actual rows=1.00 loops=1)
-                           Sort Key: m3_3."time"
-                           Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m3_3 (actual rows=336.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_2 (actual rows=1.00 loops=1)
+                                 Sort Key: m1_3."time", m1_3.device_id
+                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (never executed)
+                                       ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
+                     ->  Materialize (actual rows=10.00 loops=1)
+                           ->  Merge Append (actual rows=3.00 loops=1)
+                                 Sort Key: m3."time"
+                                 ->  Sort (actual rows=3.00 loops=1)
+                                       Sort Key: m3_1."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m3_1 (actual rows=720.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_2 (actual rows=1.00 loops=1)
+                                                   Filter: (device_id = 3)
+                                                   Rows Removed by Filter: 4
+                                 ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m3_2 (actual rows=1.00 loops=1)
                                        Filter: (device_id = 3)
-                                       Rows Removed by Filter: 4
+                                       Rows Removed by Filter: 2
+                                 ->  Sort (actual rows=1.00 loops=1)
+                                       Sort Key: m3_3."time"
+                                       Sort Method: quicksort 
+                                       ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m3_3 (actual rows=336.00 loops=1)
+                                             ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_2 (actual rows=1.00 loops=1)
+                                                   Filter: (device_id = 3)
+                                                   Rows Removed by Filter: 4
 
 :PREFIX
 SELECT *
@@ -2476,40 +2463,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (m1."time" = m2."time")
-         ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=100.00 loops=1)
-               Order: m1."time"
+         Merge Cond: (m2."time" = m1."time")
+         ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=100.00 loops=1)
+               Order: m2."time"
                ->  Sort (actual rows=100.00 loops=1)
-                     Sort Key: m1_1."time"
+                     Sort Key: m2_1."time"
                      Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=720.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 Rows Removed by Filter: 4
-               ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m1_2 (never executed)
-                     Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_1 (actual rows=720.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 2
+               ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_2 (never executed)
+                     Index Cond: (device_id = 2)
                ->  Sort (never executed)
-                     Sort Key: m1_3."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (never executed)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
-                                 Filter: (device_id = 1)
+                     Sort Key: m2_3."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_3 (never executed)
+                           ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
+                                 Filter: (device_id = 2)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=100.00 loops=1)
-                     Order: m2."time"
+               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=100.00 loops=1)
+                     Order: m1."time"
                      ->  Sort (actual rows=100.00 loops=1)
-                           Sort Key: m2_1."time"
+                           Sort Key: m1_1."time"
                            Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_1 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 2)
-                                       Rows Removed by Filter: 2
-                     ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_2 (never executed)
-                           Index Cond: (device_id = 2)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=720.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=1.00 loops=1)
+                                       Filter: (device_id = 1)
+                                       Rows Removed by Filter: 4
+                     ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m1_2 (never executed)
+                           Filter: (device_id = 1)
                      ->  Sort (never executed)
-                           Sort Key: m2_3."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_3 (never executed)
-                                 ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
-                                       Filter: (device_id = 2)
+                           Sort Key: m1_3."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (never executed)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
+                                       Filter: (device_id = 1)
 
 -- test OUTER JOIN
 :PREFIX
@@ -2570,29 +2557,36 @@
    ->  Sort (actual rows=100.00 loops=1)
          Sort Key: m1."time", m1.device_id, m2."time", m2.device_id
          Sort Method: top-N heapsort 
-         ->  Hash Left Join (actual rows=8640.00 loops=1)
-               Hash Cond: (m1."time" = m2."time")
+         ->  Hash Right Join (actual rows=8640.00 loops=1)
+               Hash Cond: (m2."time" = m1."time")
                Join Filter: (m1.device_id = 1)
                Rows Removed by Join Filter: 6912
-               ->  Append (actual rows=8640.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
-                     ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
-               ->  Hash (actual rows=1728.00 loops=1)
-                     ->  Append (actual rows=1728.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics m2 (actual rows=1728.00 loops=1)
+                     Order: m2."time"
+                     ->  Sort (actual rows=720.00 loops=1)
+                           Sort Key: m2_1."time"
+                           Sort Method: quicksort 
                            ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m2_1 (actual rows=720.00 loops=1)
                                  ->  Seq Scan on compress_hyper_5_15_chunk compress_hyper_5_15_chunk_1 (actual rows=1.00 loops=1)
                                        Filter: (device_id = 2)
                                        Rows Removed by Filter: 4
-                           ->  Seq Scan on _hyper_1_2_chunk m2_2 (actual rows=672.00 loops=1)
-                                 Filter: (device_id = 2)
-                                 Rows Removed by Filter: 2688
+                     ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m2_2 (actual rows=672.00 loops=1)
+                           Filter: (device_id = 2)
+                           Rows Removed by Filter: 2688
+                     ->  Sort (actual rows=336.00 loops=1)
+                           Sort Key: m2_3."time"
+                           Sort Method: quicksort 
                            ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m2_3 (actual rows=336.00 loops=1)
                                  ->  Seq Scan on compress_hyper_5_16_chunk compress_hyper_5_16_chunk_1 (actual rows=1.00 loops=1)
                                        Filter: (device_id = 2)
                                        Rows Removed by Filter: 4
+               ->  Hash (actual rows=8640.00 loops=1)
+                     ->  Append (actual rows=8640.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=3600.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=5.00 loops=1)
+                           ->  Seq Scan on _hyper_1_2_chunk m1_2 (actual rows=3360.00 loops=1)
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (actual rows=1680.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (actual rows=5.00 loops=1)
 
 :PREFIX
 SELECT *
@@ -3810,34 +3804,25 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space (actual rows=10.00 loops=1)
-         Order: metrics_space."time", metrics_space.device_id
-         ->  Merge Append (actual rows=10.00 loops=1)
-               Sort Key: metrics_space."time", metrics_space.device_id
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_4_chunk."time", _hyper_2_4_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=6.00 loops=1)
-                           Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 714
-                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=6.00 loops=1)
-                     Sort Key: _hyper_2_5_chunk."time", _hyper_2_5_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=18.00 loops=1)
-                           Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 2142
-                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
-                                 Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_6_chunk."time", _hyper_2_6_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=6.00 loops=1)
-                           Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 714
-                           ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: metrics_space."time", metrics_space.device_id
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=30.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=6.00 loops=1)
+                     Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 714
+                     ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=18.00 loops=1)
+                     Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 2142
+                     ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
+                           Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=6.00 loops=1)
+                     Vectorized Filter: ("time" < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 714
+                     ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 < 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX
 SELECT *
@@ -3848,34 +3833,25 @@
 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on metrics_space (actual rows=10.00 loops=1)
-         Order: metrics_space."time", metrics_space.device_id
-         ->  Merge Append (actual rows=10.00 loops=1)
-               Sort Key: metrics_space."time", metrics_space.device_id
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_4_chunk."time", _hyper_2_4_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=7.00 loops=1)
-                           Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 713
-                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=6.00 loops=1)
-                     Sort Key: _hyper_2_5_chunk."time", _hyper_2_5_chunk.device_id
-                     Sort Method: top-N heapsort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=21.00 loops=1)
-                           Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 2139
-                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
-                                 Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort (actual rows=3.00 loops=1)
-                     Sort Key: _hyper_2_6_chunk."time", _hyper_2_6_chunk.device_id
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=7.00 loops=1)
-                           Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-                           Rows Removed by Filter: 713
-                           ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
-                                 Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+   ->  Sort (actual rows=10.00 loops=1)
+         Sort Key: metrics_space."time", metrics_space.device_id
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=35.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=7.00 loops=1)
+                     Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 713
+                     ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=21.00 loops=1)
+                     Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 2139
+                     ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=3.00 loops=1)
+                           Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Custom Scan (ColumnarScan) on _hyper_2_6_chunk (actual rows=7.00 loops=1)
+                     Vectorized Filter: ("time" <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+                     Rows Removed by Filter: 713
+                     ->  Seq Scan on compress_hyper_6_19_chunk (actual rows=1.00 loops=1)
+                           Filter: (_ts_meta_min_3 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX
 SELECT *
@@ -5570,38 +5546,38 @@
    ->  Custom Scan (ChunkAppend) on metrics_space (actual rows=1728.00 loops=1)
          Order: metrics_space."time"
          ->  Sort (actual rows=720.00 loops=1)
-               Sort Key: _hyper_2_5_chunk."time"
+               Sort Key: _hyper_2_4_chunk."time"
                Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=720.00 loops=1)
-                     ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
-                           Filter: (device_id = 2)
-                           Rows Removed by Filter: 2
-         ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk (actual rows=672.00 loops=1)
-               Index Cond: (device_id = 2)
-         ->  Sort (actual rows=336.00 loops=1)
-               Sort Key: _hyper_2_11_chunk."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=720.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+         ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk (actual rows=672.00 loops=1)
+               Filter: (device_id = 1)
+         ->  Sort (actual rows=336.00 loops=1)
+               Sort Key: _hyper_2_10_chunk."time"
                Sort Method: quicksort 
-               ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=336.00 loops=1)
-                     ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
-                           Filter: (device_id = 2)
-                           Rows Removed by Filter: 2
+               ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk (actual rows=336.00 loops=1)
+                     ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
    ->  Materialize (actual rows=1728.00 loops=1)
          ->  Custom Scan (ChunkAppend) on metrics_space metrics_space_1 (actual rows=1728.00 loops=1)
                Order: metrics_space_1."time"
                ->  Sort (actual rows=720.00 loops=1)
-                     Sort Key: _hyper_2_4_chunk."time"
+                     Sort Key: _hyper_2_5_chunk."time"
                      Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk (actual rows=720.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-               ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk (actual rows=672.00 loops=1)
-                     Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk (actual rows=720.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 2
+               ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk (actual rows=672.00 loops=1)
+                     Index Cond: (device_id = 2)
                ->  Sort (actual rows=336.00 loops=1)
-                     Sort Key: _hyper_2_10_chunk."time"
+                     Sort Key: _hyper_2_11_chunk."time"
                      Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk (actual rows=336.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_20_chunk (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk (actual rows=336.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_21_chunk (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 2
 
 :PREFIX WITH q1 AS (
     SELECT time,
@@ -6585,54 +6561,6 @@
 SELECT *
 FROM :TEST_TABLE m1
     INNER JOIN :TEST_TABLE m2 ON m1.time = m2.time
-        AND m1.device_id = 1
-        AND m2.device_id = 2
-    ORDER BY m1.time,
-        m1.device_id,
-        m2.time,
-        m2.device_id
-    LIMIT 100;
---- QUERY PLAN ---
- Limit (actual rows=100.00 loops=1)
-   ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (m2."time" = m1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=100.00 loops=1)
-               Order: m2."time"
-               ->  Sort (actual rows=100.00 loops=1)
-                     Sort Key: m2_1."time"
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_1 (actual rows=720.00 loops=1)
-                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 2)
-                                 Rows Removed by Filter: 2
-               ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_2 (never executed)
-                     Index Cond: (device_id = 2)
-               ->  Sort (never executed)
-                     Sort Key: m2_3."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_3 (never executed)
-                           ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
-                                 Filter: (device_id = 2)
-         ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_space m1 (actual rows=100.00 loops=1)
-                     Order: m1."time"
-                     ->  Sort (actual rows=100.00 loops=1)
-                           Sort Key: m1_1."time"
-                           Sort Method: quicksort 
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m1_1 (actual rows=720.00 loops=1)
-                                 ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
-                                       Filter: (device_id = 1)
-                     ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk m1_2 (never executed)
-                           Filter: (device_id = 1)
-                     ->  Sort (never executed)
-                           Sort Key: m1_3."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m1_3 (never executed)
-                                 ->  Seq Scan on compress_hyper_6_20_chunk (never executed)
-                                       Filter: (device_id = 1)
-
-:PREFIX
-SELECT *
-FROM metrics m1
-    INNER JOIN metrics_space m2 ON m1.time = m2.time
         AND m1.device_id = 1
         AND m2.device_id = 2
     ORDER BY m1.time,
@@ -6644,21 +6572,20 @@
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
          Merge Cond: (m1."time" = m2."time")
-         ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=100.00 loops=1)
+         ->  Custom Scan (ChunkAppend) on metrics_space m1 (actual rows=100.00 loops=1)
                Order: m1."time"
                ->  Sort (actual rows=100.00 loops=1)
                      Sort Key: m1_1."time"
                      Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=720.00 loops=1)
-                           ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=1.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_4_chunk m1_1 (actual rows=720.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_17_chunk (actual rows=1.00 loops=1)
                                  Filter: (device_id = 1)
-                                 Rows Removed by Filter: 4
-               ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m1_2 (never executed)
+               ->  Index Scan Backward using _hyper_2_7_chunk_metrics_space_time_idx on _hyper_2_7_chunk m1_2 (never executed)
                      Filter: (device_id = 1)
                ->  Sort (never executed)
                      Sort Key: m1_3."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (never executed)
-                           ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_10_chunk m1_3 (never executed)
+                           ->  Seq Scan on compress_hyper_6_20_chunk (never executed)
                                  Filter: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
                ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=100.00 loops=1)
@@ -6678,6 +6605,55 @@
                                  ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
                                        Filter: (device_id = 2)
 
+:PREFIX
+SELECT *
+FROM metrics m1
+    INNER JOIN metrics_space m2 ON m1.time = m2.time
+        AND m1.device_id = 1
+        AND m2.device_id = 2
+    ORDER BY m1.time,
+        m1.device_id,
+        m2.time,
+        m2.device_id
+    LIMIT 100;
+--- QUERY PLAN ---
+ Limit (actual rows=100.00 loops=1)
+   ->  Merge Join (actual rows=100.00 loops=1)
+         Merge Cond: (m2."time" = m1."time")
+         ->  Custom Scan (ChunkAppend) on metrics_space m2 (actual rows=100.00 loops=1)
+               Order: m2."time"
+               ->  Sort (actual rows=100.00 loops=1)
+                     Sort Key: m2_1."time"
+                     Sort Method: quicksort 
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_5_chunk m2_1 (actual rows=720.00 loops=1)
+                           ->  Seq Scan on compress_hyper_6_18_chunk (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 2
+               ->  Index Scan Backward using _hyper_2_8_chunk_metrics_space_device_id_time_idx on _hyper_2_8_chunk m2_2 (never executed)
+                     Index Cond: (device_id = 2)
+               ->  Sort (never executed)
+                     Sort Key: m2_3."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_2_11_chunk m2_3 (never executed)
+                           ->  Seq Scan on compress_hyper_6_21_chunk (never executed)
+                                 Filter: (device_id = 2)
+         ->  Materialize (actual rows=100.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics m1 (actual rows=100.00 loops=1)
+                     Order: m1."time"
+                     ->  Sort (actual rows=100.00 loops=1)
+                           Sort Key: m1_1."time"
+                           Sort Method: quicksort 
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m1_1 (actual rows=720.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_5_15_chunk (actual rows=1.00 loops=1)
+                                       Filter: (device_id = 1)
+                                       Rows Removed by Filter: 4
+                     ->  Index Scan Backward using _hyper_1_2_chunk_metrics_time_idx on _hyper_1_2_chunk m1_2 (never executed)
+                           Filter: (device_id = 1)
+                     ->  Sort (never executed)
+                           Sort Key: m1_3."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m1_3 (never executed)
+                                 ->  Seq Scan on compress_hyper_5_16_chunk (never executed)
+                                       Filter: (device_id = 1)
+
 -- test OUTER JOIN
 :PREFIX
 SELECT *
@@ -8940,16 +8916,19 @@
 SET min_parallel_table_scan_size TO '0';
 EXPLAIN (buffers off, costs off) SELECT * FROM metrics ORDER BY time, device_id;
 --- QUERY PLAN ---
- Gather Merge
-   Workers Planned: 3
+ Custom Scan (ChunkAppend) on metrics
+   Order: metrics."time", metrics.device_id
    ->  Sort
-         Sort Key: metrics."time", metrics.device_id
-         ->  Parallel Append
-               ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
-                     ->  Parallel Seq Scan on compress_hyper_5_15_chunk
-               ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk
-                     ->  Parallel Seq Scan on compress_hyper_5_16_chunk
-               ->  Parallel Seq Scan on _hyper_1_2_chunk
+         Sort Key: _hyper_1_1_chunk."time", _hyper_1_1_chunk.device_id
+         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk
+               ->  Seq Scan on compress_hyper_5_15_chunk
+   ->  Sort
+         Sort Key: _hyper_1_2_chunk."time", _hyper_1_2_chunk.device_id
+         ->  Seq Scan on _hyper_1_2_chunk
+   ->  Sort
+         Sort Key: _hyper_1_3_chunk."time", _hyper_1_3_chunk.device_id
+         ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk
+               ->  Seq Scan on compress_hyper_5_16_chunk
 
 EXPLAIN (buffers off, costs off) SELECT time_bucket('10 minutes', time) bucket, avg(v0) avg_v0 FROM metrics GROUP BY bucket;
 --- QUERY PLAN ---
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_join_index.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_join_index.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_join_index.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_join_index.out	2025-11-06 12:40:49
@@ -64,12 +64,11 @@
                Sort Key: compress_hyper_2_2_chunk._ts_meta_min_1
                ->  Index Scan using compress_hyper_2_2_chunk_a_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_2_2_chunk
                      Index Cond: ((_ts_meta_min_1 <= 'Wed Jan 01 00:02:00 2020 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Wed Jan 01 00:00:00 2020 PST'::timestamp with time zone))
-   ->  Materialize
-         ->  Unique
-               ->  Sort
-                     Sort Key: test_copy.a
-                     ->  Seq Scan on test_copy
-                           Filter: (((a)::text = ANY ('{lat,lon}'::text[])) AND (b = 1))
+   ->  Unique
+         ->  Sort
+               Sort Key: test_copy.a
+               ->  Seq Scan on test_copy
+                     Filter: (((a)::text = ANY ('{lat,lon}'::text[])) AND (b = 1))
 
 with query_params as (
 	select distinct a, b
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_ordered_index-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_ordered_index-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_ordered_index-17.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_ordered_index-17.out	2025-11-06 12:40:52
@@ -295,12 +295,12 @@
 WHERE extract(minute FROM d.time) = 0;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Sort (actual rows=12.00 loops=1)
-         Sort Key: d.device_id
-         Sort Method: quicksort 
-         ->  Nested Loop (actual rows=12.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_ordered_idx d (actual rows=389.00 loops=1)
-                     Chunks excluded during startup: 0
+   ->  Nested Loop (actual rows=12.00 loops=1)
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=389.00 loops=1)
+               Hypertable: metrics_ordered_idx
+               Chunks excluded during startup: 0
+               ->  Merge Append (actual rows=389.00 loops=1)
+                     Sort Key: d.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk d_1 (actual rows=120.00 loops=1)
                            Filter: (EXTRACT(minute FROM "time") = '0'::numeric)
                            Rows Removed by Filter: 360
@@ -320,28 +320,28 @@
                      ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk d_5 (actual rows=5.00 loops=1)
                            Filter: (EXTRACT(minute FROM "time") = '0'::numeric)
                            ->  Index Scan using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
-               ->  Subquery Scan on m (actual rows=0.00 loops=389)
-                     Filter: (d.device_id_peer = m.device_id_peer)
-                     Rows Removed by Filter: 0
-                     ->  Limit (actual rows=0.00 loops=389)
-                           ->  Custom Scan (ChunkAppend) on metrics_ordered_idx m_1 (actual rows=0.00 loops=389)
-                                 Order: m_1."time" DESC
-                                 Hypertables excluded during runtime: 0
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk m_2 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk compress_hyper_2_10_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk m_3 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk compress_hyper_2_9_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m_4 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk compress_hyper_2_8_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk m_5 (actual rows=0.00 loops=304)
-                                       ->  Index Scan Backward using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk compress_hyper_2_7_chunk_1 (actual rows=0.00 loops=304)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m_6 (actual rows=0.00 loops=304)
-                                       ->  Index Scan Backward using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk compress_hyper_2_6_chunk_1 (actual rows=0.00 loops=304)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+         ->  Subquery Scan on m (actual rows=0.00 loops=389)
+               Filter: (d.device_id_peer = m.device_id_peer)
+               Rows Removed by Filter: 0
+               ->  Limit (actual rows=0.00 loops=389)
+                     ->  Custom Scan (ChunkAppend) on metrics_ordered_idx m_1 (actual rows=0.00 loops=389)
+                           Order: m_1."time" DESC
+                           Hypertables excluded during runtime: 0
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk m_2 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk compress_hyper_2_10_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk m_3 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk compress_hyper_2_9_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m_4 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk compress_hyper_2_8_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk m_5 (actual rows=0.00 loops=304)
+                                 ->  Index Scan Backward using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk compress_hyper_2_7_chunk_1 (actual rows=0.00 loops=304)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m_6 (actual rows=0.00 loops=304)
+                                 ->  Index Scan Backward using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk compress_hyper_2_6_chunk_1 (actual rows=0.00 loops=304)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
 
 :PREFIX
 SELECT d.device_id,
@@ -604,14 +604,14 @@
       and met.device_id = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=1.00 loops=1)
          Vectorized Filter: (("time" > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND ("time" < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (v0 = 5))
          Rows Removed by Filter: 47
          ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Index Cond: ((device_id = 3) AND (_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
+         Filter: ((column1 = 3) AND (column2 = 5))
+         Rows Removed by Filter: 1
 
 :PREFIX
 WITH lookup as ( SELECT * from (values( 3, 5) , (3, 4) ) as lu( did, version) )
@@ -623,14 +623,13 @@
       and met.device_id_peer = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=0.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=0.00 loops=1)
          Vectorized Filter: ((v0 = 5) AND ("time" = 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
          Rows Removed by Filter: 48
          ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Index Cond: ((device_id = 3) AND (device_id_peer = 3) AND (_ts_meta_min_1 <= 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+   ->  Values Scan on "*VALUES*" (never executed)
+         Filter: ((column1 = 3) AND (column2 = 5))
 
 -- lateral subquery
 :PREFIX
@@ -643,18 +642,17 @@
    and met.v0 = q.v0 and met.v0 > 2 and time = '2018-01-19 20:00:00-05';
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   Join Filter: (met.device_id = nodetime.node)
+   Join Filter: ((met.device_id = nodetime.node) AND (met.device_id_peer = "*VALUES*".column2) AND ("*VALUES*".column3 = met.v0))
+   ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk met (actual rows=1.00 loops=1)
+         Vectorized Filter: ((v0 > 2) AND ("time" = 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
+         Rows Removed by Filter: 47
+         ->  Index Scan using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
    ->  Nested Loop (actual rows=1.00 loops=1)
          Join Filter: (nodetime.node = "*VALUES*".column1)
          Rows Removed by Join Filter: 1
          ->  Seq Scan on nodetime (actual rows=1.00 loops=1)
          ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
-   ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk met (actual rows=1.00 loops=1)
-         Filter: ("*VALUES*".column3 = v0)
-         Rows Removed by Filter: 47
-         Vectorized Filter: ((v0 > 2) AND ("time" = 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
-         ->  Index Scan using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
-               Index Cond: ((device_id = "*VALUES*".column1) AND (device_id_peer = "*VALUES*".column2) AND (_ts_meta_min_1 <= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
 
 -- filter on compressed attr (v0) with seqscan enabled and indexscan
 -- disabled. filters on compressed attr should be above the seq scan.
@@ -672,14 +670,14 @@
       and met.device_id_peer = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=1.00 loops=1)
          Vectorized Filter: (("time" > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND ("time" < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (v0 = 5))
          Rows Removed by Filter: 47
          ->  Seq Scan on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Filter: ((_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (device_id = 3) AND (device_id_peer = 3))
+   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
+         Filter: ((column1 = 3) AND (column2 = 5))
+         Rows Removed by Filter: 1
 
 RESET enable_hashjoin  ;
 RESET enable_mergejoin;
@@ -792,17 +790,18 @@
     2,
     3;
 --- QUERY PLAN ---
- Sort (actual rows=0.00 loops=1)
-   Sort Key: m.device_id, d.v0, (count(*))
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=0.00 loops=1)
+ Incremental Sort (actual rows=0.00 loops=1)
+   Sort Key: m.device_id, d.v0, (count(*))
+   Presorted Key: m.device_id, d.v0
+   Full-sort Groups: 1  Sort Method: quicksort 
+   ->  GroupAggregate (actual rows=0.00 loops=1)
          Group Key: m.device_id, d.v0
-         ->  Hash Join (actual rows=0.00 loops=1)
-               Hash Cond: ((d.device_id = m.device_id) AND (d."time" = m."time"))
+         ->  Nested Loop (actual rows=0.00 loops=1)
+               Join Filter: ((m.device_id = d.device_id) AND (d."time" = m."time"))
                ->  Custom Scan (ConstraintAwareAppend) (actual rows=0.00 loops=1)
                      Hypertable: metrics_ordered_idx
                      Chunks excluded during startup: 2
-               ->  Hash (never executed)
+               ->  Materialize (never executed)
                      ->  Custom Scan (ConstraintAwareAppend) (never executed)
                            Hypertable: metrics_ordered_idx
                            Chunks excluded during startup: 2
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_queries-17.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_queries-17.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_queries-17.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_queries-17.out	2025-11-06 12:40:57
@@ -178,15 +178,15 @@
 SELECT * from test_chartab
 WHERE check_equal_228(rtt) and ts < '2019-12-15 00:00:00' order by ts;
 --- QUERY PLAN ---
- Sort (actual rows=1.00 loops=1)
-   Sort Key: test_chartab.ts
-   Sort Method: quicksort 
-   ->  Custom Scan (ChunkAppend) on test_chartab (actual rows=1.00 loops=1)
-         Chunks excluded during startup: 0
-         ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1.00 loops=1)
-               Filter: check_equal_228(rtt)
-               Rows Removed by Filter: 2
-               Vectorized Filter: (ts < 'Sun Dec 15 00:00:00 2019'::timestamp without time zone)
+ Custom Scan (ChunkAppend) on test_chartab (actual rows=1.00 loops=1)
+   Order: test_chartab.ts
+   Chunks excluded during startup: 0
+   ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk (actual rows=1.00 loops=1)
+         Filter: ((ts < 'Sun Dec 15 00:00:00 2019'::timestamp without time zone) AND check_equal_228(rtt))
+         Rows Removed by Filter: 2
+         ->  Sort (actual rows=3.00 loops=1)
+               Sort Key: compress_hyper_2_3_chunk._ts_meta_min_1
+               Sort Method: quicksort 
                ->  Seq Scan on compress_hyper_2_3_chunk (actual rows=3.00 loops=1)
                      Filter: (_ts_meta_min_1 < 'Sun Dec 15 00:00:00 2019'::timestamp without time zone)
 
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_grouping.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_grouping.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_grouping.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_grouping.out	2025-11-06 12:41:23
@@ -1494,449 +1494,4 @@
  $  |   $
 
 select cint4, cint2, count(*) from agggroup where cint2 is null and x is null group by cint4, cint2 order by count(*), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -15063 |     $ |     1
- -14949 |     $ |     1
- -14443 |     $ |     1
- -11240 |     $ |     1
-  -8873 |     $ |     1
-  -7170 |     $ |     1
-  -4740 |     $ |     1
-  -1217 |     $ |     1
-   -166 |     $ |     1
-   -119 |     $ |     1
-
-select cint4, cint8, count(*) from agggroup where cint2 is null and x is null group by cint4, cint8 order by count(*), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -15063 |   3990 |     1
- -14949 | -10395 |     1
- -14443 | -12710 |     1
- -11240 |  -8825 |     1
-  -8873 | -12094 |     1
-  -7170 |   7723 |     1
-  -4740 |   7720 |     1
-  -1217 |   6383 |     1
-   -166 | -10858 |     1
-   -119 |   -231 |     1
-
-select cint2, cint4, cint8, count(*) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by count(*), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -15063 |   3990 |     1
-     $ | -14949 | -10395 |     1
-     $ | -14443 | -12710 |     1
-     $ | -11240 |  -8825 |     1
-     $ |  -8873 | -12094 |     1
-     $ |  -7170 |   7723 |     1
-     $ |  -4740 |   7720 |     1
-     $ |  -1217 |   6383 |     1
-     $ |   -166 | -10858 |     1
-     $ |   -119 |   -231 |     1
-
-select s, cint2, count(*) from agggroup where cint2 is null and x is null group by s, cint2 order by count(*), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 2 |     $ |    19
-
-select s, ss, count(*) from agggroup where cint2 is null and x is null group by s, ss order by count(*), s, ss limit 10;
- s | ss | count 
----+----+-------
- 2 |  $ |    19
-
-select s, x, count(*) from agggroup where cint2 is null and x is null group by s, x order by count(*), s, x limit 10;
- s | x | count 
----+---+-------
- 2 | $ |    19
-
-select ss, cint2, x, count(*) from agggroup where cint2 is null and x is null group by ss, cint2, x order by count(*), ss, cint2, x limit 10;
- ss | cint2 | x | count 
-----+-------+---+-------
-  $ |     $ | $ |    19
-
-select ss, s, count(*) from agggroup where cint2 is null and x is null group by ss, s order by count(*), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  $ | 2 |    19
-
-select ss, x, cint2, count(*) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by count(*), ss, x, cint2 limit 10;
- ss | x | cint2 | count 
-----+---+-------+-------
-  $ | $ |     $ |    19
-
-select t, s, ss, x, cint4, cint8, cint2, count(*) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by count(*), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |     1
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |     1
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |     1
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |     1
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |     1
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |     1
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |     1
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |     1
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |     1
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |     1
-
-select x, count(*) from agggroup where cint2 is null and x is null group by x order by count(*), x limit 10;
- x | count 
----+-------
- $ |    19
-
-select cint4, cint2, count(cint2) from agggroup where cint2 is null and x is null group by cint4, cint2 order by count(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -15063 |     $ |     0
- -14949 |     $ |     0
- -14443 |     $ |     0
- -11240 |     $ |     0
-  -8873 |     $ |     0
-  -7170 |     $ |     0
-  -4740 |     $ |     0
-  -1217 |     $ |     0
-   -166 |     $ |     0
-   -119 |     $ |     0
-
-select cint4, cint8, count(cint2) from agggroup where cint2 is null and x is null group by cint4, cint8 order by count(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -15063 |   3990 |     0
- -14949 | -10395 |     0
- -14443 | -12710 |     0
- -11240 |  -8825 |     0
-  -8873 | -12094 |     0
-  -7170 |   7723 |     0
-  -4740 |   7720 |     0
-  -1217 |   6383 |     0
-   -166 | -10858 |     0
-   -119 |   -231 |     0
-
-select cint2, cint4, cint8, count(cint2) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by count(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -15063 |   3990 |     0
-     $ | -14949 | -10395 |     0
-     $ | -14443 | -12710 |     0
-     $ | -11240 |  -8825 |     0
-     $ |  -8873 | -12094 |     0
-     $ |  -7170 |   7723 |     0
-     $ |  -4740 |   7720 |     0
-     $ |  -1217 |   6383 |     0
-     $ |   -166 | -10858 |     0
-     $ |   -119 |   -231 |     0
-
-select s, cint2, count(cint2) from agggroup where cint2 is null and x is null group by s, cint2 order by count(cint2), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 2 |     $ |     0
-
-select s, ss, count(cint2) from agggroup where cint2 is null and x is null group by s, ss order by count(cint2), s, ss limit 10;
- s | ss | count 
----+----+-------
- 2 |  $ |     0
-
-select s, x, count(cint2) from agggroup where cint2 is null and x is null group by s, x order by count(cint2), s, x limit 10;
- s | x | count 
----+---+-------
- 2 | $ |     0
-
-select ss, cint2, x, count(cint2) from agggroup where cint2 is null and x is null group by ss, cint2, x order by count(cint2), ss, cint2, x limit 10;
- ss | cint2 | x | count 
-----+-------+---+-------
-  $ |     $ | $ |     0
-
-select ss, s, count(cint2) from agggroup where cint2 is null and x is null group by ss, s order by count(cint2), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  $ | 2 |     0
-
-select ss, x, cint2, count(cint2) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by count(cint2), ss, x, cint2 limit 10;
- ss | x | cint2 | count 
-----+---+-------+-------
-  $ | $ |     $ |     0
-
-select t, s, ss, x, cint4, cint8, cint2, count(cint2) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by count(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |     0
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |     0
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |     0
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |     0
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |     0
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |     0
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |     0
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |     0
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |     0
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |     0
-
-select x, count(cint2) from agggroup where cint2 is null and x is null group by x order by count(cint2), x limit 10;
- x | count 
----+-------
- $ |     0
-
-select cint4, cint2, min(cint2) from agggroup where cint2 is null and x is null group by cint4, cint2 order by min(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | min 
---------+-------+-----
- -15063 |     $ |   $
- -14949 |     $ |   $
- -14443 |     $ |   $
- -11240 |     $ |   $
-  -8873 |     $ |   $
-  -7170 |     $ |   $
-  -4740 |     $ |   $
-  -1217 |     $ |   $
-   -166 |     $ |   $
-   -119 |     $ |   $
-
-select cint4, cint8, min(cint2) from agggroup where cint2 is null and x is null group by cint4, cint8 order by min(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | min 
---------+--------+-----
- -15063 |   3990 |   $
- -14949 | -10395 |   $
- -14443 | -12710 |   $
- -11240 |  -8825 |   $
-  -8873 | -12094 |   $
-  -7170 |   7723 |   $
-  -4740 |   7720 |   $
-  -1217 |   6383 |   $
-   -166 | -10858 |   $
-   -119 |   -231 |   $
-
-select cint2, cint4, cint8, min(cint2) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by min(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | min 
--------+--------+--------+-----
-     $ | -15063 |   3990 |   $
-     $ | -14949 | -10395 |   $
-     $ | -14443 | -12710 |   $
-     $ | -11240 |  -8825 |   $
-     $ |  -8873 | -12094 |   $
-     $ |  -7170 |   7723 |   $
-     $ |  -4740 |   7720 |   $
-     $ |  -1217 |   6383 |   $
-     $ |   -166 | -10858 |   $
-     $ |   -119 |   -231 |   $
-
-select s, cint2, min(cint2) from agggroup where cint2 is null and x is null group by s, cint2 order by min(cint2), s, cint2 limit 10;
- s | cint2 | min 
----+-------+-----
- 2 |     $ |   $
-
-select s, ss, min(cint2) from agggroup where cint2 is null and x is null group by s, ss order by min(cint2), s, ss limit 10;
- s | ss | min 
----+----+-----
- 2 |  $ |   $
-
-select s, x, min(cint2) from agggroup where cint2 is null and x is null group by s, x order by min(cint2), s, x limit 10;
- s | x | min 
----+---+-----
- 2 | $ |   $
-
-select ss, cint2, x, min(cint2) from agggroup where cint2 is null and x is null group by ss, cint2, x order by min(cint2), ss, cint2, x limit 10;
- ss | cint2 | x | min 
-----+-------+---+-----
-  $ |     $ | $ |   $
-
-select ss, s, min(cint2) from agggroup where cint2 is null and x is null group by ss, s order by min(cint2), ss, s limit 10;
- ss | s | min 
-----+---+-----
-  $ | 2 |   $
-
-select ss, x, cint2, min(cint2) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by min(cint2), ss, x, cint2 limit 10;
- ss | x | cint2 | min 
-----+---+-------+-----
-  $ | $ |     $ |   $
-
-select t, s, ss, x, cint4, cint8, cint2, min(cint2) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by min(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | min 
--------+---+----+---+--------+--------+-------+-----
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |   $
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |   $
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |   $
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |   $
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |   $
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |   $
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |   $
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |   $
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |   $
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |   $
-
-select x, min(cint2) from agggroup where cint2 is null and x is null group by x order by min(cint2), x limit 10;
- x | min 
----+-----
- $ |   $
-
-reset timescaledb.debug_require_vector_agg;
--- Test long text columns. Also make one of them a segmentby, so that we can
--- test the long scalar values.
-create table long(t int, a text, b text, c text, d text);
-select create_hypertable('long', 't');
- create_hypertable 
--------------------
- (3,public,long,t)
-
-insert into long select n, a, x, x, x from (
-    select n, 'short' || m a, repeat('1', 100 * 4 + n) x
-    from generate_series(1, 4) n,
-        generate_series(1, 4) m) t
-;
-insert into long values (-1, 'a', 'b', 'c', 'd');
-insert into long values (-2, repeat('long', 1000), 'b', 'c', 'd');
-alter table long set (timescaledb.compress, timescaledb.compress_segmentby = 'a',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('long') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
--- Various placements of long scalar column
-select sum(t) from long group by a, b, c, d order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
-select sum(t) from long group by d, b, c, a order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
-select sum(t) from long group by d, b, a, c order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
--- Just the scalar column
-select sum(t) from long group by a order by 1;
- sum 
------
-  -2
-  -1
-  10
-  10
-  10
-  10
-
--- No scalar columns
-select sum(t) from long group by b, c, d order by 1 limit 10;
- sum 
------
-  -3
-   4
-   8
-  12
-  16
-
-reset timescaledb.debug_require_vector_agg;
--- Test various serialized key lengths. We want to touch the transition from short
--- to long varlena header for the serialized key.
-create table keylength(t int, a text, b text);
-select create_hypertable('keylength', 't');
-   create_hypertable    
-------------------------
- (5,public,keylength,t)
-
-insert into keylength select t, 'a', repeat('b', t) from generate_series(1, 1000) t;
-insert into keylength values (-1, '', ''); -- second chunk
-alter table keylength set (timescaledb.compress, timescaledb.compress_segmentby = '',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('keylength') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
-select sum(t) from keylength group by a, b order by 1 desc limit 10;
- sum  
-------
- 1000
-  999
-  998
-  997
-  996
-  995
-  994
-  993
-  992
-  991
-
-select sum(t) from keylength group by b, a order by 1 desc limit 10;
- sum  
-------
- 1000
-  999
-  998
-  997
-  996
-  995
-  994
-  993
-  992
-  991
-
-reset timescaledb.debug_require_vector_agg;
--- Add a very simple test for NULLs. We also have some null values in the general
--- grouping test above.
-create table groupnull(t int, a text, b text);
-select create_hypertable('groupnull', 't');
-   create_hypertable    
-------------------------
- (7,public,groupnull,t)
-
-insert into groupnull values (1, '1', null), (2, null, '2'), (3000000, '3', '3');
-alter table groupnull set (timescaledb.compress, timescaledb.compress_segmentby = '',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('groupnull') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
-select sum(t), a, b from groupnull group by a, b order by 1;
-   sum   | a | b 
----------+---+---
-       1 | 1 | $
-       2 | $ | 2
- 3000000 | 3 | 3
-
-select sum(t), a, b from groupnull group by b, a order by 1;
-   sum   | a | b 
----------+---+---
-       1 | 1 | $
-       2 | $ | 2
- 3000000 | 3 | 3
-
-reset timescaledb.debug_require_vector_agg;
+ERROR:  postgres partial aggregation nodes inconsistent with debug_require_vector_agg GUC
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_uuid.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_uuid.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_uuid.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_uuid.out	2025-11-06 12:41:13
@@ -132,12 +132,12 @@
 -----+--------------------------------------+----+-------------------------------------
    7 | 01941f29-7c00-706a-bea9-105dad841304 | 17 | Tue Dec 31 16:00:00.000025 2024 PST
    7 | 01941f2a-665f-7722-b4b5-cf4e70e666d0 | 18 | Tue Dec 31 16:00:59.999445 2024 PST
-   7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  4 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  3 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  2 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  1 | Wed Jun 25 08:16:46.347777 2025 PDT
-   7 | 0197a7a9-b48b-7c75-a810-8acf630e634f |  5 | Wed Jun 25 08:16:46.347778 2025 PDT
+   7 | 0197a7a9-b48b-7c71-92cb-eb724822bb0f |  4 | Wed Jun 25 08:16:46.347777 2025 PDT
    7 | 0197a7a9-b48b-7c75-a810-8acf630e634f |  6 | Wed Jun 25 08:16:46.347778 2025 PDT
+   7 | 0197a7a9-b48b-7c75-a810-8acf630e634f |  5 | Wed Jun 25 08:16:46.347778 2025 PDT
    7 | 0197a7a9-b48b-7c76-b616-69e64a802b5c |  7 | Wed Jun 25 08:16:46.347778 2025 PDT
 
 SELECT ver, u, count(*), sum(ts) from uuid_table
diff -u /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/vectorized_aggregation.out /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/vectorized_aggregation.out
--- /Users/runner/work/timescaledb/timescaledb/tsl/test/expected/vectorized_aggregation.out	2025-11-06 12:29:26
+++ /Users/runner/work/timescaledb/timescaledb/build/tsl/test/results/vectorized_aggregation.out	2025-11-06 12:41:16
@@ -2287,90 +2287,87 @@
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.int_value)
-   ->  Gather
-         Output: (PARTIAL sum(testtable.int_value))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_41_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_41_chunk
-                           Output: _hyper_1_41_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_51_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_51_chunk
-                                 Output: compress_hyper_2_51_chunk._ts_meta_count, compress_hyper_2_51_chunk.segment_by_value, compress_hyper_2_51_chunk._ts_meta_min_1, compress_hyper_2_51_chunk._ts_meta_max_1, compress_hyper_2_51_chunk."time", compress_hyper_2_51_chunk.int_value, compress_hyper_2_51_chunk.float_value
-                                 Index Cond: (compress_hyper_2_51_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_42_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_42_chunk
-                           Output: _hyper_1_42_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_52_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_52_chunk
-                                 Output: compress_hyper_2_52_chunk._ts_meta_count, compress_hyper_2_52_chunk.segment_by_value, compress_hyper_2_52_chunk._ts_meta_min_1, compress_hyper_2_52_chunk._ts_meta_max_1, compress_hyper_2_52_chunk."time", compress_hyper_2_52_chunk.int_value, compress_hyper_2_52_chunk.float_value
-                                 Index Cond: (compress_hyper_2_52_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_43_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_43_chunk
-                           Output: _hyper_1_43_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_53_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_53_chunk
-                                 Output: compress_hyper_2_53_chunk._ts_meta_count, compress_hyper_2_53_chunk.segment_by_value, compress_hyper_2_53_chunk._ts_meta_min_1, compress_hyper_2_53_chunk._ts_meta_max_1, compress_hyper_2_53_chunk."time", compress_hyper_2_53_chunk.int_value, compress_hyper_2_53_chunk.float_value
-                                 Index Cond: (compress_hyper_2_53_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_44_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_44_chunk
-                           Output: _hyper_1_44_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_54_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_54_chunk
-                                 Output: compress_hyper_2_54_chunk._ts_meta_count, compress_hyper_2_54_chunk.segment_by_value, compress_hyper_2_54_chunk._ts_meta_min_1, compress_hyper_2_54_chunk._ts_meta_max_1, compress_hyper_2_54_chunk."time", compress_hyper_2_54_chunk.int_value, compress_hyper_2_54_chunk.float_value
-                                 Index Cond: (compress_hyper_2_54_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_45_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_45_chunk
-                           Output: _hyper_1_45_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_55_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_55_chunk
-                                 Output: compress_hyper_2_55_chunk._ts_meta_count, compress_hyper_2_55_chunk.segment_by_value, compress_hyper_2_55_chunk._ts_meta_min_1, compress_hyper_2_55_chunk._ts_meta_max_1, compress_hyper_2_55_chunk."time", compress_hyper_2_55_chunk.int_value, compress_hyper_2_55_chunk.float_value
-                                 Index Cond: (compress_hyper_2_55_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_46_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_46_chunk
-                           Output: _hyper_1_46_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_56_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_56_chunk
-                                 Output: compress_hyper_2_56_chunk._ts_meta_count, compress_hyper_2_56_chunk.segment_by_value, compress_hyper_2_56_chunk._ts_meta_min_1, compress_hyper_2_56_chunk._ts_meta_max_1, compress_hyper_2_56_chunk."time", compress_hyper_2_56_chunk.int_value, compress_hyper_2_56_chunk.float_value
-                                 Index Cond: (compress_hyper_2_56_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_47_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_47_chunk
-                           Output: _hyper_1_47_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_57_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_57_chunk
-                                 Output: compress_hyper_2_57_chunk._ts_meta_count, compress_hyper_2_57_chunk.segment_by_value, compress_hyper_2_57_chunk._ts_meta_min_1, compress_hyper_2_57_chunk._ts_meta_max_1, compress_hyper_2_57_chunk."time", compress_hyper_2_57_chunk.int_value, compress_hyper_2_57_chunk.float_value
-                                 Index Cond: (compress_hyper_2_57_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_48_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_48_chunk
-                           Output: _hyper_1_48_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_58_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_58_chunk
-                                 Output: compress_hyper_2_58_chunk._ts_meta_count, compress_hyper_2_58_chunk.segment_by_value, compress_hyper_2_58_chunk._ts_meta_min_1, compress_hyper_2_58_chunk._ts_meta_max_1, compress_hyper_2_58_chunk."time", compress_hyper_2_58_chunk.int_value, compress_hyper_2_58_chunk.float_value
-                                 Index Cond: (compress_hyper_2_58_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_49_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_49_chunk
-                           Output: _hyper_1_49_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_59_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_59_chunk
-                                 Output: compress_hyper_2_59_chunk._ts_meta_count, compress_hyper_2_59_chunk.segment_by_value, compress_hyper_2_59_chunk._ts_meta_min_1, compress_hyper_2_59_chunk._ts_meta_max_1, compress_hyper_2_59_chunk."time", compress_hyper_2_59_chunk.int_value, compress_hyper_2_59_chunk.float_value
-                                 Index Cond: (compress_hyper_2_59_chunk.segment_by_value > 5)
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_50_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_50_chunk
-                           Output: _hyper_1_50_chunk.int_value
-                           ->  Parallel Index Scan using compress_hyper_2_60_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_60_chunk
-                                 Output: compress_hyper_2_60_chunk._ts_meta_count, compress_hyper_2_60_chunk.segment_by_value, compress_hyper_2_60_chunk._ts_meta_min_1, compress_hyper_2_60_chunk._ts_meta_max_1, compress_hyper_2_60_chunk."time", compress_hyper_2_60_chunk.int_value, compress_hyper_2_60_chunk.float_value
-                                 Index Cond: (compress_hyper_2_60_chunk.segment_by_value > 5)
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_41_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_41_chunk
+                     Output: _hyper_1_41_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_51_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_51_chunk
+                           Output: compress_hyper_2_51_chunk._ts_meta_count, compress_hyper_2_51_chunk.segment_by_value, compress_hyper_2_51_chunk._ts_meta_min_1, compress_hyper_2_51_chunk._ts_meta_max_1, compress_hyper_2_51_chunk."time", compress_hyper_2_51_chunk.int_value, compress_hyper_2_51_chunk.float_value
+                           Index Cond: (compress_hyper_2_51_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_42_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_42_chunk
+                     Output: _hyper_1_42_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_52_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_52_chunk
+                           Output: compress_hyper_2_52_chunk._ts_meta_count, compress_hyper_2_52_chunk.segment_by_value, compress_hyper_2_52_chunk._ts_meta_min_1, compress_hyper_2_52_chunk._ts_meta_max_1, compress_hyper_2_52_chunk."time", compress_hyper_2_52_chunk.int_value, compress_hyper_2_52_chunk.float_value
+                           Index Cond: (compress_hyper_2_52_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_43_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_43_chunk
+                     Output: _hyper_1_43_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_53_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_53_chunk
+                           Output: compress_hyper_2_53_chunk._ts_meta_count, compress_hyper_2_53_chunk.segment_by_value, compress_hyper_2_53_chunk._ts_meta_min_1, compress_hyper_2_53_chunk._ts_meta_max_1, compress_hyper_2_53_chunk."time", compress_hyper_2_53_chunk.int_value, compress_hyper_2_53_chunk.float_value
+                           Index Cond: (compress_hyper_2_53_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_44_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_44_chunk
+                     Output: _hyper_1_44_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_54_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_54_chunk
+                           Output: compress_hyper_2_54_chunk._ts_meta_count, compress_hyper_2_54_chunk.segment_by_value, compress_hyper_2_54_chunk._ts_meta_min_1, compress_hyper_2_54_chunk._ts_meta_max_1, compress_hyper_2_54_chunk."time", compress_hyper_2_54_chunk.int_value, compress_hyper_2_54_chunk.float_value
+                           Index Cond: (compress_hyper_2_54_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_45_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_45_chunk
+                     Output: _hyper_1_45_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_55_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_55_chunk
+                           Output: compress_hyper_2_55_chunk._ts_meta_count, compress_hyper_2_55_chunk.segment_by_value, compress_hyper_2_55_chunk._ts_meta_min_1, compress_hyper_2_55_chunk._ts_meta_max_1, compress_hyper_2_55_chunk."time", compress_hyper_2_55_chunk.int_value, compress_hyper_2_55_chunk.float_value
+                           Index Cond: (compress_hyper_2_55_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_46_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_46_chunk
+                     Output: _hyper_1_46_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_56_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_56_chunk
+                           Output: compress_hyper_2_56_chunk._ts_meta_count, compress_hyper_2_56_chunk.segment_by_value, compress_hyper_2_56_chunk._ts_meta_min_1, compress_hyper_2_56_chunk._ts_meta_max_1, compress_hyper_2_56_chunk."time", compress_hyper_2_56_chunk.int_value, compress_hyper_2_56_chunk.float_value
+                           Index Cond: (compress_hyper_2_56_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_47_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_47_chunk
+                     Output: _hyper_1_47_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_57_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_57_chunk
+                           Output: compress_hyper_2_57_chunk._ts_meta_count, compress_hyper_2_57_chunk.segment_by_value, compress_hyper_2_57_chunk._ts_meta_min_1, compress_hyper_2_57_chunk._ts_meta_max_1, compress_hyper_2_57_chunk."time", compress_hyper_2_57_chunk.int_value, compress_hyper_2_57_chunk.float_value
+                           Index Cond: (compress_hyper_2_57_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_48_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_48_chunk
+                     Output: _hyper_1_48_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_58_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_58_chunk
+                           Output: compress_hyper_2_58_chunk._ts_meta_count, compress_hyper_2_58_chunk.segment_by_value, compress_hyper_2_58_chunk._ts_meta_min_1, compress_hyper_2_58_chunk._ts_meta_max_1, compress_hyper_2_58_chunk."time", compress_hyper_2_58_chunk.int_value, compress_hyper_2_58_chunk.float_value
+                           Index Cond: (compress_hyper_2_58_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_49_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_49_chunk
+                     Output: _hyper_1_49_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_59_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_59_chunk
+                           Output: compress_hyper_2_59_chunk._ts_meta_count, compress_hyper_2_59_chunk.segment_by_value, compress_hyper_2_59_chunk._ts_meta_min_1, compress_hyper_2_59_chunk._ts_meta_max_1, compress_hyper_2_59_chunk."time", compress_hyper_2_59_chunk.int_value, compress_hyper_2_59_chunk.float_value
+                           Index Cond: (compress_hyper_2_59_chunk.segment_by_value > 5)
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_50_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_50_chunk
+                     Output: _hyper_1_50_chunk.int_value
+                     ->  Index Scan using compress_hyper_2_60_chunk_segment_by_value__ts_meta_min_1___idx on _timescaledb_internal.compress_hyper_2_60_chunk
+                           Output: compress_hyper_2_60_chunk._ts_meta_count, compress_hyper_2_60_chunk.segment_by_value, compress_hyper_2_60_chunk._ts_meta_min_1, compress_hyper_2_60_chunk._ts_meta_max_1, compress_hyper_2_60_chunk."time", compress_hyper_2_60_chunk.int_value, compress_hyper_2_60_chunk.float_value
+                           Index Cond: (compress_hyper_2_60_chunk.segment_by_value > 5)
 
 SELECT sum(int_value) FROM testtable WHERE segment_by_value > 5;
  sum  
@@ -2408,80 +2405,77 @@
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.segment_by_value)
-   ->  Gather
-         Output: (PARTIAL sum(testtable.segment_by_value))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_41_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_41_chunk
-                           Output: _hyper_1_41_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_51_chunk
-                                 Output: compress_hyper_2_51_chunk._ts_meta_count, compress_hyper_2_51_chunk.segment_by_value, compress_hyper_2_51_chunk._ts_meta_min_1, compress_hyper_2_51_chunk._ts_meta_max_1, compress_hyper_2_51_chunk."time", compress_hyper_2_51_chunk.int_value, compress_hyper_2_51_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_42_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_42_chunk
-                           Output: _hyper_1_42_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_52_chunk
-                                 Output: compress_hyper_2_52_chunk._ts_meta_count, compress_hyper_2_52_chunk.segment_by_value, compress_hyper_2_52_chunk._ts_meta_min_1, compress_hyper_2_52_chunk._ts_meta_max_1, compress_hyper_2_52_chunk."time", compress_hyper_2_52_chunk.int_value, compress_hyper_2_52_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_43_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_43_chunk
-                           Output: _hyper_1_43_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_53_chunk
-                                 Output: compress_hyper_2_53_chunk._ts_meta_count, compress_hyper_2_53_chunk.segment_by_value, compress_hyper_2_53_chunk._ts_meta_min_1, compress_hyper_2_53_chunk._ts_meta_max_1, compress_hyper_2_53_chunk."time", compress_hyper_2_53_chunk.int_value, compress_hyper_2_53_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_44_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_44_chunk
-                           Output: _hyper_1_44_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_54_chunk
-                                 Output: compress_hyper_2_54_chunk._ts_meta_count, compress_hyper_2_54_chunk.segment_by_value, compress_hyper_2_54_chunk._ts_meta_min_1, compress_hyper_2_54_chunk._ts_meta_max_1, compress_hyper_2_54_chunk."time", compress_hyper_2_54_chunk.int_value, compress_hyper_2_54_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_45_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_45_chunk
-                           Output: _hyper_1_45_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_55_chunk
-                                 Output: compress_hyper_2_55_chunk._ts_meta_count, compress_hyper_2_55_chunk.segment_by_value, compress_hyper_2_55_chunk._ts_meta_min_1, compress_hyper_2_55_chunk._ts_meta_max_1, compress_hyper_2_55_chunk."time", compress_hyper_2_55_chunk.int_value, compress_hyper_2_55_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_46_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_46_chunk
-                           Output: _hyper_1_46_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_56_chunk
-                                 Output: compress_hyper_2_56_chunk._ts_meta_count, compress_hyper_2_56_chunk.segment_by_value, compress_hyper_2_56_chunk._ts_meta_min_1, compress_hyper_2_56_chunk._ts_meta_max_1, compress_hyper_2_56_chunk."time", compress_hyper_2_56_chunk.int_value, compress_hyper_2_56_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_47_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_47_chunk
-                           Output: _hyper_1_47_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_57_chunk
-                                 Output: compress_hyper_2_57_chunk._ts_meta_count, compress_hyper_2_57_chunk.segment_by_value, compress_hyper_2_57_chunk._ts_meta_min_1, compress_hyper_2_57_chunk._ts_meta_max_1, compress_hyper_2_57_chunk."time", compress_hyper_2_57_chunk.int_value, compress_hyper_2_57_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_48_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_48_chunk
-                           Output: _hyper_1_48_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_58_chunk
-                                 Output: compress_hyper_2_58_chunk._ts_meta_count, compress_hyper_2_58_chunk.segment_by_value, compress_hyper_2_58_chunk._ts_meta_min_1, compress_hyper_2_58_chunk._ts_meta_max_1, compress_hyper_2_58_chunk."time", compress_hyper_2_58_chunk.int_value, compress_hyper_2_58_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_49_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_49_chunk
-                           Output: _hyper_1_49_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_59_chunk
-                                 Output: compress_hyper_2_59_chunk._ts_meta_count, compress_hyper_2_59_chunk.segment_by_value, compress_hyper_2_59_chunk._ts_meta_min_1, compress_hyper_2_59_chunk._ts_meta_max_1, compress_hyper_2_59_chunk."time", compress_hyper_2_59_chunk.int_value, compress_hyper_2_59_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_50_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_50_chunk
-                           Output: _hyper_1_50_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_60_chunk
-                                 Output: compress_hyper_2_60_chunk._ts_meta_count, compress_hyper_2_60_chunk.segment_by_value, compress_hyper_2_60_chunk._ts_meta_min_1, compress_hyper_2_60_chunk._ts_meta_max_1, compress_hyper_2_60_chunk."time", compress_hyper_2_60_chunk.int_value, compress_hyper_2_60_chunk.float_value
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_41_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_41_chunk
+                     Output: _hyper_1_41_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_51_chunk
+                           Output: compress_hyper_2_51_chunk._ts_meta_count, compress_hyper_2_51_chunk.segment_by_value, compress_hyper_2_51_chunk._ts_meta_min_1, compress_hyper_2_51_chunk._ts_meta_max_1, compress_hyper_2_51_chunk."time", compress_hyper_2_51_chunk.int_value, compress_hyper_2_51_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_42_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_42_chunk
+                     Output: _hyper_1_42_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_52_chunk
+                           Output: compress_hyper_2_52_chunk._ts_meta_count, compress_hyper_2_52_chunk.segment_by_value, compress_hyper_2_52_chunk._ts_meta_min_1, compress_hyper_2_52_chunk._ts_meta_max_1, compress_hyper_2_52_chunk."time", compress_hyper_2_52_chunk.int_value, compress_hyper_2_52_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_43_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_43_chunk
+                     Output: _hyper_1_43_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_53_chunk
+                           Output: compress_hyper_2_53_chunk._ts_meta_count, compress_hyper_2_53_chunk.segment_by_value, compress_hyper_2_53_chunk._ts_meta_min_1, compress_hyper_2_53_chunk._ts_meta_max_1, compress_hyper_2_53_chunk."time", compress_hyper_2_53_chunk.int_value, compress_hyper_2_53_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_44_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_44_chunk
+                     Output: _hyper_1_44_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_54_chunk
+                           Output: compress_hyper_2_54_chunk._ts_meta_count, compress_hyper_2_54_chunk.segment_by_value, compress_hyper_2_54_chunk._ts_meta_min_1, compress_hyper_2_54_chunk._ts_meta_max_1, compress_hyper_2_54_chunk."time", compress_hyper_2_54_chunk.int_value, compress_hyper_2_54_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_45_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_45_chunk
+                     Output: _hyper_1_45_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_55_chunk
+                           Output: compress_hyper_2_55_chunk._ts_meta_count, compress_hyper_2_55_chunk.segment_by_value, compress_hyper_2_55_chunk._ts_meta_min_1, compress_hyper_2_55_chunk._ts_meta_max_1, compress_hyper_2_55_chunk."time", compress_hyper_2_55_chunk.int_value, compress_hyper_2_55_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_46_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_46_chunk
+                     Output: _hyper_1_46_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_56_chunk
+                           Output: compress_hyper_2_56_chunk._ts_meta_count, compress_hyper_2_56_chunk.segment_by_value, compress_hyper_2_56_chunk._ts_meta_min_1, compress_hyper_2_56_chunk._ts_meta_max_1, compress_hyper_2_56_chunk."time", compress_hyper_2_56_chunk.int_value, compress_hyper_2_56_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_47_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_47_chunk
+                     Output: _hyper_1_47_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_57_chunk
+                           Output: compress_hyper_2_57_chunk._ts_meta_count, compress_hyper_2_57_chunk.segment_by_value, compress_hyper_2_57_chunk._ts_meta_min_1, compress_hyper_2_57_chunk._ts_meta_max_1, compress_hyper_2_57_chunk."time", compress_hyper_2_57_chunk.int_value, compress_hyper_2_57_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_48_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_48_chunk
+                     Output: _hyper_1_48_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_58_chunk
+                           Output: compress_hyper_2_58_chunk._ts_meta_count, compress_hyper_2_58_chunk.segment_by_value, compress_hyper_2_58_chunk._ts_meta_min_1, compress_hyper_2_58_chunk._ts_meta_max_1, compress_hyper_2_58_chunk."time", compress_hyper_2_58_chunk.int_value, compress_hyper_2_58_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_49_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_49_chunk
+                     Output: _hyper_1_49_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_59_chunk
+                           Output: compress_hyper_2_59_chunk._ts_meta_count, compress_hyper_2_59_chunk.segment_by_value, compress_hyper_2_59_chunk._ts_meta_min_1, compress_hyper_2_59_chunk._ts_meta_max_1, compress_hyper_2_59_chunk."time", compress_hyper_2_59_chunk.int_value, compress_hyper_2_59_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_50_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_50_chunk
+                     Output: _hyper_1_50_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_60_chunk
+                           Output: compress_hyper_2_60_chunk._ts_meta_count, compress_hyper_2_60_chunk.segment_by_value, compress_hyper_2_60_chunk._ts_meta_min_1, compress_hyper_2_60_chunk._ts_meta_max_1, compress_hyper_2_60_chunk."time", compress_hyper_2_60_chunk.int_value, compress_hyper_2_60_chunk.float_value
 
 SELECT sum(segment_by_value) FROM testtable;
  sum  
@@ -2594,160 +2588,154 @@
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.segment_by_value)
-   ->  Gather
-         Output: (PARTIAL sum(testtable.segment_by_value))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
-                           Output: _hyper_1_81_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
-                                 Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
-                           Output: _hyper_1_82_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
-                                 Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
-                           Output: _hyper_1_83_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
-                                 Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
-                           Output: _hyper_1_84_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
-                                 Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
-                           Output: _hyper_1_85_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
-                                 Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
-                           Output: _hyper_1_86_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
-                                 Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
-                           Output: _hyper_1_87_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
-                                 Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
-                           Output: _hyper_1_88_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
-                                 Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
-                           Output: _hyper_1_89_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
-                                 Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
-                           Output: _hyper_1_90_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
-                                 Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
+                     Output: _hyper_1_81_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
+                           Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
+                     Output: _hyper_1_82_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
+                           Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
+                     Output: _hyper_1_83_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
+                           Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
+                     Output: _hyper_1_84_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
+                           Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
+                     Output: _hyper_1_85_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
+                           Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
+                     Output: _hyper_1_86_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
+                           Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
+                     Output: _hyper_1_87_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
+                           Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
+                     Output: _hyper_1_88_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
+                           Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
+                     Output: _hyper_1_89_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
+                           Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
+                     Output: _hyper_1_90_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
+                           Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
 
 :EXPLAIN
 SELECT sum(int_value) FROM testtable;
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.int_value)
-   ->  Gather
-         Output: (PARTIAL sum(testtable.int_value))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_81_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
-                           Output: _hyper_1_81_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
-                                 Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_82_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
-                           Output: _hyper_1_82_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
-                                 Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_83_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
-                           Output: _hyper_1_83_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
-                                 Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_84_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
-                           Output: _hyper_1_84_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
-                                 Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_85_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
-                           Output: _hyper_1_85_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
-                                 Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_86_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
-                           Output: _hyper_1_86_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
-                                 Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_87_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
-                           Output: _hyper_1_87_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
-                                 Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_88_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
-                           Output: _hyper_1_88_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
-                                 Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_89_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
-                           Output: _hyper_1_89_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
-                                 Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_90_chunk.int_value))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
-                           Output: _hyper_1_90_chunk.int_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
-                                 Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_81_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
+                     Output: _hyper_1_81_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
+                           Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_82_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
+                     Output: _hyper_1_82_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
+                           Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_83_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
+                     Output: _hyper_1_83_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
+                           Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_84_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
+                     Output: _hyper_1_84_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
+                           Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_85_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
+                     Output: _hyper_1_85_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
+                           Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_86_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
+                     Output: _hyper_1_86_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
+                           Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_87_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
+                     Output: _hyper_1_87_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
+                           Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_88_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
+                     Output: _hyper_1_88_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
+                           Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_89_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
+                     Output: _hyper_1_89_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
+                           Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_90_chunk.int_value))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
+                     Output: _hyper_1_90_chunk.int_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
+                           Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
 
 SELECT sum(segment_by_value) FROM testtable;
  sum  
@@ -2765,80 +2753,77 @@
 --- QUERY PLAN ---
  Finalize Aggregate
    Output: sum(testtable.segment_by_value) FILTER (WHERE (testtable.segment_by_value > 99999))
-   ->  Gather
-         Output: (PARTIAL sum(testtable.segment_by_value) FILTER (WHERE (testtable.segment_by_value > 99999)))
-         Workers Planned: 2
-         ->  Parallel Append
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value) FILTER (WHERE (_hyper_1_81_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
-                           Output: _hyper_1_81_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
-                                 Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value) FILTER (WHERE (_hyper_1_82_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
-                           Output: _hyper_1_82_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
-                                 Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value) FILTER (WHERE (_hyper_1_83_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
-                           Output: _hyper_1_83_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
-                                 Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value) FILTER (WHERE (_hyper_1_84_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
-                           Output: _hyper_1_84_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
-                                 Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value) FILTER (WHERE (_hyper_1_85_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
-                           Output: _hyper_1_85_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
-                                 Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value) FILTER (WHERE (_hyper_1_86_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
-                           Output: _hyper_1_86_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
-                                 Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value) FILTER (WHERE (_hyper_1_87_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
-                           Output: _hyper_1_87_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
-                                 Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value) FILTER (WHERE (_hyper_1_88_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
-                           Output: _hyper_1_88_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
-                                 Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value) FILTER (WHERE (_hyper_1_89_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
-                           Output: _hyper_1_89_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
-                                 Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
-               ->  Custom Scan (VectorAgg)
-                     Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value) FILTER (WHERE (_hyper_1_90_chunk.segment_by_value > 99999)))
-                     Grouping Policy: all compressed batches
-                     ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
-                           Output: _hyper_1_90_chunk.segment_by_value
-                           ->  Parallel Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
-                                 Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
+   ->  Append
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_81_chunk.segment_by_value) FILTER (WHERE (_hyper_1_81_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_81_chunk
+                     Output: _hyper_1_81_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_91_chunk
+                           Output: compress_hyper_2_91_chunk._ts_meta_count, compress_hyper_2_91_chunk.segment_by_value, compress_hyper_2_91_chunk._ts_meta_min_1, compress_hyper_2_91_chunk._ts_meta_max_1, compress_hyper_2_91_chunk."time", compress_hyper_2_91_chunk.int_value, compress_hyper_2_91_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_82_chunk.segment_by_value) FILTER (WHERE (_hyper_1_82_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_82_chunk
+                     Output: _hyper_1_82_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_92_chunk
+                           Output: compress_hyper_2_92_chunk._ts_meta_count, compress_hyper_2_92_chunk.segment_by_value, compress_hyper_2_92_chunk._ts_meta_min_1, compress_hyper_2_92_chunk._ts_meta_max_1, compress_hyper_2_92_chunk."time", compress_hyper_2_92_chunk.int_value, compress_hyper_2_92_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_83_chunk.segment_by_value) FILTER (WHERE (_hyper_1_83_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_83_chunk
+                     Output: _hyper_1_83_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_93_chunk
+                           Output: compress_hyper_2_93_chunk._ts_meta_count, compress_hyper_2_93_chunk.segment_by_value, compress_hyper_2_93_chunk._ts_meta_min_1, compress_hyper_2_93_chunk._ts_meta_max_1, compress_hyper_2_93_chunk."time", compress_hyper_2_93_chunk.int_value, compress_hyper_2_93_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_84_chunk.segment_by_value) FILTER (WHERE (_hyper_1_84_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_84_chunk
+                     Output: _hyper_1_84_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_94_chunk
+                           Output: compress_hyper_2_94_chunk._ts_meta_count, compress_hyper_2_94_chunk.segment_by_value, compress_hyper_2_94_chunk._ts_meta_min_1, compress_hyper_2_94_chunk._ts_meta_max_1, compress_hyper_2_94_chunk."time", compress_hyper_2_94_chunk.int_value, compress_hyper_2_94_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_85_chunk.segment_by_value) FILTER (WHERE (_hyper_1_85_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_85_chunk
+                     Output: _hyper_1_85_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_95_chunk
+                           Output: compress_hyper_2_95_chunk._ts_meta_count, compress_hyper_2_95_chunk.segment_by_value, compress_hyper_2_95_chunk._ts_meta_min_1, compress_hyper_2_95_chunk._ts_meta_max_1, compress_hyper_2_95_chunk."time", compress_hyper_2_95_chunk.int_value, compress_hyper_2_95_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_86_chunk.segment_by_value) FILTER (WHERE (_hyper_1_86_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_86_chunk
+                     Output: _hyper_1_86_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_96_chunk
+                           Output: compress_hyper_2_96_chunk._ts_meta_count, compress_hyper_2_96_chunk.segment_by_value, compress_hyper_2_96_chunk._ts_meta_min_1, compress_hyper_2_96_chunk._ts_meta_max_1, compress_hyper_2_96_chunk."time", compress_hyper_2_96_chunk.int_value, compress_hyper_2_96_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_87_chunk.segment_by_value) FILTER (WHERE (_hyper_1_87_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_87_chunk
+                     Output: _hyper_1_87_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_97_chunk
+                           Output: compress_hyper_2_97_chunk._ts_meta_count, compress_hyper_2_97_chunk.segment_by_value, compress_hyper_2_97_chunk._ts_meta_min_1, compress_hyper_2_97_chunk._ts_meta_max_1, compress_hyper_2_97_chunk."time", compress_hyper_2_97_chunk.int_value, compress_hyper_2_97_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_88_chunk.segment_by_value) FILTER (WHERE (_hyper_1_88_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_88_chunk
+                     Output: _hyper_1_88_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_98_chunk
+                           Output: compress_hyper_2_98_chunk._ts_meta_count, compress_hyper_2_98_chunk.segment_by_value, compress_hyper_2_98_chunk._ts_meta_min_1, compress_hyper_2_98_chunk._ts_meta_max_1, compress_hyper_2_98_chunk."time", compress_hyper_2_98_chunk.int_value, compress_hyper_2_98_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_89_chunk.segment_by_value) FILTER (WHERE (_hyper_1_89_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_89_chunk
+                     Output: _hyper_1_89_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_99_chunk
+                           Output: compress_hyper_2_99_chunk._ts_meta_count, compress_hyper_2_99_chunk.segment_by_value, compress_hyper_2_99_chunk._ts_meta_min_1, compress_hyper_2_99_chunk._ts_meta_max_1, compress_hyper_2_99_chunk."time", compress_hyper_2_99_chunk.int_value, compress_hyper_2_99_chunk.float_value
+         ->  Custom Scan (VectorAgg)
+               Output: (PARTIAL sum(_hyper_1_90_chunk.segment_by_value) FILTER (WHERE (_hyper_1_90_chunk.segment_by_value > 99999)))
+               Grouping Policy: all compressed batches
+               ->  Custom Scan (ColumnarScan) on _timescaledb_internal._hyper_1_90_chunk
+                     Output: _hyper_1_90_chunk.segment_by_value
+                     ->  Seq Scan on _timescaledb_internal.compress_hyper_2_100_chunk
+                           Output: compress_hyper_2_100_chunk._ts_meta_count, compress_hyper_2_100_chunk.segment_by_value, compress_hyper_2_100_chunk._ts_meta_min_1, compress_hyper_2_100_chunk._ts_meta_max_1, compress_hyper_2_100_chunk."time", compress_hyper_2_100_chunk.int_value, compress_hyper_2_100_chunk.float_value
 
 SET timescaledb.enable_vectorized_aggregation = OFF;
 SELECT sum(segment_by_value) FILTER (WHERE segment_by_value > 99999) FROM testtable;
