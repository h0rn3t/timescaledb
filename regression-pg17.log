diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/columnar_scan_cost.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/columnar_scan_cost.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/columnar_scan_cost.out	2025-11-05 21:21:41.673102361 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/columnar_scan_cost.out	2025-11-05 21:29:34.358103729 +0000
@@ -33,20 +33,20 @@
 
 explain (buffers off) select * from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.60 rows=50 width=108)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=142)
 
 explain (buffers off) select * from costtab where ti = '200';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.38..31.12 rows=3000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.38..1.27 rows=15 width=108)
    Vectorized Filter: (ti = '200'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.12 rows=3 width=142)
          Filter: _timescaledb_functions.bloom1_contains(_ts_meta_v2_bloom1_ti, '200'::text)
 
 explain (buffers off) select * from costtab where fi = 200;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.15 rows=10000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.65 rows=50 width=108)
    Vectorized Filter: (fi = '200'::double precision)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.15 rows=10 width=142)
          Filter: ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision))
@@ -64,7 +64,7 @@
 
 explain (buffers off) select ts from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=4)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.60 rows=50 width=4)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=76)
 
@@ -81,27 +81,27 @@
 
 explain (buffers off) select ts, s from costtab where c = '100';
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..101.10 rows=10000 width=36)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=0.11..1.60 rows=50 width=36)
    Vectorized Filter: (c = '100'::text)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.10 rows=10 width=78)
 
 explain (buffers off) select * from costtab where ts = 5000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.15..11.15 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.15..1.20 rows=5 width=108)
    Vectorized Filter: (ts = 5000)
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.15 rows=1 width=142)
          Filter: ((_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000))
 
 explain (buffers off) select * from costtab where fi = 200 and ts = 5000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.20..11.20 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.20..1.21 rows=1 width=108)
    Vectorized Filter: ((fi = '200'::double precision) AND (ts = 5000))
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.20 rows=1 width=142)
          Filter: ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision) AND (_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000))
 
 explain (buffers off) select * from costtab where s = '1' or (fi = 200 and ts = 5000);
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.23..11.22 rows=1000 width=108)
+ Custom Scan (ColumnarScan) on _hyper_1_1_chunk  (cost=1.23..1.28 rows=5 width=108)
    Filter: ((s = '1'::text) OR ((fi = '200'::double precision) AND (ts = 5000)))
    ->  Seq Scan on compress_hyper_2_2_chunk  (cost=0.00..1.23 rows=1 width=142)
          Filter: ((s = '1'::text) OR ((_ts_meta_v2_min_fi <= '200'::double precision) AND (_ts_meta_v2_max_fi >= '200'::double precision) AND (_ts_meta_min_1 <= 5000) AND (_ts_meta_max_1 >= 5000)))
@@ -269,7 +269,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts > 200000 and ts < 300000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.43..1005.58 rows=99000 width=4) (actual rows=99999.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.43..20.53 rows=495 width=4) (actual rows=99999.00 loops=1)
    Vectorized Filter: ((ts > 200000) AND (ts < 300000))
    Rows Removed by Filter: 1
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..15.58 rows=99 width=44) (actual rows=100.00 loops=1)
@@ -278,7 +278,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts = 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=18.70..28.70 rows=1000 width=4) (actual rows=1.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=18.70..18.75 rows=5 width=4) (actual rows=1.00 loops=1)
    Vectorized Filter: (ts = 500000)
    Rows Removed by Filter: 999
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..18.70 rows=1 width=44) (actual rows=1.00 loops=1)
@@ -287,7 +287,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts < 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.32..5001.61 rows=498000 width=4) (actual rows=499999.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.32..1681.62 rows=166000 width=4) (actual rows=499999.00 loops=1)
    Vectorized Filter: (ts < 500000)
    Rows Removed by Filter: 1
    ->  Index Scan using compress_hyper_6_26_chunk__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_26_chunk  (cost=0.28..21.61 rows=498 width=44) (actual rows=500.00 loops=1)
@@ -296,7 +296,7 @@
 explain (buffers off, analyze, timing off, summary off)
 select * from highcard where ts > 500000;
 --- QUERY PLAN ---
- Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.05..5035.50 rows=501000 width=4) (actual rows=500000.00 loops=1)
+ Custom Scan (ColumnarScan) on _hyper_5_25_chunk  (cost=0.05..1695.50 rows=167000 width=4) (actual rows=500000.00 loops=1)
    Vectorized Filter: (ts > 500000)
    ->  Seq Scan on compress_hyper_6_26_chunk  (cost=0.00..25.50 rows=501 width=44) (actual rows=500.00 loops=1)
          Filter: (_ts_meta_max_1 > 500000)
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/merge_append_partially_compressed.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/merge_append_partially_compressed.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/merge_append_partially_compressed.out	2025-11-05 21:21:41.684102261 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/merge_append_partially_compressed.out	2025-11-05 21:31:09.440234143 +0000
@@ -617,18 +617,15 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Index Scan using _hyper_3_7_chunk_test1_time_idx on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
 -- requires resorting
@@ -636,146 +633,107 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 -- all these require resorting, no pushdown can happen
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST, x4 ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3, test1.x4
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3, test1.x4
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3, test1.x4
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time DESC NULLS FIRST, x3 ASC NULLS LAST, x4 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" DESC, test1.x3, test1.x4 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" DESC, test1.x3, test1.x4 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" DESC, test1.x3, test1.x4 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time"
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time"
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time"
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Index Scan Backward using _hyper_3_7_chunk_test1_time_idx on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time"
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST, x3 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time", test1.x3 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time", test1.x3 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time", test1.x3 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS LAST, x3 DESC NULLS FIRST, x4 DESC NULLS FIRST LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time", test1.x3 DESC, test1.x4 DESC
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time", test1.x3 DESC, test1.x4 DESC
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time", test1.x3 DESC, test1.x4 DESC
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY time ASC NULLS FIRST, x3 DESC NULLS LAST, x4 ASC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-         Order: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
-         ->  Merge Append (actual rows=5.00 loops=1)
-               Sort Key: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
-               ->  Sort (actual rows=4.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" NULLS FIRST, _hyper_3_7_chunk.x3 DESC NULLS LAST, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
-                           Rows Removed by Filter: 10000
-                           ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: _hyper_3_7_chunk."time" NULLS FIRST, _hyper_3_7_chunk.x3 DESC NULLS LAST, _hyper_3_7_chunk.x4
-                     Sort Method: quicksort 
-                     ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                           Filter: ((x4 % 11) <> 0)
+   ->  Sort (actual rows=5.00 loops=1)
+         Sort Key: test1."time" NULLS FIRST, test1.x3 DESC NULLS LAST, test1.x4
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
+                     ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+               ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
 
 set enable_hashagg to off; -- different on PG13
 :PREFIX
@@ -786,41 +744,31 @@
    ->  GroupAggregate (actual rows=5.00 loops=1)
          Group Key: test1."time", test1.x1, test1.x2
          ->  Limit (actual rows=5.00 loops=1)
-               ->  Result (actual rows=5.00 loops=1)
-                     ->  Custom Scan (ChunkAppend) on test1 (actual rows=5.00 loops=1)
-                           Order: test1."time", test1.x1, test1.x2
-                           ->  Merge Append (actual rows=5.00 loops=1)
-                                 Sort Key: test1."time", test1.x1, test1.x2
-                                 ->  Sort (actual rows=4.00 loops=1)
-                                       Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2
-                                       Sort Method: quicksort 
-                                       ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-                                             Filter: ((x4 % 11) <> 0)
-                                             Rows Removed by Filter: 10000
-                                             ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-                                 ->  Sort (actual rows=1.00 loops=1)
-                                       Sort Key: _hyper_3_7_chunk."time", _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2
-                                       Sort Method: quicksort 
-                                       ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
-                                             Filter: ((x4 % 11) <> 0)
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: test1."time", test1.x1, test1.x2
+                     Sort Method: quicksort 
+                     ->  Result (actual rows=5.00 loops=1)
+                           ->  Append (actual rows=5.00 loops=1)
+                                 ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                                       Filter: ((x4 % 11) <> 0)
+                                       Rows Removed by Filter: 10000
+                                       ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
+                                 ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
+                                       Filter: ((x4 % 11) <> 0)
 
 reset enable_hashagg;
 :PREFIX
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1.x4, test1."time"
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk.x4, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk.x4, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -828,18 +776,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -847,18 +791,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -866,18 +806,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3, test1.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -885,18 +821,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x4 DESC LIMIT 10; -- no pushdown because orderby does not match
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x4 DESC
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -905,18 +837,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1, compress_hyper_4_8_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -924,18 +852,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time DESC, x3 ASC, x4 ASC LIMIT 10; -- pushdown
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time" DESC, test1.x3, test1.x4
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1 DESC, compress_hyper_4_8_chunk._ts_meta_max_1 DESC, compress_hyper_4_8_chunk._ts_meta_min_2, compress_hyper_4_8_chunk._ts_meta_max_2, compress_hyper_4_8_chunk._ts_meta_min_3, compress_hyper_4_8_chunk._ts_meta_max_3
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time" DESC, _hyper_3_7_chunk.x3, _hyper_3_7_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -943,18 +867,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time ASC, x3 DESC, x4 DESC LIMIT 10; -- pushdown
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3 DESC, test1.x4 DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1, compress_hyper_4_8_chunk._ts_meta_max_1, compress_hyper_4_8_chunk._ts_meta_min_2 DESC, compress_hyper_4_8_chunk._ts_meta_max_2 DESC, compress_hyper_4_8_chunk._ts_meta_min_3 DESC, compress_hyper_4_8_chunk._ts_meta_max_3 DESC
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC, _hyper_3_7_chunk.x4 DESC
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -962,18 +882,14 @@
 SELECT * FROM test1 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time, x3 DESC LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=5.00 loops=1)
-   ->  Merge Append (actual rows=5.00 loops=1)
+   ->  Sort (actual rows=5.00 loops=1)
          Sort Key: test1.x1, test1.x2, test1.x5, test1."time", test1.x3 DESC
-         ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_4_8_chunk.x1, compress_hyper_4_8_chunk.x2, compress_hyper_4_8_chunk.x5, compress_hyper_4_8_chunk._ts_meta_min_1, compress_hyper_4_8_chunk._ts_meta_max_1, compress_hyper_4_8_chunk._ts_meta_min_2 DESC, compress_hyper_4_8_chunk._ts_meta_max_2 DESC
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=5.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_3_7_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_4_8_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_3_7_chunk.x1, _hyper_3_7_chunk.x2, _hyper_3_7_chunk.x5, _hyper_3_7_chunk."time", _hyper_3_7_chunk.x3 DESC
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_3_7_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1043,30 +959,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2.x3
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_11_chunk.x1, compress_hyper_6_11_chunk.x2, compress_hyper_6_11_chunk.x5, compress_hyper_6_11_chunk._ts_meta_min_1, compress_hyper_6_11_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_12_chunk.x1, compress_hyper_6_12_chunk.x2, compress_hyper_6_12_chunk.x5, compress_hyper_6_12_chunk._ts_meta_min_1, compress_hyper_6_12_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1087,30 +993,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2.x3, test2.x4
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_11_chunk.x1, compress_hyper_6_11_chunk.x2, compress_hyper_6_11_chunk.x5, compress_hyper_6_11_chunk._ts_meta_min_1, compress_hyper_6_11_chunk._ts_meta_max_1, compress_hyper_6_11_chunk._ts_meta_min_2, compress_hyper_6_11_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x3, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=13.00 loops=1)
-                     Sort Key: compress_hyper_6_12_chunk.x1, compress_hyper_6_12_chunk.x2, compress_hyper_6_12_chunk.x5, compress_hyper_6_12_chunk._ts_meta_min_1, compress_hyper_6_12_chunk._ts_meta_max_1, compress_hyper_6_12_chunk._ts_meta_min_2, compress_hyper_6_12_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x3, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1132,30 +1028,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x3
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1176,30 +1062,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2.x4
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1220,30 +1096,20 @@
 :PREFIX SELECT * FROM test2 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test2.x1, test2.x2, test2.x5, test2."time"
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=10.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_11_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_9_chunk.x1, _hyper_5_9_chunk.x2, _hyper_5_9_chunk.x5, _hyper_5_9_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_9_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_5_10_chunk (actual rows=4.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_6_12_chunk (actual rows=13.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_5_10_chunk.x1, _hyper_5_10_chunk.x2, _hyper_5_10_chunk.x5, _hyper_5_10_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_5_10_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1317,54 +1183,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3.x3
-         ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_17_chunk.x1, compress_hyper_8_17_chunk.x2, compress_hyper_8_17_chunk.x5, compress_hyper_8_17_chunk._ts_meta_min_1, compress_hyper_8_17_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_18_chunk.x1, compress_hyper_8_18_chunk.x2, compress_hyper_8_18_chunk.x5, compress_hyper_8_18_chunk._ts_meta_min_1, compress_hyper_8_18_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_19_chunk.x1, compress_hyper_8_19_chunk.x2, compress_hyper_8_19_chunk.x5, compress_hyper_8_19_chunk._ts_meta_min_1, compress_hyper_8_19_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_20_chunk.x1, compress_hyper_8_20_chunk.x2, compress_hyper_8_20_chunk.x5, compress_hyper_8_20_chunk._ts_meta_min_1, compress_hyper_8_20_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1385,54 +1229,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x3, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3.x3, test3.x4
-         ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_17_chunk.x1, compress_hyper_8_17_chunk.x2, compress_hyper_8_17_chunk.x5, compress_hyper_8_17_chunk._ts_meta_min_1, compress_hyper_8_17_chunk._ts_meta_max_1, compress_hyper_8_17_chunk._ts_meta_min_2, compress_hyper_8_17_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x3, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_18_chunk.x1, compress_hyper_8_18_chunk.x2, compress_hyper_8_18_chunk.x5, compress_hyper_8_18_chunk._ts_meta_min_1, compress_hyper_8_18_chunk._ts_meta_max_1, compress_hyper_8_18_chunk._ts_meta_min_2, compress_hyper_8_18_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x3, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=12.00 loops=1)
-                     Sort Key: compress_hyper_8_19_chunk.x1, compress_hyper_8_19_chunk.x2, compress_hyper_8_19_chunk.x5, compress_hyper_8_19_chunk._ts_meta_min_1, compress_hyper_8_19_chunk._ts_meta_max_1, compress_hyper_8_19_chunk._ts_meta_min_2, compress_hyper_8_19_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x3, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
-               Filter: ((x4 % 11) <> 0)
-               Rows Removed by Filter: 10000
-               ->  Sort (actual rows=11.00 loops=1)
-                     Sort Key: compress_hyper_8_20_chunk.x1, compress_hyper_8_20_chunk.x2, compress_hyper_8_20_chunk.x5, compress_hyper_8_20_chunk._ts_meta_min_1, compress_hyper_8_20_chunk._ts_meta_max_1, compress_hyper_8_20_chunk._ts_meta_min_2, compress_hyper_8_20_chunk._ts_meta_max_2
-                     Sort Method: quicksort 
+               ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
+                     Filter: ((x4 % 11) <> 0)
+                     Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x3, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1454,54 +1276,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x3 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x3
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x3
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1522,54 +1322,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, x4 LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3.x4
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk.x4
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
@@ -1590,54 +1368,32 @@
 :PREFIX SELECT * FROM test3 WHERE x4 % 11 != 0 ORDER BY x1, x2, x5, time LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: test3.x1, test3.x2, test3.x5, test3."time"
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk."time"
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=12.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_7_13_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_17_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_13_chunk.x1, _hyper_7_13_chunk.x2, _hyper_7_13_chunk.x5, _hyper_7_13_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_13_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_18_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_14_chunk.x1, _hyper_7_14_chunk.x2, _hyper_7_14_chunk.x5, _hyper_7_14_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_14_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_15_chunk (actual rows=3.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_19_chunk (actual rows=12.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_15_chunk.x1, _hyper_7_15_chunk.x2, _hyper_7_15_chunk.x5, _hyper_7_15_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_15_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk."time"
-               Sort Method: quicksort 
                ->  Custom Scan (ColumnarScan) on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
                      Rows Removed by Filter: 10000
                      ->  Seq Scan on compress_hyper_8_20_chunk (actual rows=11.00 loops=1)
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: _hyper_7_16_chunk.x1, _hyper_7_16_chunk.x2, _hyper_7_16_chunk.x5, _hyper_7_16_chunk."time"
-               Sort Method: quicksort 
                ->  Seq Scan on _hyper_7_16_chunk (actual rows=1.00 loops=1)
                      Filter: ((x4 % 11) <> 0)
 
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan-17.out	2025-11-05 21:21:41.691102197 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan-17.out	2025-11-05 21:31:32.380023305 +0000
@@ -4023,12 +4023,11 @@
 :PREFIX SELECT DISTINCT time, dev FROM :TABLE WHERE time = 100 ORDER BY time, dev;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 1492
-               ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
-                     Index Cond: ((_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_3_5_chunk (actual rows=11.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 2494
+         ->  Index Scan using compress_hyper_4_18_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_4_18_chunk (actual rows=11.00 loops=1)
+               Index Cond: ((_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 -- multicolumn "segmentby = 'dev, dev_name'"
 SELECT decompress_chunk(ch) FROM show_chunks('skip_scan_htc') ch;
@@ -6811,19 +6810,18 @@
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time BETWEEN 100 AND 300;
 --- QUERY PLAN ---
  Unique (actual rows=11.00 loops=1)
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE time < 200;
 --- QUERY PLAN ---
@@ -7274,12 +7272,11 @@
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time = 100;
 --- QUERY PLAN ---
  Unique (actual rows=5.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 745
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                     Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 1245
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+               Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev,time FROM :TABLE WHERE dev > 5 AND time > 200;
 --- QUERY PLAN ---
@@ -7332,12 +7329,11 @@
 :PREFIX SELECT DISTINCT ON (dev) dev,time,val FROM :TABLE WHERE time > 100 AND time < 200 AND val > 10 AND val < 10000 AND dev > 2 AND dev < 7 ORDER BY dev,time DESC;
 --- QUERY PLAN ---
  Unique (actual rows=0.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT DISTINCT ON (dev) dev FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_dagg-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_dagg-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/plan_skip_scan_dagg-17.out	2025-11-05 21:21:41.693102179 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/plan_skip_scan_dagg-17.out	2025-11-05 21:31:31.451032054 +0000
@@ -5492,19 +5492,18 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=11.00 loops=1)
    Group Key: skip_scan_htcl.dev
-   ->  Merge Append (actual rows=22.00 loops=1)
+   ->  Merge Append (actual rows=2015.00 loops=1)
          Sort Key: skip_scan_htcl.dev
-         ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
-         ->  Custom Scan (SkipScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-               ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=11.00 loops=1)
-                     Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
-                     Rows Removed by Filter: 1993
-                     ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
-                           Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=1503.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1002
+               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
+         ->  Custom Scan (ColumnarScan) on _hyper_5_11_chunk (actual rows=512.00 loops=1)
+               Vectorized Filter: (("time" >= 100) AND ("time" <= 300))
+               Rows Removed by Filter: 1993
+               ->  Index Scan using compress_hyper_6_14_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_14_chunk (actual rows=11.00 loops=1)
+                     Index Cond: ((_ts_meta_min_1 <= 300) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT count(DISTINCT dev), dev FROM :TABLE WHERE time < 200 GROUP BY dev;
 --- QUERY PLAN ---
@@ -5924,12 +5923,11 @@
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 5 AND time = 100;
 --- QUERY PLAN ---
  Aggregate (actual rows=1.00 loops=1)
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
-               Vectorized Filter: ("time" = 100)
-               Rows Removed by Filter: 745
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
-                     Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=5.00 loops=1)
+         Vectorized Filter: ("time" = 100)
+         Rows Removed by Filter: 1245
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=5.00 loops=1)
+               Index Cond: ((dev > 5) AND (_ts_meta_min_1 <= 100) AND (_ts_meta_max_1 >= 100))
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev > 5 AND time > 200;
 --- QUERY PLAN ---
@@ -5983,12 +5981,11 @@
 --- QUERY PLAN ---
  GroupAggregate (actual rows=0.00 loops=1)
    Group Key: _hyper_5_9_chunk.dev
-   ->  Custom Scan (SkipScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-         ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
-               Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
-               Rows Removed by Filter: 1000
-               ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
-                     Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
+   ->  Custom Scan (ColumnarScan) on _hyper_5_9_chunk (actual rows=0.00 loops=1)
+         Vectorized Filter: (("time" > 100) AND ("time" < 200) AND (val > 10) AND (val < 10000))
+         Rows Removed by Filter: 1000
+         ->  Index Scan using compress_hyper_6_10_chunk_dev__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_6_10_chunk (actual rows=4.00 loops=1)
+               Index Cond: ((dev > 2) AND (dev < 7) AND (_ts_meta_min_1 < 200) AND (_ts_meta_max_1 > 100))
 
 :PREFIX SELECT count(DISTINCT dev) FROM :TABLE WHERE dev IS NULL;
 --- QUERY PLAN ---
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/skip_scan.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/skip_scan.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/skip_scan.out	2025-11-05 21:21:41.695102160 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/skip_scan.out	2025-11-05 21:31:48.380873825 +0000
@@ -2837,10 +2837,6 @@
 psql:include/skip_scan_multi_query.sql:34: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL, dev_name NOT NULL)
 \qecho ordered append on :TABLE
 :PREFIX SELECT DISTINCT ON (region, dev) region, dev FROM :TABLE WHERE status = 1 AND time BETWEEN 0 AND 5000;
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_74_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_75_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
-psql:include/skip_scan_multi_query.sql:37: INFO:  SkipScan used on compress_hyper_9_76_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
 \qecho SUBSELECTS on :TABLE
 :PREFIX SELECT time, region, dev, val, 'q4_1' FROM (SELECT DISTINCT ON (region, dev) * FROM :TABLE WHERE status = 1) a;
 psql:include/skip_scan_multi_query.sql:40: INFO:  SkipScan used on compress_hyper_9_73_chunk_status_region_dev_dev_name__ts_me_idx(region NOT NULL, dev NOT NULL)
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_join_index.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_join_index.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_join_index.out	2025-11-05 21:21:41.699102124 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_join_index.out	2025-11-05 21:31:36.391985901 +0000
@@ -64,12 +64,11 @@
                Sort Key: compress_hyper_2_2_chunk._ts_meta_min_1
                ->  Index Scan using compress_hyper_2_2_chunk_a_b__ts_meta_min_1__ts_meta_max_1_idx on compress_hyper_2_2_chunk
                      Index Cond: ((_ts_meta_min_1 <= 'Wed Jan 01 00:02:00 2020 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Wed Jan 01 00:00:00 2020 PST'::timestamp with time zone))
-   ->  Materialize
-         ->  Unique
-               ->  Sort
-                     Sort Key: test_copy.a
-                     ->  Seq Scan on test_copy
-                           Filter: (((a)::text = ANY ('{lat,lon}'::text[])) AND (b = 1))
+   ->  Unique
+         ->  Sort
+               Sort Key: test_copy.a
+               ->  Seq Scan on test_copy
+                     Filter: (((a)::text = ANY ('{lat,lon}'::text[])) AND (b = 1))
 
 with query_params as (
 	select distinct a, b
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_ordered_index-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_ordered_index-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/transparent_decompression_ordered_index-17.out	2025-11-05 21:21:41.699102124 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/transparent_decompression_ordered_index-17.out	2025-11-05 21:31:38.055970712 +0000
@@ -295,12 +295,12 @@
 WHERE extract(minute FROM d.time) = 0;
 --- QUERY PLAN ---
  Unique (actual rows=1.00 loops=1)
-   ->  Sort (actual rows=12.00 loops=1)
-         Sort Key: d.device_id
-         Sort Method: quicksort 
-         ->  Nested Loop (actual rows=12.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_ordered_idx d (actual rows=389.00 loops=1)
-                     Chunks excluded during startup: 0
+   ->  Nested Loop (actual rows=12.00 loops=1)
+         ->  Custom Scan (ConstraintAwareAppend) (actual rows=389.00 loops=1)
+               Hypertable: metrics_ordered_idx
+               Chunks excluded during startup: 0
+               ->  Merge Append (actual rows=389.00 loops=1)
+                     Sort Key: d.device_id
                      ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk d_1 (actual rows=120.00 loops=1)
                            Filter: (EXTRACT(minute FROM "time") = '0'::numeric)
                            Rows Removed by Filter: 360
@@ -320,28 +320,28 @@
                      ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk d_5 (actual rows=5.00 loops=1)
                            Filter: (EXTRACT(minute FROM "time") = '0'::numeric)
                            ->  Index Scan using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk (actual rows=5.00 loops=1)
-               ->  Subquery Scan on m (actual rows=0.00 loops=389)
-                     Filter: (d.device_id_peer = m.device_id_peer)
-                     Rows Removed by Filter: 0
-                     ->  Limit (actual rows=0.00 loops=389)
-                           ->  Custom Scan (ChunkAppend) on metrics_ordered_idx m_1 (actual rows=0.00 loops=389)
-                                 Order: m_1."time" DESC
-                                 Hypertables excluded during runtime: 0
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk m_2 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk compress_hyper_2_10_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk m_3 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk compress_hyper_2_9_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m_4 (actual rows=0.00 loops=388)
-                                       ->  Index Scan Backward using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk compress_hyper_2_8_chunk_1 (actual rows=0.00 loops=388)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk m_5 (actual rows=0.00 loops=304)
-                                       ->  Index Scan Backward using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk compress_hyper_2_7_chunk_1 (actual rows=0.00 loops=304)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
-                                 ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m_6 (actual rows=0.00 loops=304)
-                                       ->  Index Scan Backward using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk compress_hyper_2_6_chunk_1 (actual rows=0.00 loops=304)
-                                             Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+         ->  Subquery Scan on m (actual rows=0.00 loops=389)
+               Filter: (d.device_id_peer = m.device_id_peer)
+               Rows Removed by Filter: 0
+               ->  Limit (actual rows=0.00 loops=389)
+                     ->  Custom Scan (ChunkAppend) on metrics_ordered_idx m_1 (actual rows=0.00 loops=389)
+                           Order: m_1."time" DESC
+                           Hypertables excluded during runtime: 0
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_5_chunk m_2 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_10_chunk_device_id_device_id_peer__ts_meta_idx on compress_hyper_2_10_chunk compress_hyper_2_10_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk m_3 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk compress_hyper_2_9_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk m_4 (actual rows=0.00 loops=388)
+                                 ->  Index Scan Backward using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk compress_hyper_2_8_chunk_1 (actual rows=0.00 loops=388)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_2_chunk m_5 (actual rows=0.00 loops=304)
+                                 ->  Index Scan Backward using compress_hyper_2_7_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_7_chunk compress_hyper_2_7_chunk_1 (actual rows=0.00 loops=304)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
+                           ->  Custom Scan (ColumnarScan) on _hyper_1_1_chunk m_6 (actual rows=0.00 loops=304)
+                                 ->  Index Scan Backward using compress_hyper_2_6_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_6_chunk compress_hyper_2_6_chunk_1 (actual rows=0.00 loops=304)
+                                       Index Cond: ((device_id = d.device_id) AND (device_id_peer = 3))
 
 :PREFIX
 SELECT d.device_id,
@@ -604,14 +604,14 @@
       and met.device_id = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=1.00 loops=1)
          Vectorized Filter: (("time" > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND ("time" < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (v0 = 5))
          Rows Removed by Filter: 47
          ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Index Cond: ((device_id = 3) AND (_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
+         Filter: ((column1 = 3) AND (column2 = 5))
+         Rows Removed by Filter: 1
 
 :PREFIX
 WITH lookup as ( SELECT * from (values( 3, 5) , (3, 4) ) as lu( did, version) )
@@ -623,14 +623,13 @@
       and met.device_id_peer = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=0.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=0.00 loops=1)
          Vectorized Filter: ((v0 = 5) AND ("time" = 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
          Rows Removed by Filter: 48
          ->  Index Scan using compress_hyper_2_8_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Index Cond: ((device_id = 3) AND (device_id_peer = 3) AND (_ts_meta_min_1 <= 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone))
+   ->  Values Scan on "*VALUES*" (never executed)
+         Filter: ((column1 = 3) AND (column2 = 5))
 
 -- lateral subquery
 :PREFIX
@@ -643,18 +642,17 @@
    and met.v0 = q.v0 and met.v0 > 2 and time = '2018-01-19 20:00:00-05';
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   Join Filter: (met.device_id = nodetime.node)
+   Join Filter: ((met.device_id_peer = "*VALUES*".column2) AND ("*VALUES*".column3 = met.v0))
    ->  Nested Loop (actual rows=1.00 loops=1)
          Join Filter: (nodetime.node = "*VALUES*".column1)
          Rows Removed by Join Filter: 1
          ->  Seq Scan on nodetime (actual rows=1.00 loops=1)
          ->  Values Scan on "*VALUES*" (actual rows=2.00 loops=1)
    ->  Custom Scan (ColumnarScan) on _hyper_1_4_chunk met (actual rows=1.00 loops=1)
-         Filter: ("*VALUES*".column3 = v0)
-         Rows Removed by Filter: 47
          Vectorized Filter: ((v0 > 2) AND ("time" = 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
+         Rows Removed by Filter: 47
          ->  Index Scan using compress_hyper_2_9_chunk_device_id_device_id_peer__ts_meta__idx on compress_hyper_2_9_chunk (actual rows=1.00 loops=1)
-               Index Cond: ((device_id = "*VALUES*".column1) AND (device_id_peer = "*VALUES*".column2) AND (_ts_meta_min_1 <= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
+               Index Cond: ((device_id = nodetime.node) AND (_ts_meta_min_1 <= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Jan 19 17:00:00 2018 PST'::timestamp with time zone))
 
 -- filter on compressed attr (v0) with seqscan enabled and indexscan
 -- disabled. filters on compressed attr should be above the seq scan.
@@ -672,14 +670,14 @@
       and met.device_id_peer = 3 and met.v0 = 5;
 --- QUERY PLAN ---
  Nested Loop (actual rows=1.00 loops=1)
-   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
-         Filter: ((column1 = 3) AND (column2 = 5))
-         Rows Removed by Filter: 1
    ->  Custom Scan (ColumnarScan) on _hyper_1_3_chunk met (actual rows=1.00 loops=1)
          Vectorized Filter: (("time" > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND ("time" < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (v0 = 5))
          Rows Removed by Filter: 47
          ->  Seq Scan on compress_hyper_2_8_chunk (actual rows=1.00 loops=1)
                Filter: ((_ts_meta_max_1 > 'Wed Jan 19 16:00:00 2000 PST'::timestamp with time zone) AND (_ts_meta_min_1 < 'Thu Jan 20 17:00:00 2000 PST'::timestamp with time zone) AND (device_id = 3) AND (device_id_peer = 3))
+   ->  Values Scan on "*VALUES*" (actual rows=1.00 loops=1)
+         Filter: ((column1 = 3) AND (column2 = 5))
+         Rows Removed by Filter: 1
 
 RESET enable_hashjoin  ;
 RESET enable_mergejoin;
@@ -792,20 +790,19 @@
     2,
     3;
 --- QUERY PLAN ---
- Sort (actual rows=0.00 loops=1)
+ Incremental Sort (actual rows=0.00 loops=1)
    Sort Key: m.device_id, d.v0, (count(*))
-   Sort Method: quicksort 
-   ->  HashAggregate (actual rows=0.00 loops=1)
+   Presorted Key: m.device_id, d.v0
+   Full-sort Groups: 1  Sort Method: quicksort 
+   ->  GroupAggregate (actual rows=0.00 loops=1)
          Group Key: m.device_id, d.v0
-         ->  Hash Join (actual rows=0.00 loops=1)
-               Hash Cond: ((d.device_id = m.device_id) AND (d."time" = m."time"))
+         ->  Nested Loop (actual rows=0.00 loops=1)
                ->  Custom Scan (ConstraintAwareAppend) (actual rows=0.00 loops=1)
                      Hypertable: metrics_ordered_idx
                      Chunks excluded during startup: 2
-               ->  Hash (never executed)
-                     ->  Custom Scan (ConstraintAwareAppend) (never executed)
-                           Hypertable: metrics_ordered_idx
-                           Chunks excluded during startup: 2
+               ->  Custom Scan (ConstraintAwareAppend) (never executed)
+                     Hypertable: metrics_ordered_idx
+                     Chunks excluded during startup: 2
 
 --query with no results --
 :PREFIX
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_grouping.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_grouping.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/expected/vector_agg_grouping.out	2025-11-05 21:21:41.701102106 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/results/vector_agg_grouping.out	2025-11-05 21:32:09.503680299 +0000
@@ -1494,449 +1494,4 @@
  $  |   $
 
 select cint4, cint2, count(*) from agggroup where cint2 is null and x is null group by cint4, cint2 order by count(*), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -15063 |     $ |     1
- -14949 |     $ |     1
- -14443 |     $ |     1
- -11240 |     $ |     1
-  -8873 |     $ |     1
-  -7170 |     $ |     1
-  -4740 |     $ |     1
-  -1217 |     $ |     1
-   -166 |     $ |     1
-   -119 |     $ |     1
-
-select cint4, cint8, count(*) from agggroup where cint2 is null and x is null group by cint4, cint8 order by count(*), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -15063 |   3990 |     1
- -14949 | -10395 |     1
- -14443 | -12710 |     1
- -11240 |  -8825 |     1
-  -8873 | -12094 |     1
-  -7170 |   7723 |     1
-  -4740 |   7720 |     1
-  -1217 |   6383 |     1
-   -166 | -10858 |     1
-   -119 |   -231 |     1
-
-select cint2, cint4, cint8, count(*) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by count(*), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -15063 |   3990 |     1
-     $ | -14949 | -10395 |     1
-     $ | -14443 | -12710 |     1
-     $ | -11240 |  -8825 |     1
-     $ |  -8873 | -12094 |     1
-     $ |  -7170 |   7723 |     1
-     $ |  -4740 |   7720 |     1
-     $ |  -1217 |   6383 |     1
-     $ |   -166 | -10858 |     1
-     $ |   -119 |   -231 |     1
-
-select s, cint2, count(*) from agggroup where cint2 is null and x is null group by s, cint2 order by count(*), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 2 |     $ |    19
-
-select s, ss, count(*) from agggroup where cint2 is null and x is null group by s, ss order by count(*), s, ss limit 10;
- s | ss | count 
----+----+-------
- 2 |  $ |    19
-
-select s, x, count(*) from agggroup where cint2 is null and x is null group by s, x order by count(*), s, x limit 10;
- s | x | count 
----+---+-------
- 2 | $ |    19
-
-select ss, cint2, x, count(*) from agggroup where cint2 is null and x is null group by ss, cint2, x order by count(*), ss, cint2, x limit 10;
- ss | cint2 | x | count 
-----+-------+---+-------
-  $ |     $ | $ |    19
-
-select ss, s, count(*) from agggroup where cint2 is null and x is null group by ss, s order by count(*), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  $ | 2 |    19
-
-select ss, x, cint2, count(*) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by count(*), ss, x, cint2 limit 10;
- ss | x | cint2 | count 
-----+---+-------+-------
-  $ | $ |     $ |    19
-
-select t, s, ss, x, cint4, cint8, cint2, count(*) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by count(*), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |     1
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |     1
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |     1
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |     1
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |     1
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |     1
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |     1
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |     1
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |     1
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |     1
-
-select x, count(*) from agggroup where cint2 is null and x is null group by x order by count(*), x limit 10;
- x | count 
----+-------
- $ |    19
-
-select cint4, cint2, count(cint2) from agggroup where cint2 is null and x is null group by cint4, cint2 order by count(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | count 
---------+-------+-------
- -15063 |     $ |     0
- -14949 |     $ |     0
- -14443 |     $ |     0
- -11240 |     $ |     0
-  -8873 |     $ |     0
-  -7170 |     $ |     0
-  -4740 |     $ |     0
-  -1217 |     $ |     0
-   -166 |     $ |     0
-   -119 |     $ |     0
-
-select cint4, cint8, count(cint2) from agggroup where cint2 is null and x is null group by cint4, cint8 order by count(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | count 
---------+--------+-------
- -15063 |   3990 |     0
- -14949 | -10395 |     0
- -14443 | -12710 |     0
- -11240 |  -8825 |     0
-  -8873 | -12094 |     0
-  -7170 |   7723 |     0
-  -4740 |   7720 |     0
-  -1217 |   6383 |     0
-   -166 | -10858 |     0
-   -119 |   -231 |     0
-
-select cint2, cint4, cint8, count(cint2) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by count(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | count 
--------+--------+--------+-------
-     $ | -15063 |   3990 |     0
-     $ | -14949 | -10395 |     0
-     $ | -14443 | -12710 |     0
-     $ | -11240 |  -8825 |     0
-     $ |  -8873 | -12094 |     0
-     $ |  -7170 |   7723 |     0
-     $ |  -4740 |   7720 |     0
-     $ |  -1217 |   6383 |     0
-     $ |   -166 | -10858 |     0
-     $ |   -119 |   -231 |     0
-
-select s, cint2, count(cint2) from agggroup where cint2 is null and x is null group by s, cint2 order by count(cint2), s, cint2 limit 10;
- s | cint2 | count 
----+-------+-------
- 2 |     $ |     0
-
-select s, ss, count(cint2) from agggroup where cint2 is null and x is null group by s, ss order by count(cint2), s, ss limit 10;
- s | ss | count 
----+----+-------
- 2 |  $ |     0
-
-select s, x, count(cint2) from agggroup where cint2 is null and x is null group by s, x order by count(cint2), s, x limit 10;
- s | x | count 
----+---+-------
- 2 | $ |     0
-
-select ss, cint2, x, count(cint2) from agggroup where cint2 is null and x is null group by ss, cint2, x order by count(cint2), ss, cint2, x limit 10;
- ss | cint2 | x | count 
-----+-------+---+-------
-  $ |     $ | $ |     0
-
-select ss, s, count(cint2) from agggroup where cint2 is null and x is null group by ss, s order by count(cint2), ss, s limit 10;
- ss | s | count 
-----+---+-------
-  $ | 2 |     0
-
-select ss, x, cint2, count(cint2) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by count(cint2), ss, x, cint2 limit 10;
- ss | x | cint2 | count 
-----+---+-------+-------
-  $ | $ |     $ |     0
-
-select t, s, ss, x, cint4, cint8, cint2, count(cint2) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by count(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | count 
--------+---+----+---+--------+--------+-------+-------
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |     0
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |     0
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |     0
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |     0
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |     0
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |     0
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |     0
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |     0
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |     0
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |     0
-
-select x, count(cint2) from agggroup where cint2 is null and x is null group by x order by count(cint2), x limit 10;
- x | count 
----+-------
- $ |     0
-
-select cint4, cint2, min(cint2) from agggroup where cint2 is null and x is null group by cint4, cint2 order by min(cint2), cint4, cint2 limit 10;
- cint4  | cint2 | min 
---------+-------+-----
- -15063 |     $ |   $
- -14949 |     $ |   $
- -14443 |     $ |   $
- -11240 |     $ |   $
-  -8873 |     $ |   $
-  -7170 |     $ |   $
-  -4740 |     $ |   $
-  -1217 |     $ |   $
-   -166 |     $ |   $
-   -119 |     $ |   $
-
-select cint4, cint8, min(cint2) from agggroup where cint2 is null and x is null group by cint4, cint8 order by min(cint2), cint4, cint8 limit 10;
- cint4  | cint8  | min 
---------+--------+-----
- -15063 |   3990 |   $
- -14949 | -10395 |   $
- -14443 | -12710 |   $
- -11240 |  -8825 |   $
-  -8873 | -12094 |   $
-  -7170 |   7723 |   $
-  -4740 |   7720 |   $
-  -1217 |   6383 |   $
-   -166 | -10858 |   $
-   -119 |   -231 |   $
-
-select cint2, cint4, cint8, min(cint2) from agggroup where cint2 is null and x is null group by cint2, cint4, cint8 order by min(cint2), cint2, cint4, cint8 limit 10;
- cint2 | cint4  | cint8  | min 
--------+--------+--------+-----
-     $ | -15063 |   3990 |   $
-     $ | -14949 | -10395 |   $
-     $ | -14443 | -12710 |   $
-     $ | -11240 |  -8825 |   $
-     $ |  -8873 | -12094 |   $
-     $ |  -7170 |   7723 |   $
-     $ |  -4740 |   7720 |   $
-     $ |  -1217 |   6383 |   $
-     $ |   -166 | -10858 |   $
-     $ |   -119 |   -231 |   $
-
-select s, cint2, min(cint2) from agggroup where cint2 is null and x is null group by s, cint2 order by min(cint2), s, cint2 limit 10;
- s | cint2 | min 
----+-------+-----
- 2 |     $ |   $
-
-select s, ss, min(cint2) from agggroup where cint2 is null and x is null group by s, ss order by min(cint2), s, ss limit 10;
- s | ss | min 
----+----+-----
- 2 |  $ |   $
-
-select s, x, min(cint2) from agggroup where cint2 is null and x is null group by s, x order by min(cint2), s, x limit 10;
- s | x | min 
----+---+-----
- 2 | $ |   $
-
-select ss, cint2, x, min(cint2) from agggroup where cint2 is null and x is null group by ss, cint2, x order by min(cint2), ss, cint2, x limit 10;
- ss | cint2 | x | min 
-----+-------+---+-----
-  $ |     $ | $ |   $
-
-select ss, s, min(cint2) from agggroup where cint2 is null and x is null group by ss, s order by min(cint2), ss, s limit 10;
- ss | s | min 
-----+---+-----
-  $ | 2 |   $
-
-select ss, x, cint2, min(cint2) from agggroup where cint2 is null and x is null group by ss, x, cint2 order by min(cint2), ss, x, cint2 limit 10;
- ss | x | cint2 | min 
-----+---+-------+-----
-  $ | $ |     $ |   $
-
-select t, s, ss, x, cint4, cint8, cint2, min(cint2) from agggroup where cint2 is null and x is null group by t, s, ss, x, cint4, cint8, cint2 order by min(cint2), t, s, ss, x, cint4, cint8, cint2 limit 10;
-   t   | s | ss | x | cint4  | cint8  | cint2 | min 
--------+---+----+---+--------+--------+-------+-----
- 21051 | 2 |  $ | $ |  14385 |   -587 |     $ |   $
- 22102 | 2 |  $ | $ |  13826 |  -5912 |     $ |   $
- 23153 | 2 |  $ | $ |  11182 |   4556 |     $ |   $
- 24204 | 2 |  $ | $ | -15063 |   3990 |     $ |   $
- 25255 | 2 |  $ | $ |   2876 |   5568 |     $ |   $
- 26306 | 2 |  $ | $ |   -119 |   -231 |     $ |   $
- 27357 | 2 |  $ | $ |   9448 |   -312 |     $ |   $
- 28408 | 2 |  $ | $ |  -7170 |   7723 |     $ |   $
- 29459 | 2 |  $ | $ | -14443 | -12710 |     $ |   $
- 30510 | 2 |  $ | $ |  12536 |   8350 |     $ |   $
-
-select x, min(cint2) from agggroup where cint2 is null and x is null group by x order by min(cint2), x limit 10;
- x | min 
----+-----
- $ |   $
-
-reset timescaledb.debug_require_vector_agg;
--- Test long text columns. Also make one of them a segmentby, so that we can
--- test the long scalar values.
-create table long(t int, a text, b text, c text, d text);
-select create_hypertable('long', 't');
- create_hypertable 
--------------------
- (3,public,long,t)
-
-insert into long select n, a, x, x, x from (
-    select n, 'short' || m a, repeat('1', 100 * 4 + n) x
-    from generate_series(1, 4) n,
-        generate_series(1, 4) m) t
-;
-insert into long values (-1, 'a', 'b', 'c', 'd');
-insert into long values (-2, repeat('long', 1000), 'b', 'c', 'd');
-alter table long set (timescaledb.compress, timescaledb.compress_segmentby = 'a',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('long') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
--- Various placements of long scalar column
-select sum(t) from long group by a, b, c, d order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
-select sum(t) from long group by d, b, c, a order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
-select sum(t) from long group by d, b, a, c order by 1 limit 10;
- sum 
------
-  -2
-  -1
-   1
-   1
-   1
-   1
-   2
-   2
-   2
-   2
-
--- Just the scalar column
-select sum(t) from long group by a order by 1;
- sum 
------
-  -2
-  -1
-  10
-  10
-  10
-  10
-
--- No scalar columns
-select sum(t) from long group by b, c, d order by 1 limit 10;
- sum 
------
-  -3
-   4
-   8
-  12
-  16
-
-reset timescaledb.debug_require_vector_agg;
--- Test various serialized key lengths. We want to touch the transition from short
--- to long varlena header for the serialized key.
-create table keylength(t int, a text, b text);
-select create_hypertable('keylength', 't');
-   create_hypertable    
-------------------------
- (5,public,keylength,t)
-
-insert into keylength select t, 'a', repeat('b', t) from generate_series(1, 1000) t;
-insert into keylength values (-1, '', ''); -- second chunk
-alter table keylength set (timescaledb.compress, timescaledb.compress_segmentby = '',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('keylength') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
-select sum(t) from keylength group by a, b order by 1 desc limit 10;
- sum  
-------
- 1000
-  999
-  998
-  997
-  996
-  995
-  994
-  993
-  992
-  991
-
-select sum(t) from keylength group by b, a order by 1 desc limit 10;
- sum  
-------
- 1000
-  999
-  998
-  997
-  996
-  995
-  994
-  993
-  992
-  991
-
-reset timescaledb.debug_require_vector_agg;
--- Add a very simple test for NULLs. We also have some null values in the general
--- grouping test above.
-create table groupnull(t int, a text, b text);
-select create_hypertable('groupnull', 't');
-   create_hypertable    
-------------------------
- (7,public,groupnull,t)
-
-insert into groupnull values (1, '1', null), (2, null, '2'), (3000000, '3', '3');
-alter table groupnull set (timescaledb.compress, timescaledb.compress_segmentby = '',
-    timescaledb.compress_orderby = 't desc');
-select count(compress_chunk(x)) from show_chunks('groupnull') x;
- count 
--------
-     2
-
-set timescaledb.debug_require_vector_agg = 'require';
--- Uncomment to generate reference.
---set timescaledb.enable_vectorized_aggregation to off; set timescaledb.debug_require_vector_agg = 'allow';
-select sum(t), a, b from groupnull group by a, b order by 1;
-   sum   | a | b 
----------+---+---
-       1 | 1 | $
-       2 | $ | 2
- 3000000 | 3 | 3
-
-select sum(t), a, b from groupnull group by b, a order by 1;
-   sum   | a | b 
----------+---+---
-       1 | 1 | $
-       2 | $ | 2
- 3000000 | 3 | 3
-
-reset timescaledb.debug_require_vector_agg;
+ERROR:  postgres partial aggregation nodes inconsistent with debug_require_vector_agg GUC
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/constraint_exclusion_prepared-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/constraint_exclusion_prepared-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/constraint_exclusion_prepared-17.out	2025-11-05 21:21:41.729101850 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/constraint_exclusion_prepared-17.out	2025-11-05 21:32:14.753632480 +0000
@@ -1934,98 +1934,44 @@
 PREPARE prep(timestamptz) AS SELECT device_id, time FROM :TEST_TABLE WHERE time = $1 ORDER BY device_id, time;
 :PREFIX EXECUTE prep('2000-01-01 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=4.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 3996
-         ->  Sort (actual rows=4.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 2
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=4.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 3996
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 14
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Index Cond: ("time" = $1)
 
 :PREFIX EXECUTE prep('2000-01-10 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 4995
-         ->  Sort (actual rows=5.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 25
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 3
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=5.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 4995
+               ->  Sort (actual rows=5.00 loops=1)
+                     Sort Key: compress_hyper_X_X_chunk.device_id
+                     Sort Method: quicksort 
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=5.00 loops=1)
+                           Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
+                           Rows Removed by Filter: 25
 
 :PREFIX EXECUTE prep(now());
 --- QUERY PLAN ---
- Merge Append (actual rows=0.00 loops=1)
+ Sort (actual rows=0.00 loops=1)
    Sort Key: metrics_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Index Only Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Index Cond: ("time" = $1)
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 30
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_compressed (actual rows=0.00 loops=1)
+         Chunks excluded during startup: 4
 
 DEALLOCATE prep;
 RESET plan_cache_mode;
@@ -3149,240 +3095,63 @@
 PREPARE prep(timestamptz) AS SELECT device_id, time FROM :TEST_TABLE WHERE time = $1 ORDER BY device_id, time;
 :PREFIX EXECUTE prep('2000-01-01 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_space_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 6
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 3
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 2997
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 2997
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 9
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 3
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
 
 :PREFIX EXECUTE prep('2000-01-10 23:42');
 --- QUERY PLAN ---
- Merge Append (actual rows=5.00 loops=1)
+ Sort (actual rows=5.00 loops=1)
    Sort Key: metrics_space_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 12
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=5.00 loops=1)
+         Chunks excluded during startup: 6
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 5
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 2997
-         ->  Sort (actual rows=3.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 2997
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=3.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 15
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         Rows Removed by Filter: 999
-         ->  Sort (actual rows=1.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=1.00 loops=1)
+               Vectorized Filter: ("time" = $1)
+               Rows Removed by Filter: 999
                ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
                      Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
                      Rows Removed by Filter: 5
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
 
 :PREFIX EXECUTE prep(now());
 --- QUERY PLAN ---
- Merge Append (actual rows=0.00 loops=1)
+ Sort (actual rows=0.00 loops=1)
    Sort Key: metrics_space_compressed.device_id
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 12
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 4
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 18
-   ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-         Vectorized Filter: ("time" = $1)
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: compress_hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
-               ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
-                     Filter: ((_ts_meta_min_1 <= $1) AND (_ts_meta_max_1 >= $1))
-                     Rows Removed by Filter: 6
+   Sort Method: quicksort 
+   ->  Custom Scan (ChunkAppend) on metrics_space_compressed (actual rows=0.00 loops=1)
+         Chunks excluded during startup: 9
 
 DEALLOCATE prep;
 RESET plan_cache_mode;
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/ordered_append_join-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/ordered_append_join-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/ordered_append_join-17.out	2025-11-05 21:21:41.733101813 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/ordered_append_join-17.out	2025-11-05 21:32:18.862595190 +0000
@@ -1917,55 +1917,55 @@
 ORDER BY o1.time;
 --- QUERY PLAN ---
  Merge Join (actual rows=13674.00 loops=1)
-   Merge Cond: (o2."time" = o1."time")
-   ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=13674.00 loops=1)
-         Order: o2."time"
+   Merge Cond: (o1."time" = o2."time")
+   ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=13674.00 loops=1)
+         Order: o1."time"
          ->  Merge Append (actual rows=3598.00 loops=1)
-               Sort Key: o2."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=3598.00 loops=1)
-                     Filter: (device_id = 2)
+               Sort Key: o1."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=2000.00 loops=1)
+                     Filter: (device_id = 1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                     ->  Sort (actual rows=4.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
+                     ->  Sort (actual rows=2.00 loops=1)
+                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                            Sort Method: quicksort 
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=4.00 loops=1)
-                                 Filter: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-                                 Rows Removed by Filter: 14
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                     Index Cond: ((device_id = 2) AND ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (actual rows=5038.00 loops=1)
+                           ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
+                                 Filter: ((_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone) AND (device_id = 1))
+                                 Rows Removed by Filter: 16
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=1598.00 loops=1)
+                     Index Cond: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
+                     Filter: (device_id = 1)
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (actual rows=5038.00 loops=1)
                Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
-                     Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (actual rows=5038.00 loops=1)
+               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                     Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (actual rows=5038.00 loops=1)
                Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
-                     Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
+                     Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
    ->  Materialize (actual rows=13674.00 loops=1)
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=13674.00 loops=1)
-               Order: o1."time"
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=13674.00 loops=1)
+               Order: o2."time"
                ->  Merge Append (actual rows=3598.00 loops=1)
-                     Sort Key: o1."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=2000.00 loops=1)
-                           Filter: (device_id = 1)
+                     Sort Key: o2."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=3598.00 loops=1)
+                           Filter: (device_id = 2)
                            Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                           ->  Sort (actual rows=2.00 loops=1)
-                                 Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                           ->  Sort (actual rows=4.00 loops=1)
+                                 Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
                                  Sort Method: quicksort 
-                                 ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
-                                       Filter: ((_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone) AND (device_id = 1))
-                                       Rows Removed by Filter: 16
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=1598.00 loops=1)
-                           Index Cond: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                           Filter: (device_id = 1)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (actual rows=5038.00 loops=1)
+                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=4.00 loops=1)
+                                       Filter: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                                       Rows Removed by Filter: 14
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                           Index Cond: ((device_id = 2) AND ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (actual rows=5038.00 loops=1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                           Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (actual rows=5038.00 loops=1)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
+                           Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (actual rows=5038.00 loops=1)
                      Vectorized Filter: ("time" < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=6.00 loops=1)
-                           Index Cond: ((device_id = 1) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=6.00 loops=1)
+                           Index Cond: ((device_id = 2) AND (_ts_meta_min_1 < 'Tue Feb 01 00:00:00 2000 PST'::timestamp with time zone))
 
 -- test JOIN
 -- last chunk of o2 should not be executed
@@ -2101,40 +2101,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with USING
 -- should use 2 ChunkAppend
@@ -2149,40 +2149,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test NATURAL JOIN on time column
 -- should use 2 ChunkAppend
@@ -2215,40 +2215,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test RIGHT JOIN on time column
 -- should use 2 ChunkAppend
@@ -2263,40 +2263,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with ON clause expression order switched
 -- should use 2 ChunkAppend
@@ -2311,40 +2311,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with equality condition in WHERE clause
 -- should use 2 ChunkAppend
@@ -2360,40 +2360,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with ORDER BY 2nd hypertable
 -- should use 2 ChunkAppend
@@ -2408,40 +2408,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column and device_id
 -- should use 2 ChunkAppend
@@ -2553,40 +2553,40 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o2."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
-               Order: o2."time"
+         Merge Cond: (o1."time" = o2."time")
+         ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+               Order: o1."time"
                ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o2."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 2)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 2)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
-                           Index Cond: (device_id = 2)
+                     Sort Key: o1."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                           Filter: (device_id = 1)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                 Index Cond: (device_id = 1)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                           Filter: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                           Index Cond: (device_id = 1)
          ->  Materialize (actual rows=100.00 loops=1)
-               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                     Order: o1."time"
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
+                     Order: o2."time"
                      ->  Merge Append (actual rows=100.00 loops=1)
-                           Sort Key: o1."time"
-                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                       Index Cond: (device_id = 1)
-                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                 Filter: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                 Index Cond: (device_id = 1)
+                           Sort Key: o2."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 2)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o2_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
+                                 Index Cond: (device_id = 2)
 
 -- test JOIN on time column with 3 hypertables
 -- should use 3 ChunkAppend
@@ -2603,26 +2603,26 @@
 --- QUERY PLAN ---
  Limit (actual rows=100.00 loops=1)
    ->  Merge Join (actual rows=100.00 loops=1)
-         Merge Cond: (o3."time" = o1."time")
-         ->  Custom Scan (ChunkAppend) on metrics_compressed o3 (actual rows=100.00 loops=1)
-               Order: o3."time"
-               ->  Merge Append (actual rows=100.00 loops=1)
-                     Sort Key: o3."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
-                           Filter: (device_id = 3)
-                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (actual rows=1.00 loops=1)
-                                 Index Cond: (device_id = 3)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o3_1 (actual rows=0.00 loops=1)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
-                           Index Cond: (device_id = 3)
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
-                     ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
-                           Index Cond: (device_id = 3)
-         ->  Materialize (actual rows=100.00 loops=1)
-               ->  Merge Join (actual rows=100.00 loops=1)
-                     Merge Cond: (o2."time" = o1."time")
+         Merge Cond: (o1."time" = o3."time")
+         ->  Merge Join (actual rows=100.00 loops=1)
+               Merge Cond: (o1."time" = o2."time")
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
+                     Order: o1."time"
+                     ->  Merge Append (actual rows=100.00 loops=1)
+                           Sort Key: o1."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
+                                 Filter: (device_id = 1)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 1)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
+                                 Index Cond: (device_id = 1)
+               ->  Materialize (actual rows=100.00 loops=1)
                      ->  Custom Scan (ChunkAppend) on metrics_compressed o2 (actual rows=100.00 loops=1)
                            Order: o2."time"
                            ->  Merge Append (actual rows=100.00 loops=1)
@@ -2639,23 +2639,23 @@
                            ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o2_3 (never executed)
                                  ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (never executed)
                                        Index Cond: (device_id = 2)
-                     ->  Materialize (actual rows=100.00 loops=1)
-                           ->  Custom Scan (ChunkAppend) on metrics_compressed o1 (actual rows=100.00 loops=1)
-                                 Order: o1."time"
-                                 ->  Merge Append (actual rows=100.00 loops=1)
-                                       Sort Key: o1."time"
-                                       ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_1 (actual rows=1.00 loops=1)
-                                             Filter: (device_id = 1)
-                                             ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (actual rows=1.00 loops=1)
-                                                   Index Cond: (device_id = 1)
-                                       ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk o1_1 (actual rows=100.00 loops=1)
-                                             Filter: (device_id = 1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_2 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 1)
-                                 ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o1_3 (never executed)
-                                       ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk (never executed)
-                                             Index Cond: (device_id = 1)
+         ->  Materialize (actual rows=100.00 loops=1)
+               ->  Custom Scan (ChunkAppend) on metrics_compressed o3 (actual rows=100.00 loops=1)
+                     Order: o3."time"
+                     ->  Merge Append (actual rows=100.00 loops=1)
+                           Sort Key: o3."time"
+                           ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_1 (actual rows=100.00 loops=1)
+                                 Filter: (device_id = 3)
+                                 ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (actual rows=1.00 loops=1)
+                                       Index Cond: (device_id = 3)
+                           ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk o3_1 (actual rows=0.00 loops=1)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_2 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
+                                 Index Cond: (device_id = 3)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk o3_3 (never executed)
+                           ->  Index Scan Backward using compress_hyper_X_X_chunk_device_id__ts_meta_min_1__ts_meta_idx on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_2 (never executed)
+                                 Index Cond: (device_id = 3)
 
 RESET enable_seqscan;
 \set TEST_TABLE 'metrics_space_compressed'
diff -u /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/transparent_decompress_chunk-17.out /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/transparent_decompress_chunk-17.out
--- /home/runner/work/timescaledb/timescaledb/tsl/test/shared/expected/transparent_decompress_chunk-17.out	2025-11-05 21:21:41.734101804 +0000
+++ /home/runner/work/timescaledb/timescaledb/build/tsl/test/shared/results/transparent_decompress_chunk-17.out	2025-11-05 21:32:18.342599907 +0000
@@ -238,19 +238,15 @@
 :PREFIX SELECT * FROM :TEST_TABLE WHERE device_id IS NULL ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=0.00 loops=1)
-   ->  Merge Append (actual rows=0.00 loops=1)
+   ->  Sort (actual rows=0.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
+         Sort Method: quicksort 
+         ->  Append (actual rows=0.00 loops=1)
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=0.00 loops=1)
                      Filter: (device_id IS NULL)
                      ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=0.00 loops=1)
                            Filter: (device_id IS NULL)
                            Rows Removed by Filter: 18
-         ->  Sort (actual rows=0.00 loops=1)
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-               Sort Method: quicksort 
                ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
                      Index Cond: (device_id IS NULL)
 
@@ -326,18 +322,17 @@
 :PREFIX SELECT * FROM :TEST_TABLE WHERE device_id = 1 + 4 / 2 ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit (actual rows=10.00 loops=1)
-   ->  Merge Append (actual rows=10.00 loops=1)
+   ->  Sort (actual rows=10.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=10.00 loops=1)
-               Filter: (device_id = 3)
-               ->  Sort (actual rows=1.00 loops=1)
-                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                     Sort Method: quicksort 
+         Sort Method: top-N heapsort 
+         ->  Append (actual rows=3598.00 loops=1)
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
+                     Filter: (device_id = 3)
                      ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
                            Filter: (device_id = 3)
                            Rows Removed by Filter: 14
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-               Index Cond: (device_id = 3)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
+                     Index Cond: (device_id = 3)
 
 -- test function calls
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE device_id = length(substring(version(), 1, 3)) ORDER BY time, device_id LIMIT 10;
@@ -345,10 +340,10 @@
  Limit
    ->  Merge Append
          Sort Key: _hyper_X_X_chunk."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
-               Filter: (device_id = length("substring"(version(), 1, 3)))
-               ->  Sort
-                     Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1
+         ->  Sort
+               Sort Key: _hyper_X_X_chunk."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
+                     Filter: (device_id = length("substring"(version(), 1, 3)))
                      ->  Seq Scan on compress_hyper_X_X_chunk
                            Filter: (device_id = length("substring"(version(), 1, 3)))
          ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk
@@ -361,16 +356,15 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE time = '2000-01-01 1:00:00+0' ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk.device_id
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
-               Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
-               ->  Sort
-                     Sort Key: compress_hyper_X_X_chunk.device_id
+         ->  Append
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
+                     Vectorized Filter: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
                      ->  Seq Scan on compress_hyper_X_X_chunk
                            Filter: ((_ts_meta_min_1 <= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone) AND (_ts_meta_max_1 >= 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone))
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk
-               Index Cond: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk
+                     Index Cond: ("time" = 'Fri Dec 31 17:00:00 1999 PST'::timestamp with time zone)
 
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE time < '2000-01-01 1:00:00+0' ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
@@ -456,15 +450,12 @@
 :PREFIX_NO_VERBOSE SELECT * FROM :TEST_TABLE WHERE v0 < 1 ORDER BY time, device_id LIMIT 10;
 --- QUERY PLAN ---
  Limit
-   ->  Merge Append
+   ->  Sort
          Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
+         ->  Append
                ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk
                      Vectorized Filter: (v0 < 1)
                      ->  Seq Scan on compress_hyper_X_X_chunk
-         ->  Sort
-               Sort Key: _hyper_X_X_chunk."time", _hyper_X_X_chunk.device_id
                ->  Seq Scan on _hyper_X_X_chunk
                      Filter: (v0 < 1)
 
@@ -718,29 +709,28 @@
    Merge Cond: (_hyper_X_X_chunk."time" = _hyper_X_X_chunk_1."time")
    ->  Merge Append (actual rows=3598.00 loops=1)
          Sort Key: _hyper_X_X_chunk."time"
-         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=3598.00 loops=1)
-               Filter: (device_id = 2)
-               ->  Sort (actual rows=4.00 loops=1)
+         ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk (actual rows=2000.00 loops=1)
+               Filter: (device_id = 1)
+               ->  Sort (actual rows=2.00 loops=1)
                      Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
                      Sort Method: quicksort 
-                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=4.00 loops=1)
-                           Filter: (device_id = 2)
-                           Rows Removed by Filter: 14
-         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk (actual rows=0.00 loops=1)
-               Index Cond: (device_id = 2)
+                     ->  Seq Scan on compress_hyper_X_X_chunk (actual rows=2.00 loops=1)
+                           Filter: (device_id = 1)
+                           Rows Removed by Filter: 16
+         ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk (actual rows=1598.00 loops=1)
+               Filter: (device_id = 1)
    ->  Materialize (actual rows=3598.00 loops=1)
-         ->  Merge Append (actual rows=3598.00 loops=1)
+         ->  Sort (actual rows=3598.00 loops=1)
                Sort Key: _hyper_X_X_chunk_1."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=2000.00 loops=1)
-                     Filter: (device_id = 1)
-                     ->  Sort (actual rows=2.00 loops=1)
-                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
-                           Sort Method: quicksort 
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=2.00 loops=1)
-                                 Filter: (device_id = 1)
-                                 Rows Removed by Filter: 16
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=1598.00 loops=1)
-                     Filter: (device_id = 1)
+               Sort Method: quicksort 
+               ->  Append (actual rows=3598.00 loops=1)
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=3598.00 loops=1)
+                           Filter: (device_id = 2)
+                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1 (actual rows=4.00 loops=1)
+                                 Filter: (device_id = 2)
+                                 Rows Removed by Filter: 14
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk _hyper_X_X_chunk_1 (actual rows=0.00 loops=1)
+                           Index Cond: (device_id = 2)
 
 --
 -- test indexes
@@ -1032,28 +1022,28 @@
 --- QUERY PLAN ---
  Limit
    ->  Merge Join
-         Merge Cond: (m2."time" = m1."time")
+         Merge Cond: (m1."time" = m2."time")
          ->  Merge Append
-               Sort Key: m2."time"
-               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
-                     Filter: (device_id = 2)
+               Sort Key: m1."time"
+               ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
+                     Filter: (device_id = 1)
                      ->  Sort
-                           Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
-                           ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
-                                 Filter: (device_id = 2)
-               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m2
-                     Index Cond: (device_id = 2)
+                           Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
+                           ->  Seq Scan on compress_hyper_X_X_chunk
+                                 Filter: (device_id = 1)
+               ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk m1
+                     Filter: (device_id = 1)
          ->  Materialize
                ->  Merge Append
-                     Sort Key: m1."time"
-                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m1
-                           Filter: (device_id = 1)
+                     Sort Key: m2."time"
+                     ->  Custom Scan (ColumnarScan) on _hyper_X_X_chunk m2
+                           Filter: (device_id = 2)
                            ->  Sort
-                                 Sort Key: compress_hyper_X_X_chunk._ts_meta_min_1, compress_hyper_X_X_chunk._ts_meta_max_1
-                                 ->  Seq Scan on compress_hyper_X_X_chunk
-                                       Filter: (device_id = 1)
-                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_time_idx on _hyper_X_X_chunk m1
-                           Filter: (device_id = 1)
+                                 Sort Key: compress_hyper_X_X_chunk_1._ts_meta_min_1, compress_hyper_X_X_chunk_1._ts_meta_max_1
+                                 ->  Seq Scan on compress_hyper_X_X_chunk compress_hyper_X_X_chunk_1
+                                       Filter: (device_id = 2)
+                     ->  Index Scan using _hyper_X_X_chunk_metrics_compressed_device_id_time_idx on _hyper_X_X_chunk m2
+                           Index Cond: (device_id = 2)
 
 :PREFIX_NO_VERBOSE
 SELECT *
